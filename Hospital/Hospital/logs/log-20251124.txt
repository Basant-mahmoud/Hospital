2025-11-24 01:28:50.948 +02:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-11-24 01:28:51.091 +02:00 [DBG] Hosting starting
2025-11-24 01:28:51.129 +02:00 [INF] User profile is available. Using 'C:\Users\E-Mad\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-24 01:28:51.158 +02:00 [DBG] Reading data from file 'C:\Users\E-Mad\AppData\Local\ASP.NET\DataProtection-Keys\key-b85f0939-0825-4b2b-b21a-67409aec9db0.xml'.
2025-11-24 01:28:51.169 +02:00 [DBG] Found key {b85f0939-0825-4b2b-b21a-67409aec9db0}.
2025-11-24 01:28:51.177 +02:00 [DBG] Considering key {b85f0939-0825-4b2b-b21a-67409aec9db0} with expiration date 2026-02-09 12:52:20Z as default key.
2025-11-24 01:28:51.181 +02:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-11-24 01:28:51.183 +02:00 [DBG] Decrypting secret element using Windows DPAPI.
2025-11-24 01:28:51.185 +02:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-11-24 01:28:51.191 +02:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-11-24 01:28:51.193 +02:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-11-24 01:28:51.196 +02:00 [DBG] Using key {b85f0939-0825-4b2b-b21a-67409aec9db0} as the default key.
2025-11-24 01:28:51.198 +02:00 [DBG] Key ring with default key {b85f0939-0825-4b2b-b21a-67409aec9db0} was loaded during application startup.
2025-11-24 01:28:51.203 +02:00 [DBG] Middleware loaded
2025-11-24 01:28:51.205 +02:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16501 B).
2025-11-24 01:28:51.207 +02:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-11-24 01:28:51.301 +02:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-11-24 01:28:51.408 +02:00 [INF] Now listening on: https://localhost:7217
2025-11-24 01:28:51.409 +02:00 [INF] Now listening on: http://localhost:5163
2025-11-24 01:28:51.410 +02:00 [DBG] Loaded hosting startup assembly Hospital
2025-11-24 01:28:51.411 +02:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-11-24 01:28:51.411 +02:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-11-24 01:28:51.412 +02:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-11-24 01:28:51.471 +02:00 [DBG] Connection id "0HNHAT07OL6LB" received FIN.
2025-11-24 01:28:51.479 +02:00 [DBG] Connection id "0HNHAT07OL6LB" accepted.
2025-11-24 01:28:51.482 +02:00 [DBG] Connection id "0HNHAT07OL6LB" started.
2025-11-24 01:28:51.501 +02:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-11-24 01:28:51.537 +02:00 [DBG] Connection id "0HNHAT07OL6LB" stopped.
2025-11-24 01:28:51.541 +02:00 [DBG] Connection id "0HNHAT07OL6LB" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-11-24 01:28:51.545 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-24 01:28:51.546 +02:00 [INF] Hosting environment: Development
2025-11-24 01:28:51.547 +02:00 [INF] Content root path: D:\Walaa\GP\Hospital\Hospital
2025-11-24 01:28:51.548 +02:00 [DBG] Hosting started
2025-11-24 01:29:14.303 +02:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-11-24 01:29:14.711 +02:00 [DBG] The index {'BranchesBranchId'} was not created on entity type 'BranchDoctor (Dictionary<string, object>)' as the properties are already covered by the index {'BranchesBranchId', 'DoctorsDoctorId'}.
2025-11-24 01:29:14.712 +02:00 [DBG] The index {'BranchId'} was not created on entity type 'BranchService (Dictionary<string, object>)' as the properties are already covered by the index {'BranchId', 'ServiceId'}.
2025-11-24 01:29:14.712 +02:00 [DBG] The index {'BranchId'} was not created on entity type 'BranchSpecialization (Dictionary<string, object>)' as the properties are already covered by the index {'BranchId', 'SpecializationId'}.
2025-11-24 01:29:14.712 +02:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserRole<string>' as the properties are already covered by the index {'UserId', 'RoleId'}.
2025-11-24 01:29:14.712 +02:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserToken<string>' as the properties are already covered by the index {'UserId', 'LoginProvider', 'Name'}.
2025-11-24 01:29:14.805 +02:00 [DBG] The property 'BranchDoctor (Dictionary<string, object>).BranchesBranchId' was created in shadow state because there are no eligible CLR members with a matching name.
2025-11-24 01:29:14.805 +02:00 [DBG] The property 'BranchDoctor (Dictionary<string, object>).DoctorsDoctorId' was created in shadow state because there are no eligible CLR members with a matching name.
2025-11-24 01:29:14.960 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:29:14.966 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:29:15.003 +02:00 [DBG] Created DbConnection. (37ms).
2025-11-24 01:29:15.009 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:29:15.013 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:29:15.016 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 01:29:17.725 +02:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-11-24 01:29:18.091 +02:00 [DBG] The index {'BranchesBranchId'} was not created on entity type 'BranchDoctor (Dictionary<string, object>)' as the properties are already covered by the index {'BranchesBranchId', 'DoctorsDoctorId'}.
2025-11-24 01:29:18.092 +02:00 [DBG] The index {'BranchId'} was not created on entity type 'BranchService (Dictionary<string, object>)' as the properties are already covered by the index {'BranchId', 'ServiceId'}.
2025-11-24 01:29:18.092 +02:00 [DBG] The index {'BranchId'} was not created on entity type 'BranchSpecialization (Dictionary<string, object>)' as the properties are already covered by the index {'BranchId', 'SpecializationId'}.
2025-11-24 01:29:18.092 +02:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserRole<string>' as the properties are already covered by the index {'UserId', 'RoleId'}.
2025-11-24 01:29:18.092 +02:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserToken<string>' as the properties are already covered by the index {'UserId', 'LoginProvider', 'Name'}.
2025-11-24 01:29:18.170 +02:00 [DBG] The property 'BranchDoctor (Dictionary<string, object>).BranchesBranchId' was created in shadow state because there are no eligible CLR members with a matching name.
2025-11-24 01:29:18.170 +02:00 [DBG] The property 'BranchDoctor (Dictionary<string, object>).DoctorsDoctorId' was created in shadow state because there are no eligible CLR members with a matching name.
2025-11-24 01:29:18.292 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:29:18.294 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:29:18.322 +02:00 [DBG] Created DbConnection. (26ms).
2025-11-24 01:29:18.335 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:29:18.481 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:29:18.485 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:18.489 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (3ms).
2025-11-24 01:29:18.489 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (6ms).
2025-11-24 01:29:18.493 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-24 01:29:18.509 +02:00 [INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-24 01:29:18.510 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:29:18.516 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (2ms).
2025-11-24 01:29:18.533 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:29:18.533 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 01:29:18.533 +02:00 [DBG] Opening connection to database 'master' on server '.'.
2025-11-24 01:29:18.539 +02:00 [DBG] Opened connection to database 'master' on server '.'.
2025-11-24 01:29:18.539 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:18.539 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:18.540 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:18.540 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [HospitalDB] SET SINGLE_USER WITH ROLLBACK IMMEDIATE;
END;
2025-11-24 01:29:18.564 +02:00 [INF] Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [HospitalDB] SET SINGLE_USER WITH ROLLBACK IMMEDIATE;
END;
2025-11-24 01:29:18.564 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:18.564 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:18.564 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:18.565 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='60']
DROP DATABASE [HospitalDB];
2025-11-24 01:29:18.628 +02:00 [INF] Executed DbCommand (63ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
DROP DATABASE [HospitalDB];
2025-11-24 01:29:18.628 +02:00 [DBG] Closing connection to database 'master' on server '.'.
2025-11-24 01:29:18.628 +02:00 [DBG] Closed connection to database 'master' on server '.' (0ms).
2025-11-24 01:29:18.629 +02:00 [DBG] Disposing connection to database 'master' on server '.'.
2025-11-24 01:29:18.630 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 01:29:18.631 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:29:18.631 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:29:18.631 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 01:29:28.282 +02:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-11-24 01:29:28.640 +02:00 [DBG] The index {'BranchesBranchId'} was not created on entity type 'BranchDoctor (Dictionary<string, object>)' as the properties are already covered by the index {'BranchesBranchId', 'DoctorsDoctorId'}.
2025-11-24 01:29:28.642 +02:00 [DBG] The index {'BranchId'} was not created on entity type 'BranchService (Dictionary<string, object>)' as the properties are already covered by the index {'BranchId', 'ServiceId'}.
2025-11-24 01:29:28.642 +02:00 [DBG] The index {'BranchId'} was not created on entity type 'BranchSpecialization (Dictionary<string, object>)' as the properties are already covered by the index {'BranchId', 'SpecializationId'}.
2025-11-24 01:29:28.642 +02:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserRole<string>' as the properties are already covered by the index {'UserId', 'RoleId'}.
2025-11-24 01:29:28.642 +02:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserToken<string>' as the properties are already covered by the index {'UserId', 'LoginProvider', 'Name'}.
2025-11-24 01:29:28.717 +02:00 [DBG] The property 'BranchDoctor (Dictionary<string, object>).BranchesBranchId' was created in shadow state because there are no eligible CLR members with a matching name.
2025-11-24 01:29:28.717 +02:00 [DBG] The property 'BranchDoctor (Dictionary<string, object>).DoctorsDoctorId' was created in shadow state because there are no eligible CLR members with a matching name.
2025-11-24 01:29:28.840 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:29:28.866 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:29:28.891 +02:00 [DBG] Created DbConnection. (22ms).
2025-11-24 01:29:28.893 +02:00 [DBG] Migrating using database 'HospitalDB' on server '.'.
2025-11-24 01:29:28.896 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:29:29.005 +02:00 [DBG] An error occurred using the connection to database 'HospitalDB' on server '.'.
2025-11-24 01:29:29.005 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:29:29.006 +02:00 [DBG] An error occurred using the connection to database 'HospitalDB' on server '.'.
2025-11-24 01:29:29.075 +02:00 [DBG] The index {'BranchesBranchId'} was not created on entity type 'BranchDoctor (Dictionary<string, object>)' as the properties are already covered by the index {'BranchesBranchId', 'DoctorsDoctorId'}.
2025-11-24 01:29:29.075 +02:00 [DBG] The index {'BranchId'} was not created on entity type 'BranchService (Dictionary<string, object>)' as the properties are already covered by the index {'BranchId', 'ServiceId'}.
2025-11-24 01:29:29.075 +02:00 [DBG] The index {'BranchId'} was not created on entity type 'BranchSpecialization (Dictionary<string, object>)' as the properties are already covered by the index {'BranchId', 'SpecializationId'}.
2025-11-24 01:29:29.075 +02:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserRole<string>' as the properties are already covered by the index {'UserId', 'RoleId'}.
2025-11-24 01:29:29.075 +02:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserToken<string>' as the properties are already covered by the index {'UserId', 'LoginProvider', 'Name'}.
2025-11-24 01:29:29.090 +02:00 [DBG] The property 'BranchDoctor (Dictionary<string, object>).BranchesBranchId' was created in shadow state because there are no eligible CLR members with a matching name.
2025-11-24 01:29:29.090 +02:00 [DBG] The property 'BranchDoctor (Dictionary<string, object>).DoctorsDoctorId' was created in shadow state because there are no eligible CLR members with a matching name.
2025-11-24 01:29:29.114 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:29:29.114 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 01:29:29.114 +02:00 [DBG] Opening connection to database 'master' on server '.'.
2025-11-24 01:29:29.128 +02:00 [DBG] Opened connection to database 'master' on server '.'.
2025-11-24 01:29:29.133 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:29.137 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (4ms).
2025-11-24 01:29:29.139 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (8ms).
2025-11-24 01:29:29.142 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='60']
CREATE DATABASE [HospitalDB];
2025-11-24 01:29:29.288 +02:00 [INF] Executed DbCommand (144ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
CREATE DATABASE [HospitalDB];
2025-11-24 01:29:29.289 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:29.289 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:29.289 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:29.289 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [HospitalDB] SET READ_COMMITTED_SNAPSHOT ON;
END;
2025-11-24 01:29:29.345 +02:00 [INF] Executed DbCommand (55ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [HospitalDB] SET READ_COMMITTED_SNAPSHOT ON;
END;
2025-11-24 01:29:29.346 +02:00 [DBG] Closing connection to database 'master' on server '.'.
2025-11-24 01:29:29.352 +02:00 [DBG] Closed connection to database 'master' on server '.' (4ms).
2025-11-24 01:29:29.354 +02:00 [DBG] Disposing connection to database 'master' on server '.'.
2025-11-24 01:29:29.354 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 01:29:29.354 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:29:29.359 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:29:29.359 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:29.359 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:29.359 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:29.359 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-24 01:29:29.365 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-24 01:29:29.365 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:29:29.365 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:29:29.399 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:29.399 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:29.399 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:29.399 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:29:29.400 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:29:29.400 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [__EFMigrationsHistory] (
    [MigrationId] nvarchar(150) NOT NULL,
    [ProductVersion] nvarchar(32) NOT NULL,
    CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
);
2025-11-24 01:29:29.406 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [__EFMigrationsHistory] (
    [MigrationId] nvarchar(150) NOT NULL,
    [ProductVersion] nvarchar(32) NOT NULL,
    CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
);
2025-11-24 01:29:29.406 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:29:29.407 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:29:29.407 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:29:29.407 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:29:29.407 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:29.407 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:29.407 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:29.407 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-24 01:29:29.408 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-24 01:29:29.408 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:29:29.408 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:29:29.410 +02:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-11-24 01:29:29.429 +02:00 [DBG] Created DbCommand for 'ExecuteScalar' (19ms).
2025-11-24 01:29:29.429 +02:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (19ms).
2025-11-24 01:29:29.429 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:29:29.430 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:29:29.430 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-24 01:29:29.440 +02:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-24 01:29:29.440 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:29:29.441 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:29:29.441 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:29:29.442 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:29:29.442 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:29:29.442 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:29:29.442 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:29:29.442 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-24 01:29:29.449 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-24 01:29:29.451 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:29:29.451 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 01:29:29.451 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:29:29.451 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:29:29.462 +02:00 [INF] Applying migration '20251111134048_init-auth'.
2025-11-24 01:29:29.517 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:29:29.518 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:29:29.519 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 01:29:29.523 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 01:29:29.524 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:29.524 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:29.525 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:29.525 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetRoles] (
    [Id] nvarchar(450) NOT NULL,
    [Name] nvarchar(256) NULL,
    [NormalizedName] nvarchar(256) NULL,
    [ConcurrencyStamp] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetRoles] PRIMARY KEY ([Id])
);
2025-11-24 01:29:29.527 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetRoles] (
    [Id] nvarchar(450) NOT NULL,
    [Name] nvarchar(256) NULL,
    [NormalizedName] nvarchar(256) NULL,
    [ConcurrencyStamp] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetRoles] PRIMARY KEY ([Id])
);
2025-11-24 01:29:29.528 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:29.528 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:29.528 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:29.528 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Branches] (
    [BranchId] int NOT NULL IDENTITY,
    [BranchName] nvarchar(150) NOT NULL,
    [Address] nvarchar(250) NULL,
    [Phone] nvarchar(25) NULL,
    [Email] nvarchar(200) NULL,
    [Description] nvarchar(max) NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    [UpdatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    CONSTRAINT [PK_Branches] PRIMARY KEY ([BranchId])
);
2025-11-24 01:29:29.530 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Branches] (
    [BranchId] int NOT NULL IDENTITY,
    [BranchName] nvarchar(150) NOT NULL,
    [Address] nvarchar(250) NULL,
    [Phone] nvarchar(25) NULL,
    [Email] nvarchar(200) NULL,
    [Description] nvarchar(max) NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    [UpdatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    CONSTRAINT [PK_Branches] PRIMARY KEY ([BranchId])
);
2025-11-24 01:29:32.202 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:32.203 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:32.203 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:32.203 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Specializations] (
    [SpecializationId] int NOT NULL IDENTITY,
    [Name] nvarchar(120) NOT NULL,
    [Description] nvarchar(max) NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    [UpdatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    CONSTRAINT [PK_Specializations] PRIMARY KEY ([SpecializationId])
);
2025-11-24 01:29:32.207 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Specializations] (
    [SpecializationId] int NOT NULL IDENTITY,
    [Name] nvarchar(120) NOT NULL,
    [Description] nvarchar(max) NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    [UpdatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    CONSTRAINT [PK_Specializations] PRIMARY KEY ([SpecializationId])
);
2025-11-24 01:29:32.207 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:32.207 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:32.207 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:32.207 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetRoleClaims] (
    [Id] int NOT NULL IDENTITY,
    [RoleId] nvarchar(450) NOT NULL,
    [ClaimType] nvarchar(max) NULL,
    [ClaimValue] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetRoleClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_AspNetRoleClaims_AspNetRoles_RoleId] FOREIGN KEY ([RoleId]) REFERENCES [AspNetRoles] ([Id]) ON DELETE CASCADE
);
2025-11-24 01:29:32.209 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetRoleClaims] (
    [Id] int NOT NULL IDENTITY,
    [RoleId] nvarchar(450) NOT NULL,
    [ClaimType] nvarchar(max) NULL,
    [ClaimValue] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetRoleClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_AspNetRoleClaims_AspNetRoles_RoleId] FOREIGN KEY ([RoleId]) REFERENCES [AspNetRoles] ([Id]) ON DELETE CASCADE
);
2025-11-24 01:29:32.209 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:32.209 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:32.209 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:32.209 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Banners] (
    [BannerId] int NOT NULL IDENTITY,
    [Title] nvarchar(150) NOT NULL,
    [ImageURL] nvarchar(300) NULL,
    [LinkURL] nvarchar(300) NULL,
    [Type] nvarchar(20) NULL,
    [BranchId] int NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    [UpdatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    CONSTRAINT [PK_Banners] PRIMARY KEY ([BannerId]),
    CONSTRAINT [FK_Banners_Branches_BranchId] FOREIGN KEY ([BranchId]) REFERENCES [Branches] ([BranchId]) ON DELETE SET NULL
);
2025-11-24 01:29:32.210 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Banners] (
    [BannerId] int NOT NULL IDENTITY,
    [Title] nvarchar(150) NOT NULL,
    [ImageURL] nvarchar(300) NULL,
    [LinkURL] nvarchar(300) NULL,
    [Type] nvarchar(20) NULL,
    [BranchId] int NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    [UpdatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    CONSTRAINT [PK_Banners] PRIMARY KEY ([BannerId]),
    CONSTRAINT [FK_Banners_Branches_BranchId] FOREIGN KEY ([BranchId]) REFERENCES [Branches] ([BranchId]) ON DELETE SET NULL
);
2025-11-24 01:29:32.210 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:32.211 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:32.211 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:32.211 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Events] (
    [EventId] int NOT NULL IDENTITY,
    [Title] nvarchar(150) NOT NULL,
    [Description] nvarchar(max) NULL,
    [EventDate] datetime2 NOT NULL,
    [ImageURL] nvarchar(300) NULL,
    [BranchId] int NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    [UpdatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    CONSTRAINT [PK_Events] PRIMARY KEY ([EventId]),
    CONSTRAINT [FK_Events_Branches_BranchId] FOREIGN KEY ([BranchId]) REFERENCES [Branches] ([BranchId]) ON DELETE SET NULL
);
2025-11-24 01:29:35.367 +02:00 [INF] Executed DbCommand (3,156ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Events] (
    [EventId] int NOT NULL IDENTITY,
    [Title] nvarchar(150) NOT NULL,
    [Description] nvarchar(max) NULL,
    [EventDate] datetime2 NOT NULL,
    [ImageURL] nvarchar(300) NULL,
    [BranchId] int NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    [UpdatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    CONSTRAINT [PK_Events] PRIMARY KEY ([EventId]),
    CONSTRAINT [FK_Events_Branches_BranchId] FOREIGN KEY ([BranchId]) REFERENCES [Branches] ([BranchId]) ON DELETE SET NULL
);
2025-11-24 01:29:35.368 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:35.368 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:35.368 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:35.368 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [News] (
    [NewsId] int NOT NULL IDENTITY,
    [Title] nvarchar(150) NOT NULL,
    [Description] nvarchar(max) NULL,
    [ImageURL] nvarchar(300) NULL,
    [Date] datetime2 NOT NULL,
    [BranchId] int NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    [UpdatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    CONSTRAINT [PK_News] PRIMARY KEY ([NewsId]),
    CONSTRAINT [FK_News_Branches_BranchId] FOREIGN KEY ([BranchId]) REFERENCES [Branches] ([BranchId]) ON DELETE SET NULL
);
2025-11-24 01:29:35.369 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [News] (
    [NewsId] int NOT NULL IDENTITY,
    [Title] nvarchar(150) NOT NULL,
    [Description] nvarchar(max) NULL,
    [ImageURL] nvarchar(300) NULL,
    [Date] datetime2 NOT NULL,
    [BranchId] int NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    [UpdatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    CONSTRAINT [PK_News] PRIMARY KEY ([NewsId]),
    CONSTRAINT [FK_News_Branches_BranchId] FOREIGN KEY ([BranchId]) REFERENCES [Branches] ([BranchId]) ON DELETE SET NULL
);
2025-11-24 01:29:35.370 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:35.370 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:35.370 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:35.370 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Users] (
    [Id] nvarchar(450) NOT NULL,
    [FullName] nvarchar(150) NOT NULL,
    [Gender] nvarchar(10) NULL,
    [DateOfBirth] datetime2 NULL,
    [Role] nvarchar(50) NOT NULL,
    [BranchId] int NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    [UpdatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    [UserName] nvarchar(256) NULL,
    [NormalizedUserName] nvarchar(256) NULL,
    [Email] nvarchar(256) NULL,
    [NormalizedEmail] nvarchar(256) NULL,
    [EmailConfirmed] bit NOT NULL,
    [PasswordHash] nvarchar(max) NULL,
    [SecurityStamp] nvarchar(max) NULL,
    [ConcurrencyStamp] nvarchar(max) NULL,
    [PhoneNumber] nvarchar(max) NULL,
    [PhoneNumberConfirmed] bit NOT NULL,
    [TwoFactorEnabled] bit NOT NULL,
    [LockoutEnd] datetimeoffset NULL,
    [LockoutEnabled] bit NOT NULL,
    [AccessFailedCount] int NOT NULL,
    CONSTRAINT [PK_Users] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Users_Branches_BranchId] FOREIGN KEY ([BranchId]) REFERENCES [Branches] ([BranchId]) ON DELETE SET NULL
);
2025-11-24 01:29:35.378 +02:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Users] (
    [Id] nvarchar(450) NOT NULL,
    [FullName] nvarchar(150) NOT NULL,
    [Gender] nvarchar(10) NULL,
    [DateOfBirth] datetime2 NULL,
    [Role] nvarchar(50) NOT NULL,
    [BranchId] int NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    [UpdatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    [UserName] nvarchar(256) NULL,
    [NormalizedUserName] nvarchar(256) NULL,
    [Email] nvarchar(256) NULL,
    [NormalizedEmail] nvarchar(256) NULL,
    [EmailConfirmed] bit NOT NULL,
    [PasswordHash] nvarchar(max) NULL,
    [SecurityStamp] nvarchar(max) NULL,
    [ConcurrencyStamp] nvarchar(max) NULL,
    [PhoneNumber] nvarchar(max) NULL,
    [PhoneNumberConfirmed] bit NOT NULL,
    [TwoFactorEnabled] bit NOT NULL,
    [LockoutEnd] datetimeoffset NULL,
    [LockoutEnabled] bit NOT NULL,
    [AccessFailedCount] int NOT NULL,
    CONSTRAINT [PK_Users] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Users_Branches_BranchId] FOREIGN KEY ([BranchId]) REFERENCES [Branches] ([BranchId]) ON DELETE SET NULL
);
2025-11-24 01:29:38.094 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:38.094 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:38.094 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:38.094 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Services] (
    [ServiceId] int NOT NULL IDENTITY,
    [Name] nvarchar(120) NOT NULL,
    [Description] nvarchar(max) NULL,
    [ImageURL] nvarchar(300) NULL,
    [BranchId] int NULL,
    [SpecializationId] int NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    [UpdatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    CONSTRAINT [PK_Services] PRIMARY KEY ([ServiceId]),
    CONSTRAINT [FK_Services_Branches_BranchId] FOREIGN KEY ([BranchId]) REFERENCES [Branches] ([BranchId]) ON DELETE SET NULL,
    CONSTRAINT [FK_Services_Specializations_SpecializationId] FOREIGN KEY ([SpecializationId]) REFERENCES [Specializations] ([SpecializationId]) ON DELETE SET NULL
);
2025-11-24 01:29:38.097 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Services] (
    [ServiceId] int NOT NULL IDENTITY,
    [Name] nvarchar(120) NOT NULL,
    [Description] nvarchar(max) NULL,
    [ImageURL] nvarchar(300) NULL,
    [BranchId] int NULL,
    [SpecializationId] int NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    [UpdatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    CONSTRAINT [PK_Services] PRIMARY KEY ([ServiceId]),
    CONSTRAINT [FK_Services_Branches_BranchId] FOREIGN KEY ([BranchId]) REFERENCES [Branches] ([BranchId]) ON DELETE SET NULL,
    CONSTRAINT [FK_Services_Specializations_SpecializationId] FOREIGN KEY ([SpecializationId]) REFERENCES [Specializations] ([SpecializationId]) ON DELETE SET NULL
);
2025-11-24 01:29:38.097 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:38.097 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:38.097 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:38.097 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserClaims] (
    [Id] int NOT NULL IDENTITY,
    [UserId] nvarchar(450) NOT NULL,
    [ClaimType] nvarchar(max) NULL,
    [ClaimValue] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetUserClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_AspNetUserClaims_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-11-24 01:29:38.099 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserClaims] (
    [Id] int NOT NULL IDENTITY,
    [UserId] nvarchar(450) NOT NULL,
    [ClaimType] nvarchar(max) NULL,
    [ClaimValue] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetUserClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_AspNetUserClaims_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-11-24 01:29:38.099 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:38.099 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:38.099 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:41.770 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserLogins] (
    [LoginProvider] nvarchar(450) NOT NULL,
    [ProviderKey] nvarchar(450) NOT NULL,
    [ProviderDisplayName] nvarchar(max) NULL,
    [UserId] nvarchar(450) NOT NULL,
    CONSTRAINT [PK_AspNetUserLogins] PRIMARY KEY ([LoginProvider], [ProviderKey]),
    CONSTRAINT [FK_AspNetUserLogins_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-11-24 01:29:41.777 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserLogins] (
    [LoginProvider] nvarchar(450) NOT NULL,
    [ProviderKey] nvarchar(450) NOT NULL,
    [ProviderDisplayName] nvarchar(max) NULL,
    [UserId] nvarchar(450) NOT NULL,
    CONSTRAINT [PK_AspNetUserLogins] PRIMARY KEY ([LoginProvider], [ProviderKey]),
    CONSTRAINT [FK_AspNetUserLogins_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-11-24 01:29:41.777 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:41.777 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:41.777 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:41.777 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserRoles] (
    [UserId] nvarchar(450) NOT NULL,
    [RoleId] nvarchar(450) NOT NULL,
    CONSTRAINT [PK_AspNetUserRoles] PRIMARY KEY ([UserId], [RoleId]),
    CONSTRAINT [FK_AspNetUserRoles_AspNetRoles_RoleId] FOREIGN KEY ([RoleId]) REFERENCES [AspNetRoles] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_AspNetUserRoles_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-11-24 01:29:41.792 +02:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserRoles] (
    [UserId] nvarchar(450) NOT NULL,
    [RoleId] nvarchar(450) NOT NULL,
    CONSTRAINT [PK_AspNetUserRoles] PRIMARY KEY ([UserId], [RoleId]),
    CONSTRAINT [FK_AspNetUserRoles_AspNetRoles_RoleId] FOREIGN KEY ([RoleId]) REFERENCES [AspNetRoles] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_AspNetUserRoles_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-11-24 01:29:41.792 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:41.792 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:41.792 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:41.792 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserTokens] (
    [UserId] nvarchar(450) NOT NULL,
    [LoginProvider] nvarchar(450) NOT NULL,
    [Name] nvarchar(450) NOT NULL,
    [Value] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetUserTokens] PRIMARY KEY ([UserId], [LoginProvider], [Name]),
    CONSTRAINT [FK_AspNetUserTokens_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-11-24 01:29:41.795 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserTokens] (
    [UserId] nvarchar(450) NOT NULL,
    [LoginProvider] nvarchar(450) NOT NULL,
    [Name] nvarchar(450) NOT NULL,
    [Value] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetUserTokens] PRIMARY KEY ([UserId], [LoginProvider], [Name]),
    CONSTRAINT [FK_AspNetUserTokens_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-11-24 01:29:41.795 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:41.795 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:41.795 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:41.795 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Doctors] (
    [DoctorId] int NOT NULL IDENTITY,
    [UserId] nvarchar(450) NOT NULL,
    [SpecializationId] int NOT NULL,
    [BranchId] int NOT NULL,
    [Biography] nvarchar(max) NULL,
    [ExperienceYears] int NULL,
    [ConsultationFees] decimal(10,2) NULL,
    [Available] bit NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    [UpdatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    CONSTRAINT [PK_Doctors] PRIMARY KEY ([DoctorId]),
    CONSTRAINT [FK_Doctors_Branches_BranchId] FOREIGN KEY ([BranchId]) REFERENCES [Branches] ([BranchId]) ON DELETE NO ACTION,
    CONSTRAINT [FK_Doctors_Specializations_SpecializationId] FOREIGN KEY ([SpecializationId]) REFERENCES [Specializations] ([SpecializationId]) ON DELETE NO ACTION,
    CONSTRAINT [FK_Doctors_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-11-24 01:29:44.473 +02:00 [INF] Executed DbCommand (2,678ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Doctors] (
    [DoctorId] int NOT NULL IDENTITY,
    [UserId] nvarchar(450) NOT NULL,
    [SpecializationId] int NOT NULL,
    [BranchId] int NOT NULL,
    [Biography] nvarchar(max) NULL,
    [ExperienceYears] int NULL,
    [ConsultationFees] decimal(10,2) NULL,
    [Available] bit NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    [UpdatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    CONSTRAINT [PK_Doctors] PRIMARY KEY ([DoctorId]),
    CONSTRAINT [FK_Doctors_Branches_BranchId] FOREIGN KEY ([BranchId]) REFERENCES [Branches] ([BranchId]) ON DELETE NO ACTION,
    CONSTRAINT [FK_Doctors_Specializations_SpecializationId] FOREIGN KEY ([SpecializationId]) REFERENCES [Specializations] ([SpecializationId]) ON DELETE NO ACTION,
    CONSTRAINT [FK_Doctors_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-11-24 01:29:44.473 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:44.474 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:44.474 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:44.474 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Patients] (
    [PatientId] int NOT NULL IDENTITY,
    [UserId] nvarchar(450) NOT NULL,
    [BloodType] nvarchar(5) NULL,
    [EmergencyContact] nvarchar(150) NULL,
    [Address] nvarchar(250) NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    [UpdatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    CONSTRAINT [PK_Patients] PRIMARY KEY ([PatientId]),
    CONSTRAINT [FK_Patients_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-11-24 01:29:44.480 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Patients] (
    [PatientId] int NOT NULL IDENTITY,
    [UserId] nvarchar(450) NOT NULL,
    [BloodType] nvarchar(5) NULL,
    [EmergencyContact] nvarchar(150) NULL,
    [Address] nvarchar(250) NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    [UpdatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    CONSTRAINT [PK_Patients] PRIMARY KEY ([PatientId]),
    CONSTRAINT [FK_Patients_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-11-24 01:29:44.480 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:44.480 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:44.480 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:44.480 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [SupportTickets] (
    [TicketId] int NOT NULL IDENTITY,
    [UserId] nvarchar(450) NOT NULL,
    [Subject] nvarchar(200) NOT NULL,
    [Message] nvarchar(max) NOT NULL,
    [Status] nvarchar(20) NOT NULL,
    [Response] nvarchar(max) NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    [UpdatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    CONSTRAINT [PK_SupportTickets] PRIMARY KEY ([TicketId]),
    CONSTRAINT [FK_SupportTickets_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-11-24 01:29:44.483 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [SupportTickets] (
    [TicketId] int NOT NULL IDENTITY,
    [UserId] nvarchar(450) NOT NULL,
    [Subject] nvarchar(200) NOT NULL,
    [Message] nvarchar(max) NOT NULL,
    [Status] nvarchar(20) NOT NULL,
    [Response] nvarchar(max) NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    [UpdatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    CONSTRAINT [PK_SupportTickets] PRIMARY KEY ([TicketId]),
    CONSTRAINT [FK_SupportTickets_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-11-24 01:29:47.262 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:47.262 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:47.262 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:47.262 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Schedules] (
    [ScheduleId] int NOT NULL IDENTITY,
    [DoctorId] int NOT NULL,
    [DayOfWeek] nvarchar(20) NOT NULL,
    [StartTime] time NOT NULL,
    [EndTime] time NOT NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    [UpdatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    CONSTRAINT [PK_Schedules] PRIMARY KEY ([ScheduleId]),
    CONSTRAINT [FK_Schedules_Doctors_DoctorId] FOREIGN KEY ([DoctorId]) REFERENCES [Doctors] ([DoctorId]) ON DELETE CASCADE
);
2025-11-24 01:29:47.279 +02:00 [INF] Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Schedules] (
    [ScheduleId] int NOT NULL IDENTITY,
    [DoctorId] int NOT NULL,
    [DayOfWeek] nvarchar(20) NOT NULL,
    [StartTime] time NOT NULL,
    [EndTime] time NOT NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    [UpdatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    CONSTRAINT [PK_Schedules] PRIMARY KEY ([ScheduleId]),
    CONSTRAINT [FK_Schedules_Doctors_DoctorId] FOREIGN KEY ([DoctorId]) REFERENCES [Doctors] ([DoctorId]) ON DELETE CASCADE
);
2025-11-24 01:29:47.279 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:47.280 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:47.280 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:47.280 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Appointments] (
    [AppointmentId] int NOT NULL IDENTITY,
    [PatientId] int NOT NULL,
    [DoctorId] int NOT NULL,
    [BranchId] int NOT NULL,
    [Date] datetime2 NOT NULL,
    [Time] time NOT NULL,
    [Status] nvarchar(20) NOT NULL,
    [CreatedBy] nvarchar(450) NULL,
    [Notes] nvarchar(max) NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    [UpdatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    CONSTRAINT [PK_Appointments] PRIMARY KEY ([AppointmentId]),
    CONSTRAINT [FK_Appointments_Branches_BranchId] FOREIGN KEY ([BranchId]) REFERENCES [Branches] ([BranchId]) ON DELETE NO ACTION,
    CONSTRAINT [FK_Appointments_Doctors_DoctorId] FOREIGN KEY ([DoctorId]) REFERENCES [Doctors] ([DoctorId]) ON DELETE NO ACTION,
    CONSTRAINT [FK_Appointments_Patients_PatientId] FOREIGN KEY ([PatientId]) REFERENCES [Patients] ([PatientId]) ON DELETE NO ACTION,
    CONSTRAINT [FK_Appointments_Users_CreatedBy] FOREIGN KEY ([CreatedBy]) REFERENCES [Users] ([Id]) ON DELETE SET NULL
);
2025-11-24 01:29:47.283 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Appointments] (
    [AppointmentId] int NOT NULL IDENTITY,
    [PatientId] int NOT NULL,
    [DoctorId] int NOT NULL,
    [BranchId] int NOT NULL,
    [Date] datetime2 NOT NULL,
    [Time] time NOT NULL,
    [Status] nvarchar(20) NOT NULL,
    [CreatedBy] nvarchar(450) NULL,
    [Notes] nvarchar(max) NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    [UpdatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    CONSTRAINT [PK_Appointments] PRIMARY KEY ([AppointmentId]),
    CONSTRAINT [FK_Appointments_Branches_BranchId] FOREIGN KEY ([BranchId]) REFERENCES [Branches] ([BranchId]) ON DELETE NO ACTION,
    CONSTRAINT [FK_Appointments_Doctors_DoctorId] FOREIGN KEY ([DoctorId]) REFERENCES [Doctors] ([DoctorId]) ON DELETE NO ACTION,
    CONSTRAINT [FK_Appointments_Patients_PatientId] FOREIGN KEY ([PatientId]) REFERENCES [Patients] ([PatientId]) ON DELETE NO ACTION,
    CONSTRAINT [FK_Appointments_Users_CreatedBy] FOREIGN KEY ([CreatedBy]) REFERENCES [Users] ([Id]) ON DELETE SET NULL
);
2025-11-24 01:29:50.015 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:50.015 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:50.016 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:50.016 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [MedicalRecords] (
    [RecordId] int NOT NULL IDENTITY,
    [AppointmentId] int NOT NULL,
    [DoctorId] int NOT NULL,
    [PatientId] int NOT NULL,
    [Diagnosis] nvarchar(max) NULL,
    [TreatmentPlan] nvarchar(max) NULL,
    [Notes] nvarchar(max) NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    [UpdatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    CONSTRAINT [PK_MedicalRecords] PRIMARY KEY ([RecordId]),
    CONSTRAINT [FK_MedicalRecords_Appointments_AppointmentId] FOREIGN KEY ([AppointmentId]) REFERENCES [Appointments] ([AppointmentId]) ON DELETE CASCADE,
    CONSTRAINT [FK_MedicalRecords_Doctors_DoctorId] FOREIGN KEY ([DoctorId]) REFERENCES [Doctors] ([DoctorId]) ON DELETE NO ACTION,
    CONSTRAINT [FK_MedicalRecords_Patients_PatientId] FOREIGN KEY ([PatientId]) REFERENCES [Patients] ([PatientId]) ON DELETE NO ACTION
);
2025-11-24 01:29:50.028 +02:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [MedicalRecords] (
    [RecordId] int NOT NULL IDENTITY,
    [AppointmentId] int NOT NULL,
    [DoctorId] int NOT NULL,
    [PatientId] int NOT NULL,
    [Diagnosis] nvarchar(max) NULL,
    [TreatmentPlan] nvarchar(max) NULL,
    [Notes] nvarchar(max) NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    [UpdatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    CONSTRAINT [PK_MedicalRecords] PRIMARY KEY ([RecordId]),
    CONSTRAINT [FK_MedicalRecords_Appointments_AppointmentId] FOREIGN KEY ([AppointmentId]) REFERENCES [Appointments] ([AppointmentId]) ON DELETE CASCADE,
    CONSTRAINT [FK_MedicalRecords_Doctors_DoctorId] FOREIGN KEY ([DoctorId]) REFERENCES [Doctors] ([DoctorId]) ON DELETE NO ACTION,
    CONSTRAINT [FK_MedicalRecords_Patients_PatientId] FOREIGN KEY ([PatientId]) REFERENCES [Patients] ([PatientId]) ON DELETE NO ACTION
);
2025-11-24 01:29:50.028 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:50.028 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:50.028 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:50.028 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Appointments_BranchId] ON [Appointments] ([BranchId]);
2025-11-24 01:29:50.030 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Appointments_BranchId] ON [Appointments] ([BranchId]);
2025-11-24 01:29:50.030 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:50.030 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:50.030 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:50.030 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Appointments_CreatedBy] ON [Appointments] ([CreatedBy]);
2025-11-24 01:29:50.031 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Appointments_CreatedBy] ON [Appointments] ([CreatedBy]);
2025-11-24 01:29:50.031 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:50.031 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:50.031 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:50.031 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Appointments_DoctorId] ON [Appointments] ([DoctorId]);
2025-11-24 01:29:50.033 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Appointments_DoctorId] ON [Appointments] ([DoctorId]);
2025-11-24 01:29:50.033 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:50.033 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:50.033 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:50.033 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Appointments_PatientId] ON [Appointments] ([PatientId]);
2025-11-24 01:29:52.660 +02:00 [INF] Executed DbCommand (2,627ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Appointments_PatientId] ON [Appointments] ([PatientId]);
2025-11-24 01:29:52.660 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:52.660 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:52.660 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:52.660 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetRoleClaims_RoleId] ON [AspNetRoleClaims] ([RoleId]);
2025-11-24 01:29:52.661 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetRoleClaims_RoleId] ON [AspNetRoleClaims] ([RoleId]);
2025-11-24 01:29:52.661 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:52.661 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:52.661 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:52.661 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [RoleNameIndex] ON [AspNetRoles] ([NormalizedName]) WHERE [NormalizedName] IS NOT NULL;
2025-11-24 01:29:52.669 +02:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [RoleNameIndex] ON [AspNetRoles] ([NormalizedName]) WHERE [NormalizedName] IS NOT NULL;
2025-11-24 01:29:52.669 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:52.669 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:52.669 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:52.669 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetUserClaims_UserId] ON [AspNetUserClaims] ([UserId]);
2025-11-24 01:29:52.671 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetUserClaims_UserId] ON [AspNetUserClaims] ([UserId]);
2025-11-24 01:29:52.671 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:52.671 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:52.671 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:52.671 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetUserLogins_UserId] ON [AspNetUserLogins] ([UserId]);
2025-11-24 01:29:52.672 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetUserLogins_UserId] ON [AspNetUserLogins] ([UserId]);
2025-11-24 01:29:52.672 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:52.672 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:52.673 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:52.673 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetUserRoles_RoleId] ON [AspNetUserRoles] ([RoleId]);
2025-11-24 01:29:52.674 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetUserRoles_RoleId] ON [AspNetUserRoles] ([RoleId]);
2025-11-24 01:29:52.674 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:52.674 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:52.674 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:52.674 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Banners_BranchId] ON [Banners] ([BranchId]);
2025-11-24 01:29:52.675 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Banners_BranchId] ON [Banners] ([BranchId]);
2025-11-24 01:29:52.675 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:52.675 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:52.675 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:52.675 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Doctors_BranchId] ON [Doctors] ([BranchId]);
2025-11-24 01:29:52.676 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Doctors_BranchId] ON [Doctors] ([BranchId]);
2025-11-24 01:29:52.676 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:52.676 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:54.941 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (2264ms).
2025-11-24 01:29:54.941 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Doctors_SpecializationId] ON [Doctors] ([SpecializationId]);
2025-11-24 01:29:54.942 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Doctors_SpecializationId] ON [Doctors] ([SpecializationId]);
2025-11-24 01:29:54.942 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:54.942 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:54.942 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:54.942 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Doctors_UserId] ON [Doctors] ([UserId]);
2025-11-24 01:29:54.943 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Doctors_UserId] ON [Doctors] ([UserId]);
2025-11-24 01:29:54.943 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:54.943 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:54.943 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:54.943 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Events_BranchId] ON [Events] ([BranchId]);
2025-11-24 01:29:54.944 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Events_BranchId] ON [Events] ([BranchId]);
2025-11-24 01:29:54.944 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:54.944 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:54.944 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:54.944 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_MedicalRecords_AppointmentId] ON [MedicalRecords] ([AppointmentId]);
2025-11-24 01:29:54.946 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_MedicalRecords_AppointmentId] ON [MedicalRecords] ([AppointmentId]);
2025-11-24 01:29:54.946 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:54.946 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:54.946 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:54.946 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_MedicalRecords_DoctorId] ON [MedicalRecords] ([DoctorId]);
2025-11-24 01:29:54.947 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_MedicalRecords_DoctorId] ON [MedicalRecords] ([DoctorId]);
2025-11-24 01:29:54.947 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:54.947 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:54.947 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:54.947 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_MedicalRecords_PatientId] ON [MedicalRecords] ([PatientId]);
2025-11-24 01:29:54.948 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_MedicalRecords_PatientId] ON [MedicalRecords] ([PatientId]);
2025-11-24 01:29:54.948 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:54.948 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:54.948 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:54.948 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_News_BranchId] ON [News] ([BranchId]);
2025-11-24 01:29:54.949 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_News_BranchId] ON [News] ([BranchId]);
2025-11-24 01:29:54.949 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:54.949 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:54.949 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:54.949 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Patients_UserId] ON [Patients] ([UserId]);
2025-11-24 01:29:54.950 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Patients_UserId] ON [Patients] ([UserId]);
2025-11-24 01:29:56.962 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:56.962 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:56.962 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:56.963 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Schedules_DoctorId] ON [Schedules] ([DoctorId]);
2025-11-24 01:29:56.964 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Schedules_DoctorId] ON [Schedules] ([DoctorId]);
2025-11-24 01:29:56.965 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:56.965 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:56.965 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:56.965 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Services_BranchId] ON [Services] ([BranchId]);
2025-11-24 01:29:56.966 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Services_BranchId] ON [Services] ([BranchId]);
2025-11-24 01:29:56.966 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:56.966 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:56.966 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:56.966 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Services_SpecializationId] ON [Services] ([SpecializationId]);
2025-11-24 01:29:56.968 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Services_SpecializationId] ON [Services] ([SpecializationId]);
2025-11-24 01:29:56.968 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:56.968 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:56.968 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:56.968 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_SupportTickets_UserId] ON [SupportTickets] ([UserId]);
2025-11-24 01:29:56.969 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_SupportTickets_UserId] ON [SupportTickets] ([UserId]);
2025-11-24 01:29:56.969 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:56.969 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:56.969 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:56.969 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [EmailIndex] ON [Users] ([NormalizedEmail]);
2025-11-24 01:29:56.970 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [EmailIndex] ON [Users] ([NormalizedEmail]);
2025-11-24 01:29:56.970 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:56.970 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:56.970 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:56.970 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Users_BranchId] ON [Users] ([BranchId]);
2025-11-24 01:29:56.971 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Users_BranchId] ON [Users] ([BranchId]);
2025-11-24 01:29:56.971 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:56.971 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:56.971 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:56.971 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Users_Email] ON [Users] ([Email]) WHERE [Email] IS NOT NULL;
2025-11-24 01:29:56.972 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Users_Email] ON [Users] ([Email]) WHERE [Email] IS NOT NULL;
2025-11-24 01:29:56.972 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:56.972 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:56.972 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:56.972 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [UserNameIndex] ON [Users] ([NormalizedUserName]) WHERE [NormalizedUserName] IS NOT NULL;
2025-11-24 01:29:56.973 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [UserNameIndex] ON [Users] ([NormalizedUserName]) WHERE [NormalizedUserName] IS NOT NULL;
2025-11-24 01:29:59.097 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:59.097 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:59.097 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:59.097 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251111134048_init-auth', N'8.0.21');
2025-11-24 01:29:59.110 +02:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251111134048_init-auth', N'8.0.21');
2025-11-24 01:29:59.112 +02:00 [DBG] Committing transaction.
2025-11-24 01:29:59.117 +02:00 [DBG] Committed transaction.
2025-11-24 01:29:59.118 +02:00 [DBG] Disposing transaction.
2025-11-24 01:29:59.118 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:29:59.118 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:29:59.118 +02:00 [INF] Applying migration '20251111134638__SeedRoles'.
2025-11-24 01:29:59.164 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:29:59.164 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:29:59.164 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 01:29:59.164 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 01:29:59.164 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:59.164 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:59.164 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:59.165 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Name', N'NormalizedName', N'ConcurrencyStamp') AND [object_id] = OBJECT_ID(N'[AspNetRoles]'))
    SET IDENTITY_INSERT [AspNetRoles] ON;
INSERT INTO [AspNetRoles] ([Id], [Name], [NormalizedName], [ConcurrencyStamp])
VALUES (N'fe4c3fe9-7197-47a3-bf2a-f2295e5edb0b', N'Admin', N'ADMIN', N'658f1e90-9a58-4763-83c9-2ed57439599c');
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Name', N'NormalizedName', N'ConcurrencyStamp') AND [object_id] = OBJECT_ID(N'[AspNetRoles]'))
    SET IDENTITY_INSERT [AspNetRoles] OFF;
2025-11-24 01:29:59.210 +02:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Name', N'NormalizedName', N'ConcurrencyStamp') AND [object_id] = OBJECT_ID(N'[AspNetRoles]'))
    SET IDENTITY_INSERT [AspNetRoles] ON;
INSERT INTO [AspNetRoles] ([Id], [Name], [NormalizedName], [ConcurrencyStamp])
VALUES (N'fe4c3fe9-7197-47a3-bf2a-f2295e5edb0b', N'Admin', N'ADMIN', N'658f1e90-9a58-4763-83c9-2ed57439599c');
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Name', N'NormalizedName', N'ConcurrencyStamp') AND [object_id] = OBJECT_ID(N'[AspNetRoles]'))
    SET IDENTITY_INSERT [AspNetRoles] OFF;
2025-11-24 01:29:59.210 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:29:59.210 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:59.210 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:29:59.210 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Name', N'NormalizedName', N'ConcurrencyStamp') AND [object_id] = OBJECT_ID(N'[AspNetRoles]'))
    SET IDENTITY_INSERT [AspNetRoles] ON;
INSERT INTO [AspNetRoles] ([Id], [Name], [NormalizedName], [ConcurrencyStamp])
VALUES (N'a3938f70-1904-4c54-843f-fa79585b2a89', N'Doctor', N'DOCTOR', N'5e476ba3-2e4f-4b0b-a701-1f04c2a9437f');
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Name', N'NormalizedName', N'ConcurrencyStamp') AND [object_id] = OBJECT_ID(N'[AspNetRoles]'))
    SET IDENTITY_INSERT [AspNetRoles] OFF;
2025-11-24 01:29:59.221 +02:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Name', N'NormalizedName', N'ConcurrencyStamp') AND [object_id] = OBJECT_ID(N'[AspNetRoles]'))
    SET IDENTITY_INSERT [AspNetRoles] ON;
INSERT INTO [AspNetRoles] ([Id], [Name], [NormalizedName], [ConcurrencyStamp])
VALUES (N'a3938f70-1904-4c54-843f-fa79585b2a89', N'Doctor', N'DOCTOR', N'5e476ba3-2e4f-4b0b-a701-1f04c2a9437f');
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Name', N'NormalizedName', N'ConcurrencyStamp') AND [object_id] = OBJECT_ID(N'[AspNetRoles]'))
    SET IDENTITY_INSERT [AspNetRoles] OFF;
2025-11-24 01:30:00.998 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:30:00.998 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:30:00.998 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:30:00.998 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Name', N'NormalizedName', N'ConcurrencyStamp') AND [object_id] = OBJECT_ID(N'[AspNetRoles]'))
    SET IDENTITY_INSERT [AspNetRoles] ON;
INSERT INTO [AspNetRoles] ([Id], [Name], [NormalizedName], [ConcurrencyStamp])
VALUES (N'acd0f30a-67c8-4507-af01-ed816126f74e', N'Patient', N'PATIENT', N'28727a82-be78-47fb-875e-b1c91950f2c2');
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Name', N'NormalizedName', N'ConcurrencyStamp') AND [object_id] = OBJECT_ID(N'[AspNetRoles]'))
    SET IDENTITY_INSERT [AspNetRoles] OFF;
2025-11-24 01:30:01.011 +02:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Name', N'NormalizedName', N'ConcurrencyStamp') AND [object_id] = OBJECT_ID(N'[AspNetRoles]'))
    SET IDENTITY_INSERT [AspNetRoles] ON;
INSERT INTO [AspNetRoles] ([Id], [Name], [NormalizedName], [ConcurrencyStamp])
VALUES (N'acd0f30a-67c8-4507-af01-ed816126f74e', N'Patient', N'PATIENT', N'28727a82-be78-47fb-875e-b1c91950f2c2');
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Name', N'NormalizedName', N'ConcurrencyStamp') AND [object_id] = OBJECT_ID(N'[AspNetRoles]'))
    SET IDENTITY_INSERT [AspNetRoles] OFF;
2025-11-24 01:30:01.011 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:30:01.011 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:30:01.011 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:30:01.011 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251111134638__SeedRoles', N'8.0.21');
2025-11-24 01:30:01.011 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251111134638__SeedRoles', N'8.0.21');
2025-11-24 01:30:01.011 +02:00 [DBG] Committing transaction.
2025-11-24 01:30:01.022 +02:00 [DBG] Committed transaction.
2025-11-24 01:30:01.022 +02:00 [DBG] Disposing transaction.
2025-11-24 01:30:01.022 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:30:01.022 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:30:01.023 +02:00 [INF] Applying migration '20251111153509__SeedRolesAdmin'.
2025-11-24 01:30:01.124 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:30:01.125 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:30:01.125 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 01:32:39.723 +02:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-11-24 01:32:40.073 +02:00 [DBG] The index {'BranchesBranchId'} was not created on entity type 'BranchDoctor (Dictionary<string, object>)' as the properties are already covered by the index {'BranchesBranchId', 'DoctorsDoctorId'}.
2025-11-24 01:32:40.074 +02:00 [DBG] The index {'BranchId'} was not created on entity type 'BranchService (Dictionary<string, object>)' as the properties are already covered by the index {'BranchId', 'ServiceId'}.
2025-11-24 01:32:40.075 +02:00 [DBG] The index {'BranchId'} was not created on entity type 'BranchSpecialization (Dictionary<string, object>)' as the properties are already covered by the index {'BranchId', 'SpecializationId'}.
2025-11-24 01:32:40.075 +02:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserRole<string>' as the properties are already covered by the index {'UserId', 'RoleId'}.
2025-11-24 01:32:40.075 +02:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserToken<string>' as the properties are already covered by the index {'UserId', 'LoginProvider', 'Name'}.
2025-11-24 01:32:40.152 +02:00 [DBG] The property 'BranchDoctor (Dictionary<string, object>).BranchesBranchId' was created in shadow state because there are no eligible CLR members with a matching name.
2025-11-24 01:32:40.153 +02:00 [DBG] The property 'BranchDoctor (Dictionary<string, object>).DoctorsDoctorId' was created in shadow state because there are no eligible CLR members with a matching name.
2025-11-24 01:32:40.276 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:32:40.290 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:32:40.315 +02:00 [DBG] Created DbConnection. (22ms).
2025-11-24 01:32:40.316 +02:00 [DBG] Migrating using database 'HospitalDB' on server '.'.
2025-11-24 01:32:40.320 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:32:40.437 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:32:40.441 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:32:40.444 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (3ms).
2025-11-24 01:32:40.445 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (6ms).
2025-11-24 01:32:40.451 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-24 01:32:40.467 +02:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-24 01:32:40.468 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:32:40.472 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (2ms).
2025-11-24 01:32:40.473 +02:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-11-24 01:32:40.473 +02:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-11-24 01:32:40.473 +02:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-11-24 01:32:40.473 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:32:40.474 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:32:40.474 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-24 01:32:40.485 +02:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-24 01:32:40.485 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:32:40.486 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:32:40.486 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:32:40.486 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:32:40.486 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:32:40.486 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:40.486 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:40.486 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-24 01:32:40.487 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-24 01:32:40.487 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:32:40.487 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:32:40.488 +02:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-11-24 01:32:40.488 +02:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-11-24 01:32:40.488 +02:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-11-24 01:32:40.488 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:32:40.488 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:32:40.488 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-24 01:32:40.488 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-24 01:32:40.488 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:32:40.488 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:32:40.495 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:32:40.496 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:32:40.496 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:32:40.496 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:32:40.496 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:32:40.496 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-24 01:32:40.510 +02:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-24 01:32:40.513 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:32:40.514 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 2ms reading results.
2025-11-24 01:32:40.514 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:32:40.514 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:32:40.521 +02:00 [INF] Applying migration '20251111153509__SeedRolesAdmin'.
2025-11-24 01:32:40.638 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:32:40.639 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:32:40.640 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 01:32:40.644 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 01:32:40.644 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:32:40.644 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:40.645 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:40.697 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'FullName', N'UserName', N'NormalizedUserName', N'Email', N'NormalizedEmail', N'PasswordHash', N'Role', N'CreatedAt', N'UpdatedAt', N'EmailConfirmed', N'AccessFailedCount', N'PhoneNumberConfirmed', N'TwoFactorEnabled', N'LockoutEnabled', N'SecurityStamp') AND [object_id] = OBJECT_ID(N'[Users]'))
    SET IDENTITY_INSERT [Users] ON;
INSERT INTO [Users] ([Id], [FullName], [UserName], [NormalizedUserName], [Email], [NormalizedEmail], [PasswordHash], [Role], [CreatedAt], [UpdatedAt], [EmailConfirmed], [AccessFailedCount], [PhoneNumberConfirmed], [TwoFactorEnabled], [LockoutEnabled], [SecurityStamp])
VALUES (N'0aa4f0b7-b504-4c09-a3e2-98f29f225d66', N'Admin', N'admin', N'ADMIN', N'admin@Hospital.com', N'ADMIN@HOSPITAL.COM', N'AQAAAAIAAYagAAAAEGbUvSei9s1j/FAnVcHUNRswEYa+g3xW4Hy1z3CMSyMRGpKPb1vYeEp8711QjlbIHQ==', N'Admin', '2025-11-23T23:32:40.5920627Z', '2025-11-23T23:32:40.5920631Z', CAST(1 AS bit), 0, CAST(0 AS bit), CAST(0 AS bit), CAST(0 AS bit), N'e728c714-f888-4b13-9893-fd366d1185b7');
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'FullName', N'UserName', N'NormalizedUserName', N'Email', N'NormalizedEmail', N'PasswordHash', N'Role', N'CreatedAt', N'UpdatedAt', N'EmailConfirmed', N'AccessFailedCount', N'PhoneNumberConfirmed', N'TwoFactorEnabled', N'LockoutEnabled', N'SecurityStamp') AND [object_id] = OBJECT_ID(N'[Users]'))
    SET IDENTITY_INSERT [Users] OFF;
2025-11-24 01:32:40.740 +02:00 [INF] Executed DbCommand (43ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'FullName', N'UserName', N'NormalizedUserName', N'Email', N'NormalizedEmail', N'PasswordHash', N'Role', N'CreatedAt', N'UpdatedAt', N'EmailConfirmed', N'AccessFailedCount', N'PhoneNumberConfirmed', N'TwoFactorEnabled', N'LockoutEnabled', N'SecurityStamp') AND [object_id] = OBJECT_ID(N'[Users]'))
    SET IDENTITY_INSERT [Users] ON;
INSERT INTO [Users] ([Id], [FullName], [UserName], [NormalizedUserName], [Email], [NormalizedEmail], [PasswordHash], [Role], [CreatedAt], [UpdatedAt], [EmailConfirmed], [AccessFailedCount], [PhoneNumberConfirmed], [TwoFactorEnabled], [LockoutEnabled], [SecurityStamp])
VALUES (N'0aa4f0b7-b504-4c09-a3e2-98f29f225d66', N'Admin', N'admin', N'ADMIN', N'admin@Hospital.com', N'ADMIN@HOSPITAL.COM', N'AQAAAAIAAYagAAAAEGbUvSei9s1j/FAnVcHUNRswEYa+g3xW4Hy1z3CMSyMRGpKPb1vYeEp8711QjlbIHQ==', N'Admin', '2025-11-23T23:32:40.5920627Z', '2025-11-23T23:32:40.5920631Z', CAST(1 AS bit), 0, CAST(0 AS bit), CAST(0 AS bit), CAST(0 AS bit), N'e728c714-f888-4b13-9893-fd366d1185b7');
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'FullName', N'UserName', N'NormalizedUserName', N'Email', N'NormalizedEmail', N'PasswordHash', N'Role', N'CreatedAt', N'UpdatedAt', N'EmailConfirmed', N'AccessFailedCount', N'PhoneNumberConfirmed', N'TwoFactorEnabled', N'LockoutEnabled', N'SecurityStamp') AND [object_id] = OBJECT_ID(N'[Users]'))
    SET IDENTITY_INSERT [Users] OFF;
2025-11-24 01:32:40.741 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:32:40.741 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:40.741 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:40.741 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']

        INSERT INTO [AspNetUserRoles] ([UserId], [RoleId])
        SELECT '0aa4f0b7-b504-4c09-a3e2-98f29f225d66', [Id]
        FROM [AspNetRoles]
        WHERE [Name] = 'Admin';
2025-11-24 01:32:40.752 +02:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']

        INSERT INTO [AspNetUserRoles] ([UserId], [RoleId])
        SELECT '0aa4f0b7-b504-4c09-a3e2-98f29f225d66', [Id]
        FROM [AspNetRoles]
        WHERE [Name] = 'Admin';
2025-11-24 01:32:40.752 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:32:40.752 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:40.752 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:43.286 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251111153509__SeedRolesAdmin', N'8.0.21');
2025-11-24 01:32:43.288 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251111153509__SeedRolesAdmin', N'8.0.21');
2025-11-24 01:32:43.289 +02:00 [DBG] Committing transaction.
2025-11-24 01:32:43.302 +02:00 [DBG] Committed transaction.
2025-11-24 01:32:43.304 +02:00 [DBG] Disposing transaction.
2025-11-24 01:32:43.304 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:32:43.304 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:32:43.304 +02:00 [INF] Applying migration '20251112174524_AddRefreshTokenColumns'.
2025-11-24 01:32:43.337 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:32:43.337 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:32:43.338 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 01:32:43.338 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 01:32:43.338 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:32:43.338 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:43.338 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:43.338 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Users] ADD [RefreshToken] nvarchar(max) NOT NULL DEFAULT N'';
2025-11-24 01:32:43.348 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Users] ADD [RefreshToken] nvarchar(max) NOT NULL DEFAULT N'';
2025-11-24 01:32:43.348 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:32:43.348 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:43.348 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:43.348 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Users] ADD [RefreshTokenExpiryTime] datetime2 NOT NULL DEFAULT '0001-01-01T00:00:00.0000000';
2025-11-24 01:32:43.350 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Users] ADD [RefreshTokenExpiryTime] datetime2 NOT NULL DEFAULT '0001-01-01T00:00:00.0000000';
2025-11-24 01:32:43.350 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:32:43.350 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:43.350 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:43.350 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251112174524_AddRefreshTokenColumns', N'8.0.21');
2025-11-24 01:32:43.350 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251112174524_AddRefreshTokenColumns', N'8.0.21');
2025-11-24 01:32:43.350 +02:00 [DBG] Committing transaction.
2025-11-24 01:32:43.351 +02:00 [DBG] Committed transaction.
2025-11-24 01:32:43.351 +02:00 [DBG] Disposing transaction.
2025-11-24 01:32:43.351 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:32:43.351 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:32:43.351 +02:00 [INF] Applying migration '20251113233448_update in banner and service and branch and specilization relations'.
2025-11-24 01:32:43.398 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:32:43.398 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:32:43.398 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 01:32:43.398 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 01:32:43.398 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:32:43.399 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:43.399 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:43.399 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Banners] DROP CONSTRAINT [FK_Banners_Branches_BranchId];
2025-11-24 01:32:43.403 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Banners] DROP CONSTRAINT [FK_Banners_Branches_BranchId];
2025-11-24 01:32:44.600 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:32:44.600 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:44.601 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:44.601 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Events] DROP CONSTRAINT [FK_Events_Branches_BranchId];
2025-11-24 01:32:44.604 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Events] DROP CONSTRAINT [FK_Events_Branches_BranchId];
2025-11-24 01:32:44.604 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:32:44.604 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:44.604 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:44.604 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [News] DROP CONSTRAINT [FK_News_Branches_BranchId];
2025-11-24 01:32:44.606 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [News] DROP CONSTRAINT [FK_News_Branches_BranchId];
2025-11-24 01:32:44.606 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:32:44.606 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:44.606 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:44.606 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Services] DROP CONSTRAINT [FK_Services_Branches_BranchId];
2025-11-24 01:32:44.607 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Services] DROP CONSTRAINT [FK_Services_Branches_BranchId];
2025-11-24 01:32:44.608 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:32:44.608 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:44.608 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:44.608 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Services] DROP CONSTRAINT [FK_Services_Specializations_SpecializationId];
2025-11-24 01:32:44.609 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Services] DROP CONSTRAINT [FK_Services_Specializations_SpecializationId];
2025-11-24 01:32:44.609 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:32:44.609 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:44.609 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:44.609 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_Services_BranchId] ON [Services];
2025-11-24 01:32:44.611 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_Services_BranchId] ON [Services];
2025-11-24 01:32:44.611 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:32:44.611 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:44.611 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:44.611 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_Services_SpecializationId] ON [Services];
2025-11-24 01:32:44.612 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_Services_SpecializationId] ON [Services];
2025-11-24 01:32:44.612 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:32:44.612 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:44.613 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:44.613 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_Banners_BranchId] ON [Banners];
2025-11-24 01:32:44.614 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_Banners_BranchId] ON [Banners];
2025-11-24 01:32:44.614 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:32:44.614 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:44.614 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:44.614 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var0 sysname;
SELECT @var0 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Services]') AND [c].[name] = N'BranchId');
IF @var0 IS NOT NULL EXEC(N'ALTER TABLE [Services] DROP CONSTRAINT [' + @var0 + '];');
ALTER TABLE [Services] DROP COLUMN [BranchId];
2025-11-24 01:32:46.748 +02:00 [INF] Executed DbCommand (2,134ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var0 sysname;
SELECT @var0 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Services]') AND [c].[name] = N'BranchId');
IF @var0 IS NOT NULL EXEC(N'ALTER TABLE [Services] DROP CONSTRAINT [' + @var0 + '];');
ALTER TABLE [Services] DROP COLUMN [BranchId];
2025-11-24 01:32:46.749 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:32:46.749 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:46.749 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:46.749 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var1 sysname;
SELECT @var1 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Services]') AND [c].[name] = N'SpecializationId');
IF @var1 IS NOT NULL EXEC(N'ALTER TABLE [Services] DROP CONSTRAINT [' + @var1 + '];');
ALTER TABLE [Services] DROP COLUMN [SpecializationId];
2025-11-24 01:32:46.762 +02:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var1 sysname;
SELECT @var1 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Services]') AND [c].[name] = N'SpecializationId');
IF @var1 IS NOT NULL EXEC(N'ALTER TABLE [Services] DROP CONSTRAINT [' + @var1 + '];');
ALTER TABLE [Services] DROP COLUMN [SpecializationId];
2025-11-24 01:32:46.762 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:32:46.762 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:46.762 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:46.762 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var2 sysname;
SELECT @var2 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Banners]') AND [c].[name] = N'BranchId');
IF @var2 IS NOT NULL EXEC(N'ALTER TABLE [Banners] DROP CONSTRAINT [' + @var2 + '];');
ALTER TABLE [Banners] DROP COLUMN [BranchId];
2025-11-24 01:32:46.782 +02:00 [INF] Executed DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var2 sysname;
SELECT @var2 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Banners]') AND [c].[name] = N'BranchId');
IF @var2 IS NOT NULL EXEC(N'ALTER TABLE [Banners] DROP CONSTRAINT [' + @var2 + '];');
ALTER TABLE [Banners] DROP COLUMN [BranchId];
2025-11-24 01:32:46.782 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:32:46.782 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:46.782 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:46.783 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [BranchServices] (
    [BranchId] int NOT NULL,
    [ServiceId] int NOT NULL,
    CONSTRAINT [PK_BranchServices] PRIMARY KEY ([BranchId], [ServiceId]),
    CONSTRAINT [FK_BranchServices_Branches_BranchId] FOREIGN KEY ([BranchId]) REFERENCES [Branches] ([BranchId]) ON DELETE CASCADE,
    CONSTRAINT [FK_BranchServices_Services_ServiceId] FOREIGN KEY ([ServiceId]) REFERENCES [Services] ([ServiceId]) ON DELETE CASCADE
);
2025-11-24 01:32:46.784 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [BranchServices] (
    [BranchId] int NOT NULL,
    [ServiceId] int NOT NULL,
    CONSTRAINT [PK_BranchServices] PRIMARY KEY ([BranchId], [ServiceId]),
    CONSTRAINT [FK_BranchServices_Branches_BranchId] FOREIGN KEY ([BranchId]) REFERENCES [Branches] ([BranchId]) ON DELETE CASCADE,
    CONSTRAINT [FK_BranchServices_Services_ServiceId] FOREIGN KEY ([ServiceId]) REFERENCES [Services] ([ServiceId]) ON DELETE CASCADE
);
2025-11-24 01:32:48.710 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:32:48.710 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:48.710 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:48.710 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [BranchSpecializations] (
    [BranchId] int NOT NULL,
    [SpecializationId] int NOT NULL,
    CONSTRAINT [PK_BranchSpecializations] PRIMARY KEY ([BranchId], [SpecializationId]),
    CONSTRAINT [FK_BranchSpecializations_Branches_BranchId] FOREIGN KEY ([BranchId]) REFERENCES [Branches] ([BranchId]) ON DELETE CASCADE,
    CONSTRAINT [FK_BranchSpecializations_Specializations_SpecializationId] FOREIGN KEY ([SpecializationId]) REFERENCES [Specializations] ([SpecializationId]) ON DELETE CASCADE
);
2025-11-24 01:32:48.715 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [BranchSpecializations] (
    [BranchId] int NOT NULL,
    [SpecializationId] int NOT NULL,
    CONSTRAINT [PK_BranchSpecializations] PRIMARY KEY ([BranchId], [SpecializationId]),
    CONSTRAINT [FK_BranchSpecializations_Branches_BranchId] FOREIGN KEY ([BranchId]) REFERENCES [Branches] ([BranchId]) ON DELETE CASCADE,
    CONSTRAINT [FK_BranchSpecializations_Specializations_SpecializationId] FOREIGN KEY ([SpecializationId]) REFERENCES [Specializations] ([SpecializationId]) ON DELETE CASCADE
);
2025-11-24 01:32:48.715 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:32:48.715 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:48.715 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:48.715 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_BranchServices_ServiceId] ON [BranchServices] ([ServiceId]);
2025-11-24 01:32:48.717 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_BranchServices_ServiceId] ON [BranchServices] ([ServiceId]);
2025-11-24 01:32:48.717 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:32:48.717 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:48.717 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:48.717 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_BranchSpecializations_SpecializationId] ON [BranchSpecializations] ([SpecializationId]);
2025-11-24 01:32:48.719 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_BranchSpecializations_SpecializationId] ON [BranchSpecializations] ([SpecializationId]);
2025-11-24 01:32:48.719 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:32:48.719 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:48.719 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:48.719 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Events] ADD CONSTRAINT [FK_Events_Branches_BranchId] FOREIGN KEY ([BranchId]) REFERENCES [Branches] ([BranchId]);
2025-11-24 01:32:48.720 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Events] ADD CONSTRAINT [FK_Events_Branches_BranchId] FOREIGN KEY ([BranchId]) REFERENCES [Branches] ([BranchId]);
2025-11-24 01:32:48.720 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:32:48.720 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:48.720 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:48.720 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [News] ADD CONSTRAINT [FK_News_Branches_BranchId] FOREIGN KEY ([BranchId]) REFERENCES [Branches] ([BranchId]);
2025-11-24 01:32:48.721 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [News] ADD CONSTRAINT [FK_News_Branches_BranchId] FOREIGN KEY ([BranchId]) REFERENCES [Branches] ([BranchId]);
2025-11-24 01:32:51.161 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:32:51.161 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:51.161 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:51.161 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251113233448_update in banner and service and branch and specilization relations', N'8.0.21');
2025-11-24 01:32:51.162 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251113233448_update in banner and service and branch and specilization relations', N'8.0.21');
2025-11-24 01:32:51.163 +02:00 [DBG] Committing transaction.
2025-11-24 01:32:51.170 +02:00 [DBG] Committed transaction.
2025-11-24 01:32:51.170 +02:00 [DBG] Disposing transaction.
2025-11-24 01:32:51.170 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:32:51.170 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:32:51.171 +02:00 [INF] Applying migration '20251115194238_add many to many relation between branch and doctor'.
2025-11-24 01:32:51.211 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:32:51.211 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:32:51.211 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 01:32:51.212 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 01:32:51.212 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:32:51.212 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:51.212 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:51.212 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Doctors] DROP CONSTRAINT [FK_Doctors_Branches_BranchId];
2025-11-24 01:32:51.214 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Doctors] DROP CONSTRAINT [FK_Doctors_Branches_BranchId];
2025-11-24 01:32:51.214 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:32:51.215 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:51.215 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:51.215 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_Doctors_BranchId] ON [Doctors];
2025-11-24 01:32:51.216 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_Doctors_BranchId] ON [Doctors];
2025-11-24 01:32:51.216 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:32:51.216 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:51.216 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:51.216 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var3 sysname;
SELECT @var3 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Doctors]') AND [c].[name] = N'BranchId');
IF @var3 IS NOT NULL EXEC(N'ALTER TABLE [Doctors] DROP CONSTRAINT [' + @var3 + '];');
ALTER TABLE [Doctors] DROP COLUMN [BranchId];
2025-11-24 01:32:51.234 +02:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var3 sysname;
SELECT @var3 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Doctors]') AND [c].[name] = N'BranchId');
IF @var3 IS NOT NULL EXEC(N'ALTER TABLE [Doctors] DROP CONSTRAINT [' + @var3 + '];');
ALTER TABLE [Doctors] DROP COLUMN [BranchId];
2025-11-24 01:32:51.234 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:32:51.235 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:51.235 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:51.235 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [DoctorBranches] (
    [BranchesBranchId] int NOT NULL,
    [DoctorsDoctorId] int NOT NULL,
    CONSTRAINT [PK_DoctorBranches] PRIMARY KEY ([BranchesBranchId], [DoctorsDoctorId]),
    CONSTRAINT [FK_DoctorBranches_Branches_BranchesBranchId] FOREIGN KEY ([BranchesBranchId]) REFERENCES [Branches] ([BranchId]) ON DELETE CASCADE,
    CONSTRAINT [FK_DoctorBranches_Doctors_DoctorsDoctorId] FOREIGN KEY ([DoctorsDoctorId]) REFERENCES [Doctors] ([DoctorId]) ON DELETE CASCADE
);
2025-11-24 01:32:53.047 +02:00 [INF] Executed DbCommand (1,813ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [DoctorBranches] (
    [BranchesBranchId] int NOT NULL,
    [DoctorsDoctorId] int NOT NULL,
    CONSTRAINT [PK_DoctorBranches] PRIMARY KEY ([BranchesBranchId], [DoctorsDoctorId]),
    CONSTRAINT [FK_DoctorBranches_Branches_BranchesBranchId] FOREIGN KEY ([BranchesBranchId]) REFERENCES [Branches] ([BranchId]) ON DELETE CASCADE,
    CONSTRAINT [FK_DoctorBranches_Doctors_DoctorsDoctorId] FOREIGN KEY ([DoctorsDoctorId]) REFERENCES [Doctors] ([DoctorId]) ON DELETE CASCADE
);
2025-11-24 01:32:53.048 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:32:53.048 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:53.048 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:53.048 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_DoctorBranches_DoctorsDoctorId] ON [DoctorBranches] ([DoctorsDoctorId]);
2025-11-24 01:32:53.049 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_DoctorBranches_DoctorsDoctorId] ON [DoctorBranches] ([DoctorsDoctorId]);
2025-11-24 01:32:53.049 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:32:53.049 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:53.049 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:53.049 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251115194238_add many to many relation between branch and doctor', N'8.0.21');
2025-11-24 01:32:53.050 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251115194238_add many to many relation between branch and doctor', N'8.0.21');
2025-11-24 01:32:53.050 +02:00 [DBG] Committing transaction.
2025-11-24 01:32:53.057 +02:00 [DBG] Committed transaction.
2025-11-24 01:32:53.057 +02:00 [DBG] Disposing transaction.
2025-11-24 01:32:53.057 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:32:53.057 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:32:53.057 +02:00 [INF] Applying migration '20251115200531_remove relation between branch and user'.
2025-11-24 01:32:53.076 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:32:53.076 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:32:53.076 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 01:32:53.077 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 01:32:53.077 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:32:53.077 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:53.077 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:53.077 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Users] DROP CONSTRAINT [FK_Users_Branches_BranchId];
2025-11-24 01:32:53.079 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Users] DROP CONSTRAINT [FK_Users_Branches_BranchId];
2025-11-24 01:32:53.079 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:32:53.079 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:53.079 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:53.079 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_Users_BranchId] ON [Users];
2025-11-24 01:32:53.081 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_Users_BranchId] ON [Users];
2025-11-24 01:32:53.081 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:32:53.081 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:53.081 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:55.152 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var4 sysname;
SELECT @var4 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Users]') AND [c].[name] = N'BranchId');
IF @var4 IS NOT NULL EXEC(N'ALTER TABLE [Users] DROP CONSTRAINT [' + @var4 + '];');
ALTER TABLE [Users] DROP COLUMN [BranchId];
2025-11-24 01:32:55.170 +02:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var4 sysname;
SELECT @var4 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Users]') AND [c].[name] = N'BranchId');
IF @var4 IS NOT NULL EXEC(N'ALTER TABLE [Users] DROP CONSTRAINT [' + @var4 + '];');
ALTER TABLE [Users] DROP COLUMN [BranchId];
2025-11-24 01:32:55.170 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:32:55.170 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:55.170 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:55.170 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251115200531_remove relation between branch and user', N'8.0.21');
2025-11-24 01:32:55.171 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251115200531_remove relation between branch and user', N'8.0.21');
2025-11-24 01:32:55.171 +02:00 [DBG] Committing transaction.
2025-11-24 01:32:55.177 +02:00 [DBG] Committed transaction.
2025-11-24 01:32:55.177 +02:00 [DBG] Disposing transaction.
2025-11-24 01:32:55.177 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:32:55.177 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:32:55.177 +02:00 [INF] Applying migration '20251116144214_MakeRefreshTokenNullable'.
2025-11-24 01:32:55.191 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:32:55.191 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:32:55.191 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 01:32:55.192 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 01:32:55.192 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:32:55.192 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:55.192 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:55.192 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var5 sysname;
SELECT @var5 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Users]') AND [c].[name] = N'RefreshToken');
IF @var5 IS NOT NULL EXEC(N'ALTER TABLE [Users] DROP CONSTRAINT [' + @var5 + '];');
ALTER TABLE [Users] ALTER COLUMN [RefreshToken] nvarchar(max) NULL;
2025-11-24 01:32:55.211 +02:00 [INF] Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var5 sysname;
SELECT @var5 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Users]') AND [c].[name] = N'RefreshToken');
IF @var5 IS NOT NULL EXEC(N'ALTER TABLE [Users] DROP CONSTRAINT [' + @var5 + '];');
ALTER TABLE [Users] ALTER COLUMN [RefreshToken] nvarchar(max) NULL;
2025-11-24 01:32:55.211 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:32:55.212 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:55.212 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:55.212 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251116144214_MakeRefreshTokenNullable', N'8.0.21');
2025-11-24 01:32:57.127 +02:00 [INF] Executed DbCommand (1,915ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251116144214_MakeRefreshTokenNullable', N'8.0.21');
2025-11-24 01:32:57.127 +02:00 [DBG] Committing transaction.
2025-11-24 01:32:57.127 +02:00 [DBG] Committed transaction.
2025-11-24 01:32:57.127 +02:00 [DBG] Disposing transaction.
2025-11-24 01:32:57.127 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:32:57.127 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:32:57.128 +02:00 [INF] Applying migration '20251116184844_editPatientModel'.
2025-11-24 01:32:57.141 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:32:57.141 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:32:57.141 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 01:32:57.142 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 01:32:57.142 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:32:57.142 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:57.142 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:57.142 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var6 sysname;
SELECT @var6 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Patients]') AND [c].[name] = N'Address');
IF @var6 IS NOT NULL EXEC(N'ALTER TABLE [Patients] DROP CONSTRAINT [' + @var6 + '];');
ALTER TABLE [Patients] DROP COLUMN [Address];
2025-11-24 01:32:57.158 +02:00 [INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var6 sysname;
SELECT @var6 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Patients]') AND [c].[name] = N'Address');
IF @var6 IS NOT NULL EXEC(N'ALTER TABLE [Patients] DROP CONSTRAINT [' + @var6 + '];');
ALTER TABLE [Patients] DROP COLUMN [Address];
2025-11-24 01:32:57.158 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:32:57.159 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:57.159 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:57.159 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var7 sysname;
SELECT @var7 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Patients]') AND [c].[name] = N'BloodType');
IF @var7 IS NOT NULL EXEC(N'ALTER TABLE [Patients] DROP CONSTRAINT [' + @var7 + '];');
ALTER TABLE [Patients] DROP COLUMN [BloodType];
2025-11-24 01:32:57.175 +02:00 [INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var7 sysname;
SELECT @var7 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Patients]') AND [c].[name] = N'BloodType');
IF @var7 IS NOT NULL EXEC(N'ALTER TABLE [Patients] DROP CONSTRAINT [' + @var7 + '];');
ALTER TABLE [Patients] DROP COLUMN [BloodType];
2025-11-24 01:32:57.175 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:32:57.175 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:57.175 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:57.175 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251116184844_editPatientModel', N'8.0.21');
2025-11-24 01:32:57.176 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251116184844_editPatientModel', N'8.0.21');
2025-11-24 01:32:57.176 +02:00 [DBG] Committing transaction.
2025-11-24 01:32:57.176 +02:00 [DBG] Committed transaction.
2025-11-24 01:32:59.444 +02:00 [DBG] Disposing transaction.
2025-11-24 01:32:59.444 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:32:59.444 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:32:59.444 +02:00 [INF] Applying migration '20251116220101_change Timeonly in schedule to DateTime'.
2025-11-24 01:32:59.470 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:32:59.470 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:32:59.470 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 01:32:59.471 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 01:32:59.471 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:32:59.471 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:59.471 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:59.471 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var8 sysname;
SELECT @var8 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Schedules]') AND [c].[name] = N'StartTime');
IF @var8 IS NOT NULL EXEC(N'ALTER TABLE [Schedules] DROP CONSTRAINT [' + @var8 + '];');
ALTER TABLE [Schedules] ALTER COLUMN [StartTime] datetime2 NOT NULL;
2025-11-24 01:32:59.538 +02:00 [INF] Executed DbCommand (67ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var8 sysname;
SELECT @var8 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Schedules]') AND [c].[name] = N'StartTime');
IF @var8 IS NOT NULL EXEC(N'ALTER TABLE [Schedules] DROP CONSTRAINT [' + @var8 + '];');
ALTER TABLE [Schedules] ALTER COLUMN [StartTime] datetime2 NOT NULL;
2025-11-24 01:32:59.538 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:32:59.538 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:59.538 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:59.538 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var9 sysname;
SELECT @var9 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Schedules]') AND [c].[name] = N'EndTime');
IF @var9 IS NOT NULL EXEC(N'ALTER TABLE [Schedules] DROP CONSTRAINT [' + @var9 + '];');
ALTER TABLE [Schedules] ALTER COLUMN [EndTime] datetime2 NOT NULL;
2025-11-24 01:32:59.569 +02:00 [INF] Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var9 sysname;
SELECT @var9 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Schedules]') AND [c].[name] = N'EndTime');
IF @var9 IS NOT NULL EXEC(N'ALTER TABLE [Schedules] DROP CONSTRAINT [' + @var9 + '];');
ALTER TABLE [Schedules] ALTER COLUMN [EndTime] datetime2 NOT NULL;
2025-11-24 01:32:59.569 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:32:59.570 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:59.570 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:32:59.570 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251116220101_change Timeonly in schedule to DateTime', N'8.0.21');
2025-11-24 01:32:59.576 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251116220101_change Timeonly in schedule to DateTime', N'8.0.21');
2025-11-24 01:32:59.576 +02:00 [DBG] Committing transaction.
2025-11-24 01:32:59.577 +02:00 [DBG] Committed transaction.
2025-11-24 01:32:59.577 +02:00 [DBG] Disposing transaction.
2025-11-24 01:32:59.577 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:32:59.577 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:33:01.688 +02:00 [INF] Applying migration '20251117115532_addPhotoToDoctor'.
2025-11-24 01:33:01.706 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:01.706 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:01.706 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 01:33:01.706 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 01:33:01.706 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:33:01.706 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:33:01.706 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:33:01.706 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Doctors] ADD [ImageURL] nvarchar(300) NULL;
2025-11-24 01:33:01.708 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Doctors] ADD [ImageURL] nvarchar(300) NULL;
2025-11-24 01:33:01.709 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:33:01.709 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:33:01.709 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:33:01.709 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251117115532_addPhotoToDoctor', N'8.0.21');
2025-11-24 01:33:01.712 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251117115532_addPhotoToDoctor', N'8.0.21');
2025-11-24 01:33:01.712 +02:00 [DBG] Committing transaction.
2025-11-24 01:33:01.713 +02:00 [DBG] Committed transaction.
2025-11-24 01:33:01.713 +02:00 [DBG] Disposing transaction.
2025-11-24 01:33:01.713 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:01.713 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:33:01.713 +02:00 [INF] Applying migration '20251118140238_editTimeOnlYToDateTime'.
2025-11-24 01:33:01.725 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:01.725 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:01.725 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 01:33:01.725 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 01:33:01.725 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:33:01.725 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:33:01.725 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:33:01.726 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var10 sysname;
SELECT @var10 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Appointments]') AND [c].[name] = N'Time');
IF @var10 IS NOT NULL EXEC(N'ALTER TABLE [Appointments] DROP CONSTRAINT [' + @var10 + '];');
ALTER TABLE [Appointments] ALTER COLUMN [Time] datetime2 NOT NULL;
2025-11-24 01:33:01.754 +02:00 [INF] Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var10 sysname;
SELECT @var10 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Appointments]') AND [c].[name] = N'Time');
IF @var10 IS NOT NULL EXEC(N'ALTER TABLE [Appointments] DROP CONSTRAINT [' + @var10 + '];');
ALTER TABLE [Appointments] ALTER COLUMN [Time] datetime2 NOT NULL;
2025-11-24 01:33:01.754 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:33:01.754 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:33:01.754 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:33:01.754 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251118140238_editTimeOnlYToDateTime', N'8.0.21');
2025-11-24 01:33:01.755 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251118140238_editTimeOnlYToDateTime', N'8.0.21');
2025-11-24 01:33:03.855 +02:00 [DBG] Committing transaction.
2025-11-24 01:33:03.862 +02:00 [DBG] Committed transaction.
2025-11-24 01:33:03.862 +02:00 [DBG] Disposing transaction.
2025-11-24 01:33:03.862 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:03.862 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:33:03.862 +02:00 [INF] Applying migration '20251118182335_improve schedule'.
2025-11-24 01:33:03.879 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:03.879 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:03.879 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 01:33:03.880 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 01:33:03.880 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:33:03.880 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:33:03.880 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:33:03.880 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Schedules] ADD [Shift] int NOT NULL DEFAULT 0;
2025-11-24 01:33:03.883 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Schedules] ADD [Shift] int NOT NULL DEFAULT 0;
2025-11-24 01:33:03.883 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:33:03.883 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:33:03.883 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:33:03.883 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251118182335_improve schedule', N'8.0.21');
2025-11-24 01:33:03.890 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251118182335_improve schedule', N'8.0.21');
2025-11-24 01:33:03.890 +02:00 [DBG] Committing transaction.
2025-11-24 01:33:03.891 +02:00 [DBG] Committed transaction.
2025-11-24 01:33:03.891 +02:00 [DBG] Disposing transaction.
2025-11-24 01:33:03.891 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:03.891 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:33:03.891 +02:00 [INF] Applying migration '20251119214128_resetPaswoard'.
2025-11-24 01:33:03.905 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:03.905 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:03.905 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 01:33:03.906 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 01:33:03.906 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:33:03.906 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:33:03.906 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:33:03.906 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [PasswordResetCodes] (
    [Id] int NOT NULL IDENTITY,
    [UserId] nvarchar(450) NOT NULL,
    [Code] nvarchar(max) NOT NULL,
    [ExpireAt] datetime2 NOT NULL,
    CONSTRAINT [PK_PasswordResetCodes] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_PasswordResetCodes_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-11-24 01:33:03.911 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [PasswordResetCodes] (
    [Id] int NOT NULL IDENTITY,
    [UserId] nvarchar(450) NOT NULL,
    [Code] nvarchar(max) NOT NULL,
    [ExpireAt] datetime2 NOT NULL,
    CONSTRAINT [PK_PasswordResetCodes] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_PasswordResetCodes_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-11-24 01:33:03.911 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:33:03.911 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:33:03.911 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:33:03.911 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_PasswordResetCodes_UserId] ON [PasswordResetCodes] ([UserId]);
2025-11-24 01:33:03.911 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_PasswordResetCodes_UserId] ON [PasswordResetCodes] ([UserId]);
2025-11-24 01:33:06.262 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:33:06.262 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:33:06.262 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:33:06.262 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251119214128_resetPaswoard', N'8.0.21');
2025-11-24 01:33:06.263 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251119214128_resetPaswoard', N'8.0.21');
2025-11-24 01:33:06.263 +02:00 [DBG] Committing transaction.
2025-11-24 01:33:06.271 +02:00 [DBG] Committed transaction.
2025-11-24 01:33:06.271 +02:00 [DBG] Disposing transaction.
2025-11-24 01:33:06.271 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:06.271 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:33:06.271 +02:00 [INF] Applying migration '20251120170506_create payment with paymob and update appoiment '.
2025-11-24 01:33:06.291 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:06.291 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:06.291 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 01:33:06.291 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 01:33:06.292 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:33:06.292 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:33:06.292 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:33:06.292 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Payments] (
    [PaymentId] int NOT NULL IDENTITY,
    [AppointmentId] int NOT NULL,
    [Amount] decimal(10,2) NOT NULL,
    [Currency] nvarchar(3) NOT NULL,
    [PaymobOrderId] bigint NULL,
    [PaymobTransactionId] bigint NULL,
    [PaymobMerchantOrderId] nvarchar(100) NULL,
    [Status] nvarchar(20) NOT NULL,
    [GatewayResponse] nvarchar(max) NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    [UpdatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    CONSTRAINT [PK_Payments] PRIMARY KEY ([PaymentId]),
    CONSTRAINT [FK_Payments_Appointments_AppointmentId] FOREIGN KEY ([AppointmentId]) REFERENCES [Appointments] ([AppointmentId]) ON DELETE NO ACTION
);
2025-11-24 01:33:06.296 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Payments] (
    [PaymentId] int NOT NULL IDENTITY,
    [AppointmentId] int NOT NULL,
    [Amount] decimal(10,2) NOT NULL,
    [Currency] nvarchar(3) NOT NULL,
    [PaymobOrderId] bigint NULL,
    [PaymobTransactionId] bigint NULL,
    [PaymobMerchantOrderId] nvarchar(100) NULL,
    [Status] nvarchar(20) NOT NULL,
    [GatewayResponse] nvarchar(max) NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    [UpdatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    CONSTRAINT [PK_Payments] PRIMARY KEY ([PaymentId]),
    CONSTRAINT [FK_Payments_Appointments_AppointmentId] FOREIGN KEY ([AppointmentId]) REFERENCES [Appointments] ([AppointmentId]) ON DELETE NO ACTION
);
2025-11-24 01:33:06.296 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:33:06.296 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:33:06.296 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:33:06.296 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Payments_AppointmentId] ON [Payments] ([AppointmentId]);
2025-11-24 01:33:06.298 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Payments_AppointmentId] ON [Payments] ([AppointmentId]);
2025-11-24 01:33:06.298 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:33:06.298 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:33:06.298 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:33:06.298 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251120170506_create payment with paymob and update appoiment ', N'8.0.21');
2025-11-24 01:33:06.299 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251120170506_create payment with paymob and update appoiment ', N'8.0.21');
2025-11-24 01:33:08.910 +02:00 [DBG] Committing transaction.
2025-11-24 01:33:08.921 +02:00 [DBG] Committed transaction.
2025-11-24 01:33:08.921 +02:00 [DBG] Disposing transaction.
2025-11-24 01:33:08.921 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:08.921 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:33:08.921 +02:00 [INF] Applying migration '20251122193859_update appoiment with payment method'.
2025-11-24 01:33:08.936 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:08.936 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:08.936 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 01:33:08.937 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 01:33:08.937 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:33:08.937 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:33:08.937 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:33:08.937 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Appointments] ADD [PaymentMethod] int NOT NULL DEFAULT 0;
2025-11-24 01:33:08.938 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Appointments] ADD [PaymentMethod] int NOT NULL DEFAULT 0;
2025-11-24 01:33:08.938 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:33:08.938 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:33:08.938 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:33:08.939 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251122193859_update appoiment with payment method', N'8.0.21');
2025-11-24 01:33:08.939 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251122193859_update appoiment with payment method', N'8.0.21');
2025-11-24 01:33:08.939 +02:00 [DBG] Committing transaction.
2025-11-24 01:33:08.939 +02:00 [DBG] Committed transaction.
2025-11-24 01:33:08.939 +02:00 [DBG] Disposing transaction.
2025-11-24 01:33:08.939 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:08.939 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:33:08.939 +02:00 [INF] Applying migration '20251122203902_convert type of fess in codtor to ba require'.
2025-11-24 01:33:08.953 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:08.953 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:08.953 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 01:33:08.954 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 01:33:08.954 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:33:08.954 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:33:08.954 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:33:08.954 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var11 sysname;
SELECT @var11 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Doctors]') AND [c].[name] = N'ConsultationFees');
IF @var11 IS NOT NULL EXEC(N'ALTER TABLE [Doctors] DROP CONSTRAINT [' + @var11 + '];');
UPDATE [Doctors] SET [ConsultationFees] = 0.0 WHERE [ConsultationFees] IS NULL;
ALTER TABLE [Doctors] ALTER COLUMN [ConsultationFees] decimal(10,2) NOT NULL;
ALTER TABLE [Doctors] ADD DEFAULT 0.0 FOR [ConsultationFees];
2025-11-24 01:33:08.982 +02:00 [INF] Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var11 sysname;
SELECT @var11 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Doctors]') AND [c].[name] = N'ConsultationFees');
IF @var11 IS NOT NULL EXEC(N'ALTER TABLE [Doctors] DROP CONSTRAINT [' + @var11 + '];');
UPDATE [Doctors] SET [ConsultationFees] = 0.0 WHERE [ConsultationFees] IS NULL;
ALTER TABLE [Doctors] ALTER COLUMN [ConsultationFees] decimal(10,2) NOT NULL;
ALTER TABLE [Doctors] ADD DEFAULT 0.0 FOR [ConsultationFees];
2025-11-24 01:33:11.425 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:33:11.425 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:33:11.425 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:33:11.425 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251122203902_convert type of fess in codtor to ba require', N'8.0.21');
2025-11-24 01:33:11.426 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251122203902_convert type of fess in codtor to ba require', N'8.0.21');
2025-11-24 01:33:11.426 +02:00 [DBG] Committing transaction.
2025-11-24 01:33:11.433 +02:00 [DBG] Committed transaction.
2025-11-24 01:33:11.433 +02:00 [DBG] Disposing transaction.
2025-11-24 01:33:11.433 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:11.433 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:33:11.433 +02:00 [INF] Applying migration '20251122214638_addImageInBranch'.
2025-11-24 01:33:11.450 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:11.450 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:11.450 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 01:33:11.450 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 01:33:11.450 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:33:11.450 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:33:11.450 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:33:11.451 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Branches] ADD [ImageURL] nvarchar(300) NULL;
2025-11-24 01:33:11.452 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Branches] ADD [ImageURL] nvarchar(300) NULL;
2025-11-24 01:33:11.452 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 01:33:11.452 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:33:11.452 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 01:33:11.452 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251122214638_addImageInBranch', N'8.0.21');
2025-11-24 01:33:11.453 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251122214638_addImageInBranch', N'8.0.21');
2025-11-24 01:33:11.453 +02:00 [DBG] Committing transaction.
2025-11-24 01:33:11.454 +02:00 [DBG] Committed transaction.
2025-11-24 01:33:11.454 +02:00 [DBG] Disposing transaction.
2025-11-24 01:33:11.454 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:11.454 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:33:11.455 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:33:11.456 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:11.457 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 01:33:21.467 +02:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-11-24 01:33:21.630 +02:00 [DBG] Hosting starting
2025-11-24 01:33:21.662 +02:00 [INF] User profile is available. Using 'C:\Users\E-Mad\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-24 01:33:21.673 +02:00 [DBG] Reading data from file 'C:\Users\E-Mad\AppData\Local\ASP.NET\DataProtection-Keys\key-b85f0939-0825-4b2b-b21a-67409aec9db0.xml'.
2025-11-24 01:33:21.682 +02:00 [DBG] Found key {b85f0939-0825-4b2b-b21a-67409aec9db0}.
2025-11-24 01:33:21.695 +02:00 [DBG] Considering key {b85f0939-0825-4b2b-b21a-67409aec9db0} with expiration date 2026-02-09 12:52:20Z as default key.
2025-11-24 01:33:21.701 +02:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-11-24 01:33:21.705 +02:00 [DBG] Decrypting secret element using Windows DPAPI.
2025-11-24 01:33:21.707 +02:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-11-24 01:33:21.712 +02:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-11-24 01:33:21.717 +02:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-11-24 01:33:21.719 +02:00 [DBG] Using key {b85f0939-0825-4b2b-b21a-67409aec9db0} as the default key.
2025-11-24 01:33:21.720 +02:00 [DBG] Key ring with default key {b85f0939-0825-4b2b-b21a-67409aec9db0} was loaded during application startup.
2025-11-24 01:33:21.726 +02:00 [DBG] Middleware loaded
2025-11-24 01:33:21.728 +02:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16501 B).
2025-11-24 01:33:21.730 +02:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-11-24 01:33:21.808 +02:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-11-24 01:33:21.895 +02:00 [INF] Now listening on: https://localhost:7217
2025-11-24 01:33:21.898 +02:00 [INF] Now listening on: http://localhost:5163
2025-11-24 01:33:21.904 +02:00 [DBG] Loaded hosting startup assembly Hospital
2025-11-24 01:33:21.908 +02:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-11-24 01:33:21.911 +02:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-11-24 01:33:21.912 +02:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-11-24 01:33:22.000 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-24 01:33:22.003 +02:00 [INF] Hosting environment: Development
2025-11-24 01:33:22.005 +02:00 [INF] Content root path: D:\Walaa\GP\Hospital\Hospital
2025-11-24 01:33:22.006 +02:00 [DBG] Hosting started
2025-11-24 01:33:22.061 +02:00 [DBG] Connection id "0HNHAT2OD6QUU" received FIN.
2025-11-24 01:33:22.077 +02:00 [DBG] Connection id "0HNHAT2OD6QUU" accepted.
2025-11-24 01:33:22.082 +02:00 [DBG] Connection id "0HNHAT2OD6QUU" started.
2025-11-24 01:33:22.103 +02:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-11-24 01:33:22.139 +02:00 [DBG] Connection id "0HNHAT2OD6QUU" stopped.
2025-11-24 01:33:22.142 +02:00 [DBG] Connection id "0HNHAT2OD6QUU" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-11-24 01:33:22.528 +02:00 [DBG] Connection id "0HNHAT2OD6QUV" accepted.
2025-11-24 01:33:22.530 +02:00 [DBG] Connection id "0HNHAT2OD6QUV" started.
2025-11-24 01:33:22.579 +02:00 [DBG] Connection 0HNHAT2OD6QUV established using the following protocol: "Tls12"
2025-11-24 01:33:22.649 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/swagger/index.html - null null
2025-11-24 01:33:22.786 +02:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-11-24 01:33:22.821 +02:00 [DBG] No candidates found for the request path '/swagger/index.html'
2025-11-24 01:33:22.822 +02:00 [DBG] Request did not match any endpoints
2025-11-24 01:33:22.888 +02:00 [DBG] Response markup is scheduled to include Browser Link script injection.
2025-11-24 01:33:22.895 +02:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2025-11-24 01:33:22.928 +02:00 [DBG] Response markup was updated to include Browser Link script injection.
2025-11-24 01:33:22.931 +02:00 [DBG] Response markup was updated to include browser refresh script injection.
2025-11-24 01:33:22.936 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/_framework/aspnetcore-browser-refresh.js - null null
2025-11-24 01:33:22.936 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/_vs/browserLink - null null
2025-11-24 01:33:22.936 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/swagger/index.html - 200 null text/html;charset=utf-8 295.831ms
2025-11-24 01:33:22.945 +02:00 [DBG] Script injected: /_framework/aspnetcore-browser-refresh.js
2025-11-24 01:33:22.950 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/_framework/aspnetcore-browser-refresh.js - 200 16501 application/javascript; charset=utf-8 13.7729ms
2025-11-24 01:33:23.014 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/_vs/browserLink - 200 null text/javascript; charset=UTF-8 77.9249ms
2025-11-24 01:33:23.053 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/swagger/v1/swagger.json - null null
2025-11-24 01:33:23.057 +02:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2025-11-24 01:33:23.058 +02:00 [DBG] Request did not match any endpoints
2025-11-24 01:33:23.122 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 69.4585ms
2025-11-24 01:33:32.396 +02:00 [DBG] Connection id "0HNHAT2OD6QV0" accepted.
2025-11-24 01:33:32.399 +02:00 [DBG] Connection id "0HNHAT2OD6QV0" received FIN.
2025-11-24 01:33:32.400 +02:00 [DBG] Connection id "0HNHAT2OD6QV0" started.
2025-11-24 01:33:32.402 +02:00 [DBG] Connection id "0HNHAT2OD6QV1" accepted.
2025-11-24 01:33:32.407 +02:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-11-24 01:33:32.408 +02:00 [DBG] Connection id "0HNHAT2OD6QV1" started.
2025-11-24 01:33:32.412 +02:00 [DBG] Connection id "0HNHAT2OD6QV0" stopped.
2025-11-24 01:33:32.419 +02:00 [DBG] Connection id "0HNHAT2OD6QV0" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-11-24 01:33:32.422 +02:00 [DBG] Connection 0HNHAT2OD6QV1 established using the following protocol: "Tls12"
2025-11-24 01:33:32.426 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Auth/login - application/json 65
2025-11-24 01:33:32.437 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/login'
2025-11-24 01:33:32.444 +02:00 [DBG] Endpoint 'Hospital.Controllers.AuthController.LoginAsync (Hospital)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-11-24 01:33:32.448 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.AuthController.LoginAsync (Hospital)'
2025-11-24 01:33:32.456 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:33:32.506 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:33:32.515 +02:00 [INF] Executing endpoint 'Hospital.Controllers.AuthController.LoginAsync (Hospital)'
2025-11-24 01:33:32.561 +02:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] LoginAsync(Hospital.Domain.Models.LoginModel) on controller Hospital.Controllers.AuthController (Hospital).
2025-11-24 01:33:32.571 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:33:32.577 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:33:32.581 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:33:32.586 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:33:32.587 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:33:32.590 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.AuthController (Hospital)
2025-11-24 01:33:32.754 +02:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-11-24 01:33:32.804 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.AuthController (Hospital)
2025-11-24 01:33:32.825 +02:00 [DBG] Attempting to bind parameter 'model' of type 'Hospital.Domain.Models.LoginModel' ...
2025-11-24 01:33:32.832 +02:00 [DBG] Attempting to bind parameter 'model' of type 'Hospital.Domain.Models.LoginModel' using the name '' in request data ...
2025-11-24 01:33:32.843 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 01:33:32.857 +02:00 [DBG] Connection id "0HNHAT2OD6QV1", Request id "0HNHAT2OD6QV1:00000001": started reading request body.
2025-11-24 01:33:32.864 +02:00 [DBG] Connection id "0HNHAT2OD6QV1", Request id "0HNHAT2OD6QV1:00000001": done reading request body.
2025-11-24 01:33:32.895 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Domain.Models.LoginModel'
2025-11-24 01:33:32.899 +02:00 [DBG] Done attempting to bind parameter 'model' of type 'Hospital.Domain.Models.LoginModel'.
2025-11-24 01:33:32.903 +02:00 [DBG] Done attempting to bind parameter 'model' of type 'Hospital.Domain.Models.LoginModel'.
2025-11-24 01:33:32.905 +02:00 [DBG] Attempting to validate the bound parameter 'model' of type 'Hospital.Domain.Models.LoginModel' ...
2025-11-24 01:33:32.915 +02:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'Hospital.Domain.Models.LoginModel'.
2025-11-24 01:33:32.926 +02:00 [INF] Login called at "2025-11-24T01:33:32.9263279+02:00"
2025-11-24 01:33:33.542 +02:00 [DBG] The index {'BranchesBranchId'} was not created on entity type 'BranchDoctor (Dictionary<string, object>)' as the properties are already covered by the index {'BranchesBranchId', 'DoctorsDoctorId'}.
2025-11-24 01:33:33.548 +02:00 [DBG] The index {'BranchId'} was not created on entity type 'BranchService (Dictionary<string, object>)' as the properties are already covered by the index {'BranchId', 'ServiceId'}.
2025-11-24 01:33:33.552 +02:00 [DBG] The index {'BranchId'} was not created on entity type 'BranchSpecialization (Dictionary<string, object>)' as the properties are already covered by the index {'BranchId', 'SpecializationId'}.
2025-11-24 01:33:33.554 +02:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserRole<string>' as the properties are already covered by the index {'UserId', 'RoleId'}.
2025-11-24 01:33:33.557 +02:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserToken<string>' as the properties are already covered by the index {'UserId', 'LoginProvider', 'Name'}.
2025-11-24 01:33:33.689 +02:00 [DBG] The property 'BranchDoctor (Dictionary<string, object>).BranchesBranchId' was created in shadow state because there are no eligible CLR members with a matching name.
2025-11-24 01:33:33.693 +02:00 [DBG] The property 'BranchDoctor (Dictionary<string, object>).DoctorsDoctorId' was created in shadow state because there are no eligible CLR members with a matching name.
2025-11-24 01:33:33.932 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:33:34.034 +02:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(u => u.NormalizedEmail == __normalizedEmail_0)'
2025-11-24 01:33:34.220 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: new SingleQueryingEnumerable<User>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 0], [Property: User.AccessFailedCount (int) Required, 1], [Property: User.ConcurrencyStamp (string) Concurrency, 2], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 3], [Property: User.DateOfBirth (DateOnly?), 4], [Property: User.Email (string) Index MaxLength(256), 5], [Property: User.EmailConfirmed (bool) Required, 6], [Property: User.FullName (string) Required MaxLength(150), 7], [Property: User.Gender (GenderType?) MaxLength(10), 8], [Property: User.LockoutEnabled (bool) Required, 9], [Property: User.LockoutEnd (DateTimeOffset?), 10], [Property: User.NormalizedEmail (string) Index MaxLength(256), 11], [Property: User.NormalizedUserName (string) Index MaxLength(256), 12], [Property: User.PasswordHash (string), 13], [Property: User.PhoneNumber (string), 14], [Property: User.PhoneNumberConfirmed (bool) Required, 15], [Property: User.RefreshToken (string), 16], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 17], [Property: User.Role (string) Required MaxLength(50), 18], [Property: User.SecurityStamp (string), 19], [Property: User.TwoFactorEnabled (bool) Required, 20], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 21], [Property: User.UserName (string) MaxLength(256), 22] }
            SELECT TOP(2) u.Id, u.AccessFailedCount, u.ConcurrencyStamp, u.CreatedAt, u.DateOfBirth, u.Email, u.EmailConfirmed, u.FullName, u.Gender, u.LockoutEnabled, u.LockoutEnd, u.NormalizedEmail, u.NormalizedUserName, u.PasswordHash, u.PhoneNumber, u.PhoneNumberConfirmed, u.RefreshToken, u.RefreshTokenExpiryTime, u.Role, u.SecurityStamp, u.TwoFactorEnabled, u.UpdatedAt, u.UserName
            FROM Users AS u
            WHERE u.NormalizedEmail == @__normalizedEmail_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 01:33:34.272 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:33:34.289 +02:00 [DBG] Created DbConnection. (15ms).
2025-11-24 01:33:34.298 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:34.627 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:34.636 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:33:34.646 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (7ms).
2025-11-24 01:33:34.662 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (27ms).
2025-11-24 01:33:34.674 +02:00 [DBG] Executing DbCommand [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedEmail] = @__normalizedEmail_0
2025-11-24 01:33:34.746 +02:00 [INF] Executed DbCommand (73ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedEmail] = @__normalizedEmail_0
2025-11-24 01:33:34.814 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:33:34.899 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:33:34.908 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 152ms reading results.
2025-11-24 01:33:34.922 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:34.932 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (9ms).
2025-11-24 01:33:35.064 +02:00 [DBG] Compiling query expression: 
'DbSet<IdentityUserClaim<string>>()
    .Where(uc => uc.UserId.Equals(__user_Id_0))
    .Select(c => c.ToClaim())'
2025-11-24 01:33:35.106 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Claim>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: IdentityUserClaim<string>.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: IdentityUserClaim<string>.ClaimType (string), 1], [Property: IdentityUserClaim<string>.ClaimValue (string), 2], [Property: IdentityUserClaim<string>.UserId (string) Required FK Index, 3] }
        SELECT a.Id, a.ClaimType, a.ClaimValue, a.UserId
        FROM AspNetUserClaims AS a
        WHERE a.UserId == @__user_Id_0), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Claim>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 01:33:35.110 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:35.114 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:35.116 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:33:35.117 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:33:35.121 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2025-11-24 01:33:35.123 +02:00 [DBG] Executing DbCommand [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2025-11-24 01:33:35.129 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2025-11-24 01:33:35.133 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:33:35.134 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 01:33:35.136 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:35.140 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (3ms).
2025-11-24 01:33:35.153 +02:00 [DBG] Compiling query expression: 
'DbSet<IdentityUserRole<string>>()
    .Join(
        inner: DbSet<IdentityRole>(), 
        outerKeySelector: userRole => userRole.RoleId, 
        innerKeySelector: role => role.Id, 
        resultSelector: (userRole, role) => new { 
            userRole = userRole, 
            role = role
         })
    .Where(<>h__TransparentIdentifier0 => <>h__TransparentIdentifier0.userRole.UserId.Equals(__userId_0))
    .Select(<>h__TransparentIdentifier0 => <>h__TransparentIdentifier0.role.Name)'
2025-11-24 01:33:35.171 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<string>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT a0.Name
        FROM AspNetUserRoles AS a
        INNER JOIN AspNetRoles AS a0 ON a.RoleId == a0.Id
        WHERE a.UserId == @__userId_0), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, string>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 01:33:35.173 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:35.173 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:35.175 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:33:35.177 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:33:35.178 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:33:35.181 +02:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2025-11-24 01:33:35.196 +02:00 [INF] Executed DbCommand (15ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2025-11-24 01:33:35.199 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:33:35.201 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 2ms reading results.
2025-11-24 01:33:35.204 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:35.206 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 01:33:35.215 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:35.216 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:35.217 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:33:35.218 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:33:35.219 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:33:35.219 +02:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2025-11-24 01:33:35.222 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2025-11-24 01:33:35.226 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:33:35.227 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 01:33:35.229 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:35.231 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (2ms).
2025-11-24 01:33:35.239 +02:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(u => u.NormalizedUserName == __normalizedUserName_0)'
2025-11-24 01:33:35.247 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: new SingleQueryingEnumerable<User>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 0], [Property: User.AccessFailedCount (int) Required, 1], [Property: User.ConcurrencyStamp (string) Concurrency, 2], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 3], [Property: User.DateOfBirth (DateOnly?), 4], [Property: User.Email (string) Index MaxLength(256), 5], [Property: User.EmailConfirmed (bool) Required, 6], [Property: User.FullName (string) Required MaxLength(150), 7], [Property: User.Gender (GenderType?) MaxLength(10), 8], [Property: User.LockoutEnabled (bool) Required, 9], [Property: User.LockoutEnd (DateTimeOffset?), 10], [Property: User.NormalizedEmail (string) Index MaxLength(256), 11], [Property: User.NormalizedUserName (string) Index MaxLength(256), 12], [Property: User.PasswordHash (string), 13], [Property: User.PhoneNumber (string), 14], [Property: User.PhoneNumberConfirmed (bool) Required, 15], [Property: User.RefreshToken (string), 16], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 17], [Property: User.Role (string) Required MaxLength(50), 18], [Property: User.SecurityStamp (string), 19], [Property: User.TwoFactorEnabled (bool) Required, 20], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 21], [Property: User.UserName (string) MaxLength(256), 22] }
            SELECT TOP(1) u.Id, u.AccessFailedCount, u.ConcurrencyStamp, u.CreatedAt, u.DateOfBirth, u.Email, u.EmailConfirmed, u.FullName, u.Gender, u.LockoutEnabled, u.LockoutEnd, u.NormalizedEmail, u.NormalizedUserName, u.PasswordHash, u.PhoneNumber, u.PhoneNumberConfirmed, u.RefreshToken, u.RefreshTokenExpiryTime, u.Role, u.SecurityStamp, u.TwoFactorEnabled, u.UpdatedAt, u.UserName
            FROM Users AS u
            WHERE u.NormalizedUserName == @__normalizedUserName_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 01:33:35.250 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:35.252 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:35.253 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:33:35.254 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:33:35.256 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:33:35.256 +02:00 [DBG] Executing DbCommand [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0
2025-11-24 01:33:35.266 +02:00 [INF] Executed DbCommand (10ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0
2025-11-24 01:33:35.269 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:33:35.270 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 01:33:35.271 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:35.272 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:33:35.289 +02:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:33:35.297 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:33:35.311 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:33:35.324 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 01:33:35.330 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:33:35.332 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:33:35.414 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:35.417 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:35.423 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:33:35.425 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:33:35.432 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (9ms).
2025-11-24 01:33:35.435 +02:00 [DBG] Executing DbCommand [Parameters=[@p22='?' (Size = 450), @p0='?' (DbType = Int32), @p1='?' (Size = 4000), @p23='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (DbType = DateTime2), @p4='?' (Size = 256), @p5='?' (DbType = Boolean), @p6='?' (Size = 150), @p7='?' (Size = 10), @p8='?' (DbType = Boolean), @p9='?' (DbType = DateTimeOffset), @p10='?' (Size = 256), @p11='?' (Size = 256), @p12='?' (Size = 4000), @p13='?' (Size = 4000), @p14='?' (DbType = Boolean), @p15='?' (Size = 4000), @p16='?' (DbType = DateTime2), @p17='?' (Size = 50), @p18='?' (Size = 4000), @p19='?' (DbType = Boolean), @p20='?' (DbType = DateTime2), @p21='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Users] SET [AccessFailedCount] = @p0, [ConcurrencyStamp] = @p1, [CreatedAt] = @p2, [DateOfBirth] = @p3, [Email] = @p4, [EmailConfirmed] = @p5, [FullName] = @p6, [Gender] = @p7, [LockoutEnabled] = @p8, [LockoutEnd] = @p9, [NormalizedEmail] = @p10, [NormalizedUserName] = @p11, [PasswordHash] = @p12, [PhoneNumber] = @p13, [PhoneNumberConfirmed] = @p14, [RefreshToken] = @p15, [RefreshTokenExpiryTime] = @p16, [Role] = @p17, [SecurityStamp] = @p18, [TwoFactorEnabled] = @p19, [UpdatedAt] = @p20, [UserName] = @p21
OUTPUT 1
WHERE [Id] = @p22 AND [ConcurrencyStamp] IS NULL;
2025-11-24 01:33:35.454 +02:00 [INF] Executed DbCommand (18ms) [Parameters=[@p22='?' (Size = 450), @p0='?' (DbType = Int32), @p1='?' (Size = 4000), @p23='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (DbType = DateTime2), @p4='?' (Size = 256), @p5='?' (DbType = Boolean), @p6='?' (Size = 150), @p7='?' (Size = 10), @p8='?' (DbType = Boolean), @p9='?' (DbType = DateTimeOffset), @p10='?' (Size = 256), @p11='?' (Size = 256), @p12='?' (Size = 4000), @p13='?' (Size = 4000), @p14='?' (DbType = Boolean), @p15='?' (Size = 4000), @p16='?' (DbType = DateTime2), @p17='?' (Size = 50), @p18='?' (Size = 4000), @p19='?' (DbType = Boolean), @p20='?' (DbType = DateTime2), @p21='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Users] SET [AccessFailedCount] = @p0, [ConcurrencyStamp] = @p1, [CreatedAt] = @p2, [DateOfBirth] = @p3, [Email] = @p4, [EmailConfirmed] = @p5, [FullName] = @p6, [Gender] = @p7, [LockoutEnabled] = @p8, [LockoutEnd] = @p9, [NormalizedEmail] = @p10, [NormalizedUserName] = @p11, [PasswordHash] = @p12, [PhoneNumber] = @p13, [PhoneNumberConfirmed] = @p14, [RefreshToken] = @p15, [RefreshTokenExpiryTime] = @p16, [Role] = @p17, [SecurityStamp] = @p18, [TwoFactorEnabled] = @p19, [UpdatedAt] = @p20, [UserName] = @p21
OUTPUT 1
WHERE [Id] = @p22 AND [ConcurrencyStamp] IS NULL;
2025-11-24 01:33:35.472 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:33:35.474 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 9ms reading results.
2025-11-24 01:33:35.480 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:35.483 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (2ms).
2025-11-24 01:33:35.492 +02:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:33:35.503 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 01:33:35.559 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:33:35.569 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:33:35.572 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:33:35.573 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:33:35.580 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 01:33:35.585 +02:00 [INF] Executing OkObjectResult, writing value of type 'Hospital.Domain.Models.AuthModel'.
2025-11-24 01:33:35.615 +02:00 [INF] Executed action Hospital.Controllers.AuthController.LoginAsync (Hospital) in 3021.8158ms
2025-11-24 01:33:35.618 +02:00 [INF] Executed endpoint 'Hospital.Controllers.AuthController.LoginAsync (Hospital)'
2025-11-24 01:33:35.622 +02:00 [DBG] Connection id "0HNHAT2OD6QV1" completed keep alive response.
2025-11-24 01:33:35.627 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:33:35.633 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:35.643 +02:00 [DBG] Disposed connection to database '' on server '' (8ms).
2025-11-24 01:33:35.648 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Auth/login - 200 null application/json; charset=utf-8 3222.0422ms
2025-11-24 01:33:46.302 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Branch/Create - application/json 145
2025-11-24 01:33:46.309 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Branch/Create'
2025-11-24 01:33:46.315 +02:00 [DBG] Endpoint 'Hospital.Controllers.BranchController.Create (Hospital)' with route pattern 'api/Branch/Create' is valid for the request path '/api/Branch/Create'
2025-11-24 01:33:46.318 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.BranchController.Create (Hospital)'
2025-11-24 01:33:46.318 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:33:46.319 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:33:46.320 +02:00 [INF] Executing endpoint 'Hospital.Controllers.BranchController.Create (Hospital)'
2025-11-24 01:33:46.324 +02:00 [INF] Route matched with {action = "Create", controller = "Branch"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Create(Hospital.Application.DTO.Branch.CreateBranchDto) on controller Hospital.Controllers.BranchController (Hospital).
2025-11-24 01:33:46.326 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:33:46.328 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:33:46.330 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:33:46.332 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:33:46.333 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:33:46.334 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.BranchController (Hospital)
2025-11-24 01:33:46.579 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.BranchController (Hospital)
2025-11-24 01:33:46.582 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Branch.CreateBranchDto' ...
2025-11-24 01:33:46.585 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Branch.CreateBranchDto' using the name '' in request data ...
2025-11-24 01:33:46.588 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 01:33:46.593 +02:00 [DBG] Connection id "0HNHAT2OD6QV1", Request id "0HNHAT2OD6QV1:00000002": started reading request body.
2025-11-24 01:33:46.596 +02:00 [DBG] Connection id "0HNHAT2OD6QV1", Request id "0HNHAT2OD6QV1:00000002": done reading request body.
2025-11-24 01:33:46.599 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Branch.CreateBranchDto'
2025-11-24 01:33:46.600 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Branch.CreateBranchDto'.
2025-11-24 01:33:46.602 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Branch.CreateBranchDto'.
2025-11-24 01:33:46.603 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Branch.CreateBranchDto' ...
2025-11-24 01:33:46.608 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Branch.CreateBranchDto'.
2025-11-24 01:33:46.613 +02:00 [INF] Create Branch called at "2025-11-24T01:33:46.6132529+02:00"
2025-11-24 01:33:46.616 +02:00 [INF] Creating new branch with name: adam7
2025-11-24 01:33:46.654 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:33:46.663 +02:00 [DBG] Compiling query expression: 
'DbSet<Branch>()
    .AsNoTracking()'
2025-11-24 01:33:46.672 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Branch>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Branch.Address (string) MaxLength(250), 1], [Property: Branch.BranchName (string) Required MaxLength(150), 2], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 3], [Property: Branch.Description (string), 4], [Property: Branch.Email (string) MaxLength(200), 5], [Property: Branch.ImageURL (string) MaxLength(300), 6], [Property: Branch.Phone (string) MaxLength(25), 7], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 8] }
        SELECT b.BranchId, b.Address, b.BranchName, b.CreatedAt, b.Description, b.Email, b.ImageURL, b.Phone, b.UpdatedAt
        FROM Branches AS b), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Branch>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 01:33:46.676 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:33:46.678 +02:00 [DBG] Created DbConnection. (1ms).
2025-11-24 01:33:46.680 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:46.680 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:46.681 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:33:46.681 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:33:46.682 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:33:46.683 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
2025-11-24 01:33:46.691 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
2025-11-24 01:33:46.693 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:33:46.694 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 01:33:46.695 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:46.695 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:33:46.721 +02:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Branch.BranchId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:33:46.768 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:33:46.772 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:33:46.781 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:33:46.786 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 01:33:46.788 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:33:46.790 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:33:46.805 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:46.811 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:46.812 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:33:46.813 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:33:46.814 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:33:46.817 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (Size = 250), @p1='?' (Size = 150), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 200), @p5='?' (Size = 300), @p6='?' (Size = 25), @p7='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Branches] ([Address], [BranchName], [CreatedAt], [Description], [Email], [ImageURL], [Phone], [UpdatedAt])
OUTPUT INSERTED.[BranchId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-11-24 01:33:46.828 +02:00 [INF] Executed DbCommand (12ms) [Parameters=[@p0='?' (Size = 250), @p1='?' (Size = 150), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 200), @p5='?' (Size = 300), @p6='?' (Size = 25), @p7='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Branches] ([Address], [BranchName], [CreatedAt], [Description], [Email], [ImageURL], [Phone], [UpdatedAt])
OUTPUT INSERTED.[BranchId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-11-24 01:33:46.838 +02:00 [DBG] The foreign key property 'Branch.BranchId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 01:33:46.844 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:33:46.849 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 17ms reading results.
2025-11-24 01:33:46.852 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:46.852 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:33:46.855 +02:00 [DBG] An entity of type 'Branch' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:33:46.857 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 01:33:46.860 +02:00 [INF] Branch created successfully with ID: 1
2025-11-24 01:33:46.865 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:33:46.868 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:33:46.869 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:33:46.869 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:33:46.870 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 01:33:46.871 +02:00 [INF] Executing CreatedAtActionResult, writing value of type 'Hospital.Application.DTO.Branch.BranchDto'.
2025-11-24 01:33:46.883 +02:00 [DBG] Found the endpoints ["Hospital.Controllers.BranchController.GetById (Hospital)"] for address (id=[1],action=[GetById],controller=[Branch])
2025-11-24 01:33:46.886 +02:00 [DBG] Successfully processed template api/Branch/GetBy/{id} for Hospital.Controllers.BranchController.GetById (Hospital) resulting in /api/Branch/GetBy/1 and 
2025-11-24 01:33:46.892 +02:00 [DBG] Link generation succeeded for endpoints ["Hospital.Controllers.BranchController.GetById (Hospital)"] with result /api/Branch/GetBy/1
2025-11-24 01:33:46.896 +02:00 [INF] Executed action Hospital.Controllers.BranchController.Create (Hospital) in 562.9524ms
2025-11-24 01:33:46.897 +02:00 [INF] Executed endpoint 'Hospital.Controllers.BranchController.Create (Hospital)'
2025-11-24 01:33:46.898 +02:00 [DBG] Connection id "0HNHAT2OD6QV1" completed keep alive response.
2025-11-24 01:33:46.899 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:33:46.899 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:46.900 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 01:33:46.901 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Branch/Create - 201 null application/json; charset=utf-8 599.0826ms
2025-11-24 01:33:54.656 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Branch/GetBy/1 - null null
2025-11-24 01:33:54.659 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Branch/GetBy/1'
2025-11-24 01:33:54.664 +02:00 [DBG] Endpoint 'Hospital.Controllers.BranchController.GetById (Hospital)' with route pattern 'api/Branch/GetBy/{id}' is valid for the request path '/api/Branch/GetBy/1'
2025-11-24 01:33:54.670 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.BranchController.GetById (Hospital)'
2025-11-24 01:33:54.672 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:33:54.674 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:33:54.675 +02:00 [INF] Executing endpoint 'Hospital.Controllers.BranchController.GetById (Hospital)'
2025-11-24 01:33:54.690 +02:00 [INF] Route matched with {action = "GetById", controller = "Branch"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetById(Int32) on controller Hospital.Controllers.BranchController (Hospital).
2025-11-24 01:33:54.698 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:33:54.701 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:33:54.702 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:33:54.703 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:33:54.704 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:33:54.706 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.BranchController (Hospital)
2025-11-24 01:33:54.708 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.BranchController (Hospital)
2025-11-24 01:33:54.709 +02:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-11-24 01:33:54.710 +02:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-11-24 01:33:54.712 +02:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-11-24 01:33:54.712 +02:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-11-24 01:33:54.713 +02:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-11-24 01:33:54.715 +02:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-11-24 01:33:54.716 +02:00 [INF] Get Branch By Id called at "2025-11-24T01:33:54.7162114+02:00"
2025-11-24 01:33:54.717 +02:00 [INF] Fetching branch by ID: 1
2025-11-24 01:33:54.725 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:33:54.728 +02:00 [DBG] Compiling query expression: 
'DbSet<Branch>()
    .FirstOrDefault(e => e.BranchId == __id_0)'
2025-11-24 01:33:54.734 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Branch>(
    asyncEnumerable: new SingleQueryingEnumerable<Branch>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Branch.Address (string) MaxLength(250), 1], [Property: Branch.BranchName (string) Required MaxLength(150), 2], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 3], [Property: Branch.Description (string), 4], [Property: Branch.Email (string) MaxLength(200), 5], [Property: Branch.ImageURL (string) MaxLength(300), 6], [Property: Branch.Phone (string) MaxLength(25), 7], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 8] }
            SELECT TOP(1) b.BranchId, b.Address, b.BranchName, b.CreatedAt, b.Description, b.Email, b.ImageURL, b.Phone, b.UpdatedAt
            FROM Branches AS b
            WHERE b.BranchId == @__id_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Branch>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 01:33:54.738 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:33:54.739 +02:00 [DBG] Created DbConnection. (1ms).
2025-11-24 01:33:54.740 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:54.742 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:54.743 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:33:54.744 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:33:54.745 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:33:54.746 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 01:33:54.751 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 01:33:54.753 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:33:54.755 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:33:54.756 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 3ms reading results.
2025-11-24 01:33:54.756 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:54.757 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:33:54.759 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:33:54.760 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:33:54.761 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:33:54.761 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:33:54.762 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 01:33:54.763 +02:00 [INF] Executing OkObjectResult, writing value of type 'Hospital.Application.DTO.Branch.BranchDto'.
2025-11-24 01:33:54.764 +02:00 [INF] Executed action Hospital.Controllers.BranchController.GetById (Hospital) in 58.3835ms
2025-11-24 01:33:54.765 +02:00 [INF] Executed endpoint 'Hospital.Controllers.BranchController.GetById (Hospital)'
2025-11-24 01:33:54.765 +02:00 [DBG] Connection id "0HNHAT2OD6QV1" completed keep alive response.
2025-11-24 01:33:54.766 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:33:54.767 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:33:54.767 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 01:33:54.768 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Branch/GetBy/1 - 200 null application/json; charset=utf-8 112.2076ms
2025-11-24 01:33:59.863 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Branch/GetAll - null null
2025-11-24 01:33:59.867 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Branch/GetAll'
2025-11-24 01:33:59.868 +02:00 [DBG] Endpoint 'Hospital.Controllers.BranchController.GetAll (Hospital)' with route pattern 'api/Branch/GetAll' is valid for the request path '/api/Branch/GetAll'
2025-11-24 01:33:59.871 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.BranchController.GetAll (Hospital)'
2025-11-24 01:33:59.873 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:33:59.920 +02:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '11/20/2025 10:16:12 PM', Current time (UTC): '11/23/2025 11:33:59 PM'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-11-24 01:33:59.924 +02:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '11/20/2025 10:16:12 PM', Current time (UTC): '11/23/2025 11:33:59 PM'.
2025-11-24 01:33:59.932 +02:00 [DBG] Policy authentication schemes  did not succeed
2025-11-24 01:33:59.938 +02:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Patient)
2025-11-24 01:33:59.943 +02:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-11-24 01:33:59.949 +02:00 [DBG] Connection id "0HNHAT2OD6QV1" completed keep alive response.
2025-11-24 01:33:59.954 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Branch/GetAll - 401 0 null 91.1074ms
2025-11-24 01:34:11.902 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Branch/GetAll - null null
2025-11-24 01:34:11.905 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Branch/GetAll'
2025-11-24 01:34:11.906 +02:00 [DBG] Endpoint 'Hospital.Controllers.BranchController.GetAll (Hospital)' with route pattern 'api/Branch/GetAll' is valid for the request path '/api/Branch/GetAll'
2025-11-24 01:34:11.908 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.BranchController.GetAll (Hospital)'
2025-11-24 01:34:11.910 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:34:11.912 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:34:11.913 +02:00 [DBG] Policy authentication schemes  did not succeed
2025-11-24 01:34:11.914 +02:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Patient)
2025-11-24 01:34:11.915 +02:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-11-24 01:34:11.916 +02:00 [DBG] Connection id "0HNHAT2OD6QV1" completed keep alive response.
2025-11-24 01:34:11.916 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Branch/GetAll - 401 0 null 14.641ms
2025-11-24 01:34:13.873 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Branch/GetAll - null null
2025-11-24 01:34:13.881 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Branch/GetAll'
2025-11-24 01:34:13.882 +02:00 [DBG] Endpoint 'Hospital.Controllers.BranchController.GetAll (Hospital)' with route pattern 'api/Branch/GetAll' is valid for the request path '/api/Branch/GetAll'
2025-11-24 01:34:13.883 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.BranchController.GetAll (Hospital)'
2025-11-24 01:34:13.884 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:34:13.885 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:34:13.886 +02:00 [DBG] Policy authentication schemes  did not succeed
2025-11-24 01:34:13.887 +02:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Patient)
2025-11-24 01:34:13.887 +02:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-11-24 01:34:13.889 +02:00 [DBG] Connection id "0HNHAT2OD6QV1" completed keep alive response.
2025-11-24 01:34:13.890 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Branch/GetAll - 401 0 null 16.4436ms
2025-11-24 01:34:22.028 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Branch/GetAll - null null
2025-11-24 01:34:22.033 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Branch/GetAll'
2025-11-24 01:34:22.035 +02:00 [DBG] Endpoint 'Hospital.Controllers.BranchController.GetAll (Hospital)' with route pattern 'api/Branch/GetAll' is valid for the request path '/api/Branch/GetAll'
2025-11-24 01:34:22.037 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.BranchController.GetAll (Hospital)'
2025-11-24 01:34:22.041 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:34:22.042 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:34:22.043 +02:00 [DBG] Policy authentication schemes  did not succeed
2025-11-24 01:34:22.044 +02:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Patient)
2025-11-24 01:34:22.046 +02:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-11-24 01:34:22.047 +02:00 [DBG] Connection id "0HNHAT2OD6QV1" completed keep alive response.
2025-11-24 01:34:22.049 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Branch/GetAll - 401 0 null 21.2149ms
2025-11-24 01:34:48.413 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/swagger/index.html - null null
2025-11-24 01:34:48.426 +02:00 [DBG] No candidates found for the request path '/swagger/index.html'
2025-11-24 01:34:48.429 +02:00 [DBG] Request did not match any endpoints
2025-11-24 01:34:48.431 +02:00 [DBG] Response markup is scheduled to include Browser Link script injection.
2025-11-24 01:34:48.433 +02:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2025-11-24 01:34:48.437 +02:00 [DBG] Response markup was updated to include Browser Link script injection.
2025-11-24 01:34:48.444 +02:00 [DBG] Response markup was updated to include browser refresh script injection.
2025-11-24 01:34:48.446 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/swagger/index.html - 200 null text/html;charset=utf-8 33.1157ms
2025-11-24 01:34:48.481 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/_framework/aspnetcore-browser-refresh.js - null null
2025-11-24 01:34:48.484 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/_vs/browserLink - null null
2025-11-24 01:34:48.487 +02:00 [DBG] Script injected: /_framework/aspnetcore-browser-refresh.js
2025-11-24 01:34:48.502 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/_framework/aspnetcore-browser-refresh.js - 200 16501 application/javascript; charset=utf-8 21.3267ms
2025-11-24 01:34:48.513 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/_vs/browserLink - 200 null text/javascript; charset=UTF-8 29.8434ms
2025-11-24 01:34:48.589 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/swagger/v1/swagger.json - null null
2025-11-24 01:34:48.594 +02:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2025-11-24 01:34:48.596 +02:00 [DBG] Request did not match any endpoints
2025-11-24 01:34:48.666 +02:00 [ERR]  Exception caught: Ambiguous HTTP method for action - Hospital.Controllers.BranchController.GetAll (Hospital). Actions require an explicit HttpMethod binding for Swagger/OpenAPI 3.0
Swashbuckle.AspNetCore.SwaggerGen.SwaggerGeneratorException: Ambiguous HTTP method for action - Hospital.Controllers.BranchController.GetAll (Hospital). Actions require an explicit HttpMethod binding for Swagger/OpenAPI 3.0
   at Swashbuckle.AspNetCore.SwaggerGen.SwaggerGenerator.GenerateOperations(IEnumerable`1 apiDescriptions, SchemaRepository schemaRepository)
   at Swashbuckle.AspNetCore.SwaggerGen.SwaggerGenerator.GeneratePaths(IEnumerable`1 apiDescriptions, SchemaRepository schemaRepository)
   at Swashbuckle.AspNetCore.SwaggerGen.SwaggerGenerator.GetSwaggerDocumentWithoutFilters(String documentName, String host, String basePath)
   at Swashbuckle.AspNetCore.SwaggerGen.SwaggerGenerator.GetSwaggerAsync(String documentName, String host, String basePath)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context)
2025-11-24 01:34:48.687 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/swagger/v1/swagger.json - 500 null application/json 98.068ms
2025-11-24 01:34:51.959 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Branch/GetAll - null null
2025-11-24 01:34:51.968 +02:00 [DBG] No candidates found for the request path '/api/Branch/GetAll'
2025-11-24 01:34:51.969 +02:00 [DBG] Request did not match any endpoints
2025-11-24 01:34:51.974 +02:00 [DBG] The request path  does not match the path filter
2025-11-24 01:34:51.976 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:34:51.981 +02:00 [DBG] Connection id "0HNHAT2OD6QV1" completed keep alive response.
2025-11-24 01:34:51.982 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Branch/GetAll - 404 0 null 23.0496ms
2025-11-24 01:34:51.985 +02:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7217/api/Branch/GetAll, Response status code: 404
2025-11-24 01:34:58.496 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Branch/GetAll - null null
2025-11-24 01:34:58.500 +02:00 [DBG] No candidates found for the request path '/api/Branch/GetAll'
2025-11-24 01:34:58.502 +02:00 [DBG] Request did not match any endpoints
2025-11-24 01:34:58.502 +02:00 [DBG] The request path  does not match the path filter
2025-11-24 01:34:58.503 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:34:58.508 +02:00 [DBG] Connection id "0HNHAT2OD6QV1" completed keep alive response.
2025-11-24 01:34:58.512 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Branch/GetAll - 404 0 null 17.0123ms
2025-11-24 01:34:58.517 +02:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7217/api/Branch/GetAll, Response status code: 404
2025-11-24 01:35:03.485 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Branch/GetBy/1 - null null
2025-11-24 01:35:03.488 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Branch/GetBy/1'
2025-11-24 01:35:03.489 +02:00 [DBG] Endpoint 'Hospital.Controllers.BranchController.GetById (Hospital)' with route pattern 'api/Branch/GetBy/{id}' is valid for the request path '/api/Branch/GetBy/1'
2025-11-24 01:35:03.494 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.BranchController.GetById (Hospital)'
2025-11-24 01:35:03.499 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:35:03.500 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:35:03.501 +02:00 [INF] Executing endpoint 'Hospital.Controllers.BranchController.GetById (Hospital)'
2025-11-24 01:35:03.505 +02:00 [INF] Route matched with {action = "GetById", controller = "Branch"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetById(Int32) on controller Hospital.Controllers.BranchController (Hospital).
2025-11-24 01:35:03.507 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:35:03.508 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:35:03.509 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:35:03.510 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:35:03.511 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:35:03.513 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.BranchController (Hospital)
2025-11-24 01:35:03.517 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.BranchController (Hospital)
2025-11-24 01:35:03.518 +02:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-11-24 01:35:03.520 +02:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-11-24 01:35:03.521 +02:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-11-24 01:35:03.521 +02:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-11-24 01:35:03.523 +02:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-11-24 01:35:03.523 +02:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-11-24 01:35:03.524 +02:00 [INF] Get Branch By Id called at "2025-11-24T01:35:03.5244605+02:00"
2025-11-24 01:35:03.525 +02:00 [INF] Fetching branch by ID: 1
2025-11-24 01:35:03.526 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:35:03.528 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:35:03.528 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 01:35:03.529 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:35:03.529 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:35:03.530 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:35:03.530 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:35:03.531 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:35:03.532 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 01:35:03.539 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 01:35:03.541 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:35:03.542 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:35:03.542 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 01:35:03.543 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:35:03.544 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:35:03.545 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:35:03.547 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:35:03.547 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:35:03.548 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:35:03.548 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 01:35:03.549 +02:00 [INF] Executing OkObjectResult, writing value of type 'Hospital.Application.DTO.Branch.BranchDto'.
2025-11-24 01:35:03.552 +02:00 [INF] Executed action Hospital.Controllers.BranchController.GetById (Hospital) in 38.9013ms
2025-11-24 01:35:03.553 +02:00 [INF] Executed endpoint 'Hospital.Controllers.BranchController.GetById (Hospital)'
2025-11-24 01:35:03.556 +02:00 [DBG] Connection id "0HNHAT2OD6QV1" completed keep alive response.
2025-11-24 01:35:03.557 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:35:03.558 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:35:03.559 +02:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-11-24 01:35:03.561 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Branch/GetBy/1 - 200 null application/json; charset=utf-8 76.9655ms
2025-11-24 01:35:07.561 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Branch/GetAll - null null
2025-11-24 01:35:07.567 +02:00 [DBG] No candidates found for the request path '/api/Branch/GetAll'
2025-11-24 01:35:07.568 +02:00 [DBG] Request did not match any endpoints
2025-11-24 01:35:07.568 +02:00 [DBG] The request path  does not match the path filter
2025-11-24 01:35:07.569 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:35:07.571 +02:00 [DBG] Connection id "0HNHAT2OD6QV1" completed keep alive response.
2025-11-24 01:35:07.575 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Branch/GetAll - 404 0 null 14.5765ms
2025-11-24 01:35:07.578 +02:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7217/api/Branch/GetAll, Response status code: 404
2025-11-24 01:36:05.255 +02:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-11-24 01:36:05.377 +02:00 [DBG] Hosting starting
2025-11-24 01:36:05.412 +02:00 [INF] User profile is available. Using 'C:\Users\E-Mad\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-24 01:36:05.421 +02:00 [DBG] Reading data from file 'C:\Users\E-Mad\AppData\Local\ASP.NET\DataProtection-Keys\key-b85f0939-0825-4b2b-b21a-67409aec9db0.xml'.
2025-11-24 01:36:05.426 +02:00 [DBG] Found key {b85f0939-0825-4b2b-b21a-67409aec9db0}.
2025-11-24 01:36:05.432 +02:00 [DBG] Considering key {b85f0939-0825-4b2b-b21a-67409aec9db0} with expiration date 2026-02-09 12:52:20Z as default key.
2025-11-24 01:36:05.436 +02:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-11-24 01:36:05.440 +02:00 [DBG] Decrypting secret element using Windows DPAPI.
2025-11-24 01:36:05.441 +02:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-11-24 01:36:05.447 +02:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-11-24 01:36:05.449 +02:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-11-24 01:36:05.450 +02:00 [DBG] Using key {b85f0939-0825-4b2b-b21a-67409aec9db0} as the default key.
2025-11-24 01:36:05.452 +02:00 [DBG] Key ring with default key {b85f0939-0825-4b2b-b21a-67409aec9db0} was loaded during application startup.
2025-11-24 01:36:05.457 +02:00 [DBG] Middleware loaded
2025-11-24 01:36:05.461 +02:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16501 B).
2025-11-24 01:36:05.465 +02:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-11-24 01:36:05.559 +02:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-11-24 01:36:05.683 +02:00 [INF] Now listening on: https://localhost:7217
2025-11-24 01:36:05.688 +02:00 [INF] Now listening on: http://localhost:5163
2025-11-24 01:36:05.694 +02:00 [DBG] Loaded hosting startup assembly Hospital
2025-11-24 01:36:05.698 +02:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-11-24 01:36:05.701 +02:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-11-24 01:36:05.702 +02:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-11-24 01:36:05.777 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-24 01:36:05.781 +02:00 [INF] Hosting environment: Development
2025-11-24 01:36:05.785 +02:00 [INF] Content root path: D:\Walaa\GP\Hospital\Hospital
2025-11-24 01:36:05.787 +02:00 [DBG] Hosting started
2025-11-24 01:36:06.146 +02:00 [DBG] Connection id "0HNHAT49A1EQH" received FIN.
2025-11-24 01:36:06.146 +02:00 [DBG] Connection id "0HNHAT49A1EQG" received FIN.
2025-11-24 01:36:06.157 +02:00 [DBG] Connection id "0HNHAT49A1EQH" accepted.
2025-11-24 01:36:06.157 +02:00 [DBG] Connection id "0HNHAT49A1EQG" accepted.
2025-11-24 01:36:06.158 +02:00 [DBG] Connection id "0HNHAT49A1EQH" started.
2025-11-24 01:36:06.159 +02:00 [DBG] Connection id "0HNHAT49A1EQG" started.
2025-11-24 01:36:06.182 +02:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-11-24 01:36:06.182 +02:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-11-24 01:36:06.230 +02:00 [DBG] Connection id "0HNHAT49A1EQG" stopped.
2025-11-24 01:36:06.230 +02:00 [DBG] Connection id "0HNHAT49A1EQH" stopped.
2025-11-24 01:36:06.236 +02:00 [DBG] Connection id "0HNHAT49A1EQG" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-11-24 01:36:06.236 +02:00 [DBG] Connection id "0HNHAT49A1EQH" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-11-24 01:36:06.355 +02:00 [DBG] Connection id "0HNHAT49A1EQI" accepted.
2025-11-24 01:36:06.357 +02:00 [DBG] Connection id "0HNHAT49A1EQI" started.
2025-11-24 01:36:06.413 +02:00 [DBG] Connection 0HNHAT49A1EQI established using the following protocol: "Tls12"
2025-11-24 01:36:06.484 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/swagger/index.html - null null
2025-11-24 01:36:06.583 +02:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-11-24 01:36:06.618 +02:00 [DBG] No candidates found for the request path '/swagger/index.html'
2025-11-24 01:36:06.621 +02:00 [DBG] Request did not match any endpoints
2025-11-24 01:36:06.672 +02:00 [DBG] Response markup is scheduled to include Browser Link script injection.
2025-11-24 01:36:06.675 +02:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2025-11-24 01:36:06.699 +02:00 [DBG] Response markup was updated to include Browser Link script injection.
2025-11-24 01:36:06.703 +02:00 [DBG] Response markup was updated to include browser refresh script injection.
2025-11-24 01:36:06.711 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/swagger/index.html - 200 null text/html;charset=utf-8 236.2598ms
2025-11-24 01:36:06.722 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/_framework/aspnetcore-browser-refresh.js - null null
2025-11-24 01:36:06.722 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/_vs/browserLink - null null
2025-11-24 01:36:06.738 +02:00 [DBG] Script injected: /_framework/aspnetcore-browser-refresh.js
2025-11-24 01:36:06.742 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/_framework/aspnetcore-browser-refresh.js - 200 16501 application/javascript; charset=utf-8 21.0172ms
2025-11-24 01:36:06.780 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/_vs/browserLink - 200 null text/javascript; charset=UTF-8 57.9176ms
2025-11-24 01:36:06.835 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/swagger/v1/swagger.json - null null
2025-11-24 01:36:06.843 +02:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2025-11-24 01:36:06.846 +02:00 [DBG] Request did not match any endpoints
2025-11-24 01:36:06.895 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 60.7767ms
2025-11-24 01:36:18.668 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/api/Branch/GetAll - null null
2025-11-24 01:36:18.678 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Branch/GetAll'
2025-11-24 01:36:18.687 +02:00 [DBG] Endpoint 'Hospital.Controllers.BranchController.GetAll (Hospital)' with route pattern 'api/Branch/GetAll' is valid for the request path '/api/Branch/GetAll'
2025-11-24 01:36:18.691 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.BranchController.GetAll (Hospital)'
2025-11-24 01:36:18.696 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:36:18.749 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:36:18.755 +02:00 [INF] Executing endpoint 'Hospital.Controllers.BranchController.GetAll (Hospital)'
2025-11-24 01:36:18.782 +02:00 [INF] Route matched with {action = "GetAll", controller = "Branch"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll() on controller Hospital.Controllers.BranchController (Hospital).
2025-11-24 01:36:18.790 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:36:18.792 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:36:18.794 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:36:18.797 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:36:18.800 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:36:18.805 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.BranchController (Hospital)
2025-11-24 01:36:18.943 +02:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-11-24 01:36:19.252 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.BranchController (Hospital)
2025-11-24 01:36:26.329 +02:00 [INF] Get All Branch called at "2025-11-24T01:36:26.3077646+02:00"
2025-11-24 01:36:30.301 +02:00 [INF] Fetching all branches
2025-11-24 01:36:30.917 +02:00 [DBG] The index {'BranchesBranchId'} was not created on entity type 'BranchDoctor (Dictionary<string, object>)' as the properties are already covered by the index {'BranchesBranchId', 'DoctorsDoctorId'}.
2025-11-24 01:36:30.923 +02:00 [DBG] The index {'BranchId'} was not created on entity type 'BranchService (Dictionary<string, object>)' as the properties are already covered by the index {'BranchId', 'ServiceId'}.
2025-11-24 01:36:30.927 +02:00 [DBG] The index {'BranchId'} was not created on entity type 'BranchSpecialization (Dictionary<string, object>)' as the properties are already covered by the index {'BranchId', 'SpecializationId'}.
2025-11-24 01:36:30.929 +02:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserRole<string>' as the properties are already covered by the index {'UserId', 'RoleId'}.
2025-11-24 01:36:30.931 +02:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserToken<string>' as the properties are already covered by the index {'UserId', 'LoginProvider', 'Name'}.
2025-11-24 01:36:31.100 +02:00 [DBG] The property 'BranchDoctor (Dictionary<string, object>).BranchesBranchId' was created in shadow state because there are no eligible CLR members with a matching name.
2025-11-24 01:36:31.101 +02:00 [DBG] The property 'BranchDoctor (Dictionary<string, object>).DoctorsDoctorId' was created in shadow state because there are no eligible CLR members with a matching name.
2025-11-24 01:36:31.304 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:36:31.360 +02:00 [DBG] Compiling query expression: 
'DbSet<Branch>()
    .AsNoTracking()'
2025-11-24 01:36:31.528 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Branch>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Branch.Address (string) MaxLength(250), 1], [Property: Branch.BranchName (string) Required MaxLength(150), 2], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 3], [Property: Branch.Description (string), 4], [Property: Branch.Email (string) MaxLength(200), 5], [Property: Branch.ImageURL (string) MaxLength(300), 6], [Property: Branch.Phone (string) MaxLength(25), 7], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 8] }
        SELECT b.BranchId, b.Address, b.BranchName, b.CreatedAt, b.Description, b.Email, b.ImageURL, b.Phone, b.UpdatedAt
        FROM Branches AS b), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Branch>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 01:36:31.555 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:36:31.581 +02:00 [DBG] Created DbConnection. (25ms).
2025-11-24 01:36:31.596 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:36:31.938 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:36:31.945 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:36:31.959 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (11ms).
2025-11-24 01:36:31.967 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (22ms).
2025-11-24 01:36:31.980 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
2025-11-24 01:36:32.037 +02:00 [INF] Executed DbCommand (59ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
2025-11-24 01:36:32.066 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:36:32.079 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 34ms reading results.
2025-11-24 01:36:32.090 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:36:32.096 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (5ms).
2025-11-24 01:36:34.827 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:36:34.831 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:36:34.835 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:36:34.836 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:36:34.840 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 01:36:34.845 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Branch.BranchDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 01:36:40.890 +02:00 [INF] Executed action Hospital.Controllers.BranchController.GetAll (Hospital) in 22082.1088ms
2025-11-24 01:36:40.896 +02:00 [INF] Executed endpoint 'Hospital.Controllers.BranchController.GetAll (Hospital)'
2025-11-24 01:36:42.941 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:36:42.946 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:36:42.952 +02:00 [DBG] Disposed connection to database '' on server '' (5ms).
2025-11-24 01:36:42.959 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/api/Branch/GetAll - 200 null application/json; charset=utf-8 24291.6677ms
2025-11-24 01:37:03.344 +02:00 [DBG] Connection id "0HNHAT49A1EQJ" accepted.
2025-11-24 01:37:03.344 +02:00 [DBG] Connection id "0HNHAT49A1EQJ" received FIN.
2025-11-24 01:37:03.348 +02:00 [DBG] Connection id "0HNHAT49A1EQJ" started.
2025-11-24 01:37:03.349 +02:00 [DBG] Connection id "0HNHAT49A1EQK" accepted.
2025-11-24 01:37:03.356 +02:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-11-24 01:37:03.357 +02:00 [DBG] Connection id "0HNHAT49A1EQK" started.
2025-11-24 01:37:03.360 +02:00 [DBG] Connection id "0HNHAT49A1EQJ" stopped.
2025-11-24 01:37:03.364 +02:00 [DBG] Connection id "0HNHAT49A1EQJ" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-11-24 01:37:03.371 +02:00 [DBG] Connection 0HNHAT49A1EQK established using the following protocol: "Tls12"
2025-11-24 01:37:03.387 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Branch/GetAll - null null
2025-11-24 01:37:03.394 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Branch/GetAll'
2025-11-24 01:37:03.399 +02:00 [DBG] Endpoint 'Hospital.Controllers.BranchController.GetAll (Hospital)' with route pattern 'api/Branch/GetAll' is valid for the request path '/api/Branch/GetAll'
2025-11-24 01:37:03.401 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.BranchController.GetAll (Hospital)'
2025-11-24 01:37:03.404 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:37:03.406 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:37:03.406 +02:00 [INF] Executing endpoint 'Hospital.Controllers.BranchController.GetAll (Hospital)'
2025-11-24 01:37:03.407 +02:00 [INF] Route matched with {action = "GetAll", controller = "Branch"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll() on controller Hospital.Controllers.BranchController (Hospital).
2025-11-24 01:37:03.408 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:37:03.409 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:37:03.410 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:37:03.411 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:37:03.412 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:37:03.413 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.BranchController (Hospital)
2025-11-24 01:37:03.417 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.BranchController (Hospital)
2025-11-24 01:37:12.103 +02:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-11-24 01:37:12.251 +02:00 [DBG] Hosting starting
2025-11-24 01:37:12.288 +02:00 [INF] User profile is available. Using 'C:\Users\E-Mad\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-24 01:37:12.300 +02:00 [DBG] Reading data from file 'C:\Users\E-Mad\AppData\Local\ASP.NET\DataProtection-Keys\key-b85f0939-0825-4b2b-b21a-67409aec9db0.xml'.
2025-11-24 01:37:12.309 +02:00 [DBG] Found key {b85f0939-0825-4b2b-b21a-67409aec9db0}.
2025-11-24 01:37:12.318 +02:00 [DBG] Considering key {b85f0939-0825-4b2b-b21a-67409aec9db0} with expiration date 2026-02-09 12:52:20Z as default key.
2025-11-24 01:37:12.326 +02:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-11-24 01:37:12.329 +02:00 [DBG] Decrypting secret element using Windows DPAPI.
2025-11-24 01:37:12.331 +02:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-11-24 01:37:12.340 +02:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-11-24 01:37:12.342 +02:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-11-24 01:37:12.345 +02:00 [DBG] Using key {b85f0939-0825-4b2b-b21a-67409aec9db0} as the default key.
2025-11-24 01:37:12.346 +02:00 [DBG] Key ring with default key {b85f0939-0825-4b2b-b21a-67409aec9db0} was loaded during application startup.
2025-11-24 01:37:12.352 +02:00 [DBG] Middleware loaded
2025-11-24 01:37:12.354 +02:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16501 B).
2025-11-24 01:37:12.356 +02:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-11-24 01:37:12.458 +02:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-11-24 01:37:12.571 +02:00 [INF] Now listening on: https://localhost:7217
2025-11-24 01:37:12.576 +02:00 [INF] Now listening on: http://localhost:5163
2025-11-24 01:37:12.579 +02:00 [DBG] Loaded hosting startup assembly Hospital
2025-11-24 01:37:12.581 +02:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-11-24 01:37:12.581 +02:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-11-24 01:37:12.582 +02:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-11-24 01:37:12.653 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-24 01:37:12.654 +02:00 [INF] Hosting environment: Development
2025-11-24 01:37:12.657 +02:00 [INF] Content root path: D:\Walaa\GP\Hospital\Hospital
2025-11-24 01:37:12.668 +02:00 [DBG] Hosting started
2025-11-24 01:37:12.685 +02:00 [DBG] Connection id "0HNHAT4T4JIFF" received FIN.
2025-11-24 01:37:12.686 +02:00 [DBG] Connection id "0HNHAT4T4JIFG" received FIN.
2025-11-24 01:37:12.690 +02:00 [DBG] Connection id "0HNHAT4T4JIFG" accepted.
2025-11-24 01:37:12.690 +02:00 [DBG] Connection id "0HNHAT4T4JIFF" accepted.
2025-11-24 01:37:12.700 +02:00 [DBG] Connection id "0HNHAT4T4JIFG" started.
2025-11-24 01:37:12.704 +02:00 [DBG] Connection id "0HNHAT4T4JIFF" started.
2025-11-24 01:37:12.727 +02:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-11-24 01:37:12.727 +02:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-11-24 01:37:12.800 +02:00 [DBG] Connection id "0HNHAT4T4JIFF" stopped.
2025-11-24 01:37:12.800 +02:00 [DBG] Connection id "0HNHAT4T4JIFG" stopped.
2025-11-24 01:37:12.805 +02:00 [DBG] Connection id "0HNHAT4T4JIFF" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-11-24 01:37:12.805 +02:00 [DBG] Connection id "0HNHAT4T4JIFG" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-11-24 01:37:12.964 +02:00 [DBG] Connection id "0HNHAT4T4JIFH" accepted.
2025-11-24 01:37:12.968 +02:00 [DBG] Connection id "0HNHAT4T4JIFH" started.
2025-11-24 01:37:13.033 +02:00 [DBG] Connection 0HNHAT4T4JIFH established using the following protocol: "Tls12"
2025-11-24 01:37:13.096 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/swagger/index.html - null null
2025-11-24 01:37:13.183 +02:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-11-24 01:37:13.210 +02:00 [DBG] No candidates found for the request path '/swagger/index.html'
2025-11-24 01:37:13.212 +02:00 [DBG] Request did not match any endpoints
2025-11-24 01:37:13.254 +02:00 [DBG] Response markup is scheduled to include Browser Link script injection.
2025-11-24 01:37:13.257 +02:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2025-11-24 01:37:13.277 +02:00 [DBG] Response markup was updated to include Browser Link script injection.
2025-11-24 01:37:13.281 +02:00 [DBG] Response markup was updated to include browser refresh script injection.
2025-11-24 01:37:13.287 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/swagger/index.html - 200 null text/html;charset=utf-8 196.8058ms
2025-11-24 01:37:13.296 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/_vs/browserLink - null null
2025-11-24 01:37:13.296 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/_framework/aspnetcore-browser-refresh.js - null null
2025-11-24 01:37:13.310 +02:00 [DBG] Script injected: /_framework/aspnetcore-browser-refresh.js
2025-11-24 01:37:13.311 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/_framework/aspnetcore-browser-refresh.js - 200 16501 application/javascript; charset=utf-8 14.8672ms
2025-11-24 01:37:13.336 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/_vs/browserLink - 200 null text/javascript; charset=UTF-8 40.1115ms
2025-11-24 01:37:13.375 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/swagger/v1/swagger.json - null null
2025-11-24 01:37:13.382 +02:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2025-11-24 01:37:13.384 +02:00 [DBG] Request did not match any endpoints
2025-11-24 01:37:13.424 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 48.682ms
2025-11-24 01:37:17.465 +02:00 [DBG] Connection id "0HNHAT4T4JIFI" accepted.
2025-11-24 01:37:17.465 +02:00 [DBG] Connection id "0HNHAT4T4JIFI" received FIN.
2025-11-24 01:37:17.468 +02:00 [DBG] Connection id "0HNHAT4T4JIFI" started.
2025-11-24 01:37:17.469 +02:00 [DBG] Connection id "0HNHAT4T4JIFJ" accepted.
2025-11-24 01:37:17.474 +02:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-11-24 01:37:17.475 +02:00 [DBG] Connection id "0HNHAT4T4JIFJ" started.
2025-11-24 01:37:17.479 +02:00 [DBG] Connection id "0HNHAT4T4JIFI" stopped.
2025-11-24 01:37:17.481 +02:00 [DBG] Connection id "0HNHAT4T4JIFI" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-11-24 01:37:17.484 +02:00 [DBG] Connection 0HNHAT4T4JIFJ established using the following protocol: "Tls12"
2025-11-24 01:37:17.488 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Branch/GetAll - null null
2025-11-24 01:37:17.492 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Branch/GetAll'
2025-11-24 01:37:17.494 +02:00 [DBG] Endpoint 'Hospital.Controllers.BranchController.GetAll (Hospital)' with route pattern 'api/Branch/GetAll' is valid for the request path '/api/Branch/GetAll'
2025-11-24 01:37:17.497 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.BranchController.GetAll (Hospital)'
2025-11-24 01:37:17.500 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:37:17.532 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:37:17.537 +02:00 [INF] Executing endpoint 'Hospital.Controllers.BranchController.GetAll (Hospital)'
2025-11-24 01:37:17.556 +02:00 [INF] Route matched with {action = "GetAll", controller = "Branch"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll() on controller Hospital.Controllers.BranchController (Hospital).
2025-11-24 01:37:17.567 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:37:17.572 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:37:17.574 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:37:17.576 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:37:17.578 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:37:17.580 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.BranchController (Hospital)
2025-11-24 01:37:17.694 +02:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-11-24 01:37:17.917 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.BranchController (Hospital)
2025-11-24 01:37:17.921 +02:00 [INF] Get All Branch called at "2025-11-24T01:37:17.9212379+02:00"
2025-11-24 01:37:17.925 +02:00 [INF] Fetching all branches
2025-11-24 01:37:18.513 +02:00 [DBG] The index {'BranchesBranchId'} was not created on entity type 'BranchDoctor (Dictionary<string, object>)' as the properties are already covered by the index {'BranchesBranchId', 'DoctorsDoctorId'}.
2025-11-24 01:37:18.522 +02:00 [DBG] The index {'BranchId'} was not created on entity type 'BranchService (Dictionary<string, object>)' as the properties are already covered by the index {'BranchId', 'ServiceId'}.
2025-11-24 01:37:18.528 +02:00 [DBG] The index {'BranchId'} was not created on entity type 'BranchSpecialization (Dictionary<string, object>)' as the properties are already covered by the index {'BranchId', 'SpecializationId'}.
2025-11-24 01:37:18.529 +02:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserRole<string>' as the properties are already covered by the index {'UserId', 'RoleId'}.
2025-11-24 01:37:18.532 +02:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserToken<string>' as the properties are already covered by the index {'UserId', 'LoginProvider', 'Name'}.
2025-11-24 01:37:18.716 +02:00 [DBG] The property 'BranchDoctor (Dictionary<string, object>).BranchesBranchId' was created in shadow state because there are no eligible CLR members with a matching name.
2025-11-24 01:37:18.718 +02:00 [DBG] The property 'BranchDoctor (Dictionary<string, object>).DoctorsDoctorId' was created in shadow state because there are no eligible CLR members with a matching name.
2025-11-24 01:37:19.006 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:37:19.056 +02:00 [DBG] Compiling query expression: 
'DbSet<Branch>()
    .AsNoTracking()'
2025-11-24 01:37:19.262 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Branch>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Branch.Address (string) MaxLength(250), 1], [Property: Branch.BranchName (string) Required MaxLength(150), 2], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 3], [Property: Branch.Description (string), 4], [Property: Branch.Email (string) MaxLength(200), 5], [Property: Branch.ImageURL (string) MaxLength(300), 6], [Property: Branch.Phone (string) MaxLength(25), 7], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 8] }
        SELECT b.BranchId, b.Address, b.BranchName, b.CreatedAt, b.Description, b.Email, b.ImageURL, b.Phone, b.UpdatedAt
        FROM Branches AS b), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Branch>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 01:37:19.304 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:37:19.336 +02:00 [DBG] Created DbConnection. (26ms).
2025-11-24 01:37:19.347 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:37:19.668 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:37:19.672 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:37:19.678 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (4ms).
2025-11-24 01:37:19.688 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (15ms).
2025-11-24 01:37:19.699 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
2025-11-24 01:37:19.750 +02:00 [INF] Executed DbCommand (52ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
2025-11-24 01:37:19.780 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:37:19.790 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 20ms reading results.
2025-11-24 01:37:19.799 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:37:19.805 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (5ms).
2025-11-24 01:37:19.826 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:37:19.831 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:37:19.831 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:37:19.832 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:37:19.833 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 01:37:19.835 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Branch.BranchDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 01:37:19.871 +02:00 [INF] Executed action Hospital.Controllers.BranchController.GetAll (Hospital) in 2286.5533ms
2025-11-24 01:37:19.877 +02:00 [INF] Executed endpoint 'Hospital.Controllers.BranchController.GetAll (Hospital)'
2025-11-24 01:37:19.881 +02:00 [DBG] Connection id "0HNHAT4T4JIFJ" completed keep alive response.
2025-11-24 01:37:19.891 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:37:19.898 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:37:19.902 +02:00 [DBG] Disposed connection to database '' on server '' (2ms).
2025-11-24 01:37:19.910 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Branch/GetAll - 200 null application/json; charset=utf-8 2421.892ms
2025-11-24 01:37:29.641 +02:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7217/api/Branch/Update - application/json 161
2025-11-24 01:37:29.649 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Branch/Update'
2025-11-24 01:37:29.653 +02:00 [DBG] Endpoint 'Hospital.Controllers.BranchController.Update (Hospital)' with route pattern 'api/Branch/Update' is valid for the request path '/api/Branch/Update'
2025-11-24 01:37:29.655 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.BranchController.Update (Hospital)'
2025-11-24 01:37:29.659 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:37:29.661 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:37:29.662 +02:00 [INF] Executing endpoint 'Hospital.Controllers.BranchController.Update (Hospital)'
2025-11-24 01:37:29.670 +02:00 [INF] Route matched with {action = "Update", controller = "Branch"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Update(Hospital.Application.DTO.Branch.UpdateBranchDto) on controller Hospital.Controllers.BranchController (Hospital).
2025-11-24 01:37:29.675 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:37:29.676 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:37:29.677 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:37:29.679 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:37:29.680 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:37:29.681 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.BranchController (Hospital)
2025-11-24 01:37:29.685 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.BranchController (Hospital)
2025-11-24 01:37:29.691 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Branch.UpdateBranchDto' ...
2025-11-24 01:37:29.693 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Branch.UpdateBranchDto' using the name '' in request data ...
2025-11-24 01:37:29.696 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 01:37:29.709 +02:00 [DBG] Connection id "0HNHAT4T4JIFJ", Request id "0HNHAT4T4JIFJ:00000002": started reading request body.
2025-11-24 01:37:29.711 +02:00 [DBG] Connection id "0HNHAT4T4JIFJ", Request id "0HNHAT4T4JIFJ:00000002": done reading request body.
2025-11-24 01:37:29.730 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Branch.UpdateBranchDto'
2025-11-24 01:37:29.738 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Branch.UpdateBranchDto'.
2025-11-24 01:37:29.738 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Branch.UpdateBranchDto'.
2025-11-24 01:37:29.739 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Branch.UpdateBranchDto' ...
2025-11-24 01:37:29.756 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Branch.UpdateBranchDto'.
2025-11-24 01:37:29.764 +02:00 [INF] Update Branch called at "2025-11-24T01:37:29.7646081+02:00"
2025-11-24 01:37:29.770 +02:00 [INF] Updating branch with ID: 1
2025-11-24 01:37:29.814 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:37:29.826 +02:00 [DBG] Compiling query expression: 
'DbSet<Branch>()
    .FirstOrDefault(e => e.BranchId == __id_0)'
2025-11-24 01:37:29.889 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Branch>(
    asyncEnumerable: new SingleQueryingEnumerable<Branch>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Branch.Address (string) MaxLength(250), 1], [Property: Branch.BranchName (string) Required MaxLength(150), 2], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 3], [Property: Branch.Description (string), 4], [Property: Branch.Email (string) MaxLength(200), 5], [Property: Branch.ImageURL (string) MaxLength(300), 6], [Property: Branch.Phone (string) MaxLength(25), 7], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 8] }
            SELECT TOP(1) b.BranchId, b.Address, b.BranchName, b.CreatedAt, b.Description, b.Email, b.ImageURL, b.Phone, b.UpdatedAt
            FROM Branches AS b
            WHERE b.BranchId == @__id_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Branch>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 01:37:29.903 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:37:29.905 +02:00 [DBG] Created DbConnection. (2ms).
2025-11-24 01:37:29.906 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:37:29.907 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:37:29.909 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:37:29.910 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:37:29.914 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2025-11-24 01:37:29.920 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 01:37:29.951 +02:00 [INF] Executed DbCommand (35ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 01:37:29.995 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:37:30.023 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:37:30.024 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 67ms reading results.
2025-11-24 01:37:30.028 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:37:30.030 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (2ms).
2025-11-24 01:37:30.033 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:37:30.034 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:37:30.035 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:37:30.036 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:37:30.038 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:37:30.039 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
2025-11-24 01:37:30.043 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
2025-11-24 01:37:30.045 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:37:30.047 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 2ms reading results.
2025-11-24 01:37:30.049 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:37:30.051 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 01:37:30.063 +02:00 [DBG] An entity of type 'Branch' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:37:30.067 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:37:30.077 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:37:30.088 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 01:37:30.090 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:37:30.091 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:37:30.133 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:37:30.137 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:37:30.142 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:37:30.144 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:37:30.152 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (10ms).
2025-11-24 01:37:30.156 +02:00 [DBG] Executing DbCommand [Parameters=[@p8='?' (DbType = Int32), @p0='?' (Size = 250), @p1='?' (Size = 150), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 200), @p5='?' (Size = 300), @p6='?' (Size = 25), @p7='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Branches] SET [Address] = @p0, [BranchName] = @p1, [CreatedAt] = @p2, [Description] = @p3, [Email] = @p4, [ImageURL] = @p5, [Phone] = @p6, [UpdatedAt] = @p7
OUTPUT 1
WHERE [BranchId] = @p8;
2025-11-24 01:37:30.169 +02:00 [INF] Executed DbCommand (13ms) [Parameters=[@p8='?' (DbType = Int32), @p0='?' (Size = 250), @p1='?' (Size = 150), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 200), @p5='?' (Size = 300), @p6='?' (Size = 25), @p7='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Branches] SET [Address] = @p0, [BranchName] = @p1, [CreatedAt] = @p2, [Description] = @p3, [Email] = @p4, [ImageURL] = @p5, [Phone] = @p6, [UpdatedAt] = @p7
OUTPUT 1
WHERE [BranchId] = @p8;
2025-11-24 01:37:30.179 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:37:30.186 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 12ms reading results.
2025-11-24 01:37:30.192 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:37:30.193 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:37:30.197 +02:00 [DBG] An entity of type 'Branch' tracked by 'AppDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:37:30.203 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 01:37:30.206 +02:00 [INF] Branch with ID 1 updated successfully
2025-11-24 01:37:30.210 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:37:30.214 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:37:30.214 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:37:30.215 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:37:30.216 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter' and content type 'text/plain' to write the response.
2025-11-24 01:37:30.217 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.String'.
2025-11-24 01:37:30.218 +02:00 [INF] Executed action Hospital.Controllers.BranchController.Update (Hospital) in 537.0218ms
2025-11-24 01:37:30.219 +02:00 [INF] Executed endpoint 'Hospital.Controllers.BranchController.Update (Hospital)'
2025-11-24 01:37:30.220 +02:00 [DBG] Connection id "0HNHAT4T4JIFJ" completed keep alive response.
2025-11-24 01:37:30.221 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:37:30.221 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:37:30.222 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 01:37:30.223 +02:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7217/api/Branch/Update - 200 null text/plain; charset=utf-8 582.364ms
2025-11-24 01:37:39.821 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Branch/Create - application/json 145
2025-11-24 01:37:39.828 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Branch/Create'
2025-11-24 01:37:39.829 +02:00 [DBG] Endpoint 'Hospital.Controllers.BranchController.Create (Hospital)' with route pattern 'api/Branch/Create' is valid for the request path '/api/Branch/Create'
2025-11-24 01:37:39.830 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.BranchController.Create (Hospital)'
2025-11-24 01:37:39.831 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:37:39.833 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:37:39.834 +02:00 [INF] Executing endpoint 'Hospital.Controllers.BranchController.Create (Hospital)'
2025-11-24 01:37:39.838 +02:00 [INF] Route matched with {action = "Create", controller = "Branch"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Create(Hospital.Application.DTO.Branch.CreateBranchDto) on controller Hospital.Controllers.BranchController (Hospital).
2025-11-24 01:37:39.840 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:37:39.840 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:37:39.841 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:37:39.842 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:37:39.842 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:37:39.845 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.BranchController (Hospital)
2025-11-24 01:37:39.849 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.BranchController (Hospital)
2025-11-24 01:37:39.850 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Branch.CreateBranchDto' ...
2025-11-24 01:37:39.853 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Branch.CreateBranchDto' using the name '' in request data ...
2025-11-24 01:37:39.854 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 01:37:39.856 +02:00 [DBG] Connection id "0HNHAT4T4JIFJ", Request id "0HNHAT4T4JIFJ:00000003": started reading request body.
2025-11-24 01:37:39.857 +02:00 [DBG] Connection id "0HNHAT4T4JIFJ", Request id "0HNHAT4T4JIFJ:00000003": done reading request body.
2025-11-24 01:37:39.859 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Branch.CreateBranchDto'
2025-11-24 01:37:39.859 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Branch.CreateBranchDto'.
2025-11-24 01:37:39.860 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Branch.CreateBranchDto'.
2025-11-24 01:37:39.860 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Branch.CreateBranchDto' ...
2025-11-24 01:37:39.867 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Branch.CreateBranchDto'.
2025-11-24 01:37:39.868 +02:00 [INF] Create Branch called at "2025-11-24T01:37:39.8689034+02:00"
2025-11-24 01:37:39.870 +02:00 [INF] Creating new branch with name: adam7
2025-11-24 01:37:39.881 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:37:39.886 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:37:39.886 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 01:37:39.887 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:37:39.888 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:37:39.889 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:37:39.889 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:37:39.890 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:37:39.891 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
2025-11-24 01:37:39.893 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
2025-11-24 01:37:39.896 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:37:39.897 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 01:37:39.897 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:37:39.898 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:37:39.917 +02:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Branch.BranchId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:37:39.921 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:37:39.924 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:37:39.927 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:37:39.929 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 01:37:39.930 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:37:39.930 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:37:39.943 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:37:39.945 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:37:39.946 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:37:39.946 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:37:39.947 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:37:39.948 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (Size = 250), @p1='?' (Size = 150), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 200), @p5='?' (Size = 300), @p6='?' (Size = 25), @p7='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Branches] ([Address], [BranchName], [CreatedAt], [Description], [Email], [ImageURL], [Phone], [UpdatedAt])
OUTPUT INSERTED.[BranchId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-11-24 01:37:39.962 +02:00 [INF] Executed DbCommand (14ms) [Parameters=[@p0='?' (Size = 250), @p1='?' (Size = 150), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 200), @p5='?' (Size = 300), @p6='?' (Size = 25), @p7='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Branches] ([Address], [BranchName], [CreatedAt], [Description], [Email], [ImageURL], [Phone], [UpdatedAt])
OUTPUT INSERTED.[BranchId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-11-24 01:37:39.972 +02:00 [DBG] The foreign key property 'Branch.BranchId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 01:37:39.980 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:37:39.981 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 15ms reading results.
2025-11-24 01:37:39.984 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:37:39.985 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 01:37:39.990 +02:00 [DBG] An entity of type 'Branch' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:37:39.991 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 01:37:39.992 +02:00 [INF] Branch created successfully with ID: 2
2025-11-24 01:37:39.996 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:37:39.999 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:37:39.999 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:37:40.000 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:37:40.001 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 01:37:40.002 +02:00 [INF] Executing CreatedAtActionResult, writing value of type 'Hospital.Application.DTO.Branch.BranchDto'.
2025-11-24 01:37:40.019 +02:00 [DBG] Found the endpoints ["Hospital.Controllers.BranchController.GetById (Hospital)"] for address (id=[2],action=[GetById],controller=[Branch])
2025-11-24 01:37:40.027 +02:00 [DBG] Successfully processed template api/Branch/GetBy/{id} for Hospital.Controllers.BranchController.GetById (Hospital) resulting in /api/Branch/GetBy/2 and 
2025-11-24 01:37:40.028 +02:00 [DBG] Link generation succeeded for endpoints ["Hospital.Controllers.BranchController.GetById (Hospital)"] with result /api/Branch/GetBy/2
2025-11-24 01:37:40.030 +02:00 [INF] Executed action Hospital.Controllers.BranchController.Create (Hospital) in 185.2333ms
2025-11-24 01:37:40.031 +02:00 [INF] Executed endpoint 'Hospital.Controllers.BranchController.Create (Hospital)'
2025-11-24 01:37:40.032 +02:00 [DBG] Connection id "0HNHAT4T4JIFJ" completed keep alive response.
2025-11-24 01:37:40.033 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:37:40.033 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:37:40.034 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 01:37:40.035 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Branch/Create - 201 null application/json; charset=utf-8 214.288ms
2025-11-24 01:38:46.885 +02:00 [DBG] Connection id "0HNHAT4T4JIFK" received FIN.
2025-11-24 01:38:46.885 +02:00 [DBG] Connection id "0HNHAT4T4JIFK" accepted.
2025-11-24 01:38:46.889 +02:00 [DBG] Connection id "0HNHAT4T4JIFK" started.
2025-11-24 01:38:46.890 +02:00 [DBG] Connection id "0HNHAT4T4JIFL" accepted.
2025-11-24 01:38:46.895 +02:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-11-24 01:38:46.896 +02:00 [DBG] Connection id "0HNHAT4T4JIFL" started.
2025-11-24 01:38:46.899 +02:00 [DBG] Connection id "0HNHAT4T4JIFK" stopped.
2025-11-24 01:38:46.901 +02:00 [DBG] Connection id "0HNHAT4T4JIFK" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-11-24 01:38:46.906 +02:00 [DBG] Connection 0HNHAT4T4JIFL established using the following protocol: "Tls12"
2025-11-24 01:38:46.907 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Branch/Create - application/json 145
2025-11-24 01:38:46.910 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Branch/Create'
2025-11-24 01:38:46.912 +02:00 [DBG] Endpoint 'Hospital.Controllers.BranchController.Create (Hospital)' with route pattern 'api/Branch/Create' is valid for the request path '/api/Branch/Create'
2025-11-24 01:38:46.913 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.BranchController.Create (Hospital)'
2025-11-24 01:38:46.913 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:38:46.915 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:38:46.916 +02:00 [INF] Executing endpoint 'Hospital.Controllers.BranchController.Create (Hospital)'
2025-11-24 01:38:46.917 +02:00 [INF] Route matched with {action = "Create", controller = "Branch"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Create(Hospital.Application.DTO.Branch.CreateBranchDto) on controller Hospital.Controllers.BranchController (Hospital).
2025-11-24 01:38:46.919 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:38:46.920 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:38:46.921 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:38:46.923 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:38:46.927 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:38:46.930 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.BranchController (Hospital)
2025-11-24 01:38:46.932 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.BranchController (Hospital)
2025-11-24 01:38:46.934 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Branch.CreateBranchDto' ...
2025-11-24 01:38:46.936 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Branch.CreateBranchDto' using the name '' in request data ...
2025-11-24 01:38:46.938 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 01:38:46.939 +02:00 [DBG] Connection id "0HNHAT4T4JIFL", Request id "0HNHAT4T4JIFL:00000001": started reading request body.
2025-11-24 01:38:46.940 +02:00 [DBG] Connection id "0HNHAT4T4JIFL", Request id "0HNHAT4T4JIFL:00000001": done reading request body.
2025-11-24 01:38:46.942 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Branch.CreateBranchDto'
2025-11-24 01:38:46.943 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Branch.CreateBranchDto'.
2025-11-24 01:38:46.944 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Branch.CreateBranchDto'.
2025-11-24 01:38:46.946 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Branch.CreateBranchDto' ...
2025-11-24 01:38:46.948 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Branch.CreateBranchDto'.
2025-11-24 01:38:46.949 +02:00 [INF] Create Branch called at "2025-11-24T01:38:46.9494371+02:00"
2025-11-24 01:38:46.949 +02:00 [INF] Creating new branch with name: adam7
2025-11-24 01:38:46.951 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:38:46.952 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:38:46.954 +02:00 [DBG] Created DbConnection. (1ms).
2025-11-24 01:38:46.954 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:38:46.955 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:38:46.955 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:38:46.956 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:38:46.956 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:38:46.957 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
2025-11-24 01:38:46.961 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
2025-11-24 01:38:46.963 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:38:46.964 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 01:38:46.966 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:38:46.966 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:38:46.967 +02:00 [WRN] Failed to create branch: Branch with name 'adam7' already exists
2025-11-24 01:38:47.040 +02:00 [INF] Executed action Hospital.Controllers.BranchController.Create (Hospital) in 110.0716ms
2025-11-24 01:38:47.044 +02:00 [INF] Executed endpoint 'Hospital.Controllers.BranchController.Create (Hospital)'
2025-11-24 01:38:47.107 +02:00 [ERR]  Exception caught: Branch with name 'adam7' already exists.
System.ComponentModel.DataAnnotations.ValidationException: Branch with name 'adam7' already exists.
   at Hospital.Infrastructure.Services.BranchService.CreateAsync(CreateBranchDto dto) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\BranchService.cs:line 42
   at Hospital.Controllers.BranchController.Create(CreateBranchDto dto) in D:\Walaa\GP\Hospital\Hospital\Controllers\BranchController.cs:line 42
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
2025-11-24 01:38:47.172 +02:00 [DBG] Connection id "0HNHAT4T4JIFL" completed keep alive response.
2025-11-24 01:38:47.174 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:38:47.176 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:38:47.181 +02:00 [DBG] Disposed connection to database '' on server '' (5ms).
2025-11-24 01:38:47.183 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Branch/Create - 400 null application/json 276.238ms
2025-11-24 01:38:57.340 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Branch/GetAll - null null
2025-11-24 01:38:57.347 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Branch/GetAll'
2025-11-24 01:38:57.351 +02:00 [DBG] Endpoint 'Hospital.Controllers.BranchController.GetAll (Hospital)' with route pattern 'api/Branch/GetAll' is valid for the request path '/api/Branch/GetAll'
2025-11-24 01:38:57.353 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.BranchController.GetAll (Hospital)'
2025-11-24 01:38:57.354 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:38:57.355 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:38:57.356 +02:00 [INF] Executing endpoint 'Hospital.Controllers.BranchController.GetAll (Hospital)'
2025-11-24 01:38:57.357 +02:00 [INF] Route matched with {action = "GetAll", controller = "Branch"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll() on controller Hospital.Controllers.BranchController (Hospital).
2025-11-24 01:38:57.359 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:38:57.360 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:38:57.360 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:38:57.362 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:38:57.363 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:38:57.366 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.BranchController (Hospital)
2025-11-24 01:38:57.368 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.BranchController (Hospital)
2025-11-24 01:38:57.369 +02:00 [INF] Get All Branch called at "2025-11-24T01:38:57.3690397+02:00"
2025-11-24 01:38:57.369 +02:00 [INF] Fetching all branches
2025-11-24 01:38:57.370 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:38:57.372 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:38:57.374 +02:00 [DBG] Created DbConnection. (2ms).
2025-11-24 01:38:57.376 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:38:57.378 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:38:57.379 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:38:57.380 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:38:57.382 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-11-24 01:38:57.384 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
2025-11-24 01:38:57.392 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
2025-11-24 01:38:57.395 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:38:57.398 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 3ms reading results.
2025-11-24 01:38:57.400 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:38:57.401 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 01:38:57.403 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:38:57.406 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:38:57.407 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:38:57.408 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:38:57.408 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 01:38:57.409 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Branch.BranchDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 01:38:57.412 +02:00 [INF] Executed action Hospital.Controllers.BranchController.GetAll (Hospital) in 45.734ms
2025-11-24 01:38:57.416 +02:00 [INF] Executed endpoint 'Hospital.Controllers.BranchController.GetAll (Hospital)'
2025-11-24 01:38:57.417 +02:00 [DBG] Connection id "0HNHAT4T4JIFL" completed keep alive response.
2025-11-24 01:38:57.419 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:38:57.420 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:38:57.421 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 01:38:57.421 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Branch/GetAll - 200 null application/json; charset=utf-8 81.63ms
2025-11-24 01:39:14.244 +02:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7217/api/Branch/Delete/1 - null null
2025-11-24 01:39:14.248 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Branch/Delete/1'
2025-11-24 01:39:14.249 +02:00 [DBG] Endpoint 'Hospital.Controllers.BranchController.Delete (Hospital)' with route pattern 'api/Branch/Delete/{id}' is valid for the request path '/api/Branch/Delete/1'
2025-11-24 01:39:14.250 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.BranchController.Delete (Hospital)'
2025-11-24 01:39:14.252 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:39:14.253 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:39:14.254 +02:00 [INF] Executing endpoint 'Hospital.Controllers.BranchController.Delete (Hospital)'
2025-11-24 01:39:14.259 +02:00 [INF] Route matched with {action = "Delete", controller = "Branch"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Delete(Int32) on controller Hospital.Controllers.BranchController (Hospital).
2025-11-24 01:39:14.262 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:39:14.263 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:39:14.264 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:39:14.266 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:39:14.268 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:39:14.269 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.BranchController (Hospital)
2025-11-24 01:39:14.270 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.BranchController (Hospital)
2025-11-24 01:39:14.270 +02:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-11-24 01:39:14.272 +02:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-11-24 01:39:14.274 +02:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-11-24 01:39:14.276 +02:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-11-24 01:39:14.279 +02:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-11-24 01:39:14.283 +02:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-11-24 01:39:14.286 +02:00 [INF] Delete Branch called at "2025-11-24T01:39:14.2867757+02:00"
2025-11-24 01:39:14.289 +02:00 [INF] Deleting branch with ID: 1
2025-11-24 01:39:14.291 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:39:14.295 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:39:14.297 +02:00 [DBG] Created DbConnection. (1ms).
2025-11-24 01:39:14.298 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:39:14.299 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:39:14.300 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:39:14.302 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:39:14.306 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (5ms).
2025-11-24 01:39:14.309 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 01:39:14.316 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 01:39:14.321 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:39:14.325 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:39:14.327 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 5ms reading results.
2025-11-24 01:39:14.330 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:39:14.331 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 01:39:14.335 +02:00 [DBG] An entity of type 'Branch' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Deleted"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:39:14.347 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:39:14.350 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:39:14.354 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 01:39:14.357 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:39:14.359 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:39:14.369 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:39:14.373 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:39:14.380 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:39:14.381 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:39:14.382 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:39:14.385 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [Branches]
OUTPUT 1
WHERE [BranchId] = @p0;
2025-11-24 01:39:14.406 +02:00 [INF] Executed DbCommand (21ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [Branches]
OUTPUT 1
WHERE [BranchId] = @p0;
2025-11-24 01:39:14.414 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:39:14.417 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 2ms reading results.
2025-11-24 01:39:14.418 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:39:14.420 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (2ms).
2025-11-24 01:39:14.425 +02:00 [DBG] An entity of type 'Branch' tracked by 'AppDbContext' changed state from '"Deleted"' to '"Detached"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:39:14.427 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 01:39:14.429 +02:00 [INF] Branch with ID 1 deleted successfully
2025-11-24 01:39:14.430 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:39:14.431 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:39:14.431 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:39:14.432 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:39:14.433 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter' and content type 'text/plain' to write the response.
2025-11-24 01:39:14.433 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.String'.
2025-11-24 01:39:14.435 +02:00 [INF] Executed action Hospital.Controllers.BranchController.Delete (Hospital) in 166.1767ms
2025-11-24 01:39:14.435 +02:00 [INF] Executed endpoint 'Hospital.Controllers.BranchController.Delete (Hospital)'
2025-11-24 01:39:14.436 +02:00 [DBG] Connection id "0HNHAT4T4JIFL" completed keep alive response.
2025-11-24 01:39:14.437 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:39:14.437 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:39:14.438 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 01:39:14.439 +02:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7217/api/Branch/Delete/1 - 200 null text/plain; charset=utf-8 194.9877ms
2025-11-24 01:39:19.402 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Branch/GetAll - null null
2025-11-24 01:39:19.409 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Branch/GetAll'
2025-11-24 01:39:19.411 +02:00 [DBG] Endpoint 'Hospital.Controllers.BranchController.GetAll (Hospital)' with route pattern 'api/Branch/GetAll' is valid for the request path '/api/Branch/GetAll'
2025-11-24 01:39:19.418 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.BranchController.GetAll (Hospital)'
2025-11-24 01:39:19.421 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:39:19.422 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:39:19.424 +02:00 [INF] Executing endpoint 'Hospital.Controllers.BranchController.GetAll (Hospital)'
2025-11-24 01:39:19.425 +02:00 [INF] Route matched with {action = "GetAll", controller = "Branch"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll() on controller Hospital.Controllers.BranchController (Hospital).
2025-11-24 01:39:19.427 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:39:19.428 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:39:19.429 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:39:19.431 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:39:19.433 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:39:19.435 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.BranchController (Hospital)
2025-11-24 01:39:19.436 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.BranchController (Hospital)
2025-11-24 01:39:19.437 +02:00 [INF] Get All Branch called at "2025-11-24T01:39:19.4378769+02:00"
2025-11-24 01:39:19.439 +02:00 [INF] Fetching all branches
2025-11-24 01:39:19.440 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:39:19.442 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:39:19.443 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 01:39:19.444 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:39:19.446 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:39:19.449 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:39:19.450 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:39:19.451 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:39:19.452 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
2025-11-24 01:39:19.456 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
2025-11-24 01:39:19.460 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:39:19.462 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 01:39:19.463 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:39:19.464 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:39:19.465 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:39:19.467 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:39:19.467 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:39:19.468 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:39:19.468 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 01:39:19.469 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Branch.BranchDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 01:39:19.471 +02:00 [INF] Executed action Hospital.Controllers.BranchController.GetAll (Hospital) in 35.7967ms
2025-11-24 01:39:19.473 +02:00 [INF] Executed endpoint 'Hospital.Controllers.BranchController.GetAll (Hospital)'
2025-11-24 01:39:19.474 +02:00 [DBG] Connection id "0HNHAT4T4JIFL" completed keep alive response.
2025-11-24 01:39:19.476 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:39:19.478 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:39:19.479 +02:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-11-24 01:39:19.480 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Branch/GetAll - 200 null application/json; charset=utf-8 78.4541ms
2025-11-24 01:39:34.107 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Event/CreateEvent - application/json 205
2025-11-24 01:39:34.110 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Event/CreateEvent'
2025-11-24 01:39:34.113 +02:00 [DBG] Endpoint 'Hospital.Controllers.EventController.CreateEvent (Hospital)' with route pattern 'api/Event/CreateEvent' is valid for the request path '/api/Event/CreateEvent'
2025-11-24 01:39:34.116 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.EventController.CreateEvent (Hospital)'
2025-11-24 01:39:34.118 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:39:34.119 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:39:34.120 +02:00 [INF] Executing endpoint 'Hospital.Controllers.EventController.CreateEvent (Hospital)'
2025-11-24 01:39:34.124 +02:00 [INF] Route matched with {action = "CreateEvent", controller = "Event"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateEvent(Hospital.Application.DTO.Event.AddEventDto) on controller Hospital.Controllers.EventController (Hospital).
2025-11-24 01:39:34.126 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:39:34.127 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:39:34.128 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:39:34.130 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:39:34.130 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:39:34.132 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.EventController (Hospital)
2025-11-24 01:39:34.133 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.EventController (Hospital)
2025-11-24 01:39:34.134 +02:00 [DBG] Attempting to bind parameter 'eventDto' of type 'Hospital.Application.DTO.Event.AddEventDto' ...
2025-11-24 01:39:34.135 +02:00 [DBG] Attempting to bind parameter 'eventDto' of type 'Hospital.Application.DTO.Event.AddEventDto' using the name '' in request data ...
2025-11-24 01:39:34.138 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 01:39:34.142 +02:00 [DBG] Connection id "0HNHAT4T4JIFL", Request id "0HNHAT4T4JIFL:00000005": started reading request body.
2025-11-24 01:39:34.143 +02:00 [DBG] Connection id "0HNHAT4T4JIFL", Request id "0HNHAT4T4JIFL:00000005": done reading request body.
2025-11-24 01:39:34.148 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Event.AddEventDto'
2025-11-24 01:39:34.149 +02:00 [DBG] Done attempting to bind parameter 'eventDto' of type 'Hospital.Application.DTO.Event.AddEventDto'.
2025-11-24 01:39:34.150 +02:00 [DBG] Done attempting to bind parameter 'eventDto' of type 'Hospital.Application.DTO.Event.AddEventDto'.
2025-11-24 01:39:34.151 +02:00 [DBG] Attempting to validate the bound parameter 'eventDto' of type 'Hospital.Application.DTO.Event.AddEventDto' ...
2025-11-24 01:39:34.154 +02:00 [DBG] Done attempting to validate the bound parameter 'eventDto' of type 'Hospital.Application.DTO.Event.AddEventDto'.
2025-11-24 01:39:34.155 +02:00 [INF] create event  called at "2025-11-24T01:39:34.1553298+02:00"
2025-11-24 01:39:34.157 +02:00 [INF] Adding new event: event 2 for Branch ID: 1
2025-11-24 01:39:34.158 +02:00 [INF] Fetching branch by ID: 1
2025-11-24 01:39:34.161 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:39:34.162 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:39:34.162 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 01:39:34.163 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:39:34.163 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:39:34.164 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:39:34.165 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:39:34.165 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:39:34.166 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 01:39:34.170 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 01:39:34.171 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:39:34.172 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 01:39:34.173 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:39:34.175 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 01:39:34.176 +02:00 [WRN] Branch with ID 1 not found
2025-11-24 01:39:34.252 +02:00 [INF] Executed action Hospital.Controllers.EventController.CreateEvent (Hospital) in 119.8879ms
2025-11-24 01:39:34.254 +02:00 [INF] Executed endpoint 'Hospital.Controllers.EventController.CreateEvent (Hospital)'
2025-11-24 01:39:34.320 +02:00 [ERR]  Exception caught: Branch with ID 1 not found
System.Collections.Generic.KeyNotFoundException: Branch with ID 1 not found
   at Hospital.Infrastructure.Services.BranchService.GetByIdAsync(Int32 id) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\BranchService.cs:line 85
   at Hospital.Infrastructure.Services.EventService.AddAsync(AddEventDto eventdto) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\EventService.cs:line 40
   at Hospital.Controllers.EventController.CreateEvent(AddEventDto eventDto) in D:\Walaa\GP\Hospital\Hospital\Controllers\EventController.cs:line 26
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
2025-11-24 01:39:34.338 +02:00 [DBG] Connection id "0HNHAT4T4JIFL" completed keep alive response.
2025-11-24 01:39:34.340 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:39:34.342 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:39:34.344 +02:00 [DBG] Disposed connection to database '' on server '' (2ms).
2025-11-24 01:39:34.347 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Event/CreateEvent - 404 null application/json 240.5904ms
2025-11-24 01:39:45.582 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Event/CreateEvent - application/json 205
2025-11-24 01:39:45.586 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Event/CreateEvent'
2025-11-24 01:39:45.587 +02:00 [DBG] Endpoint 'Hospital.Controllers.EventController.CreateEvent (Hospital)' with route pattern 'api/Event/CreateEvent' is valid for the request path '/api/Event/CreateEvent'
2025-11-24 01:39:45.589 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.EventController.CreateEvent (Hospital)'
2025-11-24 01:39:45.590 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:39:45.591 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:39:45.592 +02:00 [INF] Executing endpoint 'Hospital.Controllers.EventController.CreateEvent (Hospital)'
2025-11-24 01:39:45.594 +02:00 [INF] Route matched with {action = "CreateEvent", controller = "Event"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateEvent(Hospital.Application.DTO.Event.AddEventDto) on controller Hospital.Controllers.EventController (Hospital).
2025-11-24 01:39:45.600 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:39:45.603 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:39:45.605 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:39:45.607 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:39:45.608 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:39:45.609 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.EventController (Hospital)
2025-11-24 01:39:45.611 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.EventController (Hospital)
2025-11-24 01:39:45.612 +02:00 [DBG] Attempting to bind parameter 'eventDto' of type 'Hospital.Application.DTO.Event.AddEventDto' ...
2025-11-24 01:39:45.613 +02:00 [DBG] Attempting to bind parameter 'eventDto' of type 'Hospital.Application.DTO.Event.AddEventDto' using the name '' in request data ...
2025-11-24 01:39:45.614 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 01:39:45.616 +02:00 [DBG] Connection id "0HNHAT4T4JIFL", Request id "0HNHAT4T4JIFL:00000006": started reading request body.
2025-11-24 01:39:45.617 +02:00 [DBG] Connection id "0HNHAT4T4JIFL", Request id "0HNHAT4T4JIFL:00000006": done reading request body.
2025-11-24 01:39:45.618 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Event.AddEventDto'
2025-11-24 01:39:45.618 +02:00 [DBG] Done attempting to bind parameter 'eventDto' of type 'Hospital.Application.DTO.Event.AddEventDto'.
2025-11-24 01:39:45.619 +02:00 [DBG] Done attempting to bind parameter 'eventDto' of type 'Hospital.Application.DTO.Event.AddEventDto'.
2025-11-24 01:39:45.619 +02:00 [DBG] Attempting to validate the bound parameter 'eventDto' of type 'Hospital.Application.DTO.Event.AddEventDto' ...
2025-11-24 01:39:45.620 +02:00 [DBG] Done attempting to validate the bound parameter 'eventDto' of type 'Hospital.Application.DTO.Event.AddEventDto'.
2025-11-24 01:39:45.621 +02:00 [INF] create event  called at "2025-11-24T01:39:45.6218241+02:00"
2025-11-24 01:39:45.623 +02:00 [INF] Adding new event: event 2 for Branch ID: 2
2025-11-24 01:39:45.623 +02:00 [INF] Fetching branch by ID: 2
2025-11-24 01:39:45.625 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:39:45.626 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:39:45.626 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 01:39:45.627 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:39:45.628 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:39:45.629 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:39:45.630 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:39:45.631 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:39:45.632 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 01:39:45.638 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 01:39:45.639 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:39:45.640 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:39:45.641 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 01:39:45.642 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:39:45.643 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 01:39:45.652 +02:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Event.EventId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:39:45.668 +02:00 [DBG] The navigation 'Event.Branch' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:39:45.674 +02:00 [DBG] Context 'AppDbContext' started tracking 'Event' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:39:45.677 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:39:45.683 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:39:45.685 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 01:39:45.688 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:39:45.689 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:39:45.692 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:39:45.694 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:39:45.696 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:39:45.696 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:39:45.697 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:39:45.698 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Size = 300), @p5='?' (Size = 150), @p6='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Events] ([BranchId], [CreatedAt], [Description], [EventDate], [ImageURL], [Title], [UpdatedAt])
OUTPUT INSERTED.[EventId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-11-24 01:39:45.713 +02:00 [INF] Executed DbCommand (16ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Size = 300), @p5='?' (Size = 150), @p6='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Events] ([BranchId], [CreatedAt], [Description], [EventDate], [ImageURL], [Title], [UpdatedAt])
OUTPUT INSERTED.[EventId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-11-24 01:39:45.718 +02:00 [DBG] The foreign key property 'Event.EventId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 01:39:45.719 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:39:45.720 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 3ms reading results.
2025-11-24 01:39:45.721 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:39:45.722 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:39:45.724 +02:00 [DBG] An entity of type 'Event' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:39:45.726 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 01:39:45.727 +02:00 [INF] Event event 2 added successfully with ID 1
2025-11-24 01:39:45.729 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:39:45.730 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:39:45.731 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:39:45.731 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:39:45.732 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 01:39:45.733 +02:00 [INF] Executing CreatedAtActionResult, writing value of type 'Hospital.Application.DTO.Event.EventDto'.
2025-11-24 01:39:45.734 +02:00 [DBG] Found the endpoints ["Hospital.Controllers.EventController.GetEvent (Hospital)"] for address (id=[1],action=[GetEvent],controller=[Event])
2025-11-24 01:39:45.735 +02:00 [DBG] Successfully processed template api/Event/GetEvent for Hospital.Controllers.EventController.GetEvent (Hospital) resulting in /api/Event/GetEvent and ?id=1
2025-11-24 01:39:45.736 +02:00 [DBG] Link generation succeeded for endpoints ["Hospital.Controllers.EventController.GetEvent (Hospital)"] with result /api/Event/GetEvent?id=1
2025-11-24 01:39:45.740 +02:00 [INF] Executed action Hospital.Controllers.EventController.CreateEvent (Hospital) in 130.3897ms
2025-11-24 01:39:45.740 +02:00 [INF] Executed endpoint 'Hospital.Controllers.EventController.CreateEvent (Hospital)'
2025-11-24 01:39:45.741 +02:00 [DBG] Connection id "0HNHAT4T4JIFL" completed keep alive response.
2025-11-24 01:39:45.742 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:39:45.742 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:39:45.743 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 01:39:45.744 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Event/CreateEvent - 201 null application/json; charset=utf-8 161.6779ms
2025-11-24 01:39:56.321 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Event/GetEvent - application/json 38
2025-11-24 01:39:56.323 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Event/GetEvent'
2025-11-24 01:39:56.325 +02:00 [DBG] Endpoint 'Hospital.Controllers.EventController.GetEvent (Hospital)' with route pattern 'api/Event/GetEvent' is valid for the request path '/api/Event/GetEvent'
2025-11-24 01:39:56.327 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.EventController.GetEvent (Hospital)'
2025-11-24 01:39:56.330 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:39:56.332 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:39:56.333 +02:00 [INF] Executing endpoint 'Hospital.Controllers.EventController.GetEvent (Hospital)'
2025-11-24 01:39:56.340 +02:00 [INF] Route matched with {action = "GetEvent", controller = "Event"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetEvent(Hospital.Application.DTO.Event.GetEventDto) on controller Hospital.Controllers.EventController (Hospital).
2025-11-24 01:39:56.346 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:39:56.350 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:39:56.352 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:39:56.358 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:39:56.359 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:39:56.360 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.EventController (Hospital)
2025-11-24 01:39:56.363 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.EventController (Hospital)
2025-11-24 01:39:56.364 +02:00 [DBG] Attempting to bind parameter 'event' of type 'Hospital.Application.DTO.Event.GetEventDto' ...
2025-11-24 01:39:56.365 +02:00 [DBG] Attempting to bind parameter 'event' of type 'Hospital.Application.DTO.Event.GetEventDto' using the name '' in request data ...
2025-11-24 01:39:56.366 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 01:39:56.368 +02:00 [DBG] Connection id "0HNHAT4T4JIFL", Request id "0HNHAT4T4JIFL:00000007": started reading request body.
2025-11-24 01:39:56.369 +02:00 [DBG] Connection id "0HNHAT4T4JIFL", Request id "0HNHAT4T4JIFL:00000007": done reading request body.
2025-11-24 01:39:56.370 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Event.GetEventDto'
2025-11-24 01:39:56.371 +02:00 [DBG] Done attempting to bind parameter 'event' of type 'Hospital.Application.DTO.Event.GetEventDto'.
2025-11-24 01:39:56.372 +02:00 [DBG] Done attempting to bind parameter 'event' of type 'Hospital.Application.DTO.Event.GetEventDto'.
2025-11-24 01:39:56.373 +02:00 [DBG] Attempting to validate the bound parameter 'event' of type 'Hospital.Application.DTO.Event.GetEventDto' ...
2025-11-24 01:39:56.374 +02:00 [DBG] Done attempting to validate the bound parameter 'event' of type 'Hospital.Application.DTO.Event.GetEventDto'.
2025-11-24 01:39:56.376 +02:00 [INF] Get event  called at "2025-11-24T01:39:56.3764151+02:00"
2025-11-24 01:39:56.378 +02:00 [INF] Fetching event ID 1 for Branch ID 2
2025-11-24 01:39:56.378 +02:00 [INF] Fetching branch by ID: 2
2025-11-24 01:39:56.379 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:39:56.381 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:39:56.381 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 01:39:56.382 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:39:56.382 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:39:56.383 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:39:56.384 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:39:56.386 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:39:56.387 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 01:39:56.391 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 01:39:56.395 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:39:56.398 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:39:56.399 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 4ms reading results.
2025-11-24 01:39:56.401 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:39:56.403 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (2ms).
2025-11-24 01:39:56.408 +02:00 [DBG] Compiling query expression: 
'DbSet<Event>()
    .AsNoTracking()
    .FirstOrDefault(e => e.EventId == __id_0)'
2025-11-24 01:39:56.414 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Event>(
    asyncEnumerable: new SingleQueryingEnumerable<Event>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Event.EventId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Event.BranchId (int?) FK Index, 1], [Property: Event.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 2], [Property: Event.Description (string), 3], [Property: Event.EventDate (DateTime) Required, 4], [Property: Event.ImageURL (string) MaxLength(300), 5], [Property: Event.Title (string) Required MaxLength(150), 6], [Property: Event.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 7] }
            SELECT TOP(1) e.EventId, e.BranchId, e.CreatedAt, e.Description, e.EventDate, e.ImageURL, e.Title, e.UpdatedAt
            FROM Events AS e
            WHERE e.EventId == @__id_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Event>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 01:39:56.418 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:39:56.419 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:39:56.420 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:39:56.422 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:39:56.423 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:39:56.424 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[EventId], [e].[BranchId], [e].[CreatedAt], [e].[Description], [e].[EventDate], [e].[ImageURL], [e].[Title], [e].[UpdatedAt]
FROM [Events] AS [e]
WHERE [e].[EventId] = @__id_0
2025-11-24 01:39:56.439 +02:00 [INF] Executed DbCommand (15ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[EventId], [e].[BranchId], [e].[CreatedAt], [e].[Description], [e].[EventDate], [e].[ImageURL], [e].[Title], [e].[UpdatedAt]
FROM [Events] AS [e]
WHERE [e].[EventId] = @__id_0
2025-11-24 01:39:56.441 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:39:56.441 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 01:39:56.443 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:39:56.443 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:39:56.445 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:39:56.446 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:39:56.447 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:39:56.448 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:39:56.449 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 01:39:56.450 +02:00 [INF] Executing OkObjectResult, writing value of type 'Hospital.Application.DTO.Event.EventDto'.
2025-11-24 01:39:56.450 +02:00 [INF] Executed action Hospital.Controllers.EventController.GetEvent (Hospital) in 90.0601ms
2025-11-24 01:39:56.451 +02:00 [INF] Executed endpoint 'Hospital.Controllers.EventController.GetEvent (Hospital)'
2025-11-24 01:39:56.452 +02:00 [DBG] Connection id "0HNHAT4T4JIFL" completed keep alive response.
2025-11-24 01:39:56.453 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:39:56.454 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:39:56.455 +02:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-11-24 01:39:56.456 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Event/GetEvent - 200 null application/json; charset=utf-8 135.4475ms
2025-11-24 01:40:03.779 +02:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7217/api/Event/UpdateEvent - application/json 215
2025-11-24 01:40:03.786 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Event/UpdateEvent'
2025-11-24 01:40:03.787 +02:00 [DBG] Endpoint 'Hospital.Controllers.EventController.UpdateEvent (Hospital)' with route pattern 'api/Event/UpdateEvent' is valid for the request path '/api/Event/UpdateEvent'
2025-11-24 01:40:03.788 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.EventController.UpdateEvent (Hospital)'
2025-11-24 01:40:03.789 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:40:03.789 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:40:03.790 +02:00 [INF] Executing endpoint 'Hospital.Controllers.EventController.UpdateEvent (Hospital)'
2025-11-24 01:40:03.793 +02:00 [INF] Route matched with {action = "UpdateEvent", controller = "Event"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateEvent(Hospital.Application.DTO.Event.EventDto) on controller Hospital.Controllers.EventController (Hospital).
2025-11-24 01:40:03.795 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:40:03.796 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:40:03.796 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:40:03.797 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:40:03.798 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:40:03.799 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.EventController (Hospital)
2025-11-24 01:40:03.800 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.EventController (Hospital)
2025-11-24 01:40:03.801 +02:00 [DBG] Attempting to bind parameter 'eventDto' of type 'Hospital.Application.DTO.Event.EventDto' ...
2025-11-24 01:40:03.801 +02:00 [DBG] Attempting to bind parameter 'eventDto' of type 'Hospital.Application.DTO.Event.EventDto' using the name '' in request data ...
2025-11-24 01:40:03.802 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 01:40:03.803 +02:00 [DBG] Connection id "0HNHAT4T4JIFL", Request id "0HNHAT4T4JIFL:00000008": started reading request body.
2025-11-24 01:40:03.804 +02:00 [DBG] Connection id "0HNHAT4T4JIFL", Request id "0HNHAT4T4JIFL:00000008": done reading request body.
2025-11-24 01:40:03.806 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Event.EventDto'
2025-11-24 01:40:03.807 +02:00 [DBG] Done attempting to bind parameter 'eventDto' of type 'Hospital.Application.DTO.Event.EventDto'.
2025-11-24 01:40:03.808 +02:00 [DBG] Done attempting to bind parameter 'eventDto' of type 'Hospital.Application.DTO.Event.EventDto'.
2025-11-24 01:40:03.808 +02:00 [DBG] Attempting to validate the bound parameter 'eventDto' of type 'Hospital.Application.DTO.Event.EventDto' ...
2025-11-24 01:40:03.810 +02:00 [DBG] Done attempting to validate the bound parameter 'eventDto' of type 'Hospital.Application.DTO.Event.EventDto'.
2025-11-24 01:40:03.811 +02:00 [INF] update event  called at "2025-11-24T01:40:03.8119602+02:00"
2025-11-24 01:40:03.813 +02:00 [INF] Updating event ID 1 for Branch ID 1
2025-11-24 01:40:03.814 +02:00 [INF] Fetching branch by ID: 1
2025-11-24 01:40:03.815 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:40:03.817 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:40:03.818 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 01:40:03.818 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:40:03.819 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:40:03.820 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:40:03.821 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:40:03.822 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:40:03.822 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 01:40:03.825 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 01:40:03.828 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:40:03.829 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 01:40:03.831 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:40:03.833 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (2ms).
2025-11-24 01:40:03.835 +02:00 [WRN] Branch with ID 1 not found
2025-11-24 01:40:03.950 +02:00 [INF] Executed action Hospital.Controllers.EventController.UpdateEvent (Hospital) in 150.8731ms
2025-11-24 01:40:03.953 +02:00 [INF] Executed endpoint 'Hospital.Controllers.EventController.UpdateEvent (Hospital)'
2025-11-24 01:40:04.005 +02:00 [ERR]  Exception caught: Branch with ID 1 not found
System.Collections.Generic.KeyNotFoundException: Branch with ID 1 not found
   at Hospital.Infrastructure.Services.BranchService.GetByIdAsync(Int32 id) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\BranchService.cs:line 85
   at Hospital.Infrastructure.Services.EventService.UpdateAsync(EventDto eventdto) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\EventService.cs:line 151
   at Hospital.Controllers.EventController.UpdateEvent(EventDto eventDto) in D:\Walaa\GP\Hospital\Hospital\Controllers\EventController.cs:line 63
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
2025-11-24 01:40:04.037 +02:00 [DBG] Connection id "0HNHAT4T4JIFL" completed keep alive response.
2025-11-24 01:40:04.041 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:40:04.043 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:40:04.047 +02:00 [DBG] Disposed connection to database '' on server '' (3ms).
2025-11-24 01:40:04.048 +02:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7217/api/Event/UpdateEvent - 404 null application/json 268.1691ms
2025-11-24 01:40:10.968 +02:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7217/api/Event/UpdateEvent - application/json 215
2025-11-24 01:40:10.970 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Event/UpdateEvent'
2025-11-24 01:40:10.971 +02:00 [DBG] Endpoint 'Hospital.Controllers.EventController.UpdateEvent (Hospital)' with route pattern 'api/Event/UpdateEvent' is valid for the request path '/api/Event/UpdateEvent'
2025-11-24 01:40:10.974 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.EventController.UpdateEvent (Hospital)'
2025-11-24 01:40:10.975 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:40:10.976 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:40:10.980 +02:00 [INF] Executing endpoint 'Hospital.Controllers.EventController.UpdateEvent (Hospital)'
2025-11-24 01:40:10.983 +02:00 [INF] Route matched with {action = "UpdateEvent", controller = "Event"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateEvent(Hospital.Application.DTO.Event.EventDto) on controller Hospital.Controllers.EventController (Hospital).
2025-11-24 01:40:10.989 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:40:10.990 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:40:10.992 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:40:10.993 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:40:10.994 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:40:10.995 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.EventController (Hospital)
2025-11-24 01:40:10.996 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.EventController (Hospital)
2025-11-24 01:40:10.997 +02:00 [DBG] Attempting to bind parameter 'eventDto' of type 'Hospital.Application.DTO.Event.EventDto' ...
2025-11-24 01:40:10.998 +02:00 [DBG] Attempting to bind parameter 'eventDto' of type 'Hospital.Application.DTO.Event.EventDto' using the name '' in request data ...
2025-11-24 01:40:10.999 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 01:40:11.000 +02:00 [DBG] Connection id "0HNHAT4T4JIFL", Request id "0HNHAT4T4JIFL:00000009": started reading request body.
2025-11-24 01:40:11.000 +02:00 [DBG] Connection id "0HNHAT4T4JIFL", Request id "0HNHAT4T4JIFL:00000009": done reading request body.
2025-11-24 01:40:11.001 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Event.EventDto'
2025-11-24 01:40:11.002 +02:00 [DBG] Done attempting to bind parameter 'eventDto' of type 'Hospital.Application.DTO.Event.EventDto'.
2025-11-24 01:40:11.003 +02:00 [DBG] Done attempting to bind parameter 'eventDto' of type 'Hospital.Application.DTO.Event.EventDto'.
2025-11-24 01:40:11.004 +02:00 [DBG] Attempting to validate the bound parameter 'eventDto' of type 'Hospital.Application.DTO.Event.EventDto' ...
2025-11-24 01:40:11.005 +02:00 [DBG] Done attempting to validate the bound parameter 'eventDto' of type 'Hospital.Application.DTO.Event.EventDto'.
2025-11-24 01:40:11.006 +02:00 [INF] update event  called at "2025-11-24T01:40:11.0068691+02:00"
2025-11-24 01:40:11.007 +02:00 [INF] Updating event ID 1 for Branch ID 2
2025-11-24 01:40:11.009 +02:00 [INF] Fetching branch by ID: 2
2025-11-24 01:40:11.011 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:40:11.013 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:40:11.014 +02:00 [DBG] Created DbConnection. (1ms).
2025-11-24 01:40:11.015 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:40:11.016 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:40:11.016 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:40:11.017 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:40:11.018 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:40:11.020 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 01:40:11.022 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 01:40:11.024 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:40:11.026 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:40:11.027 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 2ms reading results.
2025-11-24 01:40:11.028 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:40:11.028 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:40:11.031 +02:00 [DBG] The navigation 'Event.Branch' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:40:11.033 +02:00 [DBG] Context 'AppDbContext' started tracking 'Event' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:40:11.034 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:40:11.035 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:40:11.036 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 01:40:11.037 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:40:11.037 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:40:11.039 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:40:11.039 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:40:11.040 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:40:11.041 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:40:11.042 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:40:11.042 +02:00 [DBG] Executing DbCommand [Parameters=[@p7='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Size = 300), @p5='?' (Size = 150), @p6='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Events] SET [BranchId] = @p0, [CreatedAt] = @p1, [Description] = @p2, [EventDate] = @p3, [ImageURL] = @p4, [Title] = @p5, [UpdatedAt] = @p6
OUTPUT 1
WHERE [EventId] = @p7;
2025-11-24 01:40:11.056 +02:00 [INF] Executed DbCommand (13ms) [Parameters=[@p7='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Size = 300), @p5='?' (Size = 150), @p6='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Events] SET [BranchId] = @p0, [CreatedAt] = @p1, [Description] = @p2, [EventDate] = @p3, [ImageURL] = @p4, [Title] = @p5, [UpdatedAt] = @p6
OUTPUT 1
WHERE [EventId] = @p7;
2025-11-24 01:40:11.058 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:40:11.059 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 01:40:11.059 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:40:11.060 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:40:11.061 +02:00 [DBG] An entity of type 'Event' tracked by 'AppDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:40:11.063 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 01:40:11.064 +02:00 [INF] Event ID 1 updated successfully
2025-11-24 01:40:11.065 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:40:11.067 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:40:11.067 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:40:11.068 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:40:11.069 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter' and content type 'text/plain' to write the response.
2025-11-24 01:40:11.070 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.String'.
2025-11-24 01:40:11.071 +02:00 [INF] Executed action Hospital.Controllers.EventController.UpdateEvent (Hospital) in 75.2464ms
2025-11-24 01:40:11.071 +02:00 [INF] Executed endpoint 'Hospital.Controllers.EventController.UpdateEvent (Hospital)'
2025-11-24 01:40:11.073 +02:00 [DBG] Connection id "0HNHAT4T4JIFL" completed keep alive response.
2025-11-24 01:40:11.073 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:40:11.074 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:40:11.075 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 01:40:11.076 +02:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7217/api/Event/UpdateEvent - 200 null text/plain; charset=utf-8 108.2002ms
2025-11-24 01:40:17.087 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Event/GetEvent - application/json 38
2025-11-24 01:40:17.090 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Event/GetEvent'
2025-11-24 01:40:17.092 +02:00 [DBG] Endpoint 'Hospital.Controllers.EventController.GetEvent (Hospital)' with route pattern 'api/Event/GetEvent' is valid for the request path '/api/Event/GetEvent'
2025-11-24 01:40:17.096 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.EventController.GetEvent (Hospital)'
2025-11-24 01:40:17.097 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:40:17.097 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:40:17.098 +02:00 [INF] Executing endpoint 'Hospital.Controllers.EventController.GetEvent (Hospital)'
2025-11-24 01:40:17.099 +02:00 [INF] Route matched with {action = "GetEvent", controller = "Event"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetEvent(Hospital.Application.DTO.Event.GetEventDto) on controller Hospital.Controllers.EventController (Hospital).
2025-11-24 01:40:17.104 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:40:17.106 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:40:17.106 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:40:17.109 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:40:17.110 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:40:17.111 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.EventController (Hospital)
2025-11-24 01:40:17.112 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.EventController (Hospital)
2025-11-24 01:40:17.113 +02:00 [DBG] Attempting to bind parameter 'event' of type 'Hospital.Application.DTO.Event.GetEventDto' ...
2025-11-24 01:40:17.114 +02:00 [DBG] Attempting to bind parameter 'event' of type 'Hospital.Application.DTO.Event.GetEventDto' using the name '' in request data ...
2025-11-24 01:40:17.116 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 01:40:17.117 +02:00 [DBG] Connection id "0HNHAT4T4JIFL", Request id "0HNHAT4T4JIFL:0000000A": started reading request body.
2025-11-24 01:40:17.118 +02:00 [DBG] Connection id "0HNHAT4T4JIFL", Request id "0HNHAT4T4JIFL:0000000A": done reading request body.
2025-11-24 01:40:17.118 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Event.GetEventDto'
2025-11-24 01:40:17.119 +02:00 [DBG] Done attempting to bind parameter 'event' of type 'Hospital.Application.DTO.Event.GetEventDto'.
2025-11-24 01:40:17.120 +02:00 [DBG] Done attempting to bind parameter 'event' of type 'Hospital.Application.DTO.Event.GetEventDto'.
2025-11-24 01:40:17.122 +02:00 [DBG] Attempting to validate the bound parameter 'event' of type 'Hospital.Application.DTO.Event.GetEventDto' ...
2025-11-24 01:40:17.125 +02:00 [DBG] Done attempting to validate the bound parameter 'event' of type 'Hospital.Application.DTO.Event.GetEventDto'.
2025-11-24 01:40:17.128 +02:00 [INF] Get event  called at "2025-11-24T01:40:17.1280958+02:00"
2025-11-24 01:40:17.129 +02:00 [INF] Fetching event ID 1 for Branch ID 2
2025-11-24 01:40:17.130 +02:00 [INF] Fetching branch by ID: 2
2025-11-24 01:40:17.132 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:40:17.135 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:40:17.135 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 01:40:17.136 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:40:17.137 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:40:17.138 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:40:17.139 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:40:17.140 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:40:17.142 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 01:40:17.144 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 01:40:17.148 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:40:17.149 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:40:17.149 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 01:40:17.151 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:40:17.152 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 01:40:17.154 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:40:17.155 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:40:17.155 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:40:17.156 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:40:17.157 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:40:17.157 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[EventId], [e].[BranchId], [e].[CreatedAt], [e].[Description], [e].[EventDate], [e].[ImageURL], [e].[Title], [e].[UpdatedAt]
FROM [Events] AS [e]
WHERE [e].[EventId] = @__id_0
2025-11-24 01:40:17.159 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[EventId], [e].[BranchId], [e].[CreatedAt], [e].[Description], [e].[EventDate], [e].[ImageURL], [e].[Title], [e].[UpdatedAt]
FROM [Events] AS [e]
WHERE [e].[EventId] = @__id_0
2025-11-24 01:40:17.161 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:40:17.162 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 01:40:17.163 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:40:17.164 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 01:40:17.167 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:40:17.169 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:40:17.170 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:40:17.171 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:40:17.172 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 01:40:17.172 +02:00 [INF] Executing OkObjectResult, writing value of type 'Hospital.Application.DTO.Event.EventDto'.
2025-11-24 01:40:17.174 +02:00 [INF] Executed action Hospital.Controllers.EventController.GetEvent (Hospital) in 63.4444ms
2025-11-24 01:40:17.176 +02:00 [INF] Executed endpoint 'Hospital.Controllers.EventController.GetEvent (Hospital)'
2025-11-24 01:40:17.178 +02:00 [DBG] Connection id "0HNHAT4T4JIFL" completed keep alive response.
2025-11-24 01:40:17.179 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:40:17.180 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:40:17.181 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 01:40:17.182 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Event/GetEvent - 200 null application/json; charset=utf-8 94.784ms
2025-11-24 01:40:27.496 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Event/CreateEvent - application/json 205
2025-11-24 01:40:27.497 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Event/CreateEvent'
2025-11-24 01:40:27.498 +02:00 [DBG] Endpoint 'Hospital.Controllers.EventController.CreateEvent (Hospital)' with route pattern 'api/Event/CreateEvent' is valid for the request path '/api/Event/CreateEvent'
2025-11-24 01:40:27.499 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.EventController.CreateEvent (Hospital)'
2025-11-24 01:40:27.500 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:40:27.501 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:40:27.502 +02:00 [INF] Executing endpoint 'Hospital.Controllers.EventController.CreateEvent (Hospital)'
2025-11-24 01:40:27.504 +02:00 [INF] Route matched with {action = "CreateEvent", controller = "Event"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateEvent(Hospital.Application.DTO.Event.AddEventDto) on controller Hospital.Controllers.EventController (Hospital).
2025-11-24 01:40:27.507 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:40:27.510 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:40:27.513 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:40:27.516 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:40:27.517 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:40:27.519 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.EventController (Hospital)
2025-11-24 01:40:27.521 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.EventController (Hospital)
2025-11-24 01:40:27.522 +02:00 [DBG] Attempting to bind parameter 'eventDto' of type 'Hospital.Application.DTO.Event.AddEventDto' ...
2025-11-24 01:40:27.524 +02:00 [DBG] Attempting to bind parameter 'eventDto' of type 'Hospital.Application.DTO.Event.AddEventDto' using the name '' in request data ...
2025-11-24 01:40:27.527 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 01:40:27.529 +02:00 [DBG] Connection id "0HNHAT4T4JIFL", Request id "0HNHAT4T4JIFL:0000000B": started reading request body.
2025-11-24 01:40:27.531 +02:00 [DBG] Connection id "0HNHAT4T4JIFL", Request id "0HNHAT4T4JIFL:0000000B": done reading request body.
2025-11-24 01:40:27.538 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Event.AddEventDto'
2025-11-24 01:40:27.540 +02:00 [DBG] Done attempting to bind parameter 'eventDto' of type 'Hospital.Application.DTO.Event.AddEventDto'.
2025-11-24 01:40:27.542 +02:00 [DBG] Done attempting to bind parameter 'eventDto' of type 'Hospital.Application.DTO.Event.AddEventDto'.
2025-11-24 01:40:27.543 +02:00 [DBG] Attempting to validate the bound parameter 'eventDto' of type 'Hospital.Application.DTO.Event.AddEventDto' ...
2025-11-24 01:40:27.546 +02:00 [DBG] Done attempting to validate the bound parameter 'eventDto' of type 'Hospital.Application.DTO.Event.AddEventDto'.
2025-11-24 01:40:27.549 +02:00 [INF] create event  called at "2025-11-24T01:40:27.5494886+02:00"
2025-11-24 01:40:27.550 +02:00 [INF] Adding new event: event 2 for Branch ID: 2
2025-11-24 01:40:27.554 +02:00 [INF] Fetching branch by ID: 2
2025-11-24 01:40:27.556 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:40:27.559 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:40:27.562 +02:00 [DBG] Created DbConnection. (2ms).
2025-11-24 01:40:27.563 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:40:27.564 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:40:27.566 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:40:27.568 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:40:27.571 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2025-11-24 01:40:27.572 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 01:40:27.578 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 01:40:27.580 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:40:27.582 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:40:27.584 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 3ms reading results.
2025-11-24 01:40:27.586 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:40:27.588 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 01:40:27.591 +02:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Event.EventId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:40:27.592 +02:00 [DBG] The navigation 'Event.Branch' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:40:27.596 +02:00 [DBG] Context 'AppDbContext' started tracking 'Event' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:40:27.598 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:40:27.598 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:40:27.599 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 01:40:27.599 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:40:27.600 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:40:27.601 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:40:27.602 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:40:27.603 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:40:27.606 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2025-11-24 01:40:27.610 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (7ms).
2025-11-24 01:40:27.611 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Size = 300), @p5='?' (Size = 150), @p6='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Events] ([BranchId], [CreatedAt], [Description], [EventDate], [ImageURL], [Title], [UpdatedAt])
OUTPUT INSERTED.[EventId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-11-24 01:40:27.616 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Size = 300), @p5='?' (Size = 150), @p6='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Events] ([BranchId], [CreatedAt], [Description], [EventDate], [ImageURL], [Title], [UpdatedAt])
OUTPUT INSERTED.[EventId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-11-24 01:40:27.621 +02:00 [DBG] The foreign key property 'Event.EventId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 01:40:27.622 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:40:27.625 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 4ms reading results.
2025-11-24 01:40:27.626 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:40:27.629 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (2ms).
2025-11-24 01:40:27.630 +02:00 [DBG] An entity of type 'Event' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:40:27.633 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 01:40:27.634 +02:00 [INF] Event event 2 added successfully with ID 2
2025-11-24 01:40:27.635 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:40:27.637 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:40:27.638 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:40:27.638 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:40:27.639 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 01:40:27.642 +02:00 [INF] Executing CreatedAtActionResult, writing value of type 'Hospital.Application.DTO.Event.EventDto'.
2025-11-24 01:40:27.644 +02:00 [DBG] Found the endpoints ["Hospital.Controllers.EventController.GetEvent (Hospital)"] for address (id=[2],action=[GetEvent],controller=[Event])
2025-11-24 01:40:27.646 +02:00 [DBG] Successfully processed template api/Event/GetEvent for Hospital.Controllers.EventController.GetEvent (Hospital) resulting in /api/Event/GetEvent and ?id=2
2025-11-24 01:40:27.647 +02:00 [DBG] Link generation succeeded for endpoints ["Hospital.Controllers.EventController.GetEvent (Hospital)"] with result /api/Event/GetEvent?id=2
2025-11-24 01:40:27.648 +02:00 [INF] Executed action Hospital.Controllers.EventController.CreateEvent (Hospital) in 129.0164ms
2025-11-24 01:40:27.649 +02:00 [INF] Executed endpoint 'Hospital.Controllers.EventController.CreateEvent (Hospital)'
2025-11-24 01:40:27.650 +02:00 [DBG] Connection id "0HNHAT4T4JIFL" completed keep alive response.
2025-11-24 01:40:27.651 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:40:27.651 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:40:27.653 +02:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-11-24 01:40:27.654 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Event/CreateEvent - 201 null application/json; charset=utf-8 158.4839ms
2025-11-24 01:40:42.795 +02:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7217/api/Event/DeleteEvent - application/json 38
2025-11-24 01:40:42.801 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Event/DeleteEvent'
2025-11-24 01:40:42.802 +02:00 [DBG] Endpoint 'Hospital.Controllers.EventController.DeleteEvent (Hospital)' with route pattern 'api/Event/DeleteEvent' is valid for the request path '/api/Event/DeleteEvent'
2025-11-24 01:40:42.803 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.EventController.DeleteEvent (Hospital)'
2025-11-24 01:40:42.804 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:40:42.804 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:40:42.805 +02:00 [INF] Executing endpoint 'Hospital.Controllers.EventController.DeleteEvent (Hospital)'
2025-11-24 01:40:42.808 +02:00 [INF] Route matched with {action = "DeleteEvent", controller = "Event"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] DeleteEvent(Hospital.Application.DTO.Event.GetEventDto) on controller Hospital.Controllers.EventController (Hospital).
2025-11-24 01:40:42.809 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:40:42.810 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:40:42.810 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:40:42.811 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:40:42.812 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:40:42.814 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.EventController (Hospital)
2025-11-24 01:40:42.815 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.EventController (Hospital)
2025-11-24 01:40:42.816 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Event.GetEventDto' ...
2025-11-24 01:40:42.818 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Event.GetEventDto' using the name '' in request data ...
2025-11-24 01:40:42.820 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 01:40:42.820 +02:00 [DBG] Connection id "0HNHAT4T4JIFL", Request id "0HNHAT4T4JIFL:0000000C": started reading request body.
2025-11-24 01:40:42.821 +02:00 [DBG] Connection id "0HNHAT4T4JIFL", Request id "0HNHAT4T4JIFL:0000000C": done reading request body.
2025-11-24 01:40:42.822 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Event.GetEventDto'
2025-11-24 01:40:42.823 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Event.GetEventDto'.
2025-11-24 01:40:42.823 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Event.GetEventDto'.
2025-11-24 01:40:42.824 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Event.GetEventDto' ...
2025-11-24 01:40:42.825 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Event.GetEventDto'.
2025-11-24 01:40:42.827 +02:00 [INF] delete event  called at "2025-11-24T01:40:42.8277830+02:00"
2025-11-24 01:40:42.830 +02:00 [INF] Deleting event ID 2 for Branch ID 2
2025-11-24 01:40:42.830 +02:00 [INF] Fetching branch by ID: 2
2025-11-24 01:40:42.832 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:40:42.833 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:40:42.836 +02:00 [DBG] Created DbConnection. (2ms).
2025-11-24 01:40:42.837 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:40:42.837 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:40:42.838 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:40:42.838 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:40:42.839 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:40:42.840 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 01:40:42.844 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 01:40:42.846 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:40:42.847 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:40:42.847 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 01:40:42.848 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:40:42.848 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:40:42.849 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:40:42.851 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:40:42.852 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:40:42.853 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:40:42.854 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:40:42.854 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[EventId], [e].[BranchId], [e].[CreatedAt], [e].[Description], [e].[EventDate], [e].[ImageURL], [e].[Title], [e].[UpdatedAt]
FROM [Events] AS [e]
WHERE [e].[EventId] = @__id_0
2025-11-24 01:40:42.858 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[EventId], [e].[BranchId], [e].[CreatedAt], [e].[Description], [e].[EventDate], [e].[ImageURL], [e].[Title], [e].[UpdatedAt]
FROM [Events] AS [e]
WHERE [e].[EventId] = @__id_0
2025-11-24 01:40:42.859 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:40:42.860 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 01:40:42.861 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:40:42.862 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:40:42.863 +02:00 [DBG] The navigation 'Event.Branch' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:40:42.864 +02:00 [DBG] Context 'AppDbContext' started tracking 'Event' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:40:42.864 +02:00 [DBG] An entity of type 'Event' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Deleted"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:40:42.866 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:40:42.867 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:40:42.867 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 01:40:42.868 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:40:42.869 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:40:42.870 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:40:42.870 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:40:42.871 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:40:42.872 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:40:42.872 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:40:42.873 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [Events]
OUTPUT 1
WHERE [EventId] = @p0;
2025-11-24 01:40:42.885 +02:00 [INF] Executed DbCommand (12ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [Events]
OUTPUT 1
WHERE [EventId] = @p0;
2025-11-24 01:40:42.886 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:40:42.887 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 01:40:42.887 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:40:42.888 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:40:42.889 +02:00 [DBG] An entity of type 'Event' tracked by 'AppDbContext' changed state from '"Deleted"' to '"Detached"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:40:42.890 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 01:40:42.891 +02:00 [INF] Event ID 2 deleted successfully
2025-11-24 01:40:42.892 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:40:42.893 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:40:42.893 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:40:42.894 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:40:42.894 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter' and content type 'text/plain' to write the response.
2025-11-24 01:40:42.895 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.String'.
2025-11-24 01:40:42.897 +02:00 [INF] Executed action Hospital.Controllers.EventController.DeleteEvent (Hospital) in 83.3713ms
2025-11-24 01:40:42.899 +02:00 [INF] Executed endpoint 'Hospital.Controllers.EventController.DeleteEvent (Hospital)'
2025-11-24 01:40:42.899 +02:00 [DBG] Connection id "0HNHAT4T4JIFL" completed keep alive response.
2025-11-24 01:40:42.900 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:40:42.900 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:40:42.901 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 01:40:42.902 +02:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7217/api/Event/DeleteEvent - 200 null text/plain; charset=utf-8 107.5184ms
2025-11-24 01:40:51.184 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Event/GetEvent - application/json 38
2025-11-24 01:40:51.187 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Event/GetEvent'
2025-11-24 01:40:51.190 +02:00 [DBG] Endpoint 'Hospital.Controllers.EventController.GetEvent (Hospital)' with route pattern 'api/Event/GetEvent' is valid for the request path '/api/Event/GetEvent'
2025-11-24 01:40:51.196 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.EventController.GetEvent (Hospital)'
2025-11-24 01:40:51.201 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:40:51.204 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:40:51.206 +02:00 [INF] Executing endpoint 'Hospital.Controllers.EventController.GetEvent (Hospital)'
2025-11-24 01:40:51.208 +02:00 [INF] Route matched with {action = "GetEvent", controller = "Event"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetEvent(Hospital.Application.DTO.Event.GetEventDto) on controller Hospital.Controllers.EventController (Hospital).
2025-11-24 01:40:51.209 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:40:51.210 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:40:51.211 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:40:51.212 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:40:51.213 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:40:51.215 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.EventController (Hospital)
2025-11-24 01:40:51.216 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.EventController (Hospital)
2025-11-24 01:40:51.216 +02:00 [DBG] Attempting to bind parameter 'event' of type 'Hospital.Application.DTO.Event.GetEventDto' ...
2025-11-24 01:40:51.217 +02:00 [DBG] Attempting to bind parameter 'event' of type 'Hospital.Application.DTO.Event.GetEventDto' using the name '' in request data ...
2025-11-24 01:40:51.221 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 01:40:51.222 +02:00 [DBG] Connection id "0HNHAT4T4JIFL", Request id "0HNHAT4T4JIFL:0000000D": started reading request body.
2025-11-24 01:40:51.224 +02:00 [DBG] Connection id "0HNHAT4T4JIFL", Request id "0HNHAT4T4JIFL:0000000D": done reading request body.
2025-11-24 01:40:51.225 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Event.GetEventDto'
2025-11-24 01:40:51.226 +02:00 [DBG] Done attempting to bind parameter 'event' of type 'Hospital.Application.DTO.Event.GetEventDto'.
2025-11-24 01:40:51.226 +02:00 [DBG] Done attempting to bind parameter 'event' of type 'Hospital.Application.DTO.Event.GetEventDto'.
2025-11-24 01:40:51.227 +02:00 [DBG] Attempting to validate the bound parameter 'event' of type 'Hospital.Application.DTO.Event.GetEventDto' ...
2025-11-24 01:40:51.228 +02:00 [DBG] Done attempting to validate the bound parameter 'event' of type 'Hospital.Application.DTO.Event.GetEventDto'.
2025-11-24 01:40:51.228 +02:00 [INF] Get event  called at "2025-11-24T01:40:51.2288321+02:00"
2025-11-24 01:40:51.229 +02:00 [INF] Fetching event ID 1 for Branch ID 2
2025-11-24 01:40:51.230 +02:00 [INF] Fetching branch by ID: 2
2025-11-24 01:40:51.232 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:40:51.233 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:40:51.234 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 01:40:51.236 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:40:51.237 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:40:51.238 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:40:51.239 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:40:51.239 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:40:51.241 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 01:40:51.246 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 01:40:51.249 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:40:51.250 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:40:51.250 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 01:40:51.252 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:40:51.254 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 01:40:51.257 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:40:51.259 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:40:51.260 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:40:51.261 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:40:51.263 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-11-24 01:40:51.266 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[EventId], [e].[BranchId], [e].[CreatedAt], [e].[Description], [e].[EventDate], [e].[ImageURL], [e].[Title], [e].[UpdatedAt]
FROM [Events] AS [e]
WHERE [e].[EventId] = @__id_0
2025-11-24 01:40:51.271 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[EventId], [e].[BranchId], [e].[CreatedAt], [e].[Description], [e].[EventDate], [e].[ImageURL], [e].[Title], [e].[UpdatedAt]
FROM [Events] AS [e]
WHERE [e].[EventId] = @__id_0
2025-11-24 01:40:51.273 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:40:51.274 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 01:40:51.275 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:40:51.277 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 01:40:51.278 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:40:51.280 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:40:51.281 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:40:51.282 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:40:51.283 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 01:40:51.283 +02:00 [INF] Executing OkObjectResult, writing value of type 'Hospital.Application.DTO.Event.EventDto'.
2025-11-24 01:40:51.285 +02:00 [INF] Executed action Hospital.Controllers.EventController.GetEvent (Hospital) in 70.1475ms
2025-11-24 01:40:51.286 +02:00 [INF] Executed endpoint 'Hospital.Controllers.EventController.GetEvent (Hospital)'
2025-11-24 01:40:51.287 +02:00 [DBG] Connection id "0HNHAT4T4JIFL" completed keep alive response.
2025-11-24 01:40:51.288 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:40:51.290 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:40:51.292 +02:00 [DBG] Disposed connection to database '' on server '' (2ms).
2025-11-24 01:40:51.295 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Event/GetEvent - 200 null application/json; charset=utf-8 111.1236ms
2025-11-24 01:41:00.161 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Event/GetAllEvents?branchId=2 - null null
2025-11-24 01:41:00.166 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Event/GetAllEvents'
2025-11-24 01:41:00.171 +02:00 [DBG] Endpoint 'Hospital.Controllers.EventController.GetAllEvents (Hospital)' with route pattern 'api/Event/GetAllEvents' is valid for the request path '/api/Event/GetAllEvents'
2025-11-24 01:41:00.177 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.EventController.GetAllEvents (Hospital)'
2025-11-24 01:41:00.180 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:41:00.180 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:41:00.182 +02:00 [INF] Executing endpoint 'Hospital.Controllers.EventController.GetAllEvents (Hospital)'
2025-11-24 01:41:00.186 +02:00 [INF] Route matched with {action = "GetAllEvents", controller = "Event"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllEvents(Int32) on controller Hospital.Controllers.EventController (Hospital).
2025-11-24 01:41:00.189 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:41:00.191 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:41:00.193 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:41:00.195 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:41:00.197 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:41:00.198 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.EventController (Hospital)
2025-11-24 01:41:00.198 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.EventController (Hospital)
2025-11-24 01:41:00.208 +02:00 [DBG] Attempting to bind parameter 'branchId' of type 'System.Int32' ...
2025-11-24 01:41:00.210 +02:00 [DBG] Attempting to bind parameter 'branchId' of type 'System.Int32' using the name 'branchId' in request data ...
2025-11-24 01:41:00.211 +02:00 [DBG] Done attempting to bind parameter 'branchId' of type 'System.Int32'.
2025-11-24 01:41:00.212 +02:00 [DBG] Done attempting to bind parameter 'branchId' of type 'System.Int32'.
2025-11-24 01:41:00.213 +02:00 [DBG] Attempting to validate the bound parameter 'branchId' of type 'System.Int32' ...
2025-11-24 01:41:00.213 +02:00 [DBG] Done attempting to validate the bound parameter 'branchId' of type 'System.Int32'.
2025-11-24 01:41:00.215 +02:00 [INF] get all event  called at "2025-11-24T01:41:00.2154116+02:00"
2025-11-24 01:41:00.216 +02:00 [INF] Fetching all events for Branch ID 2
2025-11-24 01:41:00.218 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:41:00.221 +02:00 [DBG] Compiling query expression: 
'DbSet<Event>()
    .AsNoTracking()
    .Where(b => b.BranchId == __branchId_0)'
2025-11-24 01:41:00.224 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Event>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Event.EventId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Event.BranchId (int?) FK Index, 1], [Property: Event.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 2], [Property: Event.Description (string), 3], [Property: Event.EventDate (DateTime) Required, 4], [Property: Event.ImageURL (string) MaxLength(300), 5], [Property: Event.Title (string) Required MaxLength(150), 6], [Property: Event.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 7] }
        SELECT e.EventId, e.BranchId, e.CreatedAt, e.Description, e.EventDate, e.ImageURL, e.Title, e.UpdatedAt
        FROM Events AS e
        WHERE e.BranchId == @__branchId_0), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Event>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 01:41:00.231 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:41:00.232 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 01:41:00.232 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:41:00.233 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:41:00.234 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:41:00.235 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:41:00.236 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:41:00.237 +02:00 [DBG] Executing DbCommand [Parameters=[@__branchId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [e].[EventId], [e].[BranchId], [e].[CreatedAt], [e].[Description], [e].[EventDate], [e].[ImageURL], [e].[Title], [e].[UpdatedAt]
FROM [Events] AS [e]
WHERE [e].[BranchId] = @__branchId_0
2025-11-24 01:41:00.242 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__branchId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [e].[EventId], [e].[BranchId], [e].[CreatedAt], [e].[Description], [e].[EventDate], [e].[ImageURL], [e].[Title], [e].[UpdatedAt]
FROM [Events] AS [e]
WHERE [e].[BranchId] = @__branchId_0
2025-11-24 01:41:00.243 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:41:00.244 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 01:41:00.244 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:41:00.245 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:41:00.249 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:41:00.249 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:41:00.250 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:41:00.250 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:41:00.251 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 01:41:00.252 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Event.EventDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 01:41:00.253 +02:00 [INF] Executed action Hospital.Controllers.EventController.GetAllEvents (Hospital) in 55.5852ms
2025-11-24 01:41:00.255 +02:00 [INF] Executed endpoint 'Hospital.Controllers.EventController.GetAllEvents (Hospital)'
2025-11-24 01:41:00.256 +02:00 [DBG] Connection id "0HNHAT4T4JIFL" completed keep alive response.
2025-11-24 01:41:00.256 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:41:00.257 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:41:00.258 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 01:41:00.259 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Event/GetAllEvents?branchId=2 - 200 null application/json; charset=utf-8 97.8088ms
2025-11-24 01:41:05.773 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Event/GetAllEventsInSystem - null null
2025-11-24 01:41:05.776 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Event/GetAllEventsInSystem'
2025-11-24 01:41:05.778 +02:00 [DBG] Endpoint 'Hospital.Controllers.EventController.GetAllEventsInSystem (Hospital)' with route pattern 'api/Event/GetAllEventsInSystem' is valid for the request path '/api/Event/GetAllEventsInSystem'
2025-11-24 01:41:05.779 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.EventController.GetAllEventsInSystem (Hospital)'
2025-11-24 01:41:05.779 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:41:05.780 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:41:05.780 +02:00 [INF] Executing endpoint 'Hospital.Controllers.EventController.GetAllEventsInSystem (Hospital)'
2025-11-24 01:41:05.784 +02:00 [INF] Route matched with {action = "GetAllEventsInSystem", controller = "Event"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllEventsInSystem() on controller Hospital.Controllers.EventController (Hospital).
2025-11-24 01:41:05.786 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:41:05.787 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:41:05.788 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:41:05.790 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:41:05.792 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:41:05.793 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.EventController (Hospital)
2025-11-24 01:41:05.795 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.EventController (Hospital)
2025-11-24 01:41:05.796 +02:00 [INF] get all  event in system  called at "2025-11-24T01:41:05.7967033+02:00"
2025-11-24 01:41:05.798 +02:00 [INF] Fetching all events in the system
2025-11-24 01:41:05.800 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:41:05.802 +02:00 [DBG] Compiling query expression: 
'DbSet<Event>()
    .AsNoTracking()'
2025-11-24 01:41:05.805 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Event>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Event.EventId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Event.BranchId (int?) FK Index, 1], [Property: Event.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 2], [Property: Event.Description (string), 3], [Property: Event.EventDate (DateTime) Required, 4], [Property: Event.ImageURL (string) MaxLength(300), 5], [Property: Event.Title (string) Required MaxLength(150), 6], [Property: Event.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 7] }
        SELECT e.EventId, e.BranchId, e.CreatedAt, e.Description, e.EventDate, e.ImageURL, e.Title, e.UpdatedAt
        FROM Events AS e), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Event>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 01:41:05.807 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:41:05.807 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 01:41:05.807 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:41:05.808 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:41:05.809 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:41:05.809 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:41:05.810 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:41:05.811 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [e].[EventId], [e].[BranchId], [e].[CreatedAt], [e].[Description], [e].[EventDate], [e].[ImageURL], [e].[Title], [e].[UpdatedAt]
FROM [Events] AS [e]
2025-11-24 01:41:05.815 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [e].[EventId], [e].[BranchId], [e].[CreatedAt], [e].[Description], [e].[EventDate], [e].[ImageURL], [e].[Title], [e].[UpdatedAt]
FROM [Events] AS [e]
2025-11-24 01:41:05.821 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:41:05.821 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 01:41:05.822 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:41:05.823 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:41:05.825 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:41:05.826 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:41:05.826 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:41:05.827 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:41:05.827 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 01:41:05.829 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Event.EventDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 01:41:05.831 +02:00 [INF] Executed action Hospital.Controllers.EventController.GetAllEventsInSystem (Hospital) in 38.845ms
2025-11-24 01:41:05.833 +02:00 [INF] Executed endpoint 'Hospital.Controllers.EventController.GetAllEventsInSystem (Hospital)'
2025-11-24 01:41:05.836 +02:00 [DBG] Connection id "0HNHAT4T4JIFL" completed keep alive response.
2025-11-24 01:41:05.836 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:41:05.838 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:41:05.841 +02:00 [DBG] Disposed connection to database '' on server '' (2ms).
2025-11-24 01:41:05.845 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Event/GetAllEventsInSystem - 200 null application/json; charset=utf-8 71.6869ms
2025-11-24 01:41:17.027 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/News/CreateNews - application/json 203
2025-11-24 01:41:17.031 +02:00 [DBG] 1 candidate(s) found for the request path '/api/News/CreateNews'
2025-11-24 01:41:17.032 +02:00 [DBG] Endpoint 'Hospital.Controllers.NewsController.CreateNews (Hospital)' with route pattern 'api/News/CreateNews' is valid for the request path '/api/News/CreateNews'
2025-11-24 01:41:17.035 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.NewsController.CreateNews (Hospital)'
2025-11-24 01:41:17.036 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:41:17.038 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:41:17.039 +02:00 [INF] Executing endpoint 'Hospital.Controllers.NewsController.CreateNews (Hospital)'
2025-11-24 01:41:17.045 +02:00 [INF] Route matched with {action = "CreateNews", controller = "News"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateNews(Hospital.Application.DTO.News.AddNewsDto) on controller Hospital.Controllers.NewsController (Hospital).
2025-11-24 01:41:17.047 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:41:17.047 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:41:17.048 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:41:17.049 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:41:17.051 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:41:17.053 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.NewsController (Hospital)
2025-11-24 01:41:17.055 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.NewsController (Hospital)
2025-11-24 01:41:17.056 +02:00 [DBG] Attempting to bind parameter 'newsDto' of type 'Hospital.Application.DTO.News.AddNewsDto' ...
2025-11-24 01:41:17.057 +02:00 [DBG] Attempting to bind parameter 'newsDto' of type 'Hospital.Application.DTO.News.AddNewsDto' using the name '' in request data ...
2025-11-24 01:41:17.058 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 01:41:17.059 +02:00 [DBG] Connection id "0HNHAT4T4JIFL", Request id "0HNHAT4T4JIFL:00000010": started reading request body.
2025-11-24 01:41:17.060 +02:00 [DBG] Connection id "0HNHAT4T4JIFL", Request id "0HNHAT4T4JIFL:00000010": done reading request body.
2025-11-24 01:41:17.062 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.News.AddNewsDto'
2025-11-24 01:41:17.062 +02:00 [DBG] Done attempting to bind parameter 'newsDto' of type 'Hospital.Application.DTO.News.AddNewsDto'.
2025-11-24 01:41:17.063 +02:00 [DBG] Done attempting to bind parameter 'newsDto' of type 'Hospital.Application.DTO.News.AddNewsDto'.
2025-11-24 01:41:17.063 +02:00 [DBG] Attempting to validate the bound parameter 'newsDto' of type 'Hospital.Application.DTO.News.AddNewsDto' ...
2025-11-24 01:41:17.066 +02:00 [DBG] Done attempting to validate the bound parameter 'newsDto' of type 'Hospital.Application.DTO.News.AddNewsDto'.
2025-11-24 01:41:17.069 +02:00 [INF] create News  called at "2025-11-24T01:41:17.0690509+02:00"
2025-11-24 01:41:17.072 +02:00 [INF] Adding a new news item: hiiiiiiiiii
2025-11-24 01:41:17.073 +02:00 [INF] Fetching branch by ID: 1
2025-11-24 01:41:17.075 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:41:17.076 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:41:17.077 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 01:41:17.077 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:41:17.078 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:41:17.079 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:41:17.079 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:41:17.080 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:41:17.081 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 01:41:17.085 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 01:41:17.089 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:41:17.090 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 01:41:17.093 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:41:17.096 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (3ms).
2025-11-24 01:41:17.098 +02:00 [WRN] Branch with ID 1 not found
2025-11-24 01:41:17.141 +02:00 [ERR] Error occurred while adding news: hiiiiiiiiii
System.Collections.Generic.KeyNotFoundException: Branch with ID 1 not found
   at Hospital.Infrastructure.Services.BranchService.GetByIdAsync(Int32 id) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\BranchService.cs:line 85
   at Hospital.Infrastructure.Services.NewsService.AddAsync(AddNewsDto newsdto) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\NewsService.cs:line 48
2025-11-24 01:41:17.195 +02:00 [INF] Executed action Hospital.Controllers.NewsController.CreateNews (Hospital) in 142.7269ms
2025-11-24 01:41:17.202 +02:00 [INF] Executed endpoint 'Hospital.Controllers.NewsController.CreateNews (Hospital)'
2025-11-24 01:41:17.258 +02:00 [ERR]  Exception caught: Branch with ID 1 not found
System.Collections.Generic.KeyNotFoundException: Branch with ID 1 not found
   at Hospital.Infrastructure.Services.BranchService.GetByIdAsync(Int32 id) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\BranchService.cs:line 85
   at Hospital.Infrastructure.Services.NewsService.AddAsync(AddNewsDto newsdto) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\NewsService.cs:line 48
   at Hospital.Controllers.NewsController.CreateNews(AddNewsDto newsDto) in D:\Walaa\GP\Hospital\Hospital\Controllers\NewsController.cs:line 27
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
2025-11-24 01:41:17.275 +02:00 [DBG] Connection id "0HNHAT4T4JIFL" completed keep alive response.
2025-11-24 01:41:17.276 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:41:17.276 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:41:17.277 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 01:41:17.282 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/News/CreateNews - 404 null application/json 254.5823ms
2025-11-24 01:41:22.904 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/News/CreateNews - application/json 203
2025-11-24 01:41:22.912 +02:00 [DBG] 1 candidate(s) found for the request path '/api/News/CreateNews'
2025-11-24 01:41:22.916 +02:00 [DBG] Endpoint 'Hospital.Controllers.NewsController.CreateNews (Hospital)' with route pattern 'api/News/CreateNews' is valid for the request path '/api/News/CreateNews'
2025-11-24 01:41:22.922 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.NewsController.CreateNews (Hospital)'
2025-11-24 01:41:22.925 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:41:22.927 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:41:22.928 +02:00 [INF] Executing endpoint 'Hospital.Controllers.NewsController.CreateNews (Hospital)'
2025-11-24 01:41:22.929 +02:00 [INF] Route matched with {action = "CreateNews", controller = "News"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateNews(Hospital.Application.DTO.News.AddNewsDto) on controller Hospital.Controllers.NewsController (Hospital).
2025-11-24 01:41:22.931 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:41:22.932 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:41:22.934 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:41:22.935 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:41:22.936 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:41:22.937 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.NewsController (Hospital)
2025-11-24 01:41:22.938 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.NewsController (Hospital)
2025-11-24 01:41:22.939 +02:00 [DBG] Attempting to bind parameter 'newsDto' of type 'Hospital.Application.DTO.News.AddNewsDto' ...
2025-11-24 01:41:22.940 +02:00 [DBG] Attempting to bind parameter 'newsDto' of type 'Hospital.Application.DTO.News.AddNewsDto' using the name '' in request data ...
2025-11-24 01:41:22.941 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 01:41:22.942 +02:00 [DBG] Connection id "0HNHAT4T4JIFL", Request id "0HNHAT4T4JIFL:00000011": started reading request body.
2025-11-24 01:41:22.943 +02:00 [DBG] Connection id "0HNHAT4T4JIFL", Request id "0HNHAT4T4JIFL:00000011": done reading request body.
2025-11-24 01:41:22.944 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.News.AddNewsDto'
2025-11-24 01:41:22.947 +02:00 [DBG] Done attempting to bind parameter 'newsDto' of type 'Hospital.Application.DTO.News.AddNewsDto'.
2025-11-24 01:41:22.951 +02:00 [DBG] Done attempting to bind parameter 'newsDto' of type 'Hospital.Application.DTO.News.AddNewsDto'.
2025-11-24 01:41:22.952 +02:00 [DBG] Attempting to validate the bound parameter 'newsDto' of type 'Hospital.Application.DTO.News.AddNewsDto' ...
2025-11-24 01:41:22.955 +02:00 [DBG] Done attempting to validate the bound parameter 'newsDto' of type 'Hospital.Application.DTO.News.AddNewsDto'.
2025-11-24 01:41:22.956 +02:00 [INF] create News  called at "2025-11-24T01:41:22.9568579+02:00"
2025-11-24 01:41:22.957 +02:00 [INF] Adding a new news item: hiiiiiiiiii
2025-11-24 01:41:22.959 +02:00 [INF] Fetching branch by ID: 2
2025-11-24 01:41:22.962 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:41:22.966 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:41:22.969 +02:00 [DBG] Created DbConnection. (2ms).
2025-11-24 01:41:22.971 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:41:22.977 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:41:22.979 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:41:22.983 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (4ms).
2025-11-24 01:41:22.986 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (6ms).
2025-11-24 01:41:22.987 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 01:41:22.991 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 01:41:22.996 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:41:22.997 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:41:22.998 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 01:41:22.999 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:41:23.000 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 01:41:23.004 +02:00 [DBG] 'AppDbContext' generated a temporary value for the property 'News.NewsId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:41:23.019 +02:00 [DBG] The navigation 'News.Branch' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:41:23.021 +02:00 [DBG] Context 'AppDbContext' started tracking 'News' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:41:23.024 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:41:23.029 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:41:23.030 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 01:41:23.031 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:41:23.032 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:41:23.033 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:41:23.034 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:41:23.035 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:41:23.035 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:41:23.036 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:41:23.037 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 300), @p5='?' (Size = 150), @p6='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [News] ([BranchId], [CreatedAt], [Date], [Description], [ImageURL], [Title], [UpdatedAt])
OUTPUT INSERTED.[NewsId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-11-24 01:41:23.042 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 300), @p5='?' (Size = 150), @p6='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [News] ([BranchId], [CreatedAt], [Date], [Description], [ImageURL], [Title], [UpdatedAt])
OUTPUT INSERTED.[NewsId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-11-24 01:41:23.045 +02:00 [DBG] The foreign key property 'News.NewsId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 01:41:23.047 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:41:23.047 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 2ms reading results.
2025-11-24 01:41:23.048 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:41:23.048 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:41:23.050 +02:00 [DBG] An entity of type 'News' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:41:23.052 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 01:41:23.053 +02:00 [INF] News item added successfully with ID: 1
2025-11-24 01:41:23.055 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:41:23.057 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:41:23.058 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:41:23.058 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:41:23.060 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 01:41:23.062 +02:00 [INF] Executing CreatedAtActionResult, writing value of type 'Hospital.Application.DTO.News.NewsDto'.
2025-11-24 01:41:23.063 +02:00 [DBG] Found the endpoints ["Hospital.Controllers.NewsController.GetNews (Hospital)"] for address (id=[1],action=[GetNews],controller=[News])
2025-11-24 01:41:23.064 +02:00 [DBG] Successfully processed template api/News/GetNews for Hospital.Controllers.NewsController.GetNews (Hospital) resulting in /api/News/GetNews and ?id=1
2025-11-24 01:41:23.065 +02:00 [DBG] Link generation succeeded for endpoints ["Hospital.Controllers.NewsController.GetNews (Hospital)"] with result /api/News/GetNews?id=1
2025-11-24 01:41:23.068 +02:00 [INF] Executed action Hospital.Controllers.NewsController.CreateNews (Hospital) in 131.2578ms
2025-11-24 01:41:23.069 +02:00 [INF] Executed endpoint 'Hospital.Controllers.NewsController.CreateNews (Hospital)'
2025-11-24 01:41:23.069 +02:00 [DBG] Connection id "0HNHAT4T4JIFL" completed keep alive response.
2025-11-24 01:41:23.070 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:41:23.070 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:41:23.071 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 01:41:23.072 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/News/CreateNews - 201 null application/json; charset=utf-8 168.1674ms
2025-11-24 01:41:28.513 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/News/CreateNews - application/json 203
2025-11-24 01:41:28.518 +02:00 [DBG] 1 candidate(s) found for the request path '/api/News/CreateNews'
2025-11-24 01:41:28.519 +02:00 [DBG] Endpoint 'Hospital.Controllers.NewsController.CreateNews (Hospital)' with route pattern 'api/News/CreateNews' is valid for the request path '/api/News/CreateNews'
2025-11-24 01:41:28.521 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.NewsController.CreateNews (Hospital)'
2025-11-24 01:41:28.523 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:41:28.526 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:41:28.528 +02:00 [INF] Executing endpoint 'Hospital.Controllers.NewsController.CreateNews (Hospital)'
2025-11-24 01:41:28.528 +02:00 [INF] Route matched with {action = "CreateNews", controller = "News"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateNews(Hospital.Application.DTO.News.AddNewsDto) on controller Hospital.Controllers.NewsController (Hospital).
2025-11-24 01:41:28.530 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:41:28.531 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:41:28.531 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:41:28.532 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:41:28.534 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:41:28.535 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.NewsController (Hospital)
2025-11-24 01:41:28.537 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.NewsController (Hospital)
2025-11-24 01:41:28.539 +02:00 [DBG] Attempting to bind parameter 'newsDto' of type 'Hospital.Application.DTO.News.AddNewsDto' ...
2025-11-24 01:41:28.540 +02:00 [DBG] Attempting to bind parameter 'newsDto' of type 'Hospital.Application.DTO.News.AddNewsDto' using the name '' in request data ...
2025-11-24 01:41:28.540 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 01:41:28.541 +02:00 [DBG] Connection id "0HNHAT4T4JIFL", Request id "0HNHAT4T4JIFL:00000012": started reading request body.
2025-11-24 01:41:28.542 +02:00 [DBG] Connection id "0HNHAT4T4JIFL", Request id "0HNHAT4T4JIFL:00000012": done reading request body.
2025-11-24 01:41:28.544 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.News.AddNewsDto'
2025-11-24 01:41:28.545 +02:00 [DBG] Done attempting to bind parameter 'newsDto' of type 'Hospital.Application.DTO.News.AddNewsDto'.
2025-11-24 01:41:28.545 +02:00 [DBG] Done attempting to bind parameter 'newsDto' of type 'Hospital.Application.DTO.News.AddNewsDto'.
2025-11-24 01:41:28.547 +02:00 [DBG] Attempting to validate the bound parameter 'newsDto' of type 'Hospital.Application.DTO.News.AddNewsDto' ...
2025-11-24 01:41:28.548 +02:00 [DBG] Done attempting to validate the bound parameter 'newsDto' of type 'Hospital.Application.DTO.News.AddNewsDto'.
2025-11-24 01:41:28.550 +02:00 [INF] create News  called at "2025-11-24T01:41:28.5501946+02:00"
2025-11-24 01:41:28.550 +02:00 [INF] Adding a new news item: hiiiiiiiiii
2025-11-24 01:41:28.551 +02:00 [INF] Fetching branch by ID: 2
2025-11-24 01:41:28.552 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:41:28.553 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:41:28.554 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 01:41:28.555 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:41:28.555 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:41:28.556 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:41:28.557 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:41:28.558 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:41:28.558 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 01:41:28.563 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 01:41:28.573 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:41:28.574 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:41:28.575 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 3ms reading results.
2025-11-24 01:41:28.578 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:41:28.581 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (3ms).
2025-11-24 01:41:28.585 +02:00 [DBG] 'AppDbContext' generated a temporary value for the property 'News.NewsId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:41:28.587 +02:00 [DBG] The navigation 'News.Branch' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:41:28.589 +02:00 [DBG] Context 'AppDbContext' started tracking 'News' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:41:28.591 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:41:28.592 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:41:28.593 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 01:41:28.595 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:41:28.597 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:41:28.598 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:41:28.600 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:41:28.601 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:41:28.603 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:41:28.605 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-11-24 01:41:28.606 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 300), @p5='?' (Size = 150), @p6='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [News] ([BranchId], [CreatedAt], [Date], [Description], [ImageURL], [Title], [UpdatedAt])
OUTPUT INSERTED.[NewsId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-11-24 01:41:28.614 +02:00 [INF] Executed DbCommand (8ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 300), @p5='?' (Size = 150), @p6='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [News] ([BranchId], [CreatedAt], [Date], [Description], [ImageURL], [Title], [UpdatedAt])
OUTPUT INSERTED.[NewsId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-11-24 01:41:28.617 +02:00 [DBG] The foreign key property 'News.NewsId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 01:41:28.620 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:41:28.621 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 4ms reading results.
2025-11-24 01:41:28.622 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:41:28.622 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:41:28.624 +02:00 [DBG] An entity of type 'News' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:41:28.625 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 01:41:28.627 +02:00 [INF] News item added successfully with ID: 2
2025-11-24 01:41:28.629 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:41:28.634 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:41:28.634 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:41:28.637 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:41:28.637 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 01:41:28.640 +02:00 [INF] Executing CreatedAtActionResult, writing value of type 'Hospital.Application.DTO.News.NewsDto'.
2025-11-24 01:41:28.643 +02:00 [DBG] Found the endpoints ["Hospital.Controllers.NewsController.GetNews (Hospital)"] for address (id=[2],action=[GetNews],controller=[News])
2025-11-24 01:41:28.647 +02:00 [DBG] Successfully processed template api/News/GetNews for Hospital.Controllers.NewsController.GetNews (Hospital) resulting in /api/News/GetNews and ?id=2
2025-11-24 01:41:28.652 +02:00 [DBG] Link generation succeeded for endpoints ["Hospital.Controllers.NewsController.GetNews (Hospital)"] with result /api/News/GetNews?id=2
2025-11-24 01:41:28.655 +02:00 [INF] Executed action Hospital.Controllers.NewsController.CreateNews (Hospital) in 120.2358ms
2025-11-24 01:41:28.657 +02:00 [INF] Executed endpoint 'Hospital.Controllers.NewsController.CreateNews (Hospital)'
2025-11-24 01:41:28.658 +02:00 [DBG] Connection id "0HNHAT4T4JIFL" completed keep alive response.
2025-11-24 01:41:28.660 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:41:28.663 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:41:28.664 +02:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-11-24 01:41:28.666 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/News/CreateNews - 201 null application/json; charset=utf-8 153.0994ms
2025-11-24 01:41:30.118 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/News/CreateNews - application/json 203
2025-11-24 01:41:30.131 +02:00 [DBG] 1 candidate(s) found for the request path '/api/News/CreateNews'
2025-11-24 01:41:30.135 +02:00 [DBG] Endpoint 'Hospital.Controllers.NewsController.CreateNews (Hospital)' with route pattern 'api/News/CreateNews' is valid for the request path '/api/News/CreateNews'
2025-11-24 01:41:30.137 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.NewsController.CreateNews (Hospital)'
2025-11-24 01:41:30.138 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:41:30.139 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:41:30.139 +02:00 [INF] Executing endpoint 'Hospital.Controllers.NewsController.CreateNews (Hospital)'
2025-11-24 01:41:30.140 +02:00 [INF] Route matched with {action = "CreateNews", controller = "News"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateNews(Hospital.Application.DTO.News.AddNewsDto) on controller Hospital.Controllers.NewsController (Hospital).
2025-11-24 01:41:30.141 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:41:30.141 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:41:30.144 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:41:30.146 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:41:30.147 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:41:30.152 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.NewsController (Hospital)
2025-11-24 01:41:30.154 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.NewsController (Hospital)
2025-11-24 01:41:30.156 +02:00 [DBG] Attempting to bind parameter 'newsDto' of type 'Hospital.Application.DTO.News.AddNewsDto' ...
2025-11-24 01:41:30.157 +02:00 [DBG] Attempting to bind parameter 'newsDto' of type 'Hospital.Application.DTO.News.AddNewsDto' using the name '' in request data ...
2025-11-24 01:41:30.158 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 01:41:30.158 +02:00 [DBG] Connection id "0HNHAT4T4JIFL", Request id "0HNHAT4T4JIFL:00000013": started reading request body.
2025-11-24 01:41:30.159 +02:00 [DBG] Connection id "0HNHAT4T4JIFL", Request id "0HNHAT4T4JIFL:00000013": done reading request body.
2025-11-24 01:41:30.160 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.News.AddNewsDto'
2025-11-24 01:41:30.160 +02:00 [DBG] Done attempting to bind parameter 'newsDto' of type 'Hospital.Application.DTO.News.AddNewsDto'.
2025-11-24 01:41:30.161 +02:00 [DBG] Done attempting to bind parameter 'newsDto' of type 'Hospital.Application.DTO.News.AddNewsDto'.
2025-11-24 01:41:30.161 +02:00 [DBG] Attempting to validate the bound parameter 'newsDto' of type 'Hospital.Application.DTO.News.AddNewsDto' ...
2025-11-24 01:41:30.162 +02:00 [DBG] Done attempting to validate the bound parameter 'newsDto' of type 'Hospital.Application.DTO.News.AddNewsDto'.
2025-11-24 01:41:30.163 +02:00 [INF] create News  called at "2025-11-24T01:41:30.1637953+02:00"
2025-11-24 01:41:30.165 +02:00 [INF] Adding a new news item: hiiiiiiiiii
2025-11-24 01:41:30.166 +02:00 [INF] Fetching branch by ID: 2
2025-11-24 01:41:30.167 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:41:30.168 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:41:30.169 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 01:41:30.170 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:41:30.171 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:41:30.171 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:41:30.172 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:41:30.173 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:41:30.174 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 01:41:30.179 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 01:41:30.181 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:41:30.182 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:41:30.184 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 3ms reading results.
2025-11-24 01:41:30.185 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:41:30.187 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 01:41:30.188 +02:00 [DBG] 'AppDbContext' generated a temporary value for the property 'News.NewsId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:41:30.189 +02:00 [DBG] The navigation 'News.Branch' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:41:30.190 +02:00 [DBG] Context 'AppDbContext' started tracking 'News' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:41:30.191 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:41:30.192 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:41:30.192 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 01:41:30.193 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:41:30.195 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:41:30.196 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:41:30.197 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:41:30.198 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:41:30.198 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:41:30.200 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:41:30.201 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 300), @p5='?' (Size = 150), @p6='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [News] ([BranchId], [CreatedAt], [Date], [Description], [ImageURL], [Title], [UpdatedAt])
OUTPUT INSERTED.[NewsId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-11-24 01:41:30.204 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 300), @p5='?' (Size = 150), @p6='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [News] ([BranchId], [CreatedAt], [Date], [Description], [ImageURL], [Title], [UpdatedAt])
OUTPUT INSERTED.[NewsId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-11-24 01:41:30.206 +02:00 [DBG] The foreign key property 'News.NewsId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 01:41:30.206 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:41:30.207 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 01:41:30.208 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:41:30.208 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:41:30.209 +02:00 [DBG] An entity of type 'News' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:41:30.212 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 01:41:30.213 +02:00 [INF] News item added successfully with ID: 3
2025-11-24 01:41:30.214 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:41:30.217 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:41:30.218 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:41:30.219 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:41:30.219 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 01:41:30.220 +02:00 [INF] Executing CreatedAtActionResult, writing value of type 'Hospital.Application.DTO.News.NewsDto'.
2025-11-24 01:41:30.221 +02:00 [DBG] Found the endpoints ["Hospital.Controllers.NewsController.GetNews (Hospital)"] for address (id=[3],action=[GetNews],controller=[News])
2025-11-24 01:41:30.221 +02:00 [DBG] Successfully processed template api/News/GetNews for Hospital.Controllers.NewsController.GetNews (Hospital) resulting in /api/News/GetNews and ?id=3
2025-11-24 01:41:30.222 +02:00 [DBG] Link generation succeeded for endpoints ["Hospital.Controllers.NewsController.GetNews (Hospital)"] with result /api/News/GetNews?id=3
2025-11-24 01:41:30.225 +02:00 [INF] Executed action Hospital.Controllers.NewsController.CreateNews (Hospital) in 72.2572ms
2025-11-24 01:41:30.228 +02:00 [INF] Executed endpoint 'Hospital.Controllers.NewsController.CreateNews (Hospital)'
2025-11-24 01:41:30.228 +02:00 [DBG] Connection id "0HNHAT4T4JIFL" completed keep alive response.
2025-11-24 01:41:30.229 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:41:30.230 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:41:30.230 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 01:41:30.231 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/News/CreateNews - 201 null application/json; charset=utf-8 113.1562ms
2025-11-24 01:41:38.799 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/News/GetNews - application/json 37
2025-11-24 01:41:38.803 +02:00 [DBG] 1 candidate(s) found for the request path '/api/News/GetNews'
2025-11-24 01:41:38.804 +02:00 [DBG] Endpoint 'Hospital.Controllers.NewsController.GetNews (Hospital)' with route pattern 'api/News/GetNews' is valid for the request path '/api/News/GetNews'
2025-11-24 01:41:38.805 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.NewsController.GetNews (Hospital)'
2025-11-24 01:41:38.806 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:41:38.806 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:41:38.807 +02:00 [INF] Executing endpoint 'Hospital.Controllers.NewsController.GetNews (Hospital)'
2025-11-24 01:41:38.811 +02:00 [INF] Route matched with {action = "GetNews", controller = "News"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNews(Hospital.Application.DTO.News.GetNewsDto) on controller Hospital.Controllers.NewsController (Hospital).
2025-11-24 01:41:38.812 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:41:38.813 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:41:38.815 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:41:38.816 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:41:38.817 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:41:38.818 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.NewsController (Hospital)
2025-11-24 01:41:38.819 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.NewsController (Hospital)
2025-11-24 01:41:38.819 +02:00 [DBG] Attempting to bind parameter 'news' of type 'Hospital.Application.DTO.News.GetNewsDto' ...
2025-11-24 01:41:38.821 +02:00 [DBG] Attempting to bind parameter 'news' of type 'Hospital.Application.DTO.News.GetNewsDto' using the name '' in request data ...
2025-11-24 01:41:38.822 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 01:41:38.823 +02:00 [DBG] Connection id "0HNHAT4T4JIFL", Request id "0HNHAT4T4JIFL:00000014": started reading request body.
2025-11-24 01:41:38.824 +02:00 [DBG] Connection id "0HNHAT4T4JIFL", Request id "0HNHAT4T4JIFL:00000014": done reading request body.
2025-11-24 01:41:38.826 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.News.GetNewsDto'
2025-11-24 01:41:38.827 +02:00 [DBG] Done attempting to bind parameter 'news' of type 'Hospital.Application.DTO.News.GetNewsDto'.
2025-11-24 01:41:38.828 +02:00 [DBG] Done attempting to bind parameter 'news' of type 'Hospital.Application.DTO.News.GetNewsDto'.
2025-11-24 01:41:38.828 +02:00 [DBG] Attempting to validate the bound parameter 'news' of type 'Hospital.Application.DTO.News.GetNewsDto' ...
2025-11-24 01:41:38.830 +02:00 [DBG] Done attempting to validate the bound parameter 'news' of type 'Hospital.Application.DTO.News.GetNewsDto'.
2025-11-24 01:41:38.831 +02:00 [INF] get News  called at "2025-11-24T01:41:38.8316932+02:00"
2025-11-24 01:41:38.833 +02:00 [INF] Getting news with ID: 1 for branch ID: 2
2025-11-24 01:41:38.834 +02:00 [INF] Fetching branch by ID: 2
2025-11-24 01:41:38.835 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:41:38.836 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:41:38.837 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 01:41:38.837 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:41:38.838 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:41:38.839 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:41:38.840 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:41:38.841 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:41:38.842 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 01:41:38.846 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 01:41:38.848 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:41:38.849 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:41:38.850 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 01:41:38.851 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:41:38.851 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:41:38.853 +02:00 [DBG] Compiling query expression: 
'DbSet<News>()
    .AsNoTracking()
    .FirstOrDefault(n => n.NewsId == __id_0)'
2025-11-24 01:41:38.858 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<News>(
    asyncEnumerable: new SingleQueryingEnumerable<News>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: News.NewsId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: News.BranchId (int?) FK Index, 1], [Property: News.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 2], [Property: News.Date (DateTime) Required, 3], [Property: News.Description (string), 4], [Property: News.ImageURL (string) MaxLength(300), 5], [Property: News.Title (string) Required MaxLength(150), 6], [Property: News.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 7] }
            SELECT TOP(1) n.NewsId, n.BranchId, n.CreatedAt, n.Date, n.Description, n.ImageURL, n.Title, n.UpdatedAt
            FROM News AS n
            WHERE n.NewsId == @__id_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, News>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 01:41:38.860 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:41:38.861 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:41:38.862 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:41:38.862 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:41:38.862 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:41:38.863 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[NewsId], [n].[BranchId], [n].[CreatedAt], [n].[Date], [n].[Description], [n].[ImageURL], [n].[Title], [n].[UpdatedAt]
FROM [News] AS [n]
WHERE [n].[NewsId] = @__id_0
2025-11-24 01:41:38.875 +02:00 [INF] Executed DbCommand (12ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[NewsId], [n].[BranchId], [n].[CreatedAt], [n].[Date], [n].[Description], [n].[ImageURL], [n].[Title], [n].[UpdatedAt]
FROM [News] AS [n]
WHERE [n].[NewsId] = @__id_0
2025-11-24 01:41:38.877 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:41:38.877 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 01:41:38.878 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:41:38.879 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:41:38.880 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:41:38.881 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:41:38.883 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:41:38.884 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:41:38.886 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 01:41:38.887 +02:00 [INF] Executing OkObjectResult, writing value of type 'Hospital.Application.DTO.News.NewsDto'.
2025-11-24 01:41:38.888 +02:00 [INF] Executed action Hospital.Controllers.NewsController.GetNews (Hospital) in 70.2074ms
2025-11-24 01:41:38.889 +02:00 [INF] Executed endpoint 'Hospital.Controllers.NewsController.GetNews (Hospital)'
2025-11-24 01:41:38.889 +02:00 [DBG] Connection id "0HNHAT4T4JIFL" completed keep alive response.
2025-11-24 01:41:38.890 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:41:38.890 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:41:38.891 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 01:41:38.892 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/News/GetNews - 200 null application/json; charset=utf-8 93.1652ms
2025-11-24 01:41:48.257 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/News/GetAllNews?branchId=2 - null null
2025-11-24 01:41:48.262 +02:00 [DBG] 1 candidate(s) found for the request path '/api/News/GetAllNews'
2025-11-24 01:41:48.263 +02:00 [DBG] Endpoint 'Hospital.Controllers.NewsController.GetAllNews (Hospital)' with route pattern 'api/News/GetAllNews' is valid for the request path '/api/News/GetAllNews'
2025-11-24 01:41:48.265 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.NewsController.GetAllNews (Hospital)'
2025-11-24 01:41:48.266 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:41:48.267 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:41:48.268 +02:00 [INF] Executing endpoint 'Hospital.Controllers.NewsController.GetAllNews (Hospital)'
2025-11-24 01:41:48.272 +02:00 [INF] Route matched with {action = "GetAllNews", controller = "News"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllNews(Int32) on controller Hospital.Controllers.NewsController (Hospital).
2025-11-24 01:41:48.274 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:41:48.275 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:41:48.276 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:41:48.277 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:41:48.277 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:41:48.278 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.NewsController (Hospital)
2025-11-24 01:41:48.279 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.NewsController (Hospital)
2025-11-24 01:41:48.279 +02:00 [DBG] Attempting to bind parameter 'branchId' of type 'System.Int32' ...
2025-11-24 01:41:48.280 +02:00 [DBG] Attempting to bind parameter 'branchId' of type 'System.Int32' using the name 'branchId' in request data ...
2025-11-24 01:41:48.281 +02:00 [DBG] Done attempting to bind parameter 'branchId' of type 'System.Int32'.
2025-11-24 01:41:48.282 +02:00 [DBG] Done attempting to bind parameter 'branchId' of type 'System.Int32'.
2025-11-24 01:41:48.283 +02:00 [DBG] Attempting to validate the bound parameter 'branchId' of type 'System.Int32' ...
2025-11-24 01:41:48.284 +02:00 [DBG] Done attempting to validate the bound parameter 'branchId' of type 'System.Int32'.
2025-11-24 01:41:48.285 +02:00 [INF] get all News  to specific branch called at "2025-11-24T01:41:48.2855246+02:00"
2025-11-24 01:41:48.287 +02:00 [INF] Retrieving all news for branch ID: 2
2025-11-24 01:41:48.289 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:41:48.291 +02:00 [DBG] Compiling query expression: 
'DbSet<News>()
    .AsNoTracking()
    .Where(n => n.BranchId == __branchId_0)'
2025-11-24 01:41:48.294 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<News>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: News.NewsId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: News.BranchId (int?) FK Index, 1], [Property: News.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 2], [Property: News.Date (DateTime) Required, 3], [Property: News.Description (string), 4], [Property: News.ImageURL (string) MaxLength(300), 5], [Property: News.Title (string) Required MaxLength(150), 6], [Property: News.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 7] }
        SELECT n.NewsId, n.BranchId, n.CreatedAt, n.Date, n.Description, n.ImageURL, n.Title, n.UpdatedAt
        FROM News AS n
        WHERE n.BranchId == @__branchId_0), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, News>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 01:41:48.296 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:41:48.297 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 01:41:48.297 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:41:48.298 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:41:48.299 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:41:48.300 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:41:48.301 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:41:48.302 +02:00 [DBG] Executing DbCommand [Parameters=[@__branchId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [n].[NewsId], [n].[BranchId], [n].[CreatedAt], [n].[Date], [n].[Description], [n].[ImageURL], [n].[Title], [n].[UpdatedAt]
FROM [News] AS [n]
WHERE [n].[BranchId] = @__branchId_0
2025-11-24 01:41:48.308 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@__branchId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [n].[NewsId], [n].[BranchId], [n].[CreatedAt], [n].[Date], [n].[Description], [n].[ImageURL], [n].[Title], [n].[UpdatedAt]
FROM [News] AS [n]
WHERE [n].[BranchId] = @__branchId_0
2025-11-24 01:41:48.310 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:41:48.310 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 01:41:48.311 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:41:48.312 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:41:48.315 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:41:48.318 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:41:48.318 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:41:48.319 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:41:48.320 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 01:41:48.321 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.News.NewsDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 01:41:48.323 +02:00 [INF] Executed action Hospital.Controllers.NewsController.GetAllNews (Hospital) in 44.7835ms
2025-11-24 01:41:48.324 +02:00 [INF] Executed endpoint 'Hospital.Controllers.NewsController.GetAllNews (Hospital)'
2025-11-24 01:41:48.325 +02:00 [DBG] Connection id "0HNHAT4T4JIFL" completed keep alive response.
2025-11-24 01:41:48.328 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:41:48.329 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:41:48.330 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 01:41:48.333 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/News/GetAllNews?branchId=2 - 200 null application/json; charset=utf-8 76.1025ms
2025-11-24 01:42:02.077 +02:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7217/api/News/UpdateNews - application/json 310
2025-11-24 01:42:02.082 +02:00 [DBG] 1 candidate(s) found for the request path '/api/News/UpdateNews'
2025-11-24 01:42:02.083 +02:00 [DBG] Endpoint 'Hospital.Controllers.NewsController.UpdateEvent (Hospital)' with route pattern 'api/News/UpdateNews' is valid for the request path '/api/News/UpdateNews'
2025-11-24 01:42:02.085 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.NewsController.UpdateEvent (Hospital)'
2025-11-24 01:42:02.086 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:42:02.087 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:42:02.088 +02:00 [INF] Executing endpoint 'Hospital.Controllers.NewsController.UpdateEvent (Hospital)'
2025-11-24 01:42:02.092 +02:00 [INF] Route matched with {action = "UpdateEvent", controller = "News"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateEvent(Hospital.Application.DTO.News.NewsDto) on controller Hospital.Controllers.NewsController (Hospital).
2025-11-24 01:42:02.093 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:42:02.095 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:42:02.096 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:42:02.098 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:42:02.099 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:42:02.100 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.NewsController (Hospital)
2025-11-24 01:42:02.101 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.NewsController (Hospital)
2025-11-24 01:42:02.102 +02:00 [DBG] Attempting to bind parameter 'news' of type 'Hospital.Application.DTO.News.NewsDto' ...
2025-11-24 01:42:02.103 +02:00 [DBG] Attempting to bind parameter 'news' of type 'Hospital.Application.DTO.News.NewsDto' using the name '' in request data ...
2025-11-24 01:42:02.104 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 01:42:02.105 +02:00 [DBG] Connection id "0HNHAT4T4JIFL", Request id "0HNHAT4T4JIFL:00000016": started reading request body.
2025-11-24 01:42:02.106 +02:00 [DBG] Connection id "0HNHAT4T4JIFL", Request id "0HNHAT4T4JIFL:00000016": done reading request body.
2025-11-24 01:42:02.108 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.News.NewsDto'
2025-11-24 01:42:02.109 +02:00 [DBG] Done attempting to bind parameter 'news' of type 'Hospital.Application.DTO.News.NewsDto'.
2025-11-24 01:42:02.109 +02:00 [DBG] Done attempting to bind parameter 'news' of type 'Hospital.Application.DTO.News.NewsDto'.
2025-11-24 01:42:02.110 +02:00 [DBG] Attempting to validate the bound parameter 'news' of type 'Hospital.Application.DTO.News.NewsDto' ...
2025-11-24 01:42:02.112 +02:00 [DBG] Done attempting to validate the bound parameter 'news' of type 'Hospital.Application.DTO.News.NewsDto'.
2025-11-24 01:42:02.114 +02:00 [INF] update News  called at "2025-11-24T01:42:02.1141174+02:00"
2025-11-24 01:42:02.117 +02:00 [INF] Updating news with ID: 1
2025-11-24 01:42:02.117 +02:00 [INF] Fetching branch by ID: 1
2025-11-24 01:42:02.118 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:42:02.120 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:42:02.121 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 01:42:02.121 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:42:02.122 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:42:02.123 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:42:02.124 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:42:02.124 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:42:02.125 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 01:42:02.130 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 01:42:02.132 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:42:02.132 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 01:42:02.133 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:42:02.134 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 01:42:02.135 +02:00 [WRN] Branch with ID 1 not found
2025-11-24 01:42:02.176 +02:00 [ERR] Error occurred while updating news with ID: 1
System.Collections.Generic.KeyNotFoundException: Branch with ID 1 not found
   at Hospital.Infrastructure.Services.BranchService.GetByIdAsync(Int32 id) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\BranchService.cs:line 85
   at Hospital.Infrastructure.Services.NewsService.UpdateAsync(NewsDto newsdto) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\NewsService.cs:line 160
2025-11-24 01:42:02.231 +02:00 [INF] Executed action Hospital.Controllers.NewsController.UpdateEvent (Hospital) in 130.9539ms
2025-11-24 01:42:02.236 +02:00 [INF] Executed endpoint 'Hospital.Controllers.NewsController.UpdateEvent (Hospital)'
2025-11-24 01:42:02.283 +02:00 [ERR]  Exception caught: Branch with ID 1 not found
System.Collections.Generic.KeyNotFoundException: Branch with ID 1 not found
   at Hospital.Infrastructure.Services.BranchService.GetByIdAsync(Int32 id) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\BranchService.cs:line 85
   at Hospital.Infrastructure.Services.NewsService.UpdateAsync(NewsDto newsdto) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\NewsService.cs:line 160
   at Hospital.Controllers.NewsController.UpdateEvent(NewsDto news) in D:\Walaa\GP\Hospital\Hospital\Controllers\NewsController.cs:line 63
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
2025-11-24 01:42:02.307 +02:00 [DBG] Connection id "0HNHAT4T4JIFL" completed keep alive response.
2025-11-24 01:42:02.309 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:42:02.311 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:42:02.312 +02:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-11-24 01:42:02.317 +02:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7217/api/News/UpdateNews - 404 null application/json 239.8719ms
2025-11-24 01:42:09.154 +02:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7217/api/News/UpdateNews - application/json 310
2025-11-24 01:42:09.157 +02:00 [DBG] 1 candidate(s) found for the request path '/api/News/UpdateNews'
2025-11-24 01:42:09.158 +02:00 [DBG] Endpoint 'Hospital.Controllers.NewsController.UpdateEvent (Hospital)' with route pattern 'api/News/UpdateNews' is valid for the request path '/api/News/UpdateNews'
2025-11-24 01:42:09.159 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.NewsController.UpdateEvent (Hospital)'
2025-11-24 01:42:09.160 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:42:09.160 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:42:09.161 +02:00 [INF] Executing endpoint 'Hospital.Controllers.NewsController.UpdateEvent (Hospital)'
2025-11-24 01:42:09.161 +02:00 [INF] Route matched with {action = "UpdateEvent", controller = "News"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateEvent(Hospital.Application.DTO.News.NewsDto) on controller Hospital.Controllers.NewsController (Hospital).
2025-11-24 01:42:09.163 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:42:09.164 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:42:09.165 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:42:09.166 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:42:09.167 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:42:09.170 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.NewsController (Hospital)
2025-11-24 01:42:09.171 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.NewsController (Hospital)
2025-11-24 01:42:09.173 +02:00 [DBG] Attempting to bind parameter 'news' of type 'Hospital.Application.DTO.News.NewsDto' ...
2025-11-24 01:42:09.173 +02:00 [DBG] Attempting to bind parameter 'news' of type 'Hospital.Application.DTO.News.NewsDto' using the name '' in request data ...
2025-11-24 01:42:09.176 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 01:42:09.178 +02:00 [DBG] Connection id "0HNHAT4T4JIFL", Request id "0HNHAT4T4JIFL:00000017": started reading request body.
2025-11-24 01:42:09.178 +02:00 [DBG] Connection id "0HNHAT4T4JIFL", Request id "0HNHAT4T4JIFL:00000017": done reading request body.
2025-11-24 01:42:09.179 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.News.NewsDto'
2025-11-24 01:42:09.179 +02:00 [DBG] Done attempting to bind parameter 'news' of type 'Hospital.Application.DTO.News.NewsDto'.
2025-11-24 01:42:09.181 +02:00 [DBG] Done attempting to bind parameter 'news' of type 'Hospital.Application.DTO.News.NewsDto'.
2025-11-24 01:42:09.182 +02:00 [DBG] Attempting to validate the bound parameter 'news' of type 'Hospital.Application.DTO.News.NewsDto' ...
2025-11-24 01:42:09.182 +02:00 [DBG] Done attempting to validate the bound parameter 'news' of type 'Hospital.Application.DTO.News.NewsDto'.
2025-11-24 01:42:09.183 +02:00 [INF] update News  called at "2025-11-24T01:42:09.1834674+02:00"
2025-11-24 01:42:09.184 +02:00 [INF] Updating news with ID: 1
2025-11-24 01:42:09.184 +02:00 [INF] Fetching branch by ID: 2
2025-11-24 01:42:09.185 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:42:09.187 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:42:09.188 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 01:42:09.189 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:42:09.190 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:42:09.191 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:42:09.191 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:42:09.193 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:42:09.194 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 01:42:09.199 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 01:42:09.211 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:42:09.216 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:42:09.220 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 9ms reading results.
2025-11-24 01:42:09.223 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:42:09.224 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 01:42:09.226 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:42:09.229 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:42:09.233 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:42:09.235 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:42:09.237 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2025-11-24 01:42:09.238 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[NewsId], [n].[BranchId], [n].[CreatedAt], [n].[Date], [n].[Description], [n].[ImageURL], [n].[Title], [n].[UpdatedAt]
FROM [News] AS [n]
WHERE [n].[NewsId] = @__id_0
2025-11-24 01:42:09.243 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[NewsId], [n].[BranchId], [n].[CreatedAt], [n].[Date], [n].[Description], [n].[ImageURL], [n].[Title], [n].[UpdatedAt]
FROM [News] AS [n]
WHERE [n].[NewsId] = @__id_0
2025-11-24 01:42:09.246 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:42:09.247 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 01:42:09.248 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:42:09.249 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:42:09.253 +02:00 [DBG] The navigation 'News.Branch' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:42:09.256 +02:00 [DBG] Context 'AppDbContext' started tracking 'News' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:42:09.258 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:42:09.258 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:42:09.259 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 01:42:09.262 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:42:09.264 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:42:09.268 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:42:09.271 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:42:09.273 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:42:09.274 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:42:09.276 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:42:09.277 +02:00 [DBG] Executing DbCommand [Parameters=[@p7='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 300), @p5='?' (Size = 150), @p6='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [News] SET [BranchId] = @p0, [CreatedAt] = @p1, [Date] = @p2, [Description] = @p3, [ImageURL] = @p4, [Title] = @p5, [UpdatedAt] = @p6
OUTPUT 1
WHERE [NewsId] = @p7;
2025-11-24 01:42:09.295 +02:00 [INF] Executed DbCommand (18ms) [Parameters=[@p7='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 300), @p5='?' (Size = 150), @p6='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [News] SET [BranchId] = @p0, [CreatedAt] = @p1, [Date] = @p2, [Description] = @p3, [ImageURL] = @p4, [Title] = @p5, [UpdatedAt] = @p6
OUTPUT 1
WHERE [NewsId] = @p7;
2025-11-24 01:42:09.302 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:42:09.303 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 01:42:09.304 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:42:09.307 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (2ms).
2025-11-24 01:42:09.308 +02:00 [DBG] An entity of type 'News' tracked by 'AppDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:42:09.310 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 01:42:09.311 +02:00 [INF] News updated successfully with ID: 1
2025-11-24 01:42:09.312 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:42:09.315 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:42:09.315 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:42:09.316 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:42:09.316 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter' and content type 'text/plain' to write the response.
2025-11-24 01:42:09.317 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.String'.
2025-11-24 01:42:09.318 +02:00 [INF] Executed action Hospital.Controllers.NewsController.UpdateEvent (Hospital) in 148.4491ms
2025-11-24 01:42:09.319 +02:00 [INF] Executed endpoint 'Hospital.Controllers.NewsController.UpdateEvent (Hospital)'
2025-11-24 01:42:09.320 +02:00 [DBG] Connection id "0HNHAT4T4JIFL" completed keep alive response.
2025-11-24 01:42:09.321 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:42:09.321 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:42:09.322 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 01:42:09.323 +02:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7217/api/News/UpdateNews - 200 null text/plain; charset=utf-8 169.4776ms
2025-11-24 01:42:24.544 +02:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7217/api/News/DeleteNews - application/json 37
2025-11-24 01:42:24.547 +02:00 [DBG] 1 candidate(s) found for the request path '/api/News/DeleteNews'
2025-11-24 01:42:24.550 +02:00 [DBG] Endpoint 'Hospital.Controllers.NewsController.DeleteNews (Hospital)' with route pattern 'api/News/DeleteNews' is valid for the request path '/api/News/DeleteNews'
2025-11-24 01:42:24.551 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.NewsController.DeleteNews (Hospital)'
2025-11-24 01:42:24.554 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:42:24.556 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:42:24.559 +02:00 [INF] Executing endpoint 'Hospital.Controllers.NewsController.DeleteNews (Hospital)'
2025-11-24 01:42:24.562 +02:00 [INF] Route matched with {action = "DeleteNews", controller = "News"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] DeleteNews(Hospital.Application.DTO.News.GetNewsDto) on controller Hospital.Controllers.NewsController (Hospital).
2025-11-24 01:42:24.566 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:42:24.567 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:42:24.569 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:42:24.571 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:42:24.572 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:42:24.573 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.NewsController (Hospital)
2025-11-24 01:42:24.574 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.NewsController (Hospital)
2025-11-24 01:42:24.575 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.News.GetNewsDto' ...
2025-11-24 01:42:24.576 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.News.GetNewsDto' using the name '' in request data ...
2025-11-24 01:42:24.577 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 01:42:24.578 +02:00 [DBG] Connection id "0HNHAT4T4JIFL", Request id "0HNHAT4T4JIFL:00000018": started reading request body.
2025-11-24 01:42:24.578 +02:00 [DBG] Connection id "0HNHAT4T4JIFL", Request id "0HNHAT4T4JIFL:00000018": done reading request body.
2025-11-24 01:42:24.580 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.News.GetNewsDto'
2025-11-24 01:42:24.581 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.News.GetNewsDto'.
2025-11-24 01:42:24.583 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.News.GetNewsDto'.
2025-11-24 01:42:24.584 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.News.GetNewsDto' ...
2025-11-24 01:42:24.585 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.News.GetNewsDto'.
2025-11-24 01:42:24.587 +02:00 [INF] delete News  called at "2025-11-24T01:42:24.5873007+02:00"
2025-11-24 01:42:24.589 +02:00 [INF] Deleting news item with ID: 3
2025-11-24 01:42:24.590 +02:00 [INF] Fetching branch by ID: 2
2025-11-24 01:42:24.593 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:42:24.597 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:42:24.598 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 01:42:24.599 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:42:24.600 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:42:24.602 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:42:24.604 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:42:24.605 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-11-24 01:42:24.608 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 01:42:24.614 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 01:42:24.621 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:42:24.622 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:42:24.623 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 2ms reading results.
2025-11-24 01:42:24.624 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:42:24.626 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 01:42:24.628 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:42:24.629 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:42:24.630 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:42:24.631 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:42:24.633 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:42:24.634 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[NewsId], [n].[BranchId], [n].[CreatedAt], [n].[Date], [n].[Description], [n].[ImageURL], [n].[Title], [n].[UpdatedAt]
FROM [News] AS [n]
WHERE [n].[NewsId] = @__id_0
2025-11-24 01:42:24.637 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[NewsId], [n].[BranchId], [n].[CreatedAt], [n].[Date], [n].[Description], [n].[ImageURL], [n].[Title], [n].[UpdatedAt]
FROM [News] AS [n]
WHERE [n].[NewsId] = @__id_0
2025-11-24 01:42:24.639 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:42:24.640 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 01:42:24.641 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:42:24.642 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 01:42:24.646 +02:00 [DBG] The navigation 'News.Branch' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:42:24.648 +02:00 [DBG] Context 'AppDbContext' started tracking 'News' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:42:24.651 +02:00 [DBG] An entity of type 'News' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Deleted"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:42:24.655 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:42:24.656 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:42:24.657 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 01:42:24.658 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:42:24.659 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:42:24.661 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:42:24.662 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:42:24.665 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:42:24.666 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:42:24.668 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:42:24.669 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [News]
OUTPUT 1
WHERE [NewsId] = @p0;
2025-11-24 01:42:24.674 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [News]
OUTPUT 1
WHERE [NewsId] = @p0;
2025-11-24 01:42:24.675 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:42:24.676 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 01:42:24.677 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:42:24.678 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:42:24.679 +02:00 [DBG] An entity of type 'News' tracked by 'AppDbContext' changed state from '"Deleted"' to '"Detached"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:42:24.681 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 01:42:24.682 +02:00 [INF] News item deleted successfully with ID: 3
2025-11-24 01:42:24.683 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:42:24.685 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:42:24.685 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:42:24.686 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:42:24.687 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter' and content type 'text/plain' to write the response.
2025-11-24 01:42:24.689 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.String'.
2025-11-24 01:42:24.690 +02:00 [INF] Executed action Hospital.Controllers.NewsController.DeleteNews (Hospital) in 116.4983ms
2025-11-24 01:42:24.691 +02:00 [INF] Executed endpoint 'Hospital.Controllers.NewsController.DeleteNews (Hospital)'
2025-11-24 01:42:24.692 +02:00 [DBG] Connection id "0HNHAT4T4JIFL" completed keep alive response.
2025-11-24 01:42:24.693 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:42:24.694 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:42:24.695 +02:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-11-24 01:42:24.696 +02:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7217/api/News/DeleteNews - 200 null text/plain; charset=utf-8 152.8991ms
2025-11-24 01:42:30.790 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/News/GetAllNewsInSystem - null null
2025-11-24 01:42:30.792 +02:00 [DBG] 1 candidate(s) found for the request path '/api/News/GetAllNewsInSystem'
2025-11-24 01:42:30.793 +02:00 [DBG] Endpoint 'Hospital.Controllers.NewsController.GetAllNewsInSystem (Hospital)' with route pattern 'api/News/GetAllNewsInSystem' is valid for the request path '/api/News/GetAllNewsInSystem'
2025-11-24 01:42:30.798 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.NewsController.GetAllNewsInSystem (Hospital)'
2025-11-24 01:42:30.799 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:42:30.799 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:42:30.800 +02:00 [INF] Executing endpoint 'Hospital.Controllers.NewsController.GetAllNewsInSystem (Hospital)'
2025-11-24 01:42:30.803 +02:00 [INF] Route matched with {action = "GetAllNewsInSystem", controller = "News"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllNewsInSystem() on controller Hospital.Controllers.NewsController (Hospital).
2025-11-24 01:42:30.807 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:42:30.810 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:42:30.813 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:42:30.815 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:42:30.816 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:42:30.817 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.NewsController (Hospital)
2025-11-24 01:42:30.818 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.NewsController (Hospital)
2025-11-24 01:42:30.819 +02:00 [INF] get all News in system  called at "2025-11-24T01:42:30.8192872+02:00"
2025-11-24 01:42:30.820 +02:00 [INF] Retrieving all news in the system
2025-11-24 01:42:30.821 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:42:30.822 +02:00 [DBG] Compiling query expression: 
'DbSet<News>()
    .AsNoTracking()'
2025-11-24 01:42:30.826 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<News>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: News.NewsId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: News.BranchId (int?) FK Index, 1], [Property: News.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 2], [Property: News.Date (DateTime) Required, 3], [Property: News.Description (string), 4], [Property: News.ImageURL (string) MaxLength(300), 5], [Property: News.Title (string) Required MaxLength(150), 6], [Property: News.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 7] }
        SELECT n.NewsId, n.BranchId, n.CreatedAt, n.Date, n.Description, n.ImageURL, n.Title, n.UpdatedAt
        FROM News AS n), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, News>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 01:42:30.827 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:42:30.828 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 01:42:30.828 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:42:30.830 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:42:30.831 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:42:30.832 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:42:30.833 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:42:30.835 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [n].[NewsId], [n].[BranchId], [n].[CreatedAt], [n].[Date], [n].[Description], [n].[ImageURL], [n].[Title], [n].[UpdatedAt]
FROM [News] AS [n]
2025-11-24 01:42:30.840 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [n].[NewsId], [n].[BranchId], [n].[CreatedAt], [n].[Date], [n].[Description], [n].[ImageURL], [n].[Title], [n].[UpdatedAt]
FROM [News] AS [n]
2025-11-24 01:42:30.842 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:42:30.843 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 01:42:30.845 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:42:30.846 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:42:30.847 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:42:30.848 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:42:30.849 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:42:30.850 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:42:30.850 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 01:42:30.851 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.News.NewsDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 01:42:30.851 +02:00 [INF] Executed action Hospital.Controllers.NewsController.GetAllNewsInSystem (Hospital) in 34.7876ms
2025-11-24 01:42:30.852 +02:00 [INF] Executed endpoint 'Hospital.Controllers.NewsController.GetAllNewsInSystem (Hospital)'
2025-11-24 01:42:30.853 +02:00 [DBG] Connection id "0HNHAT4T4JIFL" completed keep alive response.
2025-11-24 01:42:30.853 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:42:30.855 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:42:30.856 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 01:42:30.857 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/News/GetAllNewsInSystem - 200 null application/json; charset=utf-8 67.5358ms
2025-11-24 01:42:56.640 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Specializations/Create - application/json 176
2025-11-24 01:42:56.653 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Specializations/Create'
2025-11-24 01:42:56.657 +02:00 [DBG] Endpoint 'Hospital.Controllers.SpecializationsController.Create (Hospital)' with route pattern 'api/Specializations/Create' is valid for the request path '/api/Specializations/Create'
2025-11-24 01:42:56.660 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.SpecializationsController.Create (Hospital)'
2025-11-24 01:42:56.665 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:42:56.672 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:42:56.677 +02:00 [INF] Executing endpoint 'Hospital.Controllers.SpecializationsController.Create (Hospital)'
2025-11-24 01:42:56.684 +02:00 [INF] Route matched with {action = "Create", controller = "Specializations"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Hospital.Application.DTO.Specialization.SpecializationDTO]] Create(Hospital.Application.DTO.Specialization.CreateSpecialization) on controller Hospital.Controllers.SpecializationsController (Hospital).
2025-11-24 01:42:56.701 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:42:56.704 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:42:56.706 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:42:56.709 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:42:56.710 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:42:56.713 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.SpecializationsController (Hospital)
2025-11-24 01:42:56.716 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.SpecializationsController (Hospital)
2025-11-24 01:42:56.717 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Specialization.CreateSpecialization' ...
2025-11-24 01:42:56.718 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Specialization.CreateSpecialization' using the name '' in request data ...
2025-11-24 01:42:56.720 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 01:42:56.724 +02:00 [DBG] Connection id "0HNHAT4T4JIFL", Request id "0HNHAT4T4JIFL:0000001A": started reading request body.
2025-11-24 01:42:56.725 +02:00 [DBG] Connection id "0HNHAT4T4JIFL", Request id "0HNHAT4T4JIFL:0000001A": done reading request body.
2025-11-24 01:42:56.732 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Specialization.CreateSpecialization'
2025-11-24 01:42:56.733 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Specialization.CreateSpecialization'.
2025-11-24 01:42:56.736 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Specialization.CreateSpecialization'.
2025-11-24 01:42:56.739 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Specialization.CreateSpecialization' ...
2025-11-24 01:42:56.745 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Specialization.CreateSpecialization'.
2025-11-24 01:42:56.748 +02:00 [INF] create Specialization called at "2025-11-24T01:42:56.7484410+02:00"
2025-11-24 01:42:56.751 +02:00 [INF] Adding specialization: legg
2025-11-24 01:42:56.754 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:42:56.757 +02:00 [DBG] Compiling query expression: 
'DbSet<Branch>()
    .Where(b => __branchIds_0.Contains(b.BranchId))'
2025-11-24 01:42:56.832 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Branch>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Branch.Address (string) MaxLength(250), 1], [Property: Branch.BranchName (string) Required MaxLength(150), 2], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 3], [Property: Branch.Description (string), 4], [Property: Branch.Email (string) MaxLength(200), 5], [Property: Branch.ImageURL (string) MaxLength(300), 6], [Property: Branch.Phone (string) MaxLength(25), 7], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 8] }
        SELECT b.BranchId, b.Address, b.BranchName, b.CreatedAt, b.Description, b.Email, b.ImageURL, b.Phone, b.UpdatedAt
        FROM Branches AS b
        WHERE b.BranchId IN (
            SELECT b0.value
            FROM OPENJSON(@__branchIds_0) WITH (value int '') AS b0)), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Branch>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 01:42:56.846 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:42:56.847 +02:00 [DBG] Created DbConnection. (1ms).
2025-11-24 01:42:56.848 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:42:56.851 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:42:56.852 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:42:56.853 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:42:56.860 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (8ms).
2025-11-24 01:42:56.862 +02:00 [DBG] Executing DbCommand [Parameters=[@__branchIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [b0].[value]
    FROM OPENJSON(@__branchIds_0) WITH ([value] int '$') AS [b0]
)
2025-11-24 01:42:56.872 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[@__branchIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [b0].[value]
    FROM OPENJSON(@__branchIds_0) WITH ([value] int '$') AS [b0]
)
2025-11-24 01:42:56.875 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:42:56.876 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 01:42:56.879 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:42:56.881 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 01:42:56.931 +02:00 [INF] Executed action Hospital.Controllers.SpecializationsController.Create (Hospital) in 217.8252ms
2025-11-24 01:42:56.934 +02:00 [INF] Executed endpoint 'Hospital.Controllers.SpecializationsController.Create (Hospital)'
2025-11-24 01:42:56.989 +02:00 [ERR]  Exception caught: One or more branches not found.
System.ArgumentException: One or more branches not found.
   at Hospital.Infrastructure.Services.SpecializationService.AddAsync(CreateSpecialization dto) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\SpecializationService.cs:line 41
   at Hospital.Controllers.SpecializationsController.Create(CreateSpecialization dto) in D:\Walaa\GP\Hospital\Hospital\Controllers\SpecializationsController.cs:line 27
   at lambda_method508(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
2025-11-24 01:42:57.007 +02:00 [DBG] Connection id "0HNHAT4T4JIFL" completed keep alive response.
2025-11-24 01:42:57.012 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:42:57.015 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:42:57.016 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 01:42:57.018 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Specializations/Create - 400 null application/json 379.0072ms
2025-11-24 01:43:01.274 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Specializations/Create - application/json 176
2025-11-24 01:43:01.279 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Specializations/Create'
2025-11-24 01:43:01.282 +02:00 [DBG] Endpoint 'Hospital.Controllers.SpecializationsController.Create (Hospital)' with route pattern 'api/Specializations/Create' is valid for the request path '/api/Specializations/Create'
2025-11-24 01:43:01.286 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.SpecializationsController.Create (Hospital)'
2025-11-24 01:43:01.289 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:43:01.291 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:43:01.293 +02:00 [INF] Executing endpoint 'Hospital.Controllers.SpecializationsController.Create (Hospital)'
2025-11-24 01:43:01.296 +02:00 [INF] Route matched with {action = "Create", controller = "Specializations"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Hospital.Application.DTO.Specialization.SpecializationDTO]] Create(Hospital.Application.DTO.Specialization.CreateSpecialization) on controller Hospital.Controllers.SpecializationsController (Hospital).
2025-11-24 01:43:01.298 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:43:01.301 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:43:01.302 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:43:01.304 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:43:01.306 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:43:01.308 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.SpecializationsController (Hospital)
2025-11-24 01:43:01.311 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.SpecializationsController (Hospital)
2025-11-24 01:43:01.312 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Specialization.CreateSpecialization' ...
2025-11-24 01:43:01.313 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Specialization.CreateSpecialization' using the name '' in request data ...
2025-11-24 01:43:01.314 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 01:43:01.315 +02:00 [DBG] Connection id "0HNHAT4T4JIFL", Request id "0HNHAT4T4JIFL:0000001B": started reading request body.
2025-11-24 01:43:01.316 +02:00 [DBG] Connection id "0HNHAT4T4JIFL", Request id "0HNHAT4T4JIFL:0000001B": done reading request body.
2025-11-24 01:43:01.317 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Specialization.CreateSpecialization'
2025-11-24 01:43:01.317 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Specialization.CreateSpecialization'.
2025-11-24 01:43:01.318 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Specialization.CreateSpecialization'.
2025-11-24 01:43:01.319 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Specialization.CreateSpecialization' ...
2025-11-24 01:43:01.319 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Specialization.CreateSpecialization'.
2025-11-24 01:43:01.320 +02:00 [INF] create Specialization called at "2025-11-24T01:43:01.3205222+02:00"
2025-11-24 01:43:01.321 +02:00 [INF] Adding specialization: legg
2025-11-24 01:43:01.322 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:43:01.323 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:43:01.323 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 01:43:01.324 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:43:01.325 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:43:01.326 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:43:01.327 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:43:01.327 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:43:01.328 +02:00 [DBG] Executing DbCommand [Parameters=[@__branchIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [b0].[value]
    FROM OPENJSON(@__branchIds_0) WITH ([value] int '$') AS [b0]
)
2025-11-24 01:43:01.334 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@__branchIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [b0].[value]
    FROM OPENJSON(@__branchIds_0) WITH ([value] int '$') AS [b0]
)
2025-11-24 01:43:01.344 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:43:01.346 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:43:01.348 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 4ms reading results.
2025-11-24 01:43:01.349 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:43:01.350 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:43:01.354 +02:00 [DBG] Compiling query expression: 
'DbSet<Specialization>()
    .Include(s => s.Branches)
    .Include(s => s.Doctors)
    .ThenInclude(d => d.User)'
2025-11-24 01:43:01.363 +02:00 [DBG] Including navigation: 'Specialization.Branches'.
2025-11-24 01:43:01.367 +02:00 [DBG] Including navigation: 'Specialization.Doctors'.
2025-11-24 01:43:01.379 +02:00 [DBG] Including navigation: 'Doctor.User'.
2025-11-24 01:43:01.456 +02:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-11-24 01:43:01.463 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Specialization>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Specialization.SpecializationId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Specialization.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: Specialization.Description (string), 2], [Property: Specialization.Name (string) Required MaxLength(120), 3], [Property: Specialization.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 4] }
            1 -> 0
            2 -> Dictionary<IProperty, int> { [Property: BranchSpecialization (Dictionary<string, object>).BranchId (no field, int) Indexer Required PK FK AfterSave:Throw, 5], [Property: BranchSpecialization (Dictionary<string, object>).SpecializationId (no field, int) Indexer Required PK FK Index AfterSave:Throw, 6] }
            3 -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Branch.Address (string) MaxLength(250), 8], [Property: Branch.BranchName (string) Required MaxLength(150), 9], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 10], [Property: Branch.Description (string), 11], [Property: Branch.Email (string) MaxLength(200), 12], [Property: Branch.ImageURL (string) MaxLength(300), 13], [Property: Branch.Phone (string) MaxLength(25), 14], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 15] }
            4 -> 5
            5 -> 6
            6 -> 7
            7 -> Dictionary<IProperty, int> { [Property: Doctor.DoctorId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 16], [Property: Doctor.Available (bool?), 17], [Property: Doctor.Biography (string), 18], [Property: Doctor.ConsultationFees (decimal) Required, 19], [Property: Doctor.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 20], [Property: Doctor.ExperienceYears (int?), 21], [Property: Doctor.ImageURL (string) MaxLength(300), 22], [Property: Doctor.SpecializationId (int) Required FK Index, 23], [Property: Doctor.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 24], [Property: Doctor.UserId (string) Required FK Index, 25] }
            8 -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 26], [Property: User.AccessFailedCount (int) Required, 27], [Property: User.ConcurrencyStamp (string) Concurrency, 28], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 29], [Property: User.DateOfBirth (DateOnly?), 30], [Property: User.Email (string) Index MaxLength(256), 31], [Property: User.EmailConfirmed (bool) Required, 32], [Property: User.FullName (string) Required MaxLength(150), 33], [Property: User.Gender (GenderType?) MaxLength(10), 34], [Property: User.LockoutEnabled (bool) Required, 35], [Property: User.LockoutEnd (DateTimeOffset?), 36], [Property: User.NormalizedEmail (string) Index MaxLength(256), 37], [Property: User.NormalizedUserName (string) Index MaxLength(256), 38], [Property: User.PasswordHash (string), 39], [Property: User.PhoneNumber (string), 40], [Property: User.PhoneNumberConfirmed (bool) Required, 41], [Property: User.RefreshToken (string), 42], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 43], [Property: User.Role (string) Required MaxLength(50), 44], [Property: User.SecurityStamp (string), 45], [Property: User.TwoFactorEnabled (bool) Required, 46], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 47], [Property: User.UserName (string) MaxLength(256), 48] }
            9 -> 16
            10 -> 26
        SELECT s.SpecializationId, s.CreatedAt, s.Description, s.Name, s.UpdatedAt, t.BranchId, t.SpecializationId, t.BranchId0, t.Address, t.BranchName, t.CreatedAt, t.Description, t.Email, t.ImageURL, t.Phone, t.UpdatedAt, t0.DoctorId, t0.Available, t0.Biography, t0.ConsultationFees, t0.CreatedAt, t0.ExperienceYears, t0.ImageURL, t0.SpecializationId, t0.UpdatedAt, t0.UserId, t0.Id, t0.AccessFailedCount, t0.ConcurrencyStamp, t0.CreatedAt0, t0.DateOfBirth, t0.Email, t0.EmailConfirmed, t0.FullName, t0.Gender, t0.LockoutEnabled, t0.LockoutEnd, t0.NormalizedEmail, t0.NormalizedUserName, t0.PasswordHash, t0.PhoneNumber, t0.PhoneNumberConfirmed, t0.RefreshToken, t0.RefreshTokenExpiryTime, t0.Role, t0.SecurityStamp, t0.TwoFactorEnabled, t0.UpdatedAt0, t0.UserName
        FROM Specializations AS s
        LEFT JOIN 
        (
            SELECT b.BranchId, b.SpecializationId, b0.BranchId AS BranchId0, b0.Address, b0.BranchName, b0.CreatedAt, b0.Description, b0.Email, b0.ImageURL, b0.Phone, b0.UpdatedAt
            FROM BranchSpecializations AS b
            INNER JOIN Branches AS b0 ON b.BranchId == b0.BranchId
        ) AS t ON s.SpecializationId == t.SpecializationId
        LEFT JOIN 
        (
            SELECT d.DoctorId, d.Available, d.Biography, d.ConsultationFees, d.CreatedAt, d.ExperienceYears, d.ImageURL, d.SpecializationId, d.UpdatedAt, d.UserId, u.Id, u.AccessFailedCount, u.ConcurrencyStamp, u.CreatedAt AS CreatedAt0, u.DateOfBirth, u.Email, u.EmailConfirmed, u.FullName, u.Gender, u.LockoutEnabled, u.LockoutEnd, u.NormalizedEmail, u.NormalizedUserName, u.PasswordHash, u.PhoneNumber, u.PhoneNumberConfirmed, u.RefreshToken, u.RefreshTokenExpiryTime, u.Role, u.SecurityStamp, u.TwoFactorEnabled, u.UpdatedAt AS UpdatedAt0, u.UserName
            FROM Doctors AS d
            INNER JOIN Users AS u ON d.UserId == u.Id
        ) AS t0 ON s.SpecializationId == t0.SpecializationId
        ORDER BY s.SpecializationId ASC, t.BranchId ASC, t.SpecializationId ASC, t.BranchId0 ASC, t0.DoctorId ASC), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Specialization>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 01:43:01.521 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:43:01.528 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:43:01.531 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:43:01.533 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:43:01.535 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2025-11-24 01:43:01.537 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt], [t].[BranchId], [t].[SpecializationId], [t].[BranchId0], [t].[Address], [t].[BranchName], [t].[CreatedAt], [t].[Description], [t].[Email], [t].[ImageURL], [t].[Phone], [t].[UpdatedAt], [t0].[DoctorId], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt0], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt0], [t0].[UserName]
FROM [Specializations] AS [s]
LEFT JOIN (
    SELECT [b].[BranchId], [b].[SpecializationId], [b0].[BranchId] AS [BranchId0], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [BranchSpecializations] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
) AS [t] ON [s].[SpecializationId] = [t].[SpecializationId]
LEFT JOIN (
    SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
) AS [t0] ON [s].[SpecializationId] = [t0].[SpecializationId]
ORDER BY [s].[SpecializationId], [t].[BranchId], [t].[SpecializationId], [t].[BranchId0], [t0].[DoctorId]
2025-11-24 01:43:01.571 +02:00 [INF] Executed DbCommand (34ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt], [t].[BranchId], [t].[SpecializationId], [t].[BranchId0], [t].[Address], [t].[BranchName], [t].[CreatedAt], [t].[Description], [t].[Email], [t].[ImageURL], [t].[Phone], [t].[UpdatedAt], [t0].[DoctorId], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt0], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt0], [t0].[UserName]
FROM [Specializations] AS [s]
LEFT JOIN (
    SELECT [b].[BranchId], [b].[SpecializationId], [b0].[BranchId] AS [BranchId0], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [BranchSpecializations] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
) AS [t] ON [s].[SpecializationId] = [t].[SpecializationId]
LEFT JOIN (
    SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
) AS [t0] ON [s].[SpecializationId] = [t0].[SpecializationId]
ORDER BY [s].[SpecializationId], [t].[BranchId], [t].[SpecializationId], [t].[BranchId0], [t0].[DoctorId]
2025-11-24 01:43:01.578 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:43:01.579 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 01:43:01.581 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:43:01.581 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:43:01.587 +02:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Specialization.SpecializationId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:43:01.602 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:43:01.620 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchSpecialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:43:01.621 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:43:01.625 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:43:01.629 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 01:43:01.630 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:43:01.631 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:43:01.641 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:43:01.641 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:43:01.644 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 01:43:01.654 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 01:43:01.656 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:43:01.656 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:43:01.657 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:43:01.658 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (Size = 120), @p3='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Specializations] ([CreatedAt], [Description], [Name], [UpdatedAt])
OUTPUT INSERTED.[SpecializationId]
VALUES (@p0, @p1, @p2, @p3);
2025-11-24 01:43:01.662 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (Size = 120), @p3='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Specializations] ([CreatedAt], [Description], [Name], [UpdatedAt])
OUTPUT INSERTED.[SpecializationId]
VALUES (@p0, @p1, @p2, @p3);
2025-11-24 01:43:01.664 +02:00 [DBG] The foreign key property 'Specialization.SpecializationId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 01:43:01.671 +02:00 [DBG] The foreign key property 'BranchSpecialization.SpecializationId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 01:43:01.675 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:43:01.677 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 13ms reading results.
2025-11-24 01:43:01.680 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:43:01.681 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:43:01.682 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:43:01.683 +02:00 [DBG] Executing DbCommand [Parameters=[@p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [BranchSpecializations] ([BranchId], [SpecializationId])
VALUES (@p4, @p5);
2025-11-24 01:43:01.695 +02:00 [INF] Executed DbCommand (12ms) [Parameters=[@p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [BranchSpecializations] ([BranchId], [SpecializationId])
VALUES (@p4, @p5);
2025-11-24 01:43:01.697 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:43:01.697 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 01:43:01.701 +02:00 [DBG] Committing transaction.
2025-11-24 01:43:01.704 +02:00 [DBG] Committed transaction.
2025-11-24 01:43:01.707 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:43:01.710 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (2ms).
2025-11-24 01:43:01.713 +02:00 [DBG] Disposing transaction.
2025-11-24 01:43:01.715 +02:00 [DBG] An entity of type 'Specialization' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:43:01.716 +02:00 [DBG] An entity of type 'BranchSpecialization' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:43:01.720 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 2 entities written to the database.
2025-11-24 01:43:01.721 +02:00 [INF] Specialization 'legg' added successfully
2025-11-24 01:43:01.728 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:43:01.730 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:43:01.731 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:43:01.731 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:43:01.732 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 01:43:01.733 +02:00 [INF] Executing CreatedAtActionResult, writing value of type 'Hospital.Application.DTO.Specialization.SpecializationDTO'.
2025-11-24 01:43:01.735 +02:00 [DBG] Found the endpoints ["Hospital.Controllers.SpecializationsController.Get (Hospital)"] for address (id=[1],action=[Get],controller=[Specializations])
2025-11-24 01:43:01.737 +02:00 [DBG] Successfully processed template api/Specializations/Get/{id} for Hospital.Controllers.SpecializationsController.Get (Hospital) resulting in /api/Specializations/Get/1 and 
2025-11-24 01:43:01.738 +02:00 [DBG] Link generation succeeded for endpoints ["Hospital.Controllers.SpecializationsController.Get (Hospital)"] with result /api/Specializations/Get/1
2025-11-24 01:43:01.743 +02:00 [INF] Executed action Hospital.Controllers.SpecializationsController.Create (Hospital) in 434.9212ms
2025-11-24 01:43:01.745 +02:00 [INF] Executed endpoint 'Hospital.Controllers.SpecializationsController.Create (Hospital)'
2025-11-24 01:43:01.746 +02:00 [DBG] Connection id "0HNHAT4T4JIFL" completed keep alive response.
2025-11-24 01:43:01.747 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:43:01.748 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:43:01.749 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 01:43:01.750 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Specializations/Create - 201 null application/json; charset=utf-8 476.7198ms
2025-11-24 01:43:08.102 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Specializations/Get/6 - null null
2025-11-24 01:43:08.105 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Specializations/Get/6'
2025-11-24 01:43:08.109 +02:00 [DBG] Endpoint 'Hospital.Controllers.SpecializationsController.Get (Hospital)' with route pattern 'api/Specializations/Get/{id}' is valid for the request path '/api/Specializations/Get/6'
2025-11-24 01:43:08.112 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.SpecializationsController.Get (Hospital)'
2025-11-24 01:43:08.113 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:43:08.114 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:43:08.114 +02:00 [INF] Executing endpoint 'Hospital.Controllers.SpecializationsController.Get (Hospital)'
2025-11-24 01:43:08.119 +02:00 [INF] Route matched with {action = "Get", controller = "Specializations"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Hospital.Application.DTO.Specialization.SpecializationDTO]] Get(Int32) on controller Hospital.Controllers.SpecializationsController (Hospital).
2025-11-24 01:43:08.119 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:43:08.120 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:43:08.121 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:43:08.121 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:43:08.122 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:43:08.122 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.SpecializationsController (Hospital)
2025-11-24 01:43:08.124 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.SpecializationsController (Hospital)
2025-11-24 01:43:08.125 +02:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-11-24 01:43:08.125 +02:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-11-24 01:43:08.126 +02:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-11-24 01:43:08.127 +02:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-11-24 01:43:08.129 +02:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-11-24 01:43:08.130 +02:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-11-24 01:43:08.131 +02:00 [INF] get Specialization by id called at "2025-11-24T01:43:08.1318518+02:00"
2025-11-24 01:43:08.132 +02:00 [INF] Fetching specialization with ID 6
2025-11-24 01:43:08.135 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:43:08.136 +02:00 [DBG] Compiling query expression: 
'DbSet<Specialization>()
    .Include(s => s.Branches)
    .Include(s => s.Doctors)
    .ThenInclude(d => d.User)
    .FirstOrDefault(s => s.SpecializationId == __id_0)'
2025-11-24 01:43:08.138 +02:00 [DBG] Including navigation: 'Specialization.Branches'.
2025-11-24 01:43:08.138 +02:00 [DBG] Including navigation: 'Specialization.Doctors'.
2025-11-24 01:43:08.139 +02:00 [DBG] Including navigation: 'Doctor.User'.
2025-11-24 01:43:08.155 +02:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-11-24 01:43:08.159 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Specialization>(
    asyncEnumerable: new SingleQueryingEnumerable<Specialization>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Specialization.SpecializationId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Specialization.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: Specialization.Description (string), 2], [Property: Specialization.Name (string) Required MaxLength(120), 3], [Property: Specialization.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 4] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: BranchSpecialization (Dictionary<string, object>).BranchId (no field, int) Indexer Required PK FK AfterSave:Throw, 5], [Property: BranchSpecialization (Dictionary<string, object>).SpecializationId (no field, int) Indexer Required PK FK Index AfterSave:Throw, 6] }
                3 -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Branch.Address (string) MaxLength(250), 8], [Property: Branch.BranchName (string) Required MaxLength(150), 9], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 10], [Property: Branch.Description (string), 11], [Property: Branch.Email (string) MaxLength(200), 12], [Property: Branch.ImageURL (string) MaxLength(300), 13], [Property: Branch.Phone (string) MaxLength(25), 14], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 15] }
                4 -> 5
                5 -> 6
                6 -> 7
                7 -> Dictionary<IProperty, int> { [Property: Doctor.DoctorId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 16], [Property: Doctor.Available (bool?), 17], [Property: Doctor.Biography (string), 18], [Property: Doctor.ConsultationFees (decimal) Required, 19], [Property: Doctor.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 20], [Property: Doctor.ExperienceYears (int?), 21], [Property: Doctor.ImageURL (string) MaxLength(300), 22], [Property: Doctor.SpecializationId (int) Required FK Index, 23], [Property: Doctor.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 24], [Property: Doctor.UserId (string) Required FK Index, 25] }
                8 -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 26], [Property: User.AccessFailedCount (int) Required, 27], [Property: User.ConcurrencyStamp (string) Concurrency, 28], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 29], [Property: User.DateOfBirth (DateOnly?), 30], [Property: User.Email (string) Index MaxLength(256), 31], [Property: User.EmailConfirmed (bool) Required, 32], [Property: User.FullName (string) Required MaxLength(150), 33], [Property: User.Gender (GenderType?) MaxLength(10), 34], [Property: User.LockoutEnabled (bool) Required, 35], [Property: User.LockoutEnd (DateTimeOffset?), 36], [Property: User.NormalizedEmail (string) Index MaxLength(256), 37], [Property: User.NormalizedUserName (string) Index MaxLength(256), 38], [Property: User.PasswordHash (string), 39], [Property: User.PhoneNumber (string), 40], [Property: User.PhoneNumberConfirmed (bool) Required, 41], [Property: User.RefreshToken (string), 42], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 43], [Property: User.Role (string) Required MaxLength(50), 44], [Property: User.SecurityStamp (string), 45], [Property: User.TwoFactorEnabled (bool) Required, 46], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 47], [Property: User.UserName (string) MaxLength(256), 48] }
                9 -> 16
                10 -> 26
            SELECT t.SpecializationId, t.CreatedAt, t.Description, t.Name, t.UpdatedAt, t0.BranchId, t0.SpecializationId, t0.BranchId0, t0.Address, t0.BranchName, t0.CreatedAt, t0.Description, t0.Email, t0.ImageURL, t0.Phone, t0.UpdatedAt, t1.DoctorId, t1.Available, t1.Biography, t1.ConsultationFees, t1.CreatedAt, t1.ExperienceYears, t1.ImageURL, t1.SpecializationId, t1.UpdatedAt, t1.UserId, t1.Id, t1.AccessFailedCount, t1.ConcurrencyStamp, t1.CreatedAt0, t1.DateOfBirth, t1.Email, t1.EmailConfirmed, t1.FullName, t1.Gender, t1.LockoutEnabled, t1.LockoutEnd, t1.NormalizedEmail, t1.NormalizedUserName, t1.PasswordHash, t1.PhoneNumber, t1.PhoneNumberConfirmed, t1.RefreshToken, t1.RefreshTokenExpiryTime, t1.Role, t1.SecurityStamp, t1.TwoFactorEnabled, t1.UpdatedAt0, t1.UserName
            FROM 
            (
                SELECT TOP(1) s.SpecializationId, s.CreatedAt, s.Description, s.Name, s.UpdatedAt
                FROM Specializations AS s
                WHERE s.SpecializationId == @__id_0
            ) AS t
            LEFT JOIN 
            (
                SELECT b.BranchId, b.SpecializationId, b0.BranchId AS BranchId0, b0.Address, b0.BranchName, b0.CreatedAt, b0.Description, b0.Email, b0.ImageURL, b0.Phone, b0.UpdatedAt
                FROM BranchSpecializations AS b
                INNER JOIN Branches AS b0 ON b.BranchId == b0.BranchId
            ) AS t0 ON t.SpecializationId == t0.SpecializationId
            LEFT JOIN 
            (
                SELECT d.DoctorId, d.Available, d.Biography, d.ConsultationFees, d.CreatedAt, d.ExperienceYears, d.ImageURL, d.SpecializationId, d.UpdatedAt, d.UserId, u.Id, u.AccessFailedCount, u.ConcurrencyStamp, u.CreatedAt AS CreatedAt0, u.DateOfBirth, u.Email, u.EmailConfirmed, u.FullName, u.Gender, u.LockoutEnabled, u.LockoutEnd, u.NormalizedEmail, u.NormalizedUserName, u.PasswordHash, u.PhoneNumber, u.PhoneNumberConfirmed, u.RefreshToken, u.RefreshTokenExpiryTime, u.Role, u.SecurityStamp, u.TwoFactorEnabled, u.UpdatedAt AS UpdatedAt0, u.UserName
                FROM Doctors AS d
                INNER JOIN Users AS u ON d.UserId == u.Id
            ) AS t1 ON t.SpecializationId == t1.SpecializationId
            ORDER BY t.SpecializationId ASC, t0.BranchId ASC, t0.SpecializationId ASC, t0.BranchId0 ASC, t1.DoctorId ASC), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Specialization>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 01:43:08.179 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:43:08.183 +02:00 [DBG] Created DbConnection. (3ms).
2025-11-24 01:43:08.186 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:43:08.193 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:43:08.198 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:43:08.204 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (6ms).
2025-11-24 01:43:08.206 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (8ms).
2025-11-24 01:43:08.207 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[SpecializationId], [t].[CreatedAt], [t].[Description], [t].[Name], [t].[UpdatedAt], [t0].[BranchId], [t0].[SpecializationId], [t0].[BranchId0], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [t1].[DoctorId], [t1].[Available], [t1].[Biography], [t1].[ConsultationFees], [t1].[CreatedAt], [t1].[ExperienceYears], [t1].[ImageURL], [t1].[SpecializationId], [t1].[UpdatedAt], [t1].[UserId], [t1].[Id], [t1].[AccessFailedCount], [t1].[ConcurrencyStamp], [t1].[CreatedAt0], [t1].[DateOfBirth], [t1].[Email], [t1].[EmailConfirmed], [t1].[FullName], [t1].[Gender], [t1].[LockoutEnabled], [t1].[LockoutEnd], [t1].[NormalizedEmail], [t1].[NormalizedUserName], [t1].[PasswordHash], [t1].[PhoneNumber], [t1].[PhoneNumberConfirmed], [t1].[RefreshToken], [t1].[RefreshTokenExpiryTime], [t1].[Role], [t1].[SecurityStamp], [t1].[TwoFactorEnabled], [t1].[UpdatedAt0], [t1].[UserName]
FROM (
    SELECT TOP(1) [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt]
    FROM [Specializations] AS [s]
    WHERE [s].[SpecializationId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [b].[BranchId], [b].[SpecializationId], [b0].[BranchId] AS [BranchId0], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [BranchSpecializations] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
) AS [t0] ON [t].[SpecializationId] = [t0].[SpecializationId]
LEFT JOIN (
    SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
) AS [t1] ON [t].[SpecializationId] = [t1].[SpecializationId]
ORDER BY [t].[SpecializationId], [t0].[BranchId], [t0].[SpecializationId], [t0].[BranchId0], [t1].[DoctorId]
2025-11-24 01:43:08.237 +02:00 [INF] Executed DbCommand (30ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[SpecializationId], [t].[CreatedAt], [t].[Description], [t].[Name], [t].[UpdatedAt], [t0].[BranchId], [t0].[SpecializationId], [t0].[BranchId0], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [t1].[DoctorId], [t1].[Available], [t1].[Biography], [t1].[ConsultationFees], [t1].[CreatedAt], [t1].[ExperienceYears], [t1].[ImageURL], [t1].[SpecializationId], [t1].[UpdatedAt], [t1].[UserId], [t1].[Id], [t1].[AccessFailedCount], [t1].[ConcurrencyStamp], [t1].[CreatedAt0], [t1].[DateOfBirth], [t1].[Email], [t1].[EmailConfirmed], [t1].[FullName], [t1].[Gender], [t1].[LockoutEnabled], [t1].[LockoutEnd], [t1].[NormalizedEmail], [t1].[NormalizedUserName], [t1].[PasswordHash], [t1].[PhoneNumber], [t1].[PhoneNumberConfirmed], [t1].[RefreshToken], [t1].[RefreshTokenExpiryTime], [t1].[Role], [t1].[SecurityStamp], [t1].[TwoFactorEnabled], [t1].[UpdatedAt0], [t1].[UserName]
FROM (
    SELECT TOP(1) [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt]
    FROM [Specializations] AS [s]
    WHERE [s].[SpecializationId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [b].[BranchId], [b].[SpecializationId], [b0].[BranchId] AS [BranchId0], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [BranchSpecializations] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
) AS [t0] ON [t].[SpecializationId] = [t0].[SpecializationId]
LEFT JOIN (
    SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
) AS [t1] ON [t].[SpecializationId] = [t1].[SpecializationId]
ORDER BY [t].[SpecializationId], [t0].[BranchId], [t0].[SpecializationId], [t0].[BranchId0], [t1].[DoctorId]
2025-11-24 01:43:08.244 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:43:08.249 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 4ms reading results.
2025-11-24 01:43:08.253 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:43:08.255 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 01:43:08.257 +02:00 [WRN] Specialization with ID 6 not found
2025-11-24 01:43:08.259 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:43:08.261 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:43:08.263 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:43:08.265 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:43:08.265 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter' and content type '' to write the response.
2025-11-24 01:43:08.266 +02:00 [INF] Executing OkObjectResult, writing value of type 'null'.
2025-11-24 01:43:08.267 +02:00 [INF] Executed action Hospital.Controllers.SpecializationsController.Get (Hospital) in 144.6422ms
2025-11-24 01:43:08.269 +02:00 [INF] Executed endpoint 'Hospital.Controllers.SpecializationsController.Get (Hospital)'
2025-11-24 01:43:08.270 +02:00 [DBG] Connection id "0HNHAT4T4JIFL" completed keep alive response.
2025-11-24 01:43:08.270 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:43:08.271 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:43:08.271 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 01:43:08.272 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Specializations/Get/6 - 204 null null 170.0646ms
2025-11-24 01:45:19.328 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/swagger/index.html - null null
2025-11-24 01:45:19.349 +02:00 [DBG] No candidates found for the request path '/swagger/index.html'
2025-11-24 01:45:19.351 +02:00 [DBG] Request did not match any endpoints
2025-11-24 01:45:19.353 +02:00 [DBG] Response markup is scheduled to include Browser Link script injection.
2025-11-24 01:45:19.358 +02:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2025-11-24 01:45:19.365 +02:00 [DBG] Response markup was updated to include Browser Link script injection.
2025-11-24 01:45:19.374 +02:00 [DBG] Response markup was updated to include browser refresh script injection.
2025-11-24 01:45:19.376 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/swagger/index.html - 200 null text/html;charset=utf-8 47.8839ms
2025-11-24 01:45:19.398 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/_vs/browserLink - null null
2025-11-24 01:45:19.401 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/_framework/aspnetcore-browser-refresh.js - null null
2025-11-24 01:45:19.417 +02:00 [DBG] Script injected: /_framework/aspnetcore-browser-refresh.js
2025-11-24 01:45:19.428 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/_framework/aspnetcore-browser-refresh.js - 200 16501 application/javascript; charset=utf-8 27.1193ms
2025-11-24 01:45:19.446 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/_vs/browserLink - 200 null text/javascript; charset=UTF-8 48.4634ms
2025-11-24 01:45:19.586 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/swagger/v1/swagger.json - null null
2025-11-24 01:45:19.595 +02:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2025-11-24 01:45:19.596 +02:00 [DBG] Request did not match any endpoints
2025-11-24 01:45:19.657 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 71.0827ms
2025-11-24 01:45:25.683 +02:00 [DBG] Connection id "0HNHAT4T4JIFM" accepted.
2025-11-24 01:45:25.683 +02:00 [DBG] Connection id "0HNHAT4T4JIFM" received FIN.
2025-11-24 01:45:25.686 +02:00 [DBG] Connection id "0HNHAT4T4JIFM" started.
2025-11-24 01:45:25.688 +02:00 [DBG] Connection id "0HNHAT4T4JIFN" accepted.
2025-11-24 01:45:25.696 +02:00 [DBG] Connection id "0HNHAT4T4JIFN" started.
2025-11-24 01:45:25.694 +02:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-11-24 01:45:25.707 +02:00 [DBG] Connection 0HNHAT4T4JIFN established using the following protocol: "Tls12"
2025-11-24 01:45:25.709 +02:00 [DBG] Connection id "0HNHAT4T4JIFM" stopped.
2025-11-24 01:45:25.712 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Specializations/Get/6 - null null
2025-11-24 01:45:25.714 +02:00 [DBG] Connection id "0HNHAT4T4JIFM" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-11-24 01:45:25.718 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Specializations/Get/6'
2025-11-24 01:45:25.722 +02:00 [DBG] Endpoint 'Hospital.Controllers.SpecializationsController.Get (Hospital)' with route pattern 'api/Specializations/Get/{id}' is valid for the request path '/api/Specializations/Get/6'
2025-11-24 01:45:25.725 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.SpecializationsController.Get (Hospital)'
2025-11-24 01:45:25.726 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:45:25.728 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:45:25.730 +02:00 [INF] Executing endpoint 'Hospital.Controllers.SpecializationsController.Get (Hospital)'
2025-11-24 01:45:25.737 +02:00 [INF] Route matched with {action = "Get", controller = "Specializations"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Hospital.Application.DTO.Specialization.SpecializationDTO]] Get(Int32) on controller Hospital.Controllers.SpecializationsController (Hospital).
2025-11-24 01:45:25.745 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:45:25.748 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:45:25.752 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:45:25.757 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:45:25.759 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:45:25.761 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.SpecializationsController (Hospital)
2025-11-24 01:45:25.761 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.SpecializationsController (Hospital)
2025-11-24 01:45:25.763 +02:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-11-24 01:45:25.765 +02:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-11-24 01:45:25.767 +02:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-11-24 01:45:25.768 +02:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-11-24 01:45:25.770 +02:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-11-24 01:45:25.772 +02:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-11-24 01:45:25.773 +02:00 [INF] get Specialization by id called at "2025-11-24T01:45:25.7738461+02:00"
2025-11-24 01:45:25.775 +02:00 [INF] Fetching specialization with ID 6
2025-11-24 01:45:25.777 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:45:25.779 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:45:25.780 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 01:45:25.780 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:45:25.781 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:45:25.782 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:45:25.783 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:45:25.785 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-11-24 01:45:25.787 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[SpecializationId], [t].[CreatedAt], [t].[Description], [t].[Name], [t].[UpdatedAt], [t0].[BranchId], [t0].[SpecializationId], [t0].[BranchId0], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [t1].[DoctorId], [t1].[Available], [t1].[Biography], [t1].[ConsultationFees], [t1].[CreatedAt], [t1].[ExperienceYears], [t1].[ImageURL], [t1].[SpecializationId], [t1].[UpdatedAt], [t1].[UserId], [t1].[Id], [t1].[AccessFailedCount], [t1].[ConcurrencyStamp], [t1].[CreatedAt0], [t1].[DateOfBirth], [t1].[Email], [t1].[EmailConfirmed], [t1].[FullName], [t1].[Gender], [t1].[LockoutEnabled], [t1].[LockoutEnd], [t1].[NormalizedEmail], [t1].[NormalizedUserName], [t1].[PasswordHash], [t1].[PhoneNumber], [t1].[PhoneNumberConfirmed], [t1].[RefreshToken], [t1].[RefreshTokenExpiryTime], [t1].[Role], [t1].[SecurityStamp], [t1].[TwoFactorEnabled], [t1].[UpdatedAt0], [t1].[UserName]
FROM (
    SELECT TOP(1) [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt]
    FROM [Specializations] AS [s]
    WHERE [s].[SpecializationId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [b].[BranchId], [b].[SpecializationId], [b0].[BranchId] AS [BranchId0], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [BranchSpecializations] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
) AS [t0] ON [t].[SpecializationId] = [t0].[SpecializationId]
LEFT JOIN (
    SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
) AS [t1] ON [t].[SpecializationId] = [t1].[SpecializationId]
ORDER BY [t].[SpecializationId], [t0].[BranchId], [t0].[SpecializationId], [t0].[BranchId0], [t1].[DoctorId]
2025-11-24 01:45:25.804 +02:00 [INF] Executed DbCommand (18ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[SpecializationId], [t].[CreatedAt], [t].[Description], [t].[Name], [t].[UpdatedAt], [t0].[BranchId], [t0].[SpecializationId], [t0].[BranchId0], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [t1].[DoctorId], [t1].[Available], [t1].[Biography], [t1].[ConsultationFees], [t1].[CreatedAt], [t1].[ExperienceYears], [t1].[ImageURL], [t1].[SpecializationId], [t1].[UpdatedAt], [t1].[UserId], [t1].[Id], [t1].[AccessFailedCount], [t1].[ConcurrencyStamp], [t1].[CreatedAt0], [t1].[DateOfBirth], [t1].[Email], [t1].[EmailConfirmed], [t1].[FullName], [t1].[Gender], [t1].[LockoutEnabled], [t1].[LockoutEnd], [t1].[NormalizedEmail], [t1].[NormalizedUserName], [t1].[PasswordHash], [t1].[PhoneNumber], [t1].[PhoneNumberConfirmed], [t1].[RefreshToken], [t1].[RefreshTokenExpiryTime], [t1].[Role], [t1].[SecurityStamp], [t1].[TwoFactorEnabled], [t1].[UpdatedAt0], [t1].[UserName]
FROM (
    SELECT TOP(1) [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt]
    FROM [Specializations] AS [s]
    WHERE [s].[SpecializationId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [b].[BranchId], [b].[SpecializationId], [b0].[BranchId] AS [BranchId0], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [BranchSpecializations] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
) AS [t0] ON [t].[SpecializationId] = [t0].[SpecializationId]
LEFT JOIN (
    SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
) AS [t1] ON [t].[SpecializationId] = [t1].[SpecializationId]
ORDER BY [t].[SpecializationId], [t0].[BranchId], [t0].[SpecializationId], [t0].[BranchId0], [t1].[DoctorId]
2025-11-24 01:45:25.808 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:45:25.809 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 01:45:25.810 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:45:25.811 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:45:25.812 +02:00 [WRN] Specialization with ID 6 not found
2025-11-24 01:45:25.872 +02:00 [INF] Executed action Hospital.Controllers.SpecializationsController.Get (Hospital) in 111.0131ms
2025-11-24 01:45:25.874 +02:00 [INF] Executed endpoint 'Hospital.Controllers.SpecializationsController.Get (Hospital)'
2025-11-24 01:45:25.947 +02:00 [ERR]  Exception caught: Specialization Not Found.
System.Collections.Generic.KeyNotFoundException: Specialization Not Found.
   at Hospital.Infrastructure.Services.SpecializationService.GetAsync(Int32 id)
   at Hospital.Controllers.SpecializationsController.Get(Int32 id) in D:\Walaa\GP\Hospital\Hospital\Controllers\SpecializationsController.cs:line 109
   at lambda_method664(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
2025-11-24 01:45:25.969 +02:00 [DBG] Connection id "0HNHAT4T4JIFN" completed keep alive response.
2025-11-24 01:45:25.971 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:45:25.975 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:45:25.979 +02:00 [DBG] Disposed connection to database '' on server '' (3ms).
2025-11-24 01:45:25.981 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Specializations/Get/6 - 404 null application/json 269.7907ms
2025-11-24 01:45:32.797 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Specializations/Get/1 - null null
2025-11-24 01:45:32.801 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Specializations/Get/1'
2025-11-24 01:45:32.803 +02:00 [DBG] Endpoint 'Hospital.Controllers.SpecializationsController.Get (Hospital)' with route pattern 'api/Specializations/Get/{id}' is valid for the request path '/api/Specializations/Get/1'
2025-11-24 01:45:32.804 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.SpecializationsController.Get (Hospital)'
2025-11-24 01:45:32.805 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:45:32.806 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:45:32.806 +02:00 [INF] Executing endpoint 'Hospital.Controllers.SpecializationsController.Get (Hospital)'
2025-11-24 01:45:32.807 +02:00 [INF] Route matched with {action = "Get", controller = "Specializations"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Hospital.Application.DTO.Specialization.SpecializationDTO]] Get(Int32) on controller Hospital.Controllers.SpecializationsController (Hospital).
2025-11-24 01:45:32.809 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:45:32.810 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:45:32.814 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:45:32.816 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:45:32.817 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:45:32.818 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.SpecializationsController (Hospital)
2025-11-24 01:45:32.819 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.SpecializationsController (Hospital)
2025-11-24 01:45:32.822 +02:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-11-24 01:45:32.823 +02:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-11-24 01:45:32.825 +02:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-11-24 01:45:32.826 +02:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-11-24 01:45:32.827 +02:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-11-24 01:45:32.828 +02:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-11-24 01:45:32.829 +02:00 [INF] get Specialization by id called at "2025-11-24T01:45:32.8292592+02:00"
2025-11-24 01:45:32.829 +02:00 [INF] Fetching specialization with ID 1
2025-11-24 01:45:32.830 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:45:32.832 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:45:32.833 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 01:45:32.833 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:45:32.834 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:45:32.835 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:45:32.837 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:45:32.837 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:45:32.838 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[SpecializationId], [t].[CreatedAt], [t].[Description], [t].[Name], [t].[UpdatedAt], [t0].[BranchId], [t0].[SpecializationId], [t0].[BranchId0], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [t1].[DoctorId], [t1].[Available], [t1].[Biography], [t1].[ConsultationFees], [t1].[CreatedAt], [t1].[ExperienceYears], [t1].[ImageURL], [t1].[SpecializationId], [t1].[UpdatedAt], [t1].[UserId], [t1].[Id], [t1].[AccessFailedCount], [t1].[ConcurrencyStamp], [t1].[CreatedAt0], [t1].[DateOfBirth], [t1].[Email], [t1].[EmailConfirmed], [t1].[FullName], [t1].[Gender], [t1].[LockoutEnabled], [t1].[LockoutEnd], [t1].[NormalizedEmail], [t1].[NormalizedUserName], [t1].[PasswordHash], [t1].[PhoneNumber], [t1].[PhoneNumberConfirmed], [t1].[RefreshToken], [t1].[RefreshTokenExpiryTime], [t1].[Role], [t1].[SecurityStamp], [t1].[TwoFactorEnabled], [t1].[UpdatedAt0], [t1].[UserName]
FROM (
    SELECT TOP(1) [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt]
    FROM [Specializations] AS [s]
    WHERE [s].[SpecializationId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [b].[BranchId], [b].[SpecializationId], [b0].[BranchId] AS [BranchId0], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [BranchSpecializations] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
) AS [t0] ON [t].[SpecializationId] = [t0].[SpecializationId]
LEFT JOIN (
    SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
) AS [t1] ON [t].[SpecializationId] = [t1].[SpecializationId]
ORDER BY [t].[SpecializationId], [t0].[BranchId], [t0].[SpecializationId], [t0].[BranchId0], [t1].[DoctorId]
2025-11-24 01:45:32.842 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[SpecializationId], [t].[CreatedAt], [t].[Description], [t].[Name], [t].[UpdatedAt], [t0].[BranchId], [t0].[SpecializationId], [t0].[BranchId0], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [t1].[DoctorId], [t1].[Available], [t1].[Biography], [t1].[ConsultationFees], [t1].[CreatedAt], [t1].[ExperienceYears], [t1].[ImageURL], [t1].[SpecializationId], [t1].[UpdatedAt], [t1].[UserId], [t1].[Id], [t1].[AccessFailedCount], [t1].[ConcurrencyStamp], [t1].[CreatedAt0], [t1].[DateOfBirth], [t1].[Email], [t1].[EmailConfirmed], [t1].[FullName], [t1].[Gender], [t1].[LockoutEnabled], [t1].[LockoutEnd], [t1].[NormalizedEmail], [t1].[NormalizedUserName], [t1].[PasswordHash], [t1].[PhoneNumber], [t1].[PhoneNumberConfirmed], [t1].[RefreshToken], [t1].[RefreshTokenExpiryTime], [t1].[Role], [t1].[SecurityStamp], [t1].[TwoFactorEnabled], [t1].[UpdatedAt0], [t1].[UserName]
FROM (
    SELECT TOP(1) [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt]
    FROM [Specializations] AS [s]
    WHERE [s].[SpecializationId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [b].[BranchId], [b].[SpecializationId], [b0].[BranchId] AS [BranchId0], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [BranchSpecializations] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
) AS [t0] ON [t].[SpecializationId] = [t0].[SpecializationId]
LEFT JOIN (
    SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
) AS [t1] ON [t].[SpecializationId] = [t1].[SpecializationId]
ORDER BY [t].[SpecializationId], [t0].[BranchId], [t0].[SpecializationId], [t0].[BranchId0], [t1].[DoctorId]
2025-11-24 01:45:32.850 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:45:32.856 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchSpecialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:45:32.856 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:45:32.859 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:45:32.860 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 11ms reading results.
2025-11-24 01:45:32.861 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:45:32.862 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:45:32.863 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:45:32.864 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:45:32.865 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:45:32.865 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:45:32.866 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 01:45:32.866 +02:00 [INF] Executing OkObjectResult, writing value of type 'Hospital.Application.DTO.Specialization.SpecializationDTO'.
2025-11-24 01:45:32.869 +02:00 [INF] Executed action Hospital.Controllers.SpecializationsController.Get (Hospital) in 50.7667ms
2025-11-24 01:45:32.870 +02:00 [INF] Executed endpoint 'Hospital.Controllers.SpecializationsController.Get (Hospital)'
2025-11-24 01:45:32.871 +02:00 [DBG] Connection id "0HNHAT4T4JIFN" completed keep alive response.
2025-11-24 01:45:32.872 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:45:32.872 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:45:32.875 +02:00 [DBG] Disposed connection to database '' on server '' (2ms).
2025-11-24 01:45:32.877 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Specializations/Get/1 - 200 null application/json; charset=utf-8 80.3781ms
2025-11-24 01:45:51.757 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Doctor/add - application/json 370
2025-11-24 01:45:51.762 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/add'
2025-11-24 01:45:51.765 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.AddDoctor (Hospital)' with route pattern 'api/Doctor/add' is valid for the request path '/api/Doctor/add'
2025-11-24 01:45:51.768 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.AddDoctor (Hospital)'
2025-11-24 01:45:51.769 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:45:51.770 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:45:51.770 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.AddDoctor (Hospital)'
2025-11-24 01:45:51.775 +02:00 [INF] Route matched with {action = "AddDoctor", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddDoctor(Hospital.Application.DTO.Doctor.AddDoctorDto) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 01:45:51.781 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:45:51.782 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:45:51.782 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:45:51.786 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:45:51.788 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:45:51.789 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 01:45:51.801 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 01:45:51.805 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.AddDoctorDto' ...
2025-11-24 01:45:51.809 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.AddDoctorDto' using the name '' in request data ...
2025-11-24 01:45:51.812 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 01:45:51.829 +02:00 [DBG] Connection id "0HNHAT4T4JIFN", Request id "0HNHAT4T4JIFN:00000003": started reading request body.
2025-11-24 01:45:51.831 +02:00 [DBG] Connection id "0HNHAT4T4JIFN", Request id "0HNHAT4T4JIFN:00000003": done reading request body.
2025-11-24 01:45:51.839 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Doctor.AddDoctorDto'
2025-11-24 01:45:51.841 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.AddDoctorDto'.
2025-11-24 01:45:51.841 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.AddDoctorDto'.
2025-11-24 01:45:51.844 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Doctor.AddDoctorDto' ...
2025-11-24 01:45:51.850 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Doctor.AddDoctorDto'.
2025-11-24 01:45:51.855 +02:00 [INF] add doctor called at "2025-11-24T01:45:51.8555272+02:00"
2025-11-24 01:45:51.861 +02:00 [INF] Adding new doctor: Walaa, Email: walaa.elbishl8awy1@gmail
2025-11-24 01:45:51.865 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:45:51.874 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:45:51.876 +02:00 [DBG] Created DbConnection. (1ms).
2025-11-24 01:45:51.880 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:45:51.886 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:45:51.887 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 01:45:51.889 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 01:45:51.915 +02:00 [DBG] Compiling query expression: 
'DbSet<Specialization>()
    .FirstOrDefault(e => EF.Property<int>(e, "SpecializationId") == __p_0)'
2025-11-24 01:45:51.922 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Specialization>(
    asyncEnumerable: new SingleQueryingEnumerable<Specialization>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Specialization.SpecializationId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Specialization.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: Specialization.Description (string), 2], [Property: Specialization.Name (string) Required MaxLength(120), 3], [Property: Specialization.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 4] }
            SELECT TOP(1) s.SpecializationId, s.CreatedAt, s.Description, s.Name, s.UpdatedAt
            FROM Specializations AS s
            WHERE s.SpecializationId == @__p_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Specialization>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 01:45:51.929 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:45:51.930 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:45:51.931 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:45:51.932 +02:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt]
FROM [Specializations] AS [s]
WHERE [s].[SpecializationId] = @__p_0
2025-11-24 01:45:51.936 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt]
FROM [Specializations] AS [s]
WHERE [s].[SpecializationId] = @__p_0
2025-11-24 01:45:51.938 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:45:51.939 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:45:51.941 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 3ms reading results.
2025-11-24 01:45:51.955 +02:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(u => u.NormalizedEmail == __normalizedEmail_0)'
2025-11-24 01:45:51.963 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: new SingleQueryingEnumerable<User>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 0], [Property: User.AccessFailedCount (int) Required, 1], [Property: User.ConcurrencyStamp (string) Concurrency, 2], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 3], [Property: User.DateOfBirth (DateOnly?), 4], [Property: User.Email (string) Index MaxLength(256), 5], [Property: User.EmailConfirmed (bool) Required, 6], [Property: User.FullName (string) Required MaxLength(150), 7], [Property: User.Gender (GenderType?) MaxLength(10), 8], [Property: User.LockoutEnabled (bool) Required, 9], [Property: User.LockoutEnd (DateTimeOffset?), 10], [Property: User.NormalizedEmail (string) Index MaxLength(256), 11], [Property: User.NormalizedUserName (string) Index MaxLength(256), 12], [Property: User.PasswordHash (string), 13], [Property: User.PhoneNumber (string), 14], [Property: User.PhoneNumberConfirmed (bool) Required, 15], [Property: User.RefreshToken (string), 16], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 17], [Property: User.Role (string) Required MaxLength(50), 18], [Property: User.SecurityStamp (string), 19], [Property: User.TwoFactorEnabled (bool) Required, 20], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 21], [Property: User.UserName (string) MaxLength(256), 22] }
            SELECT TOP(2) u.Id, u.AccessFailedCount, u.ConcurrencyStamp, u.CreatedAt, u.DateOfBirth, u.Email, u.EmailConfirmed, u.FullName, u.Gender, u.LockoutEnabled, u.LockoutEnd, u.NormalizedEmail, u.NormalizedUserName, u.PasswordHash, u.PhoneNumber, u.PhoneNumberConfirmed, u.RefreshToken, u.RefreshTokenExpiryTime, u.Role, u.SecurityStamp, u.TwoFactorEnabled, u.UpdatedAt, u.UserName
            FROM Users AS u
            WHERE u.NormalizedEmail == @__normalizedEmail_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 01:45:51.969 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:45:51.970 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:45:51.971 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:45:51.972 +02:00 [DBG] Executing DbCommand [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedEmail] = @__normalizedEmail_0
2025-11-24 01:45:51.979 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedEmail] = @__normalizedEmail_0
2025-11-24 01:45:51.983 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:45:51.984 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 01:45:51.990 +02:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(u => u.NormalizedUserName == __normalizedUserName_0)'
2025-11-24 01:45:51.996 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: new SingleQueryingEnumerable<User>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 0], [Property: User.AccessFailedCount (int) Required, 1], [Property: User.ConcurrencyStamp (string) Concurrency, 2], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 3], [Property: User.DateOfBirth (DateOnly?), 4], [Property: User.Email (string) Index MaxLength(256), 5], [Property: User.EmailConfirmed (bool) Required, 6], [Property: User.FullName (string) Required MaxLength(150), 7], [Property: User.Gender (GenderType?) MaxLength(10), 8], [Property: User.LockoutEnabled (bool) Required, 9], [Property: User.LockoutEnd (DateTimeOffset?), 10], [Property: User.NormalizedEmail (string) Index MaxLength(256), 11], [Property: User.NormalizedUserName (string) Index MaxLength(256), 12], [Property: User.PasswordHash (string), 13], [Property: User.PhoneNumber (string), 14], [Property: User.PhoneNumberConfirmed (bool) Required, 15], [Property: User.RefreshToken (string), 16], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 17], [Property: User.Role (string) Required MaxLength(50), 18], [Property: User.SecurityStamp (string), 19], [Property: User.TwoFactorEnabled (bool) Required, 20], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 21], [Property: User.UserName (string) MaxLength(256), 22] }
            SELECT TOP(1) u.Id, u.AccessFailedCount, u.ConcurrencyStamp, u.CreatedAt, u.DateOfBirth, u.Email, u.EmailConfirmed, u.FullName, u.Gender, u.LockoutEnabled, u.LockoutEnd, u.NormalizedEmail, u.NormalizedUserName, u.PasswordHash, u.PhoneNumber, u.PhoneNumberConfirmed, u.RefreshToken, u.RefreshTokenExpiryTime, u.Role, u.SecurityStamp, u.TwoFactorEnabled, u.UpdatedAt, u.UserName
            FROM Users AS u
            WHERE u.NormalizedUserName == @__normalizedUserName_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 01:45:51.998 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:45:51.999 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:45:52.001 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:45:52.002 +02:00 [DBG] Executing DbCommand [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0
2025-11-24 01:45:52.008 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0
2025-11-24 01:45:52.011 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:45:52.011 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 01:45:52.016 +02:00 [DBG] Compiling query expression: 
'DbSet<IdentityRole>()
    .FirstOrDefault(r => r.NormalizedName == __normalizedName_0)'
2025-11-24 01:45:52.021 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<IdentityRole>(
    asyncEnumerable: new SingleQueryingEnumerable<IdentityRole>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: IdentityRole.Id (string) Required PK AfterSave:Throw, 0], [Property: IdentityRole.ConcurrencyStamp (string) Concurrency, 1], [Property: IdentityRole.Name (string) MaxLength(256), 2], [Property: IdentityRole.NormalizedName (string) Index MaxLength(256), 3] }
            SELECT TOP(1) a.Id, a.ConcurrencyStamp, a.Name, a.NormalizedName
            FROM AspNetRoles AS a
            WHERE a.NormalizedName == @__normalizedName_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, IdentityRole>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 01:45:52.024 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:45:52.025 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:45:52.027 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:45:52.028 +02:00 [DBG] Executing DbCommand [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-11-24 01:45:52.039 +02:00 [INF] Executed DbCommand (11ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-11-24 01:45:52.049 +02:00 [DBG] Context 'AppDbContext' started tracking 'IdentityRole' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:45:52.058 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:45:52.061 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 18ms reading results.
2025-11-24 01:45:52.188 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:45:52.193 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (5ms).
2025-11-24 01:45:52.210 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (22ms).
2025-11-24 01:45:52.221 +02:00 [DBG] Executing DbCommand [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0
2025-11-24 01:45:52.237 +02:00 [INF] Executed DbCommand (17ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0
2025-11-24 01:45:52.242 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:45:52.243 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 01:45:52.307 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:45:52.312 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:45:52.334 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:45:52.339 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 01:45:52.341 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:45:52.342 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:45:52.353 +02:00 [DBG] Creating transaction savepoint.
2025-11-24 01:45:52.368 +02:00 [DBG] Created transaction savepoint.
2025-11-24 01:45:52.370 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:45:52.371 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:45:52.374 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-11-24 01:45:52.376 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (Size = 450), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (DbType = DateTime2), @p5='?' (Size = 256), @p6='?' (DbType = Boolean), @p7='?' (Size = 150), @p8='?' (Size = 10), @p9='?' (DbType = Boolean), @p10='?' (DbType = DateTimeOffset), @p11='?' (Size = 256), @p12='?' (Size = 256), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Boolean), @p16='?' (Size = 4000), @p17='?' (DbType = DateTime2), @p18='?' (Size = 50), @p19='?' (Size = 4000), @p20='?' (DbType = Boolean), @p21='?' (DbType = DateTime2), @p22='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([Id], [AccessFailedCount], [ConcurrencyStamp], [CreatedAt], [DateOfBirth], [Email], [EmailConfirmed], [FullName], [Gender], [LockoutEnabled], [LockoutEnd], [NormalizedEmail], [NormalizedUserName], [PasswordHash], [PhoneNumber], [PhoneNumberConfirmed], [RefreshToken], [RefreshTokenExpiryTime], [Role], [SecurityStamp], [TwoFactorEnabled], [UpdatedAt], [UserName])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22);
2025-11-24 01:45:52.391 +02:00 [INF] Executed DbCommand (15ms) [Parameters=[@p0='?' (Size = 450), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (DbType = DateTime2), @p5='?' (Size = 256), @p6='?' (DbType = Boolean), @p7='?' (Size = 150), @p8='?' (Size = 10), @p9='?' (DbType = Boolean), @p10='?' (DbType = DateTimeOffset), @p11='?' (Size = 256), @p12='?' (Size = 256), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Boolean), @p16='?' (Size = 4000), @p17='?' (DbType = DateTime2), @p18='?' (Size = 50), @p19='?' (Size = 4000), @p20='?' (DbType = Boolean), @p21='?' (DbType = DateTime2), @p22='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([Id], [AccessFailedCount], [ConcurrencyStamp], [CreatedAt], [DateOfBirth], [Email], [EmailConfirmed], [FullName], [Gender], [LockoutEnabled], [LockoutEnd], [NormalizedEmail], [NormalizedUserName], [PasswordHash], [PhoneNumber], [PhoneNumberConfirmed], [RefreshToken], [RefreshTokenExpiryTime], [Role], [SecurityStamp], [TwoFactorEnabled], [UpdatedAt], [UserName])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22);
2025-11-24 01:45:52.396 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:45:52.398 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 01:45:52.401 +02:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:45:52.404 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 01:45:52.414 +02:00 [DBG] Compiling query expression: 
'DbSet<IdentityRole>()
    .SingleOrDefault(r => r.NormalizedName == __normalizedRoleName_0)'
2025-11-24 01:45:52.418 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<IdentityRole>(
    asyncEnumerable: new SingleQueryingEnumerable<IdentityRole>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: IdentityRole.Id (string) Required PK AfterSave:Throw, 0], [Property: IdentityRole.ConcurrencyStamp (string) Concurrency, 1], [Property: IdentityRole.Name (string) MaxLength(256), 2], [Property: IdentityRole.NormalizedName (string) Index MaxLength(256), 3] }
            SELECT TOP(2) a.Id, a.ConcurrencyStamp, a.Name, a.NormalizedName
            FROM AspNetRoles AS a
            WHERE a.NormalizedName == @__normalizedRoleName_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, IdentityRole>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 01:45:52.421 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:45:52.421 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:45:52.422 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:45:52.423 +02:00 [DBG] Executing DbCommand [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedRoleName_0
2025-11-24 01:45:52.429 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedRoleName_0
2025-11-24 01:45:52.431 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:45:52.432 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 01:45:52.435 +02:00 [DBG] Compiling query expression: 
'DbSet<IdentityUserRole<string>>()
    .FirstOrDefault(e => EF.Property<string>(e, "UserId") == __p_0 && EF.Property<string>(e, "RoleId") == __p_1)'
2025-11-24 01:45:52.440 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<IdentityUserRole<string>>(
    asyncEnumerable: new SingleQueryingEnumerable<IdentityUserRole<string>>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: IdentityUserRole<string>.UserId (string) Required PK FK AfterSave:Throw, 0], [Property: IdentityUserRole<string>.RoleId (string) Required PK FK Index AfterSave:Throw, 1] }
            SELECT TOP(1) a.UserId, a.RoleId
            FROM AspNetUserRoles AS a
            WHERE (a.UserId == @__p_0) && (a.RoleId == @__p_1)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, IdentityUserRole<string>>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 01:45:52.444 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:45:52.445 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:45:52.446 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:45:52.446 +02:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (Size = 450), @__p_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[UserId], [a].[RoleId]
FROM [AspNetUserRoles] AS [a]
WHERE [a].[UserId] = @__p_0 AND [a].[RoleId] = @__p_1
2025-11-24 01:45:52.450 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (Size = 450), @__p_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[UserId], [a].[RoleId]
FROM [AspNetUserRoles] AS [a]
WHERE [a].[UserId] = @__p_0 AND [a].[RoleId] = @__p_1
2025-11-24 01:45:52.452 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:45:52.453 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 01:45:52.457 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:45:52.458 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:45:52.459 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:45:52.460 +02:00 [DBG] Executing DbCommand [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedRoleName_0
2025-11-24 01:45:52.464 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedRoleName_0
2025-11-24 01:45:52.467 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:45:52.469 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 2ms reading results.
2025-11-24 01:45:52.476 +02:00 [DBG] Context 'AppDbContext' started tracking 'IdentityUserRole' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:45:52.478 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:45:52.480 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:45:52.482 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-11-24 01:45:52.482 +02:00 [DBG] Executing DbCommand [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0
2025-11-24 01:45:52.486 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0
2025-11-24 01:45:52.490 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:45:52.491 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 01:45:52.497 +02:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:45:52.500 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:45:52.501 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:45:52.503 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 01:45:52.505 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:45:52.506 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:45:52.511 +02:00 [DBG] Executing 2 update commands as a batch.
2025-11-24 01:45:52.512 +02:00 [DBG] Creating transaction savepoint.
2025-11-24 01:45:52.514 +02:00 [DBG] Created transaction savepoint.
2025-11-24 01:45:52.515 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:45:52.515 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:45:52.516 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:45:52.517 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (Size = 450), @p1='?' (Size = 450), @p24='?' (Size = 450), @p2='?' (DbType = Int32), @p3='?' (Size = 4000), @p25='?' (Size = 4000), @p4='?' (DbType = DateTime2), @p5='?' (DbType = DateTime2), @p6='?' (Size = 256), @p7='?' (DbType = Boolean), @p8='?' (Size = 150), @p9='?' (Size = 10), @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTimeOffset), @p12='?' (Size = 256), @p13='?' (Size = 256), @p14='?' (Size = 4000), @p15='?' (Size = 4000), @p16='?' (DbType = Boolean), @p17='?' (Size = 4000), @p18='?' (DbType = DateTime2), @p19='?' (Size = 50), @p20='?' (Size = 4000), @p21='?' (DbType = Boolean), @p22='?' (DbType = DateTime2), @p23='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [AspNetUserRoles] ([RoleId], [UserId])
VALUES (@p0, @p1);
UPDATE [Users] SET [AccessFailedCount] = @p2, [ConcurrencyStamp] = @p3, [CreatedAt] = @p4, [DateOfBirth] = @p5, [Email] = @p6, [EmailConfirmed] = @p7, [FullName] = @p8, [Gender] = @p9, [LockoutEnabled] = @p10, [LockoutEnd] = @p11, [NormalizedEmail] = @p12, [NormalizedUserName] = @p13, [PasswordHash] = @p14, [PhoneNumber] = @p15, [PhoneNumberConfirmed] = @p16, [RefreshToken] = @p17, [RefreshTokenExpiryTime] = @p18, [Role] = @p19, [SecurityStamp] = @p20, [TwoFactorEnabled] = @p21, [UpdatedAt] = @p22, [UserName] = @p23
OUTPUT 1
WHERE [Id] = @p24 AND [ConcurrencyStamp] = @p25;
2025-11-24 01:45:52.532 +02:00 [INF] Executed DbCommand (15ms) [Parameters=[@p0='?' (Size = 450), @p1='?' (Size = 450), @p24='?' (Size = 450), @p2='?' (DbType = Int32), @p3='?' (Size = 4000), @p25='?' (Size = 4000), @p4='?' (DbType = DateTime2), @p5='?' (DbType = DateTime2), @p6='?' (Size = 256), @p7='?' (DbType = Boolean), @p8='?' (Size = 150), @p9='?' (Size = 10), @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTimeOffset), @p12='?' (Size = 256), @p13='?' (Size = 256), @p14='?' (Size = 4000), @p15='?' (Size = 4000), @p16='?' (DbType = Boolean), @p17='?' (Size = 4000), @p18='?' (DbType = DateTime2), @p19='?' (Size = 50), @p20='?' (Size = 4000), @p21='?' (DbType = Boolean), @p22='?' (DbType = DateTime2), @p23='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [AspNetUserRoles] ([RoleId], [UserId])
VALUES (@p0, @p1);
UPDATE [Users] SET [AccessFailedCount] = @p2, [ConcurrencyStamp] = @p3, [CreatedAt] = @p4, [DateOfBirth] = @p5, [Email] = @p6, [EmailConfirmed] = @p7, [FullName] = @p8, [Gender] = @p9, [LockoutEnabled] = @p10, [LockoutEnd] = @p11, [NormalizedEmail] = @p12, [NormalizedUserName] = @p13, [PasswordHash] = @p14, [PhoneNumber] = @p15, [PhoneNumberConfirmed] = @p16, [RefreshToken] = @p17, [RefreshTokenExpiryTime] = @p18, [Role] = @p19, [SecurityStamp] = @p20, [TwoFactorEnabled] = @p21, [UpdatedAt] = @p22, [UserName] = @p23
OUTPUT 1
WHERE [Id] = @p24 AND [ConcurrencyStamp] = @p25;
2025-11-24 01:45:52.538 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:45:52.540 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 2ms reading results.
2025-11-24 01:45:52.541 +02:00 [DBG] An entity of type 'IdentityUserRole' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:45:52.542 +02:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:45:52.545 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 2 entities written to the database.
2025-11-24 01:45:52.551 +02:00 [DBG] Compiling query expression: 
'DbSet<Branch>()
    .Where(b => __ids_0
        .Contains(b.BranchId))'
2025-11-24 01:45:52.558 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Branch>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Branch.Address (string) MaxLength(250), 1], [Property: Branch.BranchName (string) Required MaxLength(150), 2], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 3], [Property: Branch.Description (string), 4], [Property: Branch.Email (string) MaxLength(200), 5], [Property: Branch.ImageURL (string) MaxLength(300), 6], [Property: Branch.Phone (string) MaxLength(25), 7], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 8] }
        SELECT b.BranchId, b.Address, b.BranchName, b.CreatedAt, b.Description, b.Email, b.ImageURL, b.Phone, b.UpdatedAt
        FROM Branches AS b
        WHERE b.BranchId IN (
            SELECT i.value
            FROM OPENJSON(@__ids_0) WITH (value int '') AS i)), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Branch>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 01:45:52.561 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:45:52.562 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:45:52.564 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:45:52.565 +02:00 [DBG] Executing DbCommand [Parameters=[@__ids_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__ids_0) WITH ([value] int '$') AS [i]
)
2025-11-24 01:45:52.570 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__ids_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__ids_0) WITH ([value] int '$') AS [i]
)
2025-11-24 01:45:52.572 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:45:52.572 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:45:52.573 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 01:45:52.578 +02:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Doctor.DoctorId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:45:52.602 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:45:52.607 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:45:52.613 +02:00 [DBG] The navigation 'User.DoctorProfile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:45:52.617 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:45:52.625 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:45:52.630 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:45:52.640 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:45:52.646 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 01:45:52.647 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:45:52.649 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:45:52.650 +02:00 [DBG] Creating transaction savepoint.
2025-11-24 01:45:52.651 +02:00 [DBG] Created transaction savepoint.
2025-11-24 01:45:52.652 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:45:52.654 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:45:52.656 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-11-24 01:45:52.658 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Boolean), @p1='?' (Size = 4000), @p2='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (Size = 300), @p6='?' (DbType = Int32), @p7='?' (DbType = DateTime2), @p8='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Doctors] ([Available], [Biography], [ConsultationFees], [CreatedAt], [ExperienceYears], [ImageURL], [SpecializationId], [UpdatedAt], [UserId])
OUTPUT INSERTED.[DoctorId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
2025-11-24 01:45:52.673 +02:00 [INF] Executed DbCommand (15ms) [Parameters=[@p0='?' (DbType = Boolean), @p1='?' (Size = 4000), @p2='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (Size = 300), @p6='?' (DbType = Int32), @p7='?' (DbType = DateTime2), @p8='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Doctors] ([Available], [Biography], [ConsultationFees], [CreatedAt], [ExperienceYears], [ImageURL], [SpecializationId], [UpdatedAt], [UserId])
OUTPUT INSERTED.[DoctorId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
2025-11-24 01:45:52.678 +02:00 [DBG] The foreign key property 'Doctor.DoctorId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 01:45:52.680 +02:00 [DBG] The foreign key property 'BranchDoctor.DoctorsDoctorId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 01:45:52.681 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:45:52.682 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 4ms reading results.
2025-11-24 01:45:52.683 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:45:52.683 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:45:52.684 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:45:52.685 +02:00 [DBG] Executing DbCommand [Parameters=[@p9='?' (DbType = Int32), @p10='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [DoctorBranches] ([BranchesBranchId], [DoctorsDoctorId])
VALUES (@p9, @p10);
2025-11-24 01:45:52.689 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@p9='?' (DbType = Int32), @p10='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [DoctorBranches] ([BranchesBranchId], [DoctorsDoctorId])
VALUES (@p9, @p10);
2025-11-24 01:45:52.690 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:45:52.691 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 01:45:52.693 +02:00 [DBG] An entity of type 'Doctor' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:45:52.694 +02:00 [DBG] An entity of type 'BranchDoctor' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:45:52.695 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 2 entities written to the database.
2025-11-24 01:45:52.695 +02:00 [DBG] Committing transaction.
2025-11-24 01:45:52.696 +02:00 [DBG] Committed transaction.
2025-11-24 01:45:52.697 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:45:52.697 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:45:56.160 +02:00 [INF] Sent registration email to walaa.elbishl8awy1@gmail
2025-11-24 01:45:56.173 +02:00 [DBG] Disposing transaction.
2025-11-24 01:45:56.178 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:45:56.184 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:45:56.185 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:45:56.186 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:45:56.189 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 01:45:56.190 +02:00 [INF] Executing OkObjectResult, writing value of type 'Hospital.Application.DTO.Doctor.DoctorDto'.
2025-11-24 01:45:56.198 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.AddDoctor (Hospital) in 4409.5548ms
2025-11-24 01:45:56.201 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.AddDoctor (Hospital)'
2025-11-24 01:45:56.201 +02:00 [DBG] Connection id "0HNHAT4T4JIFN" completed keep alive response.
2025-11-24 01:45:56.204 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:45:56.204 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:45:56.206 +02:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-11-24 01:45:56.207 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Doctor/add - 200 null application/json; charset=utf-8 4449.6962ms
2025-11-24 01:46:04.991 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Specializations/Get/1 - null null
2025-11-24 01:46:04.998 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Specializations/Get/1'
2025-11-24 01:46:05.001 +02:00 [DBG] Endpoint 'Hospital.Controllers.SpecializationsController.Get (Hospital)' with route pattern 'api/Specializations/Get/{id}' is valid for the request path '/api/Specializations/Get/1'
2025-11-24 01:46:05.005 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.SpecializationsController.Get (Hospital)'
2025-11-24 01:46:05.008 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:46:05.008 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:46:05.009 +02:00 [INF] Executing endpoint 'Hospital.Controllers.SpecializationsController.Get (Hospital)'
2025-11-24 01:46:05.011 +02:00 [INF] Route matched with {action = "Get", controller = "Specializations"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Hospital.Application.DTO.Specialization.SpecializationDTO]] Get(Int32) on controller Hospital.Controllers.SpecializationsController (Hospital).
2025-11-24 01:46:05.013 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:46:05.016 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:46:05.017 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:46:05.020 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:46:05.021 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:46:05.023 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.SpecializationsController (Hospital)
2025-11-24 01:46:05.025 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.SpecializationsController (Hospital)
2025-11-24 01:46:05.027 +02:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-11-24 01:46:05.029 +02:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-11-24 01:46:05.030 +02:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-11-24 01:46:05.031 +02:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-11-24 01:46:05.031 +02:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-11-24 01:46:05.032 +02:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-11-24 01:46:05.033 +02:00 [INF] get Specialization by id called at "2025-11-24T01:46:05.0330601+02:00"
2025-11-24 01:46:05.033 +02:00 [INF] Fetching specialization with ID 1
2025-11-24 01:46:05.035 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:46:05.037 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:46:05.037 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 01:46:05.038 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:05.040 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:05.040 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:46:05.041 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:46:05.042 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:46:05.043 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[SpecializationId], [t].[CreatedAt], [t].[Description], [t].[Name], [t].[UpdatedAt], [t0].[BranchId], [t0].[SpecializationId], [t0].[BranchId0], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [t1].[DoctorId], [t1].[Available], [t1].[Biography], [t1].[ConsultationFees], [t1].[CreatedAt], [t1].[ExperienceYears], [t1].[ImageURL], [t1].[SpecializationId], [t1].[UpdatedAt], [t1].[UserId], [t1].[Id], [t1].[AccessFailedCount], [t1].[ConcurrencyStamp], [t1].[CreatedAt0], [t1].[DateOfBirth], [t1].[Email], [t1].[EmailConfirmed], [t1].[FullName], [t1].[Gender], [t1].[LockoutEnabled], [t1].[LockoutEnd], [t1].[NormalizedEmail], [t1].[NormalizedUserName], [t1].[PasswordHash], [t1].[PhoneNumber], [t1].[PhoneNumberConfirmed], [t1].[RefreshToken], [t1].[RefreshTokenExpiryTime], [t1].[Role], [t1].[SecurityStamp], [t1].[TwoFactorEnabled], [t1].[UpdatedAt0], [t1].[UserName]
FROM (
    SELECT TOP(1) [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt]
    FROM [Specializations] AS [s]
    WHERE [s].[SpecializationId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [b].[BranchId], [b].[SpecializationId], [b0].[BranchId] AS [BranchId0], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [BranchSpecializations] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
) AS [t0] ON [t].[SpecializationId] = [t0].[SpecializationId]
LEFT JOIN (
    SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
) AS [t1] ON [t].[SpecializationId] = [t1].[SpecializationId]
ORDER BY [t].[SpecializationId], [t0].[BranchId], [t0].[SpecializationId], [t0].[BranchId0], [t1].[DoctorId]
2025-11-24 01:46:05.069 +02:00 [INF] Executed DbCommand (26ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[SpecializationId], [t].[CreatedAt], [t].[Description], [t].[Name], [t].[UpdatedAt], [t0].[BranchId], [t0].[SpecializationId], [t0].[BranchId0], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [t1].[DoctorId], [t1].[Available], [t1].[Biography], [t1].[ConsultationFees], [t1].[CreatedAt], [t1].[ExperienceYears], [t1].[ImageURL], [t1].[SpecializationId], [t1].[UpdatedAt], [t1].[UserId], [t1].[Id], [t1].[AccessFailedCount], [t1].[ConcurrencyStamp], [t1].[CreatedAt0], [t1].[DateOfBirth], [t1].[Email], [t1].[EmailConfirmed], [t1].[FullName], [t1].[Gender], [t1].[LockoutEnabled], [t1].[LockoutEnd], [t1].[NormalizedEmail], [t1].[NormalizedUserName], [t1].[PasswordHash], [t1].[PhoneNumber], [t1].[PhoneNumberConfirmed], [t1].[RefreshToken], [t1].[RefreshTokenExpiryTime], [t1].[Role], [t1].[SecurityStamp], [t1].[TwoFactorEnabled], [t1].[UpdatedAt0], [t1].[UserName]
FROM (
    SELECT TOP(1) [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt]
    FROM [Specializations] AS [s]
    WHERE [s].[SpecializationId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [b].[BranchId], [b].[SpecializationId], [b0].[BranchId] AS [BranchId0], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [BranchSpecializations] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
) AS [t0] ON [t].[SpecializationId] = [t0].[SpecializationId]
LEFT JOIN (
    SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
) AS [t1] ON [t].[SpecializationId] = [t1].[SpecializationId]
ORDER BY [t].[SpecializationId], [t0].[BranchId], [t0].[SpecializationId], [t0].[BranchId0], [t1].[DoctorId]
2025-11-24 01:46:05.078 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:46:05.079 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchSpecialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:46:05.080 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:46:05.083 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:46:05.085 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:46:05.087 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:46:05.089 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:46:05.091 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 13ms reading results.
2025-11-24 01:46:05.093 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:05.095 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 01:46:05.097 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:46:05.100 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:46:05.101 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:46:05.102 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:46:05.102 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 01:46:05.103 +02:00 [INF] Executing OkObjectResult, writing value of type 'Hospital.Application.DTO.Specialization.SpecializationDTO'.
2025-11-24 01:46:05.107 +02:00 [INF] Executed action Hospital.Controllers.SpecializationsController.Get (Hospital) in 84.5016ms
2025-11-24 01:46:05.109 +02:00 [INF] Executed endpoint 'Hospital.Controllers.SpecializationsController.Get (Hospital)'
2025-11-24 01:46:05.110 +02:00 [DBG] Connection id "0HNHAT4T4JIFN" completed keep alive response.
2025-11-24 01:46:05.113 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:46:05.115 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:05.116 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 01:46:05.117 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Specializations/Get/1 - 200 null application/json; charset=utf-8 125.6849ms
2025-11-24 01:46:11.264 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Specializations/GetAll - null null
2025-11-24 01:46:11.268 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Specializations/GetAll'
2025-11-24 01:46:11.269 +02:00 [DBG] Endpoint 'Hospital.Controllers.SpecializationsController.GetAll (Hospital)' with route pattern 'api/Specializations/GetAll' is valid for the request path '/api/Specializations/GetAll'
2025-11-24 01:46:11.271 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.SpecializationsController.GetAll (Hospital)'
2025-11-24 01:46:11.272 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:46:11.273 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:46:11.274 +02:00 [INF] Executing endpoint 'Hospital.Controllers.SpecializationsController.GetAll (Hospital)'
2025-11-24 01:46:11.278 +02:00 [INF] Route matched with {action = "GetAll", controller = "Specializations"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IEnumerable`1[Hospital.Application.DTO.Specialization.SpecializationDTO]]] GetAll() on controller Hospital.Controllers.SpecializationsController (Hospital).
2025-11-24 01:46:11.282 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:46:11.284 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:46:11.286 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:46:11.289 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:46:11.292 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:46:11.296 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.SpecializationsController (Hospital)
2025-11-24 01:46:11.298 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.SpecializationsController (Hospital)
2025-11-24 01:46:11.301 +02:00 [INF] get all Specialization called at "2025-11-24T01:46:11.3013300+02:00"
2025-11-24 01:46:11.302 +02:00 [INF] Fetching all specializations in the system
2025-11-24 01:46:11.305 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:46:11.308 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:46:11.309 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 01:46:11.310 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:11.312 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:11.314 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:46:11.315 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:46:11.316 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:46:11.317 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt], [t].[BranchId], [t].[SpecializationId], [t].[BranchId0], [t].[Address], [t].[BranchName], [t].[CreatedAt], [t].[Description], [t].[Email], [t].[ImageURL], [t].[Phone], [t].[UpdatedAt], [t0].[DoctorId], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt0], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt0], [t0].[UserName]
FROM [Specializations] AS [s]
LEFT JOIN (
    SELECT [b].[BranchId], [b].[SpecializationId], [b0].[BranchId] AS [BranchId0], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [BranchSpecializations] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
) AS [t] ON [s].[SpecializationId] = [t].[SpecializationId]
LEFT JOIN (
    SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
) AS [t0] ON [s].[SpecializationId] = [t0].[SpecializationId]
ORDER BY [s].[SpecializationId], [t].[BranchId], [t].[SpecializationId], [t].[BranchId0], [t0].[DoctorId]
2025-11-24 01:46:11.344 +02:00 [INF] Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt], [t].[BranchId], [t].[SpecializationId], [t].[BranchId0], [t].[Address], [t].[BranchName], [t].[CreatedAt], [t].[Description], [t].[Email], [t].[ImageURL], [t].[Phone], [t].[UpdatedAt], [t0].[DoctorId], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt0], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt0], [t0].[UserName]
FROM [Specializations] AS [s]
LEFT JOIN (
    SELECT [b].[BranchId], [b].[SpecializationId], [b0].[BranchId] AS [BranchId0], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [BranchSpecializations] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
) AS [t] ON [s].[SpecializationId] = [t].[SpecializationId]
LEFT JOIN (
    SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
) AS [t0] ON [s].[SpecializationId] = [t0].[SpecializationId]
ORDER BY [s].[SpecializationId], [t].[BranchId], [t].[SpecializationId], [t].[BranchId0], [t0].[DoctorId]
2025-11-24 01:46:11.350 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:46:11.353 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchSpecialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:46:11.355 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:46:11.359 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:46:11.361 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:46:11.363 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:46:11.366 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:46:11.368 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 17ms reading results.
2025-11-24 01:46:11.371 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:11.373 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (2ms).
2025-11-24 01:46:11.382 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:46:11.385 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:46:11.386 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:46:11.387 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:46:11.388 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 01:46:11.390 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Specialization.SpecializationDTO, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 01:46:11.392 +02:00 [INF] Executed action Hospital.Controllers.SpecializationsController.GetAll (Hospital) in 96.7388ms
2025-11-24 01:46:11.394 +02:00 [INF] Executed endpoint 'Hospital.Controllers.SpecializationsController.GetAll (Hospital)'
2025-11-24 01:46:11.396 +02:00 [DBG] Connection id "0HNHAT4T4JIFN" completed keep alive response.
2025-11-24 01:46:11.398 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:46:11.398 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:11.400 +02:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-11-24 01:46:11.404 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Specializations/GetAll - 200 null application/json; charset=utf-8 139.4228ms
2025-11-24 01:46:21.374 +02:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7217/api/Specializations/Update - application/json 199
2025-11-24 01:46:21.378 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Specializations/Update'
2025-11-24 01:46:21.380 +02:00 [DBG] Endpoint 'Hospital.Controllers.SpecializationsController.Update (Hospital)' with route pattern 'api/Specializations/Update' is valid for the request path '/api/Specializations/Update'
2025-11-24 01:46:21.384 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.SpecializationsController.Update (Hospital)'
2025-11-24 01:46:21.385 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:46:21.386 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:46:21.386 +02:00 [INF] Executing endpoint 'Hospital.Controllers.SpecializationsController.Update (Hospital)'
2025-11-24 01:46:21.390 +02:00 [INF] Route matched with {action = "Update", controller = "Specializations"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Hospital.Application.DTO.Specialization.SpecializationDTO]] Update(Hospital.Application.DTO.Specialization.UpdateSpecialization) on controller Hospital.Controllers.SpecializationsController (Hospital).
2025-11-24 01:46:21.393 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:46:21.400 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:46:21.401 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:46:21.402 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:46:21.405 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:46:21.406 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.SpecializationsController (Hospital)
2025-11-24 01:46:21.407 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.SpecializationsController (Hospital)
2025-11-24 01:46:21.408 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Specialization.UpdateSpecialization' ...
2025-11-24 01:46:21.409 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Specialization.UpdateSpecialization' using the name '' in request data ...
2025-11-24 01:46:21.412 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 01:46:21.415 +02:00 [DBG] Connection id "0HNHAT4T4JIFN", Request id "0HNHAT4T4JIFN:00000006": started reading request body.
2025-11-24 01:46:21.418 +02:00 [DBG] Connection id "0HNHAT4T4JIFN", Request id "0HNHAT4T4JIFN:00000006": done reading request body.
2025-11-24 01:46:21.423 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Specialization.UpdateSpecialization'
2025-11-24 01:46:21.428 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Specialization.UpdateSpecialization'.
2025-11-24 01:46:21.430 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Specialization.UpdateSpecialization'.
2025-11-24 01:46:21.434 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Specialization.UpdateSpecialization' ...
2025-11-24 01:46:21.438 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Specialization.UpdateSpecialization'.
2025-11-24 01:46:21.446 +02:00 [INF] update Specialization called at "2025-11-24T01:46:21.4461841+02:00"
2025-11-24 01:46:21.451 +02:00 [INF] Updating specialization with ID 4
2025-11-24 01:46:21.456 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:46:21.464 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:46:21.465 +02:00 [DBG] Created DbConnection. (1ms).
2025-11-24 01:46:21.466 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:21.469 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:21.470 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:46:21.471 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:46:21.473 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-11-24 01:46:21.476 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[SpecializationId], [t].[CreatedAt], [t].[Description], [t].[Name], [t].[UpdatedAt], [t0].[BranchId], [t0].[SpecializationId], [t0].[BranchId0], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [t1].[DoctorId], [t1].[Available], [t1].[Biography], [t1].[ConsultationFees], [t1].[CreatedAt], [t1].[ExperienceYears], [t1].[ImageURL], [t1].[SpecializationId], [t1].[UpdatedAt], [t1].[UserId], [t1].[Id], [t1].[AccessFailedCount], [t1].[ConcurrencyStamp], [t1].[CreatedAt0], [t1].[DateOfBirth], [t1].[Email], [t1].[EmailConfirmed], [t1].[FullName], [t1].[Gender], [t1].[LockoutEnabled], [t1].[LockoutEnd], [t1].[NormalizedEmail], [t1].[NormalizedUserName], [t1].[PasswordHash], [t1].[PhoneNumber], [t1].[PhoneNumberConfirmed], [t1].[RefreshToken], [t1].[RefreshTokenExpiryTime], [t1].[Role], [t1].[SecurityStamp], [t1].[TwoFactorEnabled], [t1].[UpdatedAt0], [t1].[UserName]
FROM (
    SELECT TOP(1) [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt]
    FROM [Specializations] AS [s]
    WHERE [s].[SpecializationId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [b].[BranchId], [b].[SpecializationId], [b0].[BranchId] AS [BranchId0], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [BranchSpecializations] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
) AS [t0] ON [t].[SpecializationId] = [t0].[SpecializationId]
LEFT JOIN (
    SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
) AS [t1] ON [t].[SpecializationId] = [t1].[SpecializationId]
ORDER BY [t].[SpecializationId], [t0].[BranchId], [t0].[SpecializationId], [t0].[BranchId0], [t1].[DoctorId]
2025-11-24 01:46:21.494 +02:00 [INF] Executed DbCommand (19ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[SpecializationId], [t].[CreatedAt], [t].[Description], [t].[Name], [t].[UpdatedAt], [t0].[BranchId], [t0].[SpecializationId], [t0].[BranchId0], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [t1].[DoctorId], [t1].[Available], [t1].[Biography], [t1].[ConsultationFees], [t1].[CreatedAt], [t1].[ExperienceYears], [t1].[ImageURL], [t1].[SpecializationId], [t1].[UpdatedAt], [t1].[UserId], [t1].[Id], [t1].[AccessFailedCount], [t1].[ConcurrencyStamp], [t1].[CreatedAt0], [t1].[DateOfBirth], [t1].[Email], [t1].[EmailConfirmed], [t1].[FullName], [t1].[Gender], [t1].[LockoutEnabled], [t1].[LockoutEnd], [t1].[NormalizedEmail], [t1].[NormalizedUserName], [t1].[PasswordHash], [t1].[PhoneNumber], [t1].[PhoneNumberConfirmed], [t1].[RefreshToken], [t1].[RefreshTokenExpiryTime], [t1].[Role], [t1].[SecurityStamp], [t1].[TwoFactorEnabled], [t1].[UpdatedAt0], [t1].[UserName]
FROM (
    SELECT TOP(1) [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt]
    FROM [Specializations] AS [s]
    WHERE [s].[SpecializationId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [b].[BranchId], [b].[SpecializationId], [b0].[BranchId] AS [BranchId0], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [BranchSpecializations] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
) AS [t0] ON [t].[SpecializationId] = [t0].[SpecializationId]
LEFT JOIN (
    SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
) AS [t1] ON [t].[SpecializationId] = [t1].[SpecializationId]
ORDER BY [t].[SpecializationId], [t0].[BranchId], [t0].[SpecializationId], [t0].[BranchId0], [t1].[DoctorId]
2025-11-24 01:46:21.498 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:46:21.501 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 3ms reading results.
2025-11-24 01:46:21.506 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:21.507 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:46:21.508 +02:00 [WRN] Specialization with ID 4 not found
2025-11-24 01:46:21.557 +02:00 [INF] Executed action Hospital.Controllers.SpecializationsController.Update (Hospital) in 150.9598ms
2025-11-24 01:46:21.559 +02:00 [INF] Executed endpoint 'Hospital.Controllers.SpecializationsController.Update (Hospital)'
2025-11-24 01:46:21.614 +02:00 [ERR]  Exception caught: Specialization not found.
System.Collections.Generic.KeyNotFoundException: Specialization not found.
   at Hospital.Infrastructure.Services.SpecializationService.UpdateAsync(UpdateSpecialization dto)
   at Hospital.Controllers.SpecializationsController.Update(UpdateSpecialization dto) in D:\Walaa\GP\Hospital\Hospital\Controllers\SpecializationsController.cs:line 127
   at lambda_method1228(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
2025-11-24 01:46:21.626 +02:00 [DBG] Connection id "0HNHAT4T4JIFN" completed keep alive response.
2025-11-24 01:46:21.629 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:46:21.630 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:21.631 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 01:46:21.632 +02:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7217/api/Specializations/Update - 404 null application/json 257.647ms
2025-11-24 01:46:28.125 +02:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7217/api/Specializations/Update - application/json 199
2025-11-24 01:46:28.130 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Specializations/Update'
2025-11-24 01:46:28.131 +02:00 [DBG] Endpoint 'Hospital.Controllers.SpecializationsController.Update (Hospital)' with route pattern 'api/Specializations/Update' is valid for the request path '/api/Specializations/Update'
2025-11-24 01:46:28.132 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.SpecializationsController.Update (Hospital)'
2025-11-24 01:46:28.133 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:46:28.133 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:46:28.134 +02:00 [INF] Executing endpoint 'Hospital.Controllers.SpecializationsController.Update (Hospital)'
2025-11-24 01:46:28.135 +02:00 [INF] Route matched with {action = "Update", controller = "Specializations"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Hospital.Application.DTO.Specialization.SpecializationDTO]] Update(Hospital.Application.DTO.Specialization.UpdateSpecialization) on controller Hospital.Controllers.SpecializationsController (Hospital).
2025-11-24 01:46:28.136 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:46:28.138 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:46:28.139 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:46:28.140 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:46:28.140 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:46:28.141 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.SpecializationsController (Hospital)
2025-11-24 01:46:28.142 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.SpecializationsController (Hospital)
2025-11-24 01:46:28.143 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Specialization.UpdateSpecialization' ...
2025-11-24 01:46:28.146 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Specialization.UpdateSpecialization' using the name '' in request data ...
2025-11-24 01:46:28.147 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 01:46:28.148 +02:00 [DBG] Connection id "0HNHAT4T4JIFN", Request id "0HNHAT4T4JIFN:00000007": started reading request body.
2025-11-24 01:46:28.148 +02:00 [DBG] Connection id "0HNHAT4T4JIFN", Request id "0HNHAT4T4JIFN:00000007": done reading request body.
2025-11-24 01:46:28.149 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Specialization.UpdateSpecialization'
2025-11-24 01:46:28.149 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Specialization.UpdateSpecialization'.
2025-11-24 01:46:28.150 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Specialization.UpdateSpecialization'.
2025-11-24 01:46:28.151 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Specialization.UpdateSpecialization' ...
2025-11-24 01:46:28.151 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Specialization.UpdateSpecialization'.
2025-11-24 01:46:28.152 +02:00 [INF] update Specialization called at "2025-11-24T01:46:28.1525581+02:00"
2025-11-24 01:46:28.153 +02:00 [INF] Updating specialization with ID 4
2025-11-24 01:46:28.153 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:46:28.155 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:46:28.155 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 01:46:28.155 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:28.156 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:28.157 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:46:28.159 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:46:28.165 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (7ms).
2025-11-24 01:46:28.166 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[SpecializationId], [t].[CreatedAt], [t].[Description], [t].[Name], [t].[UpdatedAt], [t0].[BranchId], [t0].[SpecializationId], [t0].[BranchId0], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [t1].[DoctorId], [t1].[Available], [t1].[Biography], [t1].[ConsultationFees], [t1].[CreatedAt], [t1].[ExperienceYears], [t1].[ImageURL], [t1].[SpecializationId], [t1].[UpdatedAt], [t1].[UserId], [t1].[Id], [t1].[AccessFailedCount], [t1].[ConcurrencyStamp], [t1].[CreatedAt0], [t1].[DateOfBirth], [t1].[Email], [t1].[EmailConfirmed], [t1].[FullName], [t1].[Gender], [t1].[LockoutEnabled], [t1].[LockoutEnd], [t1].[NormalizedEmail], [t1].[NormalizedUserName], [t1].[PasswordHash], [t1].[PhoneNumber], [t1].[PhoneNumberConfirmed], [t1].[RefreshToken], [t1].[RefreshTokenExpiryTime], [t1].[Role], [t1].[SecurityStamp], [t1].[TwoFactorEnabled], [t1].[UpdatedAt0], [t1].[UserName]
FROM (
    SELECT TOP(1) [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt]
    FROM [Specializations] AS [s]
    WHERE [s].[SpecializationId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [b].[BranchId], [b].[SpecializationId], [b0].[BranchId] AS [BranchId0], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [BranchSpecializations] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
) AS [t0] ON [t].[SpecializationId] = [t0].[SpecializationId]
LEFT JOIN (
    SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
) AS [t1] ON [t].[SpecializationId] = [t1].[SpecializationId]
ORDER BY [t].[SpecializationId], [t0].[BranchId], [t0].[SpecializationId], [t0].[BranchId0], [t1].[DoctorId]
2025-11-24 01:46:28.170 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[SpecializationId], [t].[CreatedAt], [t].[Description], [t].[Name], [t].[UpdatedAt], [t0].[BranchId], [t0].[SpecializationId], [t0].[BranchId0], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [t1].[DoctorId], [t1].[Available], [t1].[Biography], [t1].[ConsultationFees], [t1].[CreatedAt], [t1].[ExperienceYears], [t1].[ImageURL], [t1].[SpecializationId], [t1].[UpdatedAt], [t1].[UserId], [t1].[Id], [t1].[AccessFailedCount], [t1].[ConcurrencyStamp], [t1].[CreatedAt0], [t1].[DateOfBirth], [t1].[Email], [t1].[EmailConfirmed], [t1].[FullName], [t1].[Gender], [t1].[LockoutEnabled], [t1].[LockoutEnd], [t1].[NormalizedEmail], [t1].[NormalizedUserName], [t1].[PasswordHash], [t1].[PhoneNumber], [t1].[PhoneNumberConfirmed], [t1].[RefreshToken], [t1].[RefreshTokenExpiryTime], [t1].[Role], [t1].[SecurityStamp], [t1].[TwoFactorEnabled], [t1].[UpdatedAt0], [t1].[UserName]
FROM (
    SELECT TOP(1) [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt]
    FROM [Specializations] AS [s]
    WHERE [s].[SpecializationId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [b].[BranchId], [b].[SpecializationId], [b0].[BranchId] AS [BranchId0], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [BranchSpecializations] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
) AS [t0] ON [t].[SpecializationId] = [t0].[SpecializationId]
LEFT JOIN (
    SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
) AS [t1] ON [t].[SpecializationId] = [t1].[SpecializationId]
ORDER BY [t].[SpecializationId], [t0].[BranchId], [t0].[SpecializationId], [t0].[BranchId0], [t1].[DoctorId]
2025-11-24 01:46:28.178 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:46:28.178 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 01:46:28.179 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:28.179 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:46:28.180 +02:00 [WRN] Specialization with ID 4 not found
2025-11-24 01:46:28.228 +02:00 [INF] Executed action Hospital.Controllers.SpecializationsController.Update (Hospital) in 86.6914ms
2025-11-24 01:46:28.230 +02:00 [INF] Executed endpoint 'Hospital.Controllers.SpecializationsController.Update (Hospital)'
2025-11-24 01:46:28.272 +02:00 [ERR]  Exception caught: Specialization not found.
System.Collections.Generic.KeyNotFoundException: Specialization not found.
   at Hospital.Infrastructure.Services.SpecializationService.UpdateAsync(UpdateSpecialization dto)
   at Hospital.Controllers.SpecializationsController.Update(UpdateSpecialization dto) in D:\Walaa\GP\Hospital\Hospital\Controllers\SpecializationsController.cs:line 127
   at lambda_method1228(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
2025-11-24 01:46:28.292 +02:00 [DBG] Connection id "0HNHAT4T4JIFN" completed keep alive response.
2025-11-24 01:46:28.294 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:46:28.295 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:28.296 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 01:46:28.297 +02:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7217/api/Specializations/Update - 404 null application/json 171.7031ms
2025-11-24 01:46:38.815 +02:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7217/api/Specializations/Update - application/json 199
2025-11-24 01:46:38.820 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Specializations/Update'
2025-11-24 01:46:38.823 +02:00 [DBG] Endpoint 'Hospital.Controllers.SpecializationsController.Update (Hospital)' with route pattern 'api/Specializations/Update' is valid for the request path '/api/Specializations/Update'
2025-11-24 01:46:38.834 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.SpecializationsController.Update (Hospital)'
2025-11-24 01:46:38.836 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:46:38.836 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:46:38.838 +02:00 [INF] Executing endpoint 'Hospital.Controllers.SpecializationsController.Update (Hospital)'
2025-11-24 01:46:38.844 +02:00 [INF] Route matched with {action = "Update", controller = "Specializations"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Hospital.Application.DTO.Specialization.SpecializationDTO]] Update(Hospital.Application.DTO.Specialization.UpdateSpecialization) on controller Hospital.Controllers.SpecializationsController (Hospital).
2025-11-24 01:46:38.846 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:46:38.848 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:46:38.851 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:46:38.853 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:46:38.854 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:46:38.856 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.SpecializationsController (Hospital)
2025-11-24 01:46:38.857 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.SpecializationsController (Hospital)
2025-11-24 01:46:38.857 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Specialization.UpdateSpecialization' ...
2025-11-24 01:46:38.859 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Specialization.UpdateSpecialization' using the name '' in request data ...
2025-11-24 01:46:38.860 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 01:46:38.861 +02:00 [DBG] Connection id "0HNHAT4T4JIFN", Request id "0HNHAT4T4JIFN:00000008": started reading request body.
2025-11-24 01:46:38.862 +02:00 [DBG] Connection id "0HNHAT4T4JIFN", Request id "0HNHAT4T4JIFN:00000008": done reading request body.
2025-11-24 01:46:38.862 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Specialization.UpdateSpecialization'
2025-11-24 01:46:38.864 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Specialization.UpdateSpecialization'.
2025-11-24 01:46:38.865 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Specialization.UpdateSpecialization'.
2025-11-24 01:46:38.866 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Specialization.UpdateSpecialization' ...
2025-11-24 01:46:38.867 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Specialization.UpdateSpecialization'.
2025-11-24 01:46:38.868 +02:00 [INF] update Specialization called at "2025-11-24T01:46:38.8683856+02:00"
2025-11-24 01:46:38.868 +02:00 [INF] Updating specialization with ID 1
2025-11-24 01:46:38.869 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:46:38.871 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:46:38.872 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 01:46:38.872 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:38.874 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:38.875 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:46:38.875 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:46:38.876 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:46:38.877 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[SpecializationId], [t].[CreatedAt], [t].[Description], [t].[Name], [t].[UpdatedAt], [t0].[BranchId], [t0].[SpecializationId], [t0].[BranchId0], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [t1].[DoctorId], [t1].[Available], [t1].[Biography], [t1].[ConsultationFees], [t1].[CreatedAt], [t1].[ExperienceYears], [t1].[ImageURL], [t1].[SpecializationId], [t1].[UpdatedAt], [t1].[UserId], [t1].[Id], [t1].[AccessFailedCount], [t1].[ConcurrencyStamp], [t1].[CreatedAt0], [t1].[DateOfBirth], [t1].[Email], [t1].[EmailConfirmed], [t1].[FullName], [t1].[Gender], [t1].[LockoutEnabled], [t1].[LockoutEnd], [t1].[NormalizedEmail], [t1].[NormalizedUserName], [t1].[PasswordHash], [t1].[PhoneNumber], [t1].[PhoneNumberConfirmed], [t1].[RefreshToken], [t1].[RefreshTokenExpiryTime], [t1].[Role], [t1].[SecurityStamp], [t1].[TwoFactorEnabled], [t1].[UpdatedAt0], [t1].[UserName]
FROM (
    SELECT TOP(1) [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt]
    FROM [Specializations] AS [s]
    WHERE [s].[SpecializationId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [b].[BranchId], [b].[SpecializationId], [b0].[BranchId] AS [BranchId0], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [BranchSpecializations] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
) AS [t0] ON [t].[SpecializationId] = [t0].[SpecializationId]
LEFT JOIN (
    SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
) AS [t1] ON [t].[SpecializationId] = [t1].[SpecializationId]
ORDER BY [t].[SpecializationId], [t0].[BranchId], [t0].[SpecializationId], [t0].[BranchId0], [t1].[DoctorId]
2025-11-24 01:46:38.881 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[SpecializationId], [t].[CreatedAt], [t].[Description], [t].[Name], [t].[UpdatedAt], [t0].[BranchId], [t0].[SpecializationId], [t0].[BranchId0], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [t1].[DoctorId], [t1].[Available], [t1].[Biography], [t1].[ConsultationFees], [t1].[CreatedAt], [t1].[ExperienceYears], [t1].[ImageURL], [t1].[SpecializationId], [t1].[UpdatedAt], [t1].[UserId], [t1].[Id], [t1].[AccessFailedCount], [t1].[ConcurrencyStamp], [t1].[CreatedAt0], [t1].[DateOfBirth], [t1].[Email], [t1].[EmailConfirmed], [t1].[FullName], [t1].[Gender], [t1].[LockoutEnabled], [t1].[LockoutEnd], [t1].[NormalizedEmail], [t1].[NormalizedUserName], [t1].[PasswordHash], [t1].[PhoneNumber], [t1].[PhoneNumberConfirmed], [t1].[RefreshToken], [t1].[RefreshTokenExpiryTime], [t1].[Role], [t1].[SecurityStamp], [t1].[TwoFactorEnabled], [t1].[UpdatedAt0], [t1].[UserName]
FROM (
    SELECT TOP(1) [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt]
    FROM [Specializations] AS [s]
    WHERE [s].[SpecializationId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [b].[BranchId], [b].[SpecializationId], [b0].[BranchId] AS [BranchId0], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [BranchSpecializations] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
) AS [t0] ON [t].[SpecializationId] = [t0].[SpecializationId]
LEFT JOIN (
    SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
) AS [t1] ON [t].[SpecializationId] = [t1].[SpecializationId]
ORDER BY [t].[SpecializationId], [t0].[BranchId], [t0].[SpecializationId], [t0].[BranchId0], [t1].[DoctorId]
2025-11-24 01:46:38.885 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:46:38.886 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchSpecialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:46:38.887 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:46:38.888 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:46:38.891 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:46:38.891 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:46:38.892 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:46:38.893 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 8ms reading results.
2025-11-24 01:46:38.895 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:38.896 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:46:38.897 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:38.898 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:38.899 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:46:38.900 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:46:38.901 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:46:38.901 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt], [t].[BranchId], [t].[SpecializationId], [t].[BranchId0], [t].[Address], [t].[BranchName], [t].[CreatedAt], [t].[Description], [t].[Email], [t].[ImageURL], [t].[Phone], [t].[UpdatedAt], [t0].[DoctorId], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt0], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt0], [t0].[UserName]
FROM [Specializations] AS [s]
LEFT JOIN (
    SELECT [b].[BranchId], [b].[SpecializationId], [b0].[BranchId] AS [BranchId0], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [BranchSpecializations] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
) AS [t] ON [s].[SpecializationId] = [t].[SpecializationId]
LEFT JOIN (
    SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
) AS [t0] ON [s].[SpecializationId] = [t0].[SpecializationId]
ORDER BY [s].[SpecializationId], [t].[BranchId], [t].[SpecializationId], [t].[BranchId0], [t0].[DoctorId]
2025-11-24 01:46:38.918 +02:00 [INF] Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt], [t].[BranchId], [t].[SpecializationId], [t].[BranchId0], [t].[Address], [t].[BranchName], [t].[CreatedAt], [t].[Description], [t].[Email], [t].[ImageURL], [t].[Phone], [t].[UpdatedAt], [t0].[DoctorId], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt0], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt0], [t0].[UserName]
FROM [Specializations] AS [s]
LEFT JOIN (
    SELECT [b].[BranchId], [b].[SpecializationId], [b0].[BranchId] AS [BranchId0], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [BranchSpecializations] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
) AS [t] ON [s].[SpecializationId] = [t].[SpecializationId]
LEFT JOIN (
    SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
) AS [t0] ON [s].[SpecializationId] = [t0].[SpecializationId]
ORDER BY [s].[SpecializationId], [t].[BranchId], [t].[SpecializationId], [t].[BranchId0], [t0].[DoctorId]
2025-11-24 01:46:38.925 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:46:38.926 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 01:46:38.929 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:38.930 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 01:46:38.933 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:38.936 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:38.938 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:46:38.938 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:46:38.939 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:46:38.940 +02:00 [DBG] Executing DbCommand [Parameters=[@__branchIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [b0].[value]
    FROM OPENJSON(@__branchIds_0) WITH ([value] int '$') AS [b0]
)
2025-11-24 01:46:38.945 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__branchIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [b0].[value]
    FROM OPENJSON(@__branchIds_0) WITH ([value] int '$') AS [b0]
)
2025-11-24 01:46:38.947 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:46:38.948 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 01:46:38.950 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:38.953 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (3ms).
2025-11-24 01:46:38.956 +02:00 [DBG] An entity of type 'Specialization' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:46:38.957 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:46:38.958 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:46:38.959 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 01:46:38.961 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:46:38.961 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:46:38.963 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:38.963 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:38.964 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:46:38.965 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:46:38.967 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:46:38.968 +02:00 [DBG] Executing DbCommand [Parameters=[@p4='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (Size = 120), @p3='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Specializations] SET [CreatedAt] = @p0, [Description] = @p1, [Name] = @p2, [UpdatedAt] = @p3
OUTPUT 1
WHERE [SpecializationId] = @p4;
2025-11-24 01:46:38.972 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p4='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (Size = 120), @p3='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Specializations] SET [CreatedAt] = @p0, [Description] = @p1, [Name] = @p2, [UpdatedAt] = @p3
OUTPUT 1
WHERE [SpecializationId] = @p4;
2025-11-24 01:46:38.974 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:46:38.975 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 01:46:38.975 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:38.976 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:46:38.977 +02:00 [DBG] An entity of type 'Specialization' tracked by 'AppDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:46:38.978 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 01:46:38.979 +02:00 [INF] Specialization 1 updated successfully
2025-11-24 01:46:38.980 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:46:38.981 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:46:38.981 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:46:38.982 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:46:38.983 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter' and content type 'text/plain' to write the response.
2025-11-24 01:46:38.984 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.String'.
2025-11-24 01:46:38.985 +02:00 [INF] Executed action Hospital.Controllers.SpecializationsController.Update (Hospital) in 129.2422ms
2025-11-24 01:46:38.986 +02:00 [INF] Executed endpoint 'Hospital.Controllers.SpecializationsController.Update (Hospital)'
2025-11-24 01:46:38.986 +02:00 [DBG] Connection id "0HNHAT4T4JIFN" completed keep alive response.
2025-11-24 01:46:38.987 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:46:38.988 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:38.988 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 01:46:38.989 +02:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7217/api/Specializations/Update - 200 null text/plain; charset=utf-8 174.5328ms
2025-11-24 01:46:48.115 +02:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7217/api/Specializations/Update - application/json 201
2025-11-24 01:46:48.119 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Specializations/Update'
2025-11-24 01:46:48.121 +02:00 [DBG] Endpoint 'Hospital.Controllers.SpecializationsController.Update (Hospital)' with route pattern 'api/Specializations/Update' is valid for the request path '/api/Specializations/Update'
2025-11-24 01:46:48.124 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.SpecializationsController.Update (Hospital)'
2025-11-24 01:46:48.126 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:46:48.127 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:46:48.130 +02:00 [INF] Executing endpoint 'Hospital.Controllers.SpecializationsController.Update (Hospital)'
2025-11-24 01:46:48.130 +02:00 [INF] Route matched with {action = "Update", controller = "Specializations"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Hospital.Application.DTO.Specialization.SpecializationDTO]] Update(Hospital.Application.DTO.Specialization.UpdateSpecialization) on controller Hospital.Controllers.SpecializationsController (Hospital).
2025-11-24 01:46:48.131 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:46:48.132 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:46:48.135 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:46:48.136 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:46:48.137 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:46:48.138 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.SpecializationsController (Hospital)
2025-11-24 01:46:48.139 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.SpecializationsController (Hospital)
2025-11-24 01:46:48.139 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Specialization.UpdateSpecialization' ...
2025-11-24 01:46:48.140 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Specialization.UpdateSpecialization' using the name '' in request data ...
2025-11-24 01:46:48.141 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 01:46:48.141 +02:00 [DBG] Connection id "0HNHAT4T4JIFN", Request id "0HNHAT4T4JIFN:00000009": started reading request body.
2025-11-24 01:46:48.142 +02:00 [DBG] Connection id "0HNHAT4T4JIFN", Request id "0HNHAT4T4JIFN:00000009": done reading request body.
2025-11-24 01:46:48.143 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Specialization.UpdateSpecialization'
2025-11-24 01:46:48.144 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Specialization.UpdateSpecialization'.
2025-11-24 01:46:48.145 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Specialization.UpdateSpecialization'.
2025-11-24 01:46:48.146 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Specialization.UpdateSpecialization' ...
2025-11-24 01:46:48.147 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Specialization.UpdateSpecialization'.
2025-11-24 01:46:48.147 +02:00 [INF] update Specialization called at "2025-11-24T01:46:48.1475862+02:00"
2025-11-24 01:46:48.148 +02:00 [INF] Updating specialization with ID 1
2025-11-24 01:46:48.149 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:46:48.150 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:46:48.151 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 01:46:48.151 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:48.152 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:48.154 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:46:48.156 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:46:48.156 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:46:48.157 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[SpecializationId], [t].[CreatedAt], [t].[Description], [t].[Name], [t].[UpdatedAt], [t0].[BranchId], [t0].[SpecializationId], [t0].[BranchId0], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [t1].[DoctorId], [t1].[Available], [t1].[Biography], [t1].[ConsultationFees], [t1].[CreatedAt], [t1].[ExperienceYears], [t1].[ImageURL], [t1].[SpecializationId], [t1].[UpdatedAt], [t1].[UserId], [t1].[Id], [t1].[AccessFailedCount], [t1].[ConcurrencyStamp], [t1].[CreatedAt0], [t1].[DateOfBirth], [t1].[Email], [t1].[EmailConfirmed], [t1].[FullName], [t1].[Gender], [t1].[LockoutEnabled], [t1].[LockoutEnd], [t1].[NormalizedEmail], [t1].[NormalizedUserName], [t1].[PasswordHash], [t1].[PhoneNumber], [t1].[PhoneNumberConfirmed], [t1].[RefreshToken], [t1].[RefreshTokenExpiryTime], [t1].[Role], [t1].[SecurityStamp], [t1].[TwoFactorEnabled], [t1].[UpdatedAt0], [t1].[UserName]
FROM (
    SELECT TOP(1) [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt]
    FROM [Specializations] AS [s]
    WHERE [s].[SpecializationId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [b].[BranchId], [b].[SpecializationId], [b0].[BranchId] AS [BranchId0], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [BranchSpecializations] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
) AS [t0] ON [t].[SpecializationId] = [t0].[SpecializationId]
LEFT JOIN (
    SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
) AS [t1] ON [t].[SpecializationId] = [t1].[SpecializationId]
ORDER BY [t].[SpecializationId], [t0].[BranchId], [t0].[SpecializationId], [t0].[BranchId0], [t1].[DoctorId]
2025-11-24 01:46:48.162 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[SpecializationId], [t].[CreatedAt], [t].[Description], [t].[Name], [t].[UpdatedAt], [t0].[BranchId], [t0].[SpecializationId], [t0].[BranchId0], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [t1].[DoctorId], [t1].[Available], [t1].[Biography], [t1].[ConsultationFees], [t1].[CreatedAt], [t1].[ExperienceYears], [t1].[ImageURL], [t1].[SpecializationId], [t1].[UpdatedAt], [t1].[UserId], [t1].[Id], [t1].[AccessFailedCount], [t1].[ConcurrencyStamp], [t1].[CreatedAt0], [t1].[DateOfBirth], [t1].[Email], [t1].[EmailConfirmed], [t1].[FullName], [t1].[Gender], [t1].[LockoutEnabled], [t1].[LockoutEnd], [t1].[NormalizedEmail], [t1].[NormalizedUserName], [t1].[PasswordHash], [t1].[PhoneNumber], [t1].[PhoneNumberConfirmed], [t1].[RefreshToken], [t1].[RefreshTokenExpiryTime], [t1].[Role], [t1].[SecurityStamp], [t1].[TwoFactorEnabled], [t1].[UpdatedAt0], [t1].[UserName]
FROM (
    SELECT TOP(1) [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt]
    FROM [Specializations] AS [s]
    WHERE [s].[SpecializationId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [b].[BranchId], [b].[SpecializationId], [b0].[BranchId] AS [BranchId0], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [BranchSpecializations] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
) AS [t0] ON [t].[SpecializationId] = [t0].[SpecializationId]
LEFT JOIN (
    SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
) AS [t1] ON [t].[SpecializationId] = [t1].[SpecializationId]
ORDER BY [t].[SpecializationId], [t0].[BranchId], [t0].[SpecializationId], [t0].[BranchId0], [t1].[DoctorId]
2025-11-24 01:46:48.168 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:46:48.170 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchSpecialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:46:48.173 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:46:48.176 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:46:48.178 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:46:48.180 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:46:48.181 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:46:48.184 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 16ms reading results.
2025-11-24 01:46:48.186 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:48.187 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 01:46:48.188 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:48.189 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:48.190 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:46:48.190 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:46:48.191 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:46:48.191 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt], [t].[BranchId], [t].[SpecializationId], [t].[BranchId0], [t].[Address], [t].[BranchName], [t].[CreatedAt], [t].[Description], [t].[Email], [t].[ImageURL], [t].[Phone], [t].[UpdatedAt], [t0].[DoctorId], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt0], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt0], [t0].[UserName]
FROM [Specializations] AS [s]
LEFT JOIN (
    SELECT [b].[BranchId], [b].[SpecializationId], [b0].[BranchId] AS [BranchId0], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [BranchSpecializations] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
) AS [t] ON [s].[SpecializationId] = [t].[SpecializationId]
LEFT JOIN (
    SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
) AS [t0] ON [s].[SpecializationId] = [t0].[SpecializationId]
ORDER BY [s].[SpecializationId], [t].[BranchId], [t].[SpecializationId], [t].[BranchId0], [t0].[DoctorId]
2025-11-24 01:46:48.195 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt], [t].[BranchId], [t].[SpecializationId], [t].[BranchId0], [t].[Address], [t].[BranchName], [t].[CreatedAt], [t].[Description], [t].[Email], [t].[ImageURL], [t].[Phone], [t].[UpdatedAt], [t0].[DoctorId], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt0], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt0], [t0].[UserName]
FROM [Specializations] AS [s]
LEFT JOIN (
    SELECT [b].[BranchId], [b].[SpecializationId], [b0].[BranchId] AS [BranchId0], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [BranchSpecializations] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
) AS [t] ON [s].[SpecializationId] = [t].[SpecializationId]
LEFT JOIN (
    SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
) AS [t0] ON [s].[SpecializationId] = [t0].[SpecializationId]
ORDER BY [s].[SpecializationId], [t].[BranchId], [t].[SpecializationId], [t].[BranchId0], [t0].[DoctorId]
2025-11-24 01:46:48.199 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:46:48.200 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 01:46:48.203 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:48.205 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (2ms).
2025-11-24 01:46:48.207 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:48.208 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:48.209 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:46:48.209 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:46:48.210 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:46:48.211 +02:00 [DBG] Executing DbCommand [Parameters=[@__branchIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [b0].[value]
    FROM OPENJSON(@__branchIds_0) WITH ([value] int '$') AS [b0]
)
2025-11-24 01:46:48.213 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__branchIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [b0].[value]
    FROM OPENJSON(@__branchIds_0) WITH ([value] int '$') AS [b0]
)
2025-11-24 01:46:48.217 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:46:48.219 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 2ms reading results.
2025-11-24 01:46:48.220 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:48.221 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:46:48.223 +02:00 [WRN] Branches with IDs 1 not found
2025-11-24 01:46:48.270 +02:00 [INF] Executed action Hospital.Controllers.SpecializationsController.Update (Hospital) in 131.7095ms
2025-11-24 01:46:48.271 +02:00 [INF] Executed endpoint 'Hospital.Controllers.SpecializationsController.Update (Hospital)'
2025-11-24 01:46:48.326 +02:00 [ERR]  Exception caught: Branches with IDs 1 not found.
System.Collections.Generic.KeyNotFoundException: Branches with IDs 1 not found.
   at Hospital.Infrastructure.Services.SpecializationService.UpdateAsync(UpdateSpecialization dto)
   at Hospital.Controllers.SpecializationsController.Update(UpdateSpecialization dto) in D:\Walaa\GP\Hospital\Hospital\Controllers\SpecializationsController.cs:line 127
   at lambda_method1228(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
2025-11-24 01:46:48.343 +02:00 [DBG] Connection id "0HNHAT4T4JIFN" completed keep alive response.
2025-11-24 01:46:48.346 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:46:48.348 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:48.353 +02:00 [DBG] Disposed connection to database '' on server '' (4ms).
2025-11-24 01:46:48.355 +02:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7217/api/Specializations/Update - 404 null application/json 240.0235ms
2025-11-24 01:46:58.696 +02:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7217/api/Specializations/Update - application/json 202
2025-11-24 01:46:58.701 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Specializations/Update'
2025-11-24 01:46:58.704 +02:00 [DBG] Endpoint 'Hospital.Controllers.SpecializationsController.Update (Hospital)' with route pattern 'api/Specializations/Update' is valid for the request path '/api/Specializations/Update'
2025-11-24 01:46:58.706 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.SpecializationsController.Update (Hospital)'
2025-11-24 01:46:58.707 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:46:58.707 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:46:58.710 +02:00 [INF] Executing endpoint 'Hospital.Controllers.SpecializationsController.Update (Hospital)'
2025-11-24 01:46:58.711 +02:00 [INF] Route matched with {action = "Update", controller = "Specializations"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Hospital.Application.DTO.Specialization.SpecializationDTO]] Update(Hospital.Application.DTO.Specialization.UpdateSpecialization) on controller Hospital.Controllers.SpecializationsController (Hospital).
2025-11-24 01:46:58.713 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:46:58.714 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:46:58.716 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:46:58.720 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:46:58.722 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:46:58.725 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.SpecializationsController (Hospital)
2025-11-24 01:46:58.728 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.SpecializationsController (Hospital)
2025-11-24 01:46:58.729 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Specialization.UpdateSpecialization' ...
2025-11-24 01:46:58.732 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Specialization.UpdateSpecialization' using the name '' in request data ...
2025-11-24 01:46:58.735 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 01:46:58.739 +02:00 [DBG] Connection id "0HNHAT4T4JIFN", Request id "0HNHAT4T4JIFN:0000000A": started reading request body.
2025-11-24 01:46:58.739 +02:00 [DBG] Connection id "0HNHAT4T4JIFN", Request id "0HNHAT4T4JIFN:0000000A": done reading request body.
2025-11-24 01:46:58.740 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Specialization.UpdateSpecialization'
2025-11-24 01:46:58.741 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Specialization.UpdateSpecialization'.
2025-11-24 01:46:58.748 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Specialization.UpdateSpecialization'.
2025-11-24 01:46:58.752 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Specialization.UpdateSpecialization' ...
2025-11-24 01:46:58.755 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Specialization.UpdateSpecialization'.
2025-11-24 01:46:58.756 +02:00 [INF] update Specialization called at "2025-11-24T01:46:58.7566963+02:00"
2025-11-24 01:46:58.758 +02:00 [INF] Updating specialization with ID 1
2025-11-24 01:46:58.759 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:46:58.762 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:46:58.763 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 01:46:58.764 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:58.766 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:58.767 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:46:58.768 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:46:58.769 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:46:58.769 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[SpecializationId], [t].[CreatedAt], [t].[Description], [t].[Name], [t].[UpdatedAt], [t0].[BranchId], [t0].[SpecializationId], [t0].[BranchId0], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [t1].[DoctorId], [t1].[Available], [t1].[Biography], [t1].[ConsultationFees], [t1].[CreatedAt], [t1].[ExperienceYears], [t1].[ImageURL], [t1].[SpecializationId], [t1].[UpdatedAt], [t1].[UserId], [t1].[Id], [t1].[AccessFailedCount], [t1].[ConcurrencyStamp], [t1].[CreatedAt0], [t1].[DateOfBirth], [t1].[Email], [t1].[EmailConfirmed], [t1].[FullName], [t1].[Gender], [t1].[LockoutEnabled], [t1].[LockoutEnd], [t1].[NormalizedEmail], [t1].[NormalizedUserName], [t1].[PasswordHash], [t1].[PhoneNumber], [t1].[PhoneNumberConfirmed], [t1].[RefreshToken], [t1].[RefreshTokenExpiryTime], [t1].[Role], [t1].[SecurityStamp], [t1].[TwoFactorEnabled], [t1].[UpdatedAt0], [t1].[UserName]
FROM (
    SELECT TOP(1) [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt]
    FROM [Specializations] AS [s]
    WHERE [s].[SpecializationId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [b].[BranchId], [b].[SpecializationId], [b0].[BranchId] AS [BranchId0], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [BranchSpecializations] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
) AS [t0] ON [t].[SpecializationId] = [t0].[SpecializationId]
LEFT JOIN (
    SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
) AS [t1] ON [t].[SpecializationId] = [t1].[SpecializationId]
ORDER BY [t].[SpecializationId], [t0].[BranchId], [t0].[SpecializationId], [t0].[BranchId0], [t1].[DoctorId]
2025-11-24 01:46:58.775 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[SpecializationId], [t].[CreatedAt], [t].[Description], [t].[Name], [t].[UpdatedAt], [t0].[BranchId], [t0].[SpecializationId], [t0].[BranchId0], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [t1].[DoctorId], [t1].[Available], [t1].[Biography], [t1].[ConsultationFees], [t1].[CreatedAt], [t1].[ExperienceYears], [t1].[ImageURL], [t1].[SpecializationId], [t1].[UpdatedAt], [t1].[UserId], [t1].[Id], [t1].[AccessFailedCount], [t1].[ConcurrencyStamp], [t1].[CreatedAt0], [t1].[DateOfBirth], [t1].[Email], [t1].[EmailConfirmed], [t1].[FullName], [t1].[Gender], [t1].[LockoutEnabled], [t1].[LockoutEnd], [t1].[NormalizedEmail], [t1].[NormalizedUserName], [t1].[PasswordHash], [t1].[PhoneNumber], [t1].[PhoneNumberConfirmed], [t1].[RefreshToken], [t1].[RefreshTokenExpiryTime], [t1].[Role], [t1].[SecurityStamp], [t1].[TwoFactorEnabled], [t1].[UpdatedAt0], [t1].[UserName]
FROM (
    SELECT TOP(1) [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt]
    FROM [Specializations] AS [s]
    WHERE [s].[SpecializationId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [b].[BranchId], [b].[SpecializationId], [b0].[BranchId] AS [BranchId0], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [BranchSpecializations] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
) AS [t0] ON [t].[SpecializationId] = [t0].[SpecializationId]
LEFT JOIN (
    SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
) AS [t1] ON [t].[SpecializationId] = [t1].[SpecializationId]
ORDER BY [t].[SpecializationId], [t0].[BranchId], [t0].[SpecializationId], [t0].[BranchId0], [t1].[DoctorId]
2025-11-24 01:46:58.779 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:46:58.780 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchSpecialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:46:58.781 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:46:58.782 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:46:58.783 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:46:58.784 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:46:58.785 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:46:58.786 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 7ms reading results.
2025-11-24 01:46:58.786 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:58.787 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:46:58.789 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:58.789 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:58.790 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:46:58.791 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:46:58.792 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:46:58.793 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt], [t].[BranchId], [t].[SpecializationId], [t].[BranchId0], [t].[Address], [t].[BranchName], [t].[CreatedAt], [t].[Description], [t].[Email], [t].[ImageURL], [t].[Phone], [t].[UpdatedAt], [t0].[DoctorId], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt0], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt0], [t0].[UserName]
FROM [Specializations] AS [s]
LEFT JOIN (
    SELECT [b].[BranchId], [b].[SpecializationId], [b0].[BranchId] AS [BranchId0], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [BranchSpecializations] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
) AS [t] ON [s].[SpecializationId] = [t].[SpecializationId]
LEFT JOIN (
    SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
) AS [t0] ON [s].[SpecializationId] = [t0].[SpecializationId]
ORDER BY [s].[SpecializationId], [t].[BranchId], [t].[SpecializationId], [t].[BranchId0], [t0].[DoctorId]
2025-11-24 01:46:58.798 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt], [t].[BranchId], [t].[SpecializationId], [t].[BranchId0], [t].[Address], [t].[BranchName], [t].[CreatedAt], [t].[Description], [t].[Email], [t].[ImageURL], [t].[Phone], [t].[UpdatedAt], [t0].[DoctorId], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt0], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt0], [t0].[UserName]
FROM [Specializations] AS [s]
LEFT JOIN (
    SELECT [b].[BranchId], [b].[SpecializationId], [b0].[BranchId] AS [BranchId0], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [BranchSpecializations] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
) AS [t] ON [s].[SpecializationId] = [t].[SpecializationId]
LEFT JOIN (
    SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
) AS [t0] ON [s].[SpecializationId] = [t0].[SpecializationId]
ORDER BY [s].[SpecializationId], [t].[BranchId], [t].[SpecializationId], [t].[BranchId0], [t0].[DoctorId]
2025-11-24 01:46:58.802 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:46:58.803 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 01:46:58.804 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:58.807 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (2ms).
2025-11-24 01:46:58.808 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:58.810 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:58.811 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:46:58.812 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:46:58.813 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:46:58.815 +02:00 [DBG] Executing DbCommand [Parameters=[@__branchIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [b0].[value]
    FROM OPENJSON(@__branchIds_0) WITH ([value] int '$') AS [b0]
)
2025-11-24 01:46:58.821 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@__branchIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [b0].[value]
    FROM OPENJSON(@__branchIds_0) WITH ([value] int '$') AS [b0]
)
2025-11-24 01:46:58.823 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:46:58.825 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 2ms reading results.
2025-11-24 01:46:58.826 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:58.828 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 01:46:58.830 +02:00 [DBG] An entity of type 'Specialization' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:46:58.834 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:46:58.837 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:46:58.838 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 01:46:58.840 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:46:58.841 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:46:58.842 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:58.843 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:58.847 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:46:58.849 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:46:58.855 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (7ms).
2025-11-24 01:46:58.856 +02:00 [DBG] Executing DbCommand [Parameters=[@p4='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (Size = 120), @p3='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Specializations] SET [CreatedAt] = @p0, [Description] = @p1, [Name] = @p2, [UpdatedAt] = @p3
OUTPUT 1
WHERE [SpecializationId] = @p4;
2025-11-24 01:46:58.866 +02:00 [INF] Executed DbCommand (10ms) [Parameters=[@p4='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (Size = 120), @p3='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Specializations] SET [CreatedAt] = @p0, [Description] = @p1, [Name] = @p2, [UpdatedAt] = @p3
OUTPUT 1
WHERE [SpecializationId] = @p4;
2025-11-24 01:46:58.871 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:46:58.874 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 2ms reading results.
2025-11-24 01:46:58.877 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:58.878 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 01:46:58.879 +02:00 [DBG] An entity of type 'Specialization' tracked by 'AppDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:46:58.880 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 01:46:58.881 +02:00 [INF] Specialization 1 updated successfully
2025-11-24 01:46:58.884 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:46:58.886 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:46:58.886 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:46:58.887 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:46:58.887 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter' and content type 'text/plain' to write the response.
2025-11-24 01:46:58.888 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.String'.
2025-11-24 01:46:58.888 +02:00 [INF] Executed action Hospital.Controllers.SpecializationsController.Update (Hospital) in 163.5453ms
2025-11-24 01:46:58.889 +02:00 [INF] Executed endpoint 'Hospital.Controllers.SpecializationsController.Update (Hospital)'
2025-11-24 01:46:58.890 +02:00 [DBG] Connection id "0HNHAT4T4JIFN" completed keep alive response.
2025-11-24 01:46:58.892 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:46:58.892 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:46:58.894 +02:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-11-24 01:46:58.895 +02:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7217/api/Specializations/Update - 200 null text/plain; charset=utf-8 198.25ms
2025-11-24 01:47:09.156 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Specializations/Branch/6 - null null
2025-11-24 01:47:09.158 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Specializations/Branch/6'
2025-11-24 01:47:09.162 +02:00 [DBG] Endpoint 'Hospital.Controllers.SpecializationsController.GetAllByBranch (Hospital)' with route pattern 'api/Specializations/Branch/{branchId}' is valid for the request path '/api/Specializations/Branch/6'
2025-11-24 01:47:09.166 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.SpecializationsController.GetAllByBranch (Hospital)'
2025-11-24 01:47:09.167 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:47:09.168 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:47:09.169 +02:00 [INF] Executing endpoint 'Hospital.Controllers.SpecializationsController.GetAllByBranch (Hospital)'
2025-11-24 01:47:09.172 +02:00 [INF] Route matched with {action = "GetAllByBranch", controller = "Specializations"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IEnumerable`1[Hospital.Application.DTO.Specialization.SpecializationDTO]]] GetAllByBranch(Int32) on controller Hospital.Controllers.SpecializationsController (Hospital).
2025-11-24 01:47:09.176 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:47:09.178 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:47:09.179 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:47:09.181 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:47:09.182 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:47:09.182 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.SpecializationsController (Hospital)
2025-11-24 01:47:09.184 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.SpecializationsController (Hospital)
2025-11-24 01:47:09.185 +02:00 [DBG] Attempting to bind parameter 'branchId' of type 'System.Int32' ...
2025-11-24 01:47:09.186 +02:00 [DBG] Attempting to bind parameter 'branchId' of type 'System.Int32' using the name 'branchId' in request data ...
2025-11-24 01:47:09.187 +02:00 [DBG] Done attempting to bind parameter 'branchId' of type 'System.Int32'.
2025-11-24 01:47:09.187 +02:00 [DBG] Done attempting to bind parameter 'branchId' of type 'System.Int32'.
2025-11-24 01:47:09.188 +02:00 [DBG] Attempting to validate the bound parameter 'branchId' of type 'System.Int32' ...
2025-11-24 01:47:09.189 +02:00 [DBG] Done attempting to validate the bound parameter 'branchId' of type 'System.Int32'.
2025-11-24 01:47:09.190 +02:00 [INF] get all Specialization by branch id called at "2025-11-24T01:47:09.1903791+02:00"
2025-11-24 01:47:09.191 +02:00 [INF] Fetching all specializations for branch 6
2025-11-24 01:47:09.193 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:47:09.196 +02:00 [DBG] Compiling query expression: 
'DbSet<Specialization>()
    .Include(s => s.Branches)
    .Include(s => s.Doctors)
    .ThenInclude(d => d.User)
    .Where(s => s.Branches
        .Any(b => b.BranchId == __branchId_0))'
2025-11-24 01:47:09.199 +02:00 [DBG] Including navigation: 'Specialization.Branches'.
2025-11-24 01:47:09.199 +02:00 [DBG] Including navigation: 'Specialization.Doctors'.
2025-11-24 01:47:09.200 +02:00 [DBG] Including navigation: 'Doctor.User'.
2025-11-24 01:47:09.213 +02:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-11-24 01:47:09.219 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Specialization>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Specialization.SpecializationId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Specialization.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: Specialization.Description (string), 2], [Property: Specialization.Name (string) Required MaxLength(120), 3], [Property: Specialization.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 4] }
            1 -> 0
            2 -> Dictionary<IProperty, int> { [Property: BranchSpecialization (Dictionary<string, object>).BranchId (no field, int) Indexer Required PK FK AfterSave:Throw, 5], [Property: BranchSpecialization (Dictionary<string, object>).SpecializationId (no field, int) Indexer Required PK FK Index AfterSave:Throw, 6] }
            3 -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Branch.Address (string) MaxLength(250), 8], [Property: Branch.BranchName (string) Required MaxLength(150), 9], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 10], [Property: Branch.Description (string), 11], [Property: Branch.Email (string) MaxLength(200), 12], [Property: Branch.ImageURL (string) MaxLength(300), 13], [Property: Branch.Phone (string) MaxLength(25), 14], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 15] }
            4 -> 5
            5 -> 6
            6 -> 7
            7 -> Dictionary<IProperty, int> { [Property: Doctor.DoctorId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 16], [Property: Doctor.Available (bool?), 17], [Property: Doctor.Biography (string), 18], [Property: Doctor.ConsultationFees (decimal) Required, 19], [Property: Doctor.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 20], [Property: Doctor.ExperienceYears (int?), 21], [Property: Doctor.ImageURL (string) MaxLength(300), 22], [Property: Doctor.SpecializationId (int) Required FK Index, 23], [Property: Doctor.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 24], [Property: Doctor.UserId (string) Required FK Index, 25] }
            8 -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 26], [Property: User.AccessFailedCount (int) Required, 27], [Property: User.ConcurrencyStamp (string) Concurrency, 28], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 29], [Property: User.DateOfBirth (DateOnly?), 30], [Property: User.Email (string) Index MaxLength(256), 31], [Property: User.EmailConfirmed (bool) Required, 32], [Property: User.FullName (string) Required MaxLength(150), 33], [Property: User.Gender (GenderType?) MaxLength(10), 34], [Property: User.LockoutEnabled (bool) Required, 35], [Property: User.LockoutEnd (DateTimeOffset?), 36], [Property: User.NormalizedEmail (string) Index MaxLength(256), 37], [Property: User.NormalizedUserName (string) Index MaxLength(256), 38], [Property: User.PasswordHash (string), 39], [Property: User.PhoneNumber (string), 40], [Property: User.PhoneNumberConfirmed (bool) Required, 41], [Property: User.RefreshToken (string), 42], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 43], [Property: User.Role (string) Required MaxLength(50), 44], [Property: User.SecurityStamp (string), 45], [Property: User.TwoFactorEnabled (bool) Required, 46], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 47], [Property: User.UserName (string) MaxLength(256), 48] }
            9 -> 16
            10 -> 26
        SELECT s.SpecializationId, s.CreatedAt, s.Description, s.Name, s.UpdatedAt, t.BranchId, t.SpecializationId, t.BranchId0, t.Address, t.BranchName, t.CreatedAt, t.Description, t.Email, t.ImageURL, t.Phone, t.UpdatedAt, t0.DoctorId, t0.Available, t0.Biography, t0.ConsultationFees, t0.CreatedAt, t0.ExperienceYears, t0.ImageURL, t0.SpecializationId, t0.UpdatedAt, t0.UserId, t0.Id, t0.AccessFailedCount, t0.ConcurrencyStamp, t0.CreatedAt0, t0.DateOfBirth, t0.Email, t0.EmailConfirmed, t0.FullName, t0.Gender, t0.LockoutEnabled, t0.LockoutEnd, t0.NormalizedEmail, t0.NormalizedUserName, t0.PasswordHash, t0.PhoneNumber, t0.PhoneNumberConfirmed, t0.RefreshToken, t0.RefreshTokenExpiryTime, t0.Role, t0.SecurityStamp, t0.TwoFactorEnabled, t0.UpdatedAt0, t0.UserName
        FROM Specializations AS s
        LEFT JOIN 
        (
            SELECT b1.BranchId, b1.SpecializationId, b2.BranchId AS BranchId0, b2.Address, b2.BranchName, b2.CreatedAt, b2.Description, b2.Email, b2.ImageURL, b2.Phone, b2.UpdatedAt
            FROM BranchSpecializations AS b1
            INNER JOIN Branches AS b2 ON b1.BranchId == b2.BranchId
        ) AS t ON s.SpecializationId == t.SpecializationId
        LEFT JOIN 
        (
            SELECT d.DoctorId, d.Available, d.Biography, d.ConsultationFees, d.CreatedAt, d.ExperienceYears, d.ImageURL, d.SpecializationId, d.UpdatedAt, d.UserId, u.Id, u.AccessFailedCount, u.ConcurrencyStamp, u.CreatedAt AS CreatedAt0, u.DateOfBirth, u.Email, u.EmailConfirmed, u.FullName, u.Gender, u.LockoutEnabled, u.LockoutEnd, u.NormalizedEmail, u.NormalizedUserName, u.PasswordHash, u.PhoneNumber, u.PhoneNumberConfirmed, u.RefreshToken, u.RefreshTokenExpiryTime, u.Role, u.SecurityStamp, u.TwoFactorEnabled, u.UpdatedAt AS UpdatedAt0, u.UserName
            FROM Doctors AS d
            INNER JOIN Users AS u ON d.UserId == u.Id
        ) AS t0 ON s.SpecializationId == t0.SpecializationId
        WHERE EXISTS (
            SELECT 1
            FROM BranchSpecializations AS b
            INNER JOIN Branches AS b0 ON b.BranchId == b0.BranchId
            WHERE ((s.SpecializationId != NULL) && (s.SpecializationId == b.SpecializationId)) && (b0.BranchId == @__branchId_0))
        ORDER BY s.SpecializationId ASC, t.BranchId ASC, t.SpecializationId ASC, t.BranchId0 ASC, t0.DoctorId ASC), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Specialization>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 01:47:09.226 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:47:09.226 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 01:47:09.227 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:47:09.228 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:47:09.229 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:47:09.229 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:47:09.230 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:47:09.231 +02:00 [DBG] Executing DbCommand [Parameters=[@__branchId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt], [t].[BranchId], [t].[SpecializationId], [t].[BranchId0], [t].[Address], [t].[BranchName], [t].[CreatedAt], [t].[Description], [t].[Email], [t].[ImageURL], [t].[Phone], [t].[UpdatedAt], [t0].[DoctorId], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt0], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt0], [t0].[UserName]
FROM [Specializations] AS [s]
LEFT JOIN (
    SELECT [b1].[BranchId], [b1].[SpecializationId], [b2].[BranchId] AS [BranchId0], [b2].[Address], [b2].[BranchName], [b2].[CreatedAt], [b2].[Description], [b2].[Email], [b2].[ImageURL], [b2].[Phone], [b2].[UpdatedAt]
    FROM [BranchSpecializations] AS [b1]
    INNER JOIN [Branches] AS [b2] ON [b1].[BranchId] = [b2].[BranchId]
) AS [t] ON [s].[SpecializationId] = [t].[SpecializationId]
LEFT JOIN (
    SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
) AS [t0] ON [s].[SpecializationId] = [t0].[SpecializationId]
WHERE EXISTS (
    SELECT 1
    FROM [BranchSpecializations] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
    WHERE [s].[SpecializationId] = [b].[SpecializationId] AND [b0].[BranchId] = @__branchId_0)
ORDER BY [s].[SpecializationId], [t].[BranchId], [t].[SpecializationId], [t].[BranchId0], [t0].[DoctorId]
2025-11-24 01:47:09.252 +02:00 [INF] Executed DbCommand (21ms) [Parameters=[@__branchId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt], [t].[BranchId], [t].[SpecializationId], [t].[BranchId0], [t].[Address], [t].[BranchName], [t].[CreatedAt], [t].[Description], [t].[Email], [t].[ImageURL], [t].[Phone], [t].[UpdatedAt], [t0].[DoctorId], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt0], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt0], [t0].[UserName]
FROM [Specializations] AS [s]
LEFT JOIN (
    SELECT [b1].[BranchId], [b1].[SpecializationId], [b2].[BranchId] AS [BranchId0], [b2].[Address], [b2].[BranchName], [b2].[CreatedAt], [b2].[Description], [b2].[Email], [b2].[ImageURL], [b2].[Phone], [b2].[UpdatedAt]
    FROM [BranchSpecializations] AS [b1]
    INNER JOIN [Branches] AS [b2] ON [b1].[BranchId] = [b2].[BranchId]
) AS [t] ON [s].[SpecializationId] = [t].[SpecializationId]
LEFT JOIN (
    SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
) AS [t0] ON [s].[SpecializationId] = [t0].[SpecializationId]
WHERE EXISTS (
    SELECT 1
    FROM [BranchSpecializations] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
    WHERE [s].[SpecializationId] = [b].[SpecializationId] AND [b0].[BranchId] = @__branchId_0)
ORDER BY [s].[SpecializationId], [t].[BranchId], [t].[SpecializationId], [t].[BranchId0], [t0].[DoctorId]
2025-11-24 01:47:09.257 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:47:09.258 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 01:47:09.259 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:47:09.260 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:47:09.267 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:47:09.271 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:47:09.271 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:47:09.274 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:47:09.278 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 01:47:09.279 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Specialization.SpecializationInfoDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 01:47:09.282 +02:00 [INF] Executed action Hospital.Controllers.SpecializationsController.GetAllByBranch (Hospital) in 99.4532ms
2025-11-24 01:47:09.283 +02:00 [INF] Executed endpoint 'Hospital.Controllers.SpecializationsController.GetAllByBranch (Hospital)'
2025-11-24 01:47:09.284 +02:00 [DBG] Connection id "0HNHAT4T4JIFN" completed keep alive response.
2025-11-24 01:47:09.286 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:47:09.287 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:47:09.288 +02:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-11-24 01:47:09.289 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Specializations/Branch/6 - 200 null application/json; charset=utf-8 133.8448ms
2025-11-24 01:49:28.744 +02:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-11-24 01:49:28.869 +02:00 [DBG] Hosting starting
2025-11-24 01:49:28.899 +02:00 [INF] User profile is available. Using 'C:\Users\E-Mad\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-24 01:49:28.907 +02:00 [DBG] Reading data from file 'C:\Users\E-Mad\AppData\Local\ASP.NET\DataProtection-Keys\key-b85f0939-0825-4b2b-b21a-67409aec9db0.xml'.
2025-11-24 01:49:28.919 +02:00 [DBG] Found key {b85f0939-0825-4b2b-b21a-67409aec9db0}.
2025-11-24 01:49:28.927 +02:00 [DBG] Considering key {b85f0939-0825-4b2b-b21a-67409aec9db0} with expiration date 2026-02-09 12:52:20Z as default key.
2025-11-24 01:49:28.931 +02:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-11-24 01:49:28.934 +02:00 [DBG] Decrypting secret element using Windows DPAPI.
2025-11-24 01:49:28.936 +02:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-11-24 01:49:28.940 +02:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-11-24 01:49:28.942 +02:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-11-24 01:49:28.945 +02:00 [DBG] Using key {b85f0939-0825-4b2b-b21a-67409aec9db0} as the default key.
2025-11-24 01:49:28.947 +02:00 [DBG] Key ring with default key {b85f0939-0825-4b2b-b21a-67409aec9db0} was loaded during application startup.
2025-11-24 01:49:28.952 +02:00 [DBG] Middleware loaded
2025-11-24 01:49:28.955 +02:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16501 B).
2025-11-24 01:49:28.957 +02:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-11-24 01:49:29.043 +02:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-11-24 01:49:29.127 +02:00 [INF] Now listening on: https://localhost:7217
2025-11-24 01:49:29.128 +02:00 [INF] Now listening on: http://localhost:5163
2025-11-24 01:49:29.129 +02:00 [DBG] Loaded hosting startup assembly Hospital
2025-11-24 01:49:29.130 +02:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-11-24 01:49:29.131 +02:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-11-24 01:49:29.131 +02:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-11-24 01:49:29.221 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-24 01:49:29.223 +02:00 [INF] Hosting environment: Development
2025-11-24 01:49:29.227 +02:00 [INF] Content root path: D:\Walaa\GP\Hospital\Hospital
2025-11-24 01:49:29.229 +02:00 [DBG] Hosting started
2025-11-24 01:49:29.320 +02:00 [DBG] Connection id "0HNHATBOLMOQ8" accepted.
2025-11-24 01:49:29.322 +02:00 [DBG] Connection id "0HNHATBOLMOQ8" started.
2025-11-24 01:49:29.332 +02:00 [DBG] Connection id "0HNHATBOLMOQ8" received FIN.
2025-11-24 01:49:29.332 +02:00 [DBG] Connection id "0HNHATBOLMOQ9" received FIN.
2025-11-24 01:49:29.337 +02:00 [DBG] Connection id "0HNHATBOLMOQ9" accepted.
2025-11-24 01:49:29.347 +02:00 [DBG] Connection id "0HNHATBOLMOQ9" started.
2025-11-24 01:49:29.357 +02:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-11-24 01:49:29.357 +02:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-11-24 01:49:29.390 +02:00 [DBG] Connection id "0HNHATBOLMOQ9" stopped.
2025-11-24 01:49:29.390 +02:00 [DBG] Connection id "0HNHATBOLMOQ8" stopped.
2025-11-24 01:49:29.394 +02:00 [DBG] Connection id "0HNHATBOLMOQ9" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-11-24 01:49:29.395 +02:00 [DBG] Connection id "0HNHATBOLMOQ8" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-11-24 01:49:29.561 +02:00 [DBG] Connection id "0HNHATBOLMOQA" accepted.
2025-11-24 01:49:29.563 +02:00 [DBG] Connection id "0HNHATBOLMOQA" started.
2025-11-24 01:49:29.626 +02:00 [DBG] Connection 0HNHATBOLMOQA established using the following protocol: "Tls12"
2025-11-24 01:49:29.697 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/swagger/index.html - null null
2025-11-24 01:49:29.791 +02:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-11-24 01:49:29.824 +02:00 [DBG] No candidates found for the request path '/swagger/index.html'
2025-11-24 01:49:29.825 +02:00 [DBG] Request did not match any endpoints
2025-11-24 01:49:29.868 +02:00 [DBG] Response markup is scheduled to include Browser Link script injection.
2025-11-24 01:49:29.870 +02:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2025-11-24 01:49:29.888 +02:00 [DBG] Response markup was updated to include Browser Link script injection.
2025-11-24 01:49:29.889 +02:00 [DBG] Response markup was updated to include browser refresh script injection.
2025-11-24 01:49:29.892 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/swagger/index.html - 200 null text/html;charset=utf-8 205.6558ms
2025-11-24 01:49:29.906 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/_framework/aspnetcore-browser-refresh.js - null null
2025-11-24 01:49:29.906 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/_vs/browserLink - null null
2025-11-24 01:49:29.918 +02:00 [DBG] Script injected: /_framework/aspnetcore-browser-refresh.js
2025-11-24 01:49:29.926 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/_framework/aspnetcore-browser-refresh.js - 200 16501 application/javascript; charset=utf-8 20.0867ms
2025-11-24 01:49:29.955 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/_vs/browserLink - 200 null text/javascript; charset=UTF-8 48.8712ms
2025-11-24 01:49:30.137 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/swagger/v1/swagger.json - null null
2025-11-24 01:49:30.142 +02:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2025-11-24 01:49:30.144 +02:00 [DBG] Request did not match any endpoints
2025-11-24 01:49:30.196 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 59.5039ms
2025-11-24 01:49:31.495 +02:00 [DBG] Connection id "0HNHATBOLMOQA" received FIN.
2025-11-24 01:49:31.501 +02:00 [DBG] The connection queue processing loop for 0HNHATBOLMOQA completed.
2025-11-24 01:49:31.505 +02:00 [DBG] Connection id "0HNHATBOLMOQA" is closed. The last processed stream ID was 7.
2025-11-24 01:49:31.511 +02:00 [DBG] Connection id "0HNHATBOLMOQA" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-11-24 01:49:31.527 +02:00 [DBG] Connection id "0HNHATBOLMOQA" stopped.
2025-11-24 01:50:34.564 +02:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-11-24 01:50:34.689 +02:00 [DBG] Hosting starting
2025-11-24 01:50:34.720 +02:00 [INF] User profile is available. Using 'C:\Users\E-Mad\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-24 01:50:34.731 +02:00 [DBG] Reading data from file 'C:\Users\E-Mad\AppData\Local\ASP.NET\DataProtection-Keys\key-b85f0939-0825-4b2b-b21a-67409aec9db0.xml'.
2025-11-24 01:50:34.743 +02:00 [DBG] Found key {b85f0939-0825-4b2b-b21a-67409aec9db0}.
2025-11-24 01:50:34.751 +02:00 [DBG] Considering key {b85f0939-0825-4b2b-b21a-67409aec9db0} with expiration date 2026-02-09 12:52:20Z as default key.
2025-11-24 01:50:34.758 +02:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-11-24 01:50:34.761 +02:00 [DBG] Decrypting secret element using Windows DPAPI.
2025-11-24 01:50:34.764 +02:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-11-24 01:50:34.770 +02:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-11-24 01:50:34.775 +02:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-11-24 01:50:34.777 +02:00 [DBG] Using key {b85f0939-0825-4b2b-b21a-67409aec9db0} as the default key.
2025-11-24 01:50:34.779 +02:00 [DBG] Key ring with default key {b85f0939-0825-4b2b-b21a-67409aec9db0} was loaded during application startup.
2025-11-24 01:50:34.786 +02:00 [DBG] Middleware loaded
2025-11-24 01:50:34.790 +02:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16501 B).
2025-11-24 01:50:34.793 +02:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-11-24 01:50:34.887 +02:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-11-24 01:50:34.980 +02:00 [INF] Now listening on: https://localhost:7217
2025-11-24 01:50:34.982 +02:00 [INF] Now listening on: http://localhost:5163
2025-11-24 01:50:34.983 +02:00 [DBG] Loaded hosting startup assembly Hospital
2025-11-24 01:50:34.984 +02:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-11-24 01:50:34.984 +02:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-11-24 01:50:34.985 +02:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-11-24 01:50:35.066 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-24 01:50:35.066 +02:00 [INF] Hosting environment: Development
2025-11-24 01:50:35.067 +02:00 [INF] Content root path: D:\Walaa\GP\Hospital\Hospital
2025-11-24 01:50:35.068 +02:00 [DBG] Hosting started
2025-11-24 01:50:35.303 +02:00 [DBG] Connection id "0HNHATCCAV4K0" accepted.
2025-11-24 01:50:35.303 +02:00 [DBG] Connection id "0HNHATCCAV4JV" accepted.
2025-11-24 01:50:35.313 +02:00 [DBG] Connection id "0HNHATCCAV4K0" started.
2025-11-24 01:50:35.314 +02:00 [DBG] Connection id "0HNHATCCAV4JV" started.
2025-11-24 01:50:35.315 +02:00 [DBG] Connection id "0HNHATCCAV4K0" received FIN.
2025-11-24 01:50:35.315 +02:00 [DBG] Connection id "0HNHATCCAV4JV" received FIN.
2025-11-24 01:50:35.337 +02:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-11-24 01:50:35.337 +02:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-11-24 01:50:35.378 +02:00 [DBG] Connection id "0HNHATCCAV4JV" stopped.
2025-11-24 01:50:35.387 +02:00 [DBG] Connection id "0HNHATCCAV4K0" stopped.
2025-11-24 01:50:35.391 +02:00 [DBG] Connection id "0HNHATCCAV4K0" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-11-24 01:50:35.391 +02:00 [DBG] Connection id "0HNHATCCAV4JV" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-11-24 01:50:35.524 +02:00 [DBG] Connection id "0HNHATCCAV4K1" accepted.
2025-11-24 01:50:35.527 +02:00 [DBG] Connection id "0HNHATCCAV4K1" started.
2025-11-24 01:50:35.584 +02:00 [DBG] Connection 0HNHATCCAV4K1 established using the following protocol: "Tls12"
2025-11-24 01:50:35.647 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/swagger/index.html - null null
2025-11-24 01:50:35.740 +02:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-11-24 01:50:35.765 +02:00 [DBG] No candidates found for the request path '/swagger/index.html'
2025-11-24 01:50:35.767 +02:00 [DBG] Request did not match any endpoints
2025-11-24 01:50:35.814 +02:00 [DBG] Response markup is scheduled to include Browser Link script injection.
2025-11-24 01:50:35.817 +02:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2025-11-24 01:50:35.831 +02:00 [DBG] Response markup was updated to include Browser Link script injection.
2025-11-24 01:50:35.833 +02:00 [DBG] Response markup was updated to include browser refresh script injection.
2025-11-24 01:50:35.837 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/swagger/index.html - 200 null text/html;charset=utf-8 198.8093ms
2025-11-24 01:50:35.855 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/_vs/browserLink - null null
2025-11-24 01:50:35.855 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/_framework/aspnetcore-browser-refresh.js - null null
2025-11-24 01:50:35.875 +02:00 [DBG] Script injected: /_framework/aspnetcore-browser-refresh.js
2025-11-24 01:50:35.879 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/_framework/aspnetcore-browser-refresh.js - 200 16501 application/javascript; charset=utf-8 24.6251ms
2025-11-24 01:50:35.904 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/_vs/browserLink - 200 null text/javascript; charset=UTF-8 49.5646ms
2025-11-24 01:50:35.984 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/swagger/v1/swagger.json - null null
2025-11-24 01:50:35.990 +02:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2025-11-24 01:50:35.992 +02:00 [DBG] Request did not match any endpoints
2025-11-24 01:50:36.038 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 53.5446ms
2025-11-24 01:50:41.717 +02:00 [DBG] Connection id "0HNHATCCAV4K2" received FIN.
2025-11-24 01:50:41.723 +02:00 [DBG] Connection id "0HNHATCCAV4K2" accepted.
2025-11-24 01:50:41.728 +02:00 [DBG] Connection id "0HNHATCCAV4K2" started.
2025-11-24 01:50:41.730 +02:00 [DBG] Connection id "0HNHATCCAV4K3" accepted.
2025-11-24 01:50:41.733 +02:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-11-24 01:50:41.736 +02:00 [DBG] Connection id "0HNHATCCAV4K3" started.
2025-11-24 01:50:41.744 +02:00 [DBG] Connection id "0HNHATCCAV4K2" stopped.
2025-11-24 01:50:41.754 +02:00 [DBG] Connection id "0HNHATCCAV4K2" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-11-24 01:50:41.758 +02:00 [DBG] Connection 0HNHATCCAV4K3 established using the following protocol: "Tls12"
2025-11-24 01:50:41.768 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Specializations/Branch/6 - null null
2025-11-24 01:50:41.779 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Specializations/Branch/6'
2025-11-24 01:50:41.787 +02:00 [DBG] Endpoint 'Hospital.Controllers.SpecializationsController.GetAllByBranch (Hospital)' with route pattern 'api/Specializations/Branch/{branchId}' is valid for the request path '/api/Specializations/Branch/6'
2025-11-24 01:50:41.793 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.SpecializationsController.GetAllByBranch (Hospital)'
2025-11-24 01:50:41.802 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:50:41.869 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:50:41.879 +02:00 [INF] Executing endpoint 'Hospital.Controllers.SpecializationsController.GetAllByBranch (Hospital)'
2025-11-24 01:50:41.933 +02:00 [INF] Route matched with {action = "GetAllByBranch", controller = "Specializations"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IEnumerable`1[Hospital.Application.DTO.Specialization.SpecializationDTO]]] GetAllByBranch(Int32) on controller Hospital.Controllers.SpecializationsController (Hospital).
2025-11-24 01:50:41.946 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:50:41.951 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:50:41.957 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:50:41.960 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:50:41.961 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:50:41.963 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.SpecializationsController (Hospital)
2025-11-24 01:50:42.125 +02:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-11-24 01:50:42.389 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.SpecializationsController (Hospital)
2025-11-24 01:50:42.406 +02:00 [DBG] Attempting to bind parameter 'branchId' of type 'System.Int32' ...
2025-11-24 01:50:42.415 +02:00 [DBG] Attempting to bind parameter 'branchId' of type 'System.Int32' using the name 'branchId' in request data ...
2025-11-24 01:50:42.418 +02:00 [DBG] Done attempting to bind parameter 'branchId' of type 'System.Int32'.
2025-11-24 01:50:42.426 +02:00 [DBG] Done attempting to bind parameter 'branchId' of type 'System.Int32'.
2025-11-24 01:50:42.430 +02:00 [DBG] Attempting to validate the bound parameter 'branchId' of type 'System.Int32' ...
2025-11-24 01:50:42.434 +02:00 [DBG] Done attempting to validate the bound parameter 'branchId' of type 'System.Int32'.
2025-11-24 01:50:42.439 +02:00 [INF] get all Specialization by branch id called at "2025-11-24T01:50:42.4388942+02:00"
2025-11-24 01:50:42.443 +02:00 [INF] Fetching all specializations for branch 6
2025-11-24 01:50:43.184 +02:00 [DBG] The index {'BranchesBranchId'} was not created on entity type 'BranchDoctor (Dictionary<string, object>)' as the properties are already covered by the index {'BranchesBranchId', 'DoctorsDoctorId'}.
2025-11-24 01:50:43.190 +02:00 [DBG] The index {'BranchId'} was not created on entity type 'BranchService (Dictionary<string, object>)' as the properties are already covered by the index {'BranchId', 'ServiceId'}.
2025-11-24 01:50:43.196 +02:00 [DBG] The index {'BranchId'} was not created on entity type 'BranchSpecialization (Dictionary<string, object>)' as the properties are already covered by the index {'BranchId', 'SpecializationId'}.
2025-11-24 01:50:43.199 +02:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserRole<string>' as the properties are already covered by the index {'UserId', 'RoleId'}.
2025-11-24 01:50:43.201 +02:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserToken<string>' as the properties are already covered by the index {'UserId', 'LoginProvider', 'Name'}.
2025-11-24 01:50:43.364 +02:00 [DBG] The property 'BranchDoctor (Dictionary<string, object>).BranchesBranchId' was created in shadow state because there are no eligible CLR members with a matching name.
2025-11-24 01:50:43.367 +02:00 [DBG] The property 'BranchDoctor (Dictionary<string, object>).DoctorsDoctorId' was created in shadow state because there are no eligible CLR members with a matching name.
2025-11-24 01:50:43.630 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:50:43.722 +02:00 [DBG] Compiling query expression: 
'DbSet<Branch>()
    .FirstOrDefault(e => e.BranchId == __id_0)'
2025-11-24 01:50:43.930 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Branch>(
    asyncEnumerable: new SingleQueryingEnumerable<Branch>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Branch.Address (string) MaxLength(250), 1], [Property: Branch.BranchName (string) Required MaxLength(150), 2], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 3], [Property: Branch.Description (string), 4], [Property: Branch.Email (string) MaxLength(200), 5], [Property: Branch.ImageURL (string) MaxLength(300), 6], [Property: Branch.Phone (string) MaxLength(25), 7], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 8] }
            SELECT TOP(1) b.BranchId, b.Address, b.BranchName, b.CreatedAt, b.Description, b.Email, b.ImageURL, b.Phone, b.UpdatedAt
            FROM Branches AS b
            WHERE b.BranchId == @__id_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Branch>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 01:50:43.979 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:50:43.999 +02:00 [DBG] Created DbConnection. (17ms).
2025-11-24 01:50:44.007 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:50:44.286 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:50:44.295 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:50:44.303 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (6ms).
2025-11-24 01:50:44.312 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (17ms).
2025-11-24 01:50:44.331 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 01:50:44.414 +02:00 [INF] Executed DbCommand (89ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 01:50:44.440 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:50:44.453 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 25ms reading results.
2025-11-24 01:50:44.461 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:50:44.475 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (14ms).
2025-11-24 01:50:44.482 +02:00 [WRN] Branch with ID 6 not found
2025-11-24 01:50:44.570 +02:00 [INF] Executed action Hospital.Controllers.SpecializationsController.GetAllByBranch (Hospital) in 2603.0513ms
2025-11-24 01:50:44.574 +02:00 [INF] Executed endpoint 'Hospital.Controllers.SpecializationsController.GetAllByBranch (Hospital)'
2025-11-24 01:50:44.665 +02:00 [ERR]  Exception caught: Branch not found.
System.Collections.Generic.KeyNotFoundException: Branch not found.
   at Hospital.Infrastructure.Services.SpecializationService.GetAllByBranchAsync(Int32 branchId) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\SpecializationService.cs:line 97
   at Hospital.Controllers.SpecializationsController.GetAllByBranch(Int32 branchId) in D:\Walaa\GP\Hospital\Hospital\Controllers\SpecializationsController.cs:line 148
   at lambda_method6(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
2025-11-24 01:50:44.733 +02:00 [DBG] Connection id "0HNHATCCAV4K3" completed keep alive response.
2025-11-24 01:50:44.742 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:50:44.753 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:50:44.757 +02:00 [DBG] Disposed connection to database '' on server '' (4ms).
2025-11-24 01:50:44.763 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Specializations/Branch/6 - 404 null application/json 2995.5743ms
2025-11-24 01:50:50.862 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Specializations/Branch/2 - null null
2025-11-24 01:50:50.867 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Specializations/Branch/2'
2025-11-24 01:50:50.870 +02:00 [DBG] Endpoint 'Hospital.Controllers.SpecializationsController.GetAllByBranch (Hospital)' with route pattern 'api/Specializations/Branch/{branchId}' is valid for the request path '/api/Specializations/Branch/2'
2025-11-24 01:50:50.871 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.SpecializationsController.GetAllByBranch (Hospital)'
2025-11-24 01:50:50.872 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:50:50.874 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:50:50.875 +02:00 [INF] Executing endpoint 'Hospital.Controllers.SpecializationsController.GetAllByBranch (Hospital)'
2025-11-24 01:50:50.877 +02:00 [INF] Route matched with {action = "GetAllByBranch", controller = "Specializations"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IEnumerable`1[Hospital.Application.DTO.Specialization.SpecializationDTO]]] GetAllByBranch(Int32) on controller Hospital.Controllers.SpecializationsController (Hospital).
2025-11-24 01:50:50.878 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:50:50.879 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:50:50.881 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:50:50.883 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:50:50.884 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:50:50.885 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.SpecializationsController (Hospital)
2025-11-24 01:50:50.887 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.SpecializationsController (Hospital)
2025-11-24 01:50:50.888 +02:00 [DBG] Attempting to bind parameter 'branchId' of type 'System.Int32' ...
2025-11-24 01:50:50.889 +02:00 [DBG] Attempting to bind parameter 'branchId' of type 'System.Int32' using the name 'branchId' in request data ...
2025-11-24 01:50:50.890 +02:00 [DBG] Done attempting to bind parameter 'branchId' of type 'System.Int32'.
2025-11-24 01:50:50.891 +02:00 [DBG] Done attempting to bind parameter 'branchId' of type 'System.Int32'.
2025-11-24 01:50:50.892 +02:00 [DBG] Attempting to validate the bound parameter 'branchId' of type 'System.Int32' ...
2025-11-24 01:50:50.893 +02:00 [DBG] Done attempting to validate the bound parameter 'branchId' of type 'System.Int32'.
2025-11-24 01:50:50.893 +02:00 [INF] get all Specialization by branch id called at "2025-11-24T01:50:50.8937813+02:00"
2025-11-24 01:50:50.894 +02:00 [INF] Fetching all specializations for branch 2
2025-11-24 01:50:50.956 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:50:50.967 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:50:50.968 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 01:50:50.971 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:50:50.973 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:50:50.976 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:50:50.978 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:50:50.980 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-11-24 01:50:50.982 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 01:50:50.991 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 01:50:51.062 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:50:51.102 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:50:51.105 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 110ms reading results.
2025-11-24 01:50:51.106 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:50:51.114 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (7ms).
2025-11-24 01:50:51.126 +02:00 [DBG] Compiling query expression: 
'DbSet<Specialization>()
    .Include(s => s.Branches)
    .Include(s => s.Doctors)
    .ThenInclude(d => d.User)
    .Where(s => s.Branches
        .Any(b => b.BranchId == __branchId_0))'
2025-11-24 01:50:51.147 +02:00 [DBG] Including navigation: 'Specialization.Branches'.
2025-11-24 01:50:51.156 +02:00 [DBG] Including navigation: 'Specialization.Doctors'.
2025-11-24 01:50:51.163 +02:00 [DBG] Including navigation: 'Doctor.User'.
2025-11-24 01:50:51.281 +02:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-11-24 01:50:51.292 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Specialization>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Specialization.SpecializationId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Specialization.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: Specialization.Description (string), 2], [Property: Specialization.Name (string) Required MaxLength(120), 3], [Property: Specialization.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 4] }
            1 -> 0
            2 -> Dictionary<IProperty, int> { [Property: BranchSpecialization (Dictionary<string, object>).BranchId (no field, int) Indexer Required PK FK AfterSave:Throw, 5], [Property: BranchSpecialization (Dictionary<string, object>).SpecializationId (no field, int) Indexer Required PK FK Index AfterSave:Throw, 6] }
            3 -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Branch.Address (string) MaxLength(250), 8], [Property: Branch.BranchName (string) Required MaxLength(150), 9], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 10], [Property: Branch.Description (string), 11], [Property: Branch.Email (string) MaxLength(200), 12], [Property: Branch.ImageURL (string) MaxLength(300), 13], [Property: Branch.Phone (string) MaxLength(25), 14], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 15] }
            4 -> 5
            5 -> 6
            6 -> 7
            7 -> Dictionary<IProperty, int> { [Property: Doctor.DoctorId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 16], [Property: Doctor.Available (bool?), 17], [Property: Doctor.Biography (string), 18], [Property: Doctor.ConsultationFees (decimal) Required, 19], [Property: Doctor.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 20], [Property: Doctor.ExperienceYears (int?), 21], [Property: Doctor.ImageURL (string) MaxLength(300), 22], [Property: Doctor.SpecializationId (int) Required FK Index, 23], [Property: Doctor.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 24], [Property: Doctor.UserId (string) Required FK Index, 25] }
            8 -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 26], [Property: User.AccessFailedCount (int) Required, 27], [Property: User.ConcurrencyStamp (string) Concurrency, 28], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 29], [Property: User.DateOfBirth (DateOnly?), 30], [Property: User.Email (string) Index MaxLength(256), 31], [Property: User.EmailConfirmed (bool) Required, 32], [Property: User.FullName (string) Required MaxLength(150), 33], [Property: User.Gender (GenderType?) MaxLength(10), 34], [Property: User.LockoutEnabled (bool) Required, 35], [Property: User.LockoutEnd (DateTimeOffset?), 36], [Property: User.NormalizedEmail (string) Index MaxLength(256), 37], [Property: User.NormalizedUserName (string) Index MaxLength(256), 38], [Property: User.PasswordHash (string), 39], [Property: User.PhoneNumber (string), 40], [Property: User.PhoneNumberConfirmed (bool) Required, 41], [Property: User.RefreshToken (string), 42], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 43], [Property: User.Role (string) Required MaxLength(50), 44], [Property: User.SecurityStamp (string), 45], [Property: User.TwoFactorEnabled (bool) Required, 46], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 47], [Property: User.UserName (string) MaxLength(256), 48] }
            9 -> 16
            10 -> 26
        SELECT s.SpecializationId, s.CreatedAt, s.Description, s.Name, s.UpdatedAt, t.BranchId, t.SpecializationId, t.BranchId0, t.Address, t.BranchName, t.CreatedAt, t.Description, t.Email, t.ImageURL, t.Phone, t.UpdatedAt, t0.DoctorId, t0.Available, t0.Biography, t0.ConsultationFees, t0.CreatedAt, t0.ExperienceYears, t0.ImageURL, t0.SpecializationId, t0.UpdatedAt, t0.UserId, t0.Id, t0.AccessFailedCount, t0.ConcurrencyStamp, t0.CreatedAt0, t0.DateOfBirth, t0.Email, t0.EmailConfirmed, t0.FullName, t0.Gender, t0.LockoutEnabled, t0.LockoutEnd, t0.NormalizedEmail, t0.NormalizedUserName, t0.PasswordHash, t0.PhoneNumber, t0.PhoneNumberConfirmed, t0.RefreshToken, t0.RefreshTokenExpiryTime, t0.Role, t0.SecurityStamp, t0.TwoFactorEnabled, t0.UpdatedAt0, t0.UserName
        FROM Specializations AS s
        LEFT JOIN 
        (
            SELECT b1.BranchId, b1.SpecializationId, b2.BranchId AS BranchId0, b2.Address, b2.BranchName, b2.CreatedAt, b2.Description, b2.Email, b2.ImageURL, b2.Phone, b2.UpdatedAt
            FROM BranchSpecializations AS b1
            INNER JOIN Branches AS b2 ON b1.BranchId == b2.BranchId
        ) AS t ON s.SpecializationId == t.SpecializationId
        LEFT JOIN 
        (
            SELECT d.DoctorId, d.Available, d.Biography, d.ConsultationFees, d.CreatedAt, d.ExperienceYears, d.ImageURL, d.SpecializationId, d.UpdatedAt, d.UserId, u.Id, u.AccessFailedCount, u.ConcurrencyStamp, u.CreatedAt AS CreatedAt0, u.DateOfBirth, u.Email, u.EmailConfirmed, u.FullName, u.Gender, u.LockoutEnabled, u.LockoutEnd, u.NormalizedEmail, u.NormalizedUserName, u.PasswordHash, u.PhoneNumber, u.PhoneNumberConfirmed, u.RefreshToken, u.RefreshTokenExpiryTime, u.Role, u.SecurityStamp, u.TwoFactorEnabled, u.UpdatedAt AS UpdatedAt0, u.UserName
            FROM Doctors AS d
            INNER JOIN Users AS u ON d.UserId == u.Id
        ) AS t0 ON s.SpecializationId == t0.SpecializationId
        WHERE EXISTS (
            SELECT 1
            FROM BranchSpecializations AS b
            INNER JOIN Branches AS b0 ON b.BranchId == b0.BranchId
            WHERE ((s.SpecializationId != NULL) && (s.SpecializationId == b.SpecializationId)) && (b0.BranchId == @__branchId_0))
        ORDER BY s.SpecializationId ASC, t.BranchId ASC, t.SpecializationId ASC, t.BranchId0 ASC, t0.DoctorId ASC), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Specialization>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 01:50:51.317 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:50:51.319 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:50:51.322 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:50:51.326 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2025-11-24 01:50:51.328 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (5ms).
2025-11-24 01:50:51.329 +02:00 [DBG] Executing DbCommand [Parameters=[@__branchId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt], [t].[BranchId], [t].[SpecializationId], [t].[BranchId0], [t].[Address], [t].[BranchName], [t].[CreatedAt], [t].[Description], [t].[Email], [t].[ImageURL], [t].[Phone], [t].[UpdatedAt], [t0].[DoctorId], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt0], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt0], [t0].[UserName]
FROM [Specializations] AS [s]
LEFT JOIN (
    SELECT [b1].[BranchId], [b1].[SpecializationId], [b2].[BranchId] AS [BranchId0], [b2].[Address], [b2].[BranchName], [b2].[CreatedAt], [b2].[Description], [b2].[Email], [b2].[ImageURL], [b2].[Phone], [b2].[UpdatedAt]
    FROM [BranchSpecializations] AS [b1]
    INNER JOIN [Branches] AS [b2] ON [b1].[BranchId] = [b2].[BranchId]
) AS [t] ON [s].[SpecializationId] = [t].[SpecializationId]
LEFT JOIN (
    SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
) AS [t0] ON [s].[SpecializationId] = [t0].[SpecializationId]
WHERE EXISTS (
    SELECT 1
    FROM [BranchSpecializations] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
    WHERE [s].[SpecializationId] = [b].[SpecializationId] AND [b0].[BranchId] = @__branchId_0)
ORDER BY [s].[SpecializationId], [t].[BranchId], [t].[SpecializationId], [t].[BranchId0], [t0].[DoctorId]
2025-11-24 01:50:51.362 +02:00 [INF] Executed DbCommand (33ms) [Parameters=[@__branchId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt], [t].[BranchId], [t].[SpecializationId], [t].[BranchId0], [t].[Address], [t].[BranchName], [t].[CreatedAt], [t].[Description], [t].[Email], [t].[ImageURL], [t].[Phone], [t].[UpdatedAt], [t0].[DoctorId], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt0], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt0], [t0].[UserName]
FROM [Specializations] AS [s]
LEFT JOIN (
    SELECT [b1].[BranchId], [b1].[SpecializationId], [b2].[BranchId] AS [BranchId0], [b2].[Address], [b2].[BranchName], [b2].[CreatedAt], [b2].[Description], [b2].[Email], [b2].[ImageURL], [b2].[Phone], [b2].[UpdatedAt]
    FROM [BranchSpecializations] AS [b1]
    INNER JOIN [Branches] AS [b2] ON [b1].[BranchId] = [b2].[BranchId]
) AS [t] ON [s].[SpecializationId] = [t].[SpecializationId]
LEFT JOIN (
    SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
) AS [t0] ON [s].[SpecializationId] = [t0].[SpecializationId]
WHERE EXISTS (
    SELECT 1
    FROM [BranchSpecializations] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
    WHERE [s].[SpecializationId] = [b].[SpecializationId] AND [b0].[BranchId] = @__branchId_0)
ORDER BY [s].[SpecializationId], [t].[BranchId], [t].[SpecializationId], [t].[BranchId0], [t0].[DoctorId]
2025-11-24 01:50:51.386 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:50:51.421 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchSpecialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:50:51.445 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:50:51.500 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:50:51.503 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:50:51.540 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:50:51.544 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 166ms reading results.
2025-11-24 01:50:51.546 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:50:51.550 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (3ms).
2025-11-24 01:50:51.572 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:50:51.582 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:50:51.586 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:50:51.589 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:50:51.593 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 01:50:51.596 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Specialization.SpecializationInfoDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 01:50:51.607 +02:00 [INF] Executed action Hospital.Controllers.SpecializationsController.GetAllByBranch (Hospital) in 721.7022ms
2025-11-24 01:50:51.610 +02:00 [INF] Executed endpoint 'Hospital.Controllers.SpecializationsController.GetAllByBranch (Hospital)'
2025-11-24 01:50:51.615 +02:00 [DBG] Connection id "0HNHATCCAV4K3" completed keep alive response.
2025-11-24 01:50:51.616 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:50:51.616 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:50:51.618 +02:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-11-24 01:50:51.620 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Specializations/Branch/2 - 200 null application/json; charset=utf-8 758.1211ms
2025-11-24 01:51:05.300 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Specializations/add-from-excel - null 0
2025-11-24 01:51:05.305 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Specializations/add-from-excel'
2025-11-24 01:51:05.306 +02:00 [DBG] Endpoint 'Hospital.Controllers.SpecializationsController.AddSpecializationsFromExcel (Hospital)' with route pattern 'api/Specializations/add-from-excel' is valid for the request path '/api/Specializations/add-from-excel'
2025-11-24 01:51:05.308 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.SpecializationsController.AddSpecializationsFromExcel (Hospital)'
2025-11-24 01:51:05.309 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:51:05.312 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:51:05.315 +02:00 [INF] Executing endpoint 'Hospital.Controllers.SpecializationsController.AddSpecializationsFromExcel (Hospital)'
2025-11-24 01:51:05.321 +02:00 [INF] Route matched with {action = "AddSpecializationsFromExcel", controller = "Specializations"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddSpecializationsFromExcel(Microsoft.AspNetCore.Http.IFormFile) on controller Hospital.Controllers.SpecializationsController (Hospital).
2025-11-24 01:51:05.329 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:51:05.334 +02:00 [DBG] Execution plan of resource filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-11-24 01:51:05.335 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:51:05.339 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:51:05.340 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:51:05.341 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.SpecializationsController (Hospital)
2025-11-24 01:51:05.346 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.SpecializationsController (Hospital)
2025-11-24 01:51:05.346 +02:00 [DBG] Attempting to bind parameter 'file' of type 'Microsoft.AspNetCore.Http.IFormFile' ...
2025-11-24 01:51:05.348 +02:00 [DBG] Attempting to bind parameter 'file' of type 'Microsoft.AspNetCore.Http.IFormFile' using the name '' in request data ...
2025-11-24 01:51:05.349 +02:00 [DBG] Could not bind to model with name '' and type 'Microsoft.AspNetCore.Http.IFormFile' as the request did not have a content type of either 'application/x-www-form-urlencoded' or 'multipart/form-data'.
2025-11-24 01:51:05.350 +02:00 [DBG] Done attempting to bind parameter 'file' of type 'Microsoft.AspNetCore.Http.IFormFile'.
2025-11-24 01:51:05.351 +02:00 [DBG] Done attempting to bind parameter 'file' of type 'Microsoft.AspNetCore.Http.IFormFile'.
2025-11-24 01:51:05.352 +02:00 [DBG] Attempting to validate the bound parameter 'file' of type 'Microsoft.AspNetCore.Http.IFormFile' ...
2025-11-24 01:51:05.357 +02:00 [DBG] Done attempting to validate the bound parameter 'file' of type 'Microsoft.AspNetCore.Http.IFormFile'.
2025-11-24 01:51:05.358 +02:00 [DBG] The request has model state errors, returning an error response.
2025-11-24 01:51:05.360 +02:00 [DBG] Request was short circuited at action filter 'Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter'.
2025-11-24 01:51:05.362 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:51:05.364 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:51:05.365 +02:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2025-11-24 01:51:05.369 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2025-11-24 01:51:05.370 +02:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-11-24 01:51:05.395 +02:00 [INF] Executed action Hospital.Controllers.SpecializationsController.AddSpecializationsFromExcel (Hospital) in 54.1223ms
2025-11-24 01:51:05.397 +02:00 [INF] Executed endpoint 'Hospital.Controllers.SpecializationsController.AddSpecializationsFromExcel (Hospital)'
2025-11-24 01:51:05.398 +02:00 [DBG] Connection id "0HNHATCCAV4K3" completed keep alive response.
2025-11-24 01:51:05.399 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Specializations/add-from-excel - 400 null application/problem+json; charset=utf-8 99.5566ms
2025-11-24 01:52:23.805 +02:00 [DBG] Connection id "0HNHATCCAV4K4" accepted.
2025-11-24 01:52:23.805 +02:00 [DBG] Connection id "0HNHATCCAV4K4" received FIN.
2025-11-24 01:52:23.807 +02:00 [DBG] Connection id "0HNHATCCAV4K4" started.
2025-11-24 01:52:23.813 +02:00 [DBG] Connection id "0HNHATCCAV4K5" accepted.
2025-11-24 01:52:23.820 +02:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-11-24 01:52:23.820 +02:00 [DBG] Connection id "0HNHATCCAV4K5" started.
2025-11-24 01:52:23.825 +02:00 [DBG] Connection id "0HNHATCCAV4K4" stopped.
2025-11-24 01:52:23.826 +02:00 [DBG] Connection id "0HNHATCCAV4K4" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-11-24 01:52:23.831 +02:00 [DBG] Connection 0HNHATCCAV4K5 established using the following protocol: "Tls12"
2025-11-24 01:52:23.834 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Specializations/add-from-excel - multipart/form-data; boundary=--------------------------952304213000324185364768 5880
2025-11-24 01:52:23.838 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Specializations/add-from-excel'
2025-11-24 01:52:23.839 +02:00 [DBG] Endpoint 'Hospital.Controllers.SpecializationsController.AddSpecializationsFromExcel (Hospital)' with route pattern 'api/Specializations/add-from-excel' is valid for the request path '/api/Specializations/add-from-excel'
2025-11-24 01:52:23.840 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.SpecializationsController.AddSpecializationsFromExcel (Hospital)'
2025-11-24 01:52:23.842 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:52:23.842 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:52:23.844 +02:00 [INF] Executing endpoint 'Hospital.Controllers.SpecializationsController.AddSpecializationsFromExcel (Hospital)'
2025-11-24 01:52:23.846 +02:00 [INF] Route matched with {action = "AddSpecializationsFromExcel", controller = "Specializations"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddSpecializationsFromExcel(Microsoft.AspNetCore.Http.IFormFile) on controller Hospital.Controllers.SpecializationsController (Hospital).
2025-11-24 01:52:23.850 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:52:23.851 +02:00 [DBG] Execution plan of resource filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-11-24 01:52:23.852 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:52:23.853 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:52:23.854 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:52:23.855 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.SpecializationsController (Hospital)
2025-11-24 01:52:23.856 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.SpecializationsController (Hospital)
2025-11-24 01:52:23.867 +02:00 [DBG] Connection id "0HNHATCCAV4K5", Request id "0HNHATCCAV4K5:00000001": started reading request body.
2025-11-24 01:52:23.877 +02:00 [DBG] Connection id "0HNHATCCAV4K5", Request id "0HNHATCCAV4K5:00000001": done reading request body.
2025-11-24 01:52:23.880 +02:00 [DBG] Attempting to bind parameter 'file' of type 'Microsoft.AspNetCore.Http.IFormFile' ...
2025-11-24 01:52:23.884 +02:00 [DBG] Attempting to bind parameter 'file' of type 'Microsoft.AspNetCore.Http.IFormFile' using the name 'file' in request data ...
2025-11-24 01:52:23.887 +02:00 [DBG] Done attempting to bind parameter 'file' of type 'Microsoft.AspNetCore.Http.IFormFile'.
2025-11-24 01:52:23.888 +02:00 [DBG] Done attempting to bind parameter 'file' of type 'Microsoft.AspNetCore.Http.IFormFile'.
2025-11-24 01:52:23.890 +02:00 [DBG] Attempting to validate the bound parameter 'file' of type 'Microsoft.AspNetCore.Http.IFormFile' ...
2025-11-24 01:52:23.893 +02:00 [DBG] Done attempting to validate the bound parameter 'file' of type 'Microsoft.AspNetCore.Http.IFormFile'.
2025-11-24 01:52:24.284 +02:00 [INF] add Specialization by excel sheet called at "2025-11-24T01:52:24.2841682+02:00"
2025-11-24 01:52:24.585 +02:00 [INF] Adding specialization: Cardiology
2025-11-24 01:52:24.601 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:52:24.611 +02:00 [DBG] Compiling query expression: 
'DbSet<Branch>()
    .Where(b => __branchIds_0.Contains(b.BranchId))'
2025-11-24 01:52:24.658 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Branch>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Branch.Address (string) MaxLength(250), 1], [Property: Branch.BranchName (string) Required MaxLength(150), 2], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 3], [Property: Branch.Description (string), 4], [Property: Branch.Email (string) MaxLength(200), 5], [Property: Branch.ImageURL (string) MaxLength(300), 6], [Property: Branch.Phone (string) MaxLength(25), 7], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 8] }
        SELECT b.BranchId, b.Address, b.BranchName, b.CreatedAt, b.Description, b.Email, b.ImageURL, b.Phone, b.UpdatedAt
        FROM Branches AS b
        WHERE b.BranchId IN (
            SELECT b0.value
            FROM OPENJSON(@__branchIds_0) WITH (value int '') AS b0)), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Branch>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 01:52:24.671 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:52:24.674 +02:00 [DBG] Created DbConnection. (3ms).
2025-11-24 01:52:24.676 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:52:24.677 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:52:24.678 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:52:24.679 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:52:24.683 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (5ms).
2025-11-24 01:52:24.685 +02:00 [DBG] Executing DbCommand [Parameters=[@__branchIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [b0].[value]
    FROM OPENJSON(@__branchIds_0) WITH ([value] int '$') AS [b0]
)
2025-11-24 01:52:24.699 +02:00 [INF] Executed DbCommand (14ms) [Parameters=[@__branchIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [b0].[value]
    FROM OPENJSON(@__branchIds_0) WITH ([value] int '$') AS [b0]
)
2025-11-24 01:52:24.703 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:52:24.706 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:52:24.707 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 4ms reading results.
2025-11-24 01:52:24.710 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:52:24.710 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:52:24.782 +02:00 [INF] Adding specialization: Neurology
2025-11-24 01:52:24.785 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:52:24.789 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:52:24.792 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:52:24.798 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (5ms).
2025-11-24 01:52:24.803 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (10ms).
2025-11-24 01:52:24.808 +02:00 [DBG] Executing DbCommand [Parameters=[@__branchIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [b0].[value]
    FROM OPENJSON(@__branchIds_0) WITH ([value] int '$') AS [b0]
)
2025-11-24 01:52:24.817 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[@__branchIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [b0].[value]
    FROM OPENJSON(@__branchIds_0) WITH ([value] int '$') AS [b0]
)
2025-11-24 01:52:24.819 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:52:24.826 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 7ms reading results.
2025-11-24 01:52:24.835 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:52:24.839 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (3ms).
2025-11-24 01:52:24.844 +02:00 [DBG] Compiling query expression: 
'DbSet<Specialization>()
    .Include(s => s.Branches)
    .Include(s => s.Doctors)
    .ThenInclude(d => d.User)'
2025-11-24 01:52:24.849 +02:00 [DBG] Including navigation: 'Specialization.Branches'.
2025-11-24 01:52:24.853 +02:00 [DBG] Including navigation: 'Specialization.Doctors'.
2025-11-24 01:52:24.855 +02:00 [DBG] Including navigation: 'Doctor.User'.
2025-11-24 01:52:24.872 +02:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-11-24 01:52:24.878 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Specialization>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Specialization.SpecializationId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Specialization.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: Specialization.Description (string), 2], [Property: Specialization.Name (string) Required MaxLength(120), 3], [Property: Specialization.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 4] }
            1 -> 0
            2 -> Dictionary<IProperty, int> { [Property: BranchSpecialization (Dictionary<string, object>).BranchId (no field, int) Indexer Required PK FK AfterSave:Throw, 5], [Property: BranchSpecialization (Dictionary<string, object>).SpecializationId (no field, int) Indexer Required PK FK Index AfterSave:Throw, 6] }
            3 -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Branch.Address (string) MaxLength(250), 8], [Property: Branch.BranchName (string) Required MaxLength(150), 9], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 10], [Property: Branch.Description (string), 11], [Property: Branch.Email (string) MaxLength(200), 12], [Property: Branch.ImageURL (string) MaxLength(300), 13], [Property: Branch.Phone (string) MaxLength(25), 14], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 15] }
            4 -> 5
            5 -> 6
            6 -> 7
            7 -> Dictionary<IProperty, int> { [Property: Doctor.DoctorId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 16], [Property: Doctor.Available (bool?), 17], [Property: Doctor.Biography (string), 18], [Property: Doctor.ConsultationFees (decimal) Required, 19], [Property: Doctor.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 20], [Property: Doctor.ExperienceYears (int?), 21], [Property: Doctor.ImageURL (string) MaxLength(300), 22], [Property: Doctor.SpecializationId (int) Required FK Index, 23], [Property: Doctor.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 24], [Property: Doctor.UserId (string) Required FK Index, 25] }
            8 -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 26], [Property: User.AccessFailedCount (int) Required, 27], [Property: User.ConcurrencyStamp (string) Concurrency, 28], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 29], [Property: User.DateOfBirth (DateOnly?), 30], [Property: User.Email (string) Index MaxLength(256), 31], [Property: User.EmailConfirmed (bool) Required, 32], [Property: User.FullName (string) Required MaxLength(150), 33], [Property: User.Gender (GenderType?) MaxLength(10), 34], [Property: User.LockoutEnabled (bool) Required, 35], [Property: User.LockoutEnd (DateTimeOffset?), 36], [Property: User.NormalizedEmail (string) Index MaxLength(256), 37], [Property: User.NormalizedUserName (string) Index MaxLength(256), 38], [Property: User.PasswordHash (string), 39], [Property: User.PhoneNumber (string), 40], [Property: User.PhoneNumberConfirmed (bool) Required, 41], [Property: User.RefreshToken (string), 42], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 43], [Property: User.Role (string) Required MaxLength(50), 44], [Property: User.SecurityStamp (string), 45], [Property: User.TwoFactorEnabled (bool) Required, 46], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 47], [Property: User.UserName (string) MaxLength(256), 48] }
            9 -> 16
            10 -> 26
        SELECT s.SpecializationId, s.CreatedAt, s.Description, s.Name, s.UpdatedAt, t.BranchId, t.SpecializationId, t.BranchId0, t.Address, t.BranchName, t.CreatedAt, t.Description, t.Email, t.ImageURL, t.Phone, t.UpdatedAt, t0.DoctorId, t0.Available, t0.Biography, t0.ConsultationFees, t0.CreatedAt, t0.ExperienceYears, t0.ImageURL, t0.SpecializationId, t0.UpdatedAt, t0.UserId, t0.Id, t0.AccessFailedCount, t0.ConcurrencyStamp, t0.CreatedAt0, t0.DateOfBirth, t0.Email, t0.EmailConfirmed, t0.FullName, t0.Gender, t0.LockoutEnabled, t0.LockoutEnd, t0.NormalizedEmail, t0.NormalizedUserName, t0.PasswordHash, t0.PhoneNumber, t0.PhoneNumberConfirmed, t0.RefreshToken, t0.RefreshTokenExpiryTime, t0.Role, t0.SecurityStamp, t0.TwoFactorEnabled, t0.UpdatedAt0, t0.UserName
        FROM Specializations AS s
        LEFT JOIN 
        (
            SELECT b.BranchId, b.SpecializationId, b0.BranchId AS BranchId0, b0.Address, b0.BranchName, b0.CreatedAt, b0.Description, b0.Email, b0.ImageURL, b0.Phone, b0.UpdatedAt
            FROM BranchSpecializations AS b
            INNER JOIN Branches AS b0 ON b.BranchId == b0.BranchId
        ) AS t ON s.SpecializationId == t.SpecializationId
        LEFT JOIN 
        (
            SELECT d.DoctorId, d.Available, d.Biography, d.ConsultationFees, d.CreatedAt, d.ExperienceYears, d.ImageURL, d.SpecializationId, d.UpdatedAt, d.UserId, u.Id, u.AccessFailedCount, u.ConcurrencyStamp, u.CreatedAt AS CreatedAt0, u.DateOfBirth, u.Email, u.EmailConfirmed, u.FullName, u.Gender, u.LockoutEnabled, u.LockoutEnd, u.NormalizedEmail, u.NormalizedUserName, u.PasswordHash, u.PhoneNumber, u.PhoneNumberConfirmed, u.RefreshToken, u.RefreshTokenExpiryTime, u.Role, u.SecurityStamp, u.TwoFactorEnabled, u.UpdatedAt AS UpdatedAt0, u.UserName
            FROM Doctors AS d
            INNER JOIN Users AS u ON d.UserId == u.Id
        ) AS t0 ON s.SpecializationId == t0.SpecializationId
        ORDER BY s.SpecializationId ASC, t.BranchId ASC, t.SpecializationId ASC, t.BranchId0 ASC, t0.DoctorId ASC), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Specialization>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 01:52:24.892 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:52:24.895 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:52:24.896 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:52:24.897 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:52:24.898 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:52:24.899 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt], [t].[BranchId], [t].[SpecializationId], [t].[BranchId0], [t].[Address], [t].[BranchName], [t].[CreatedAt], [t].[Description], [t].[Email], [t].[ImageURL], [t].[Phone], [t].[UpdatedAt], [t0].[DoctorId], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt0], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt0], [t0].[UserName]
FROM [Specializations] AS [s]
LEFT JOIN (
    SELECT [b].[BranchId], [b].[SpecializationId], [b0].[BranchId] AS [BranchId0], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [BranchSpecializations] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
) AS [t] ON [s].[SpecializationId] = [t].[SpecializationId]
LEFT JOIN (
    SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
) AS [t0] ON [s].[SpecializationId] = [t0].[SpecializationId]
ORDER BY [s].[SpecializationId], [t].[BranchId], [t].[SpecializationId], [t].[BranchId0], [t0].[DoctorId]
2025-11-24 01:52:24.920 +02:00 [INF] Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt], [t].[BranchId], [t].[SpecializationId], [t].[BranchId0], [t].[Address], [t].[BranchName], [t].[CreatedAt], [t].[Description], [t].[Email], [t].[ImageURL], [t].[Phone], [t].[UpdatedAt], [t0].[DoctorId], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt0], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt0], [t0].[UserName]
FROM [Specializations] AS [s]
LEFT JOIN (
    SELECT [b].[BranchId], [b].[SpecializationId], [b0].[BranchId] AS [BranchId0], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [BranchSpecializations] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
) AS [t] ON [s].[SpecializationId] = [t].[SpecializationId]
LEFT JOIN (
    SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
) AS [t0] ON [s].[SpecializationId] = [t0].[SpecializationId]
ORDER BY [s].[SpecializationId], [t].[BranchId], [t].[SpecializationId], [t].[BranchId0], [t0].[DoctorId]
2025-11-24 01:52:24.926 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:52:24.930 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchSpecialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:52:24.932 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:52:24.933 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:52:24.935 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:52:24.936 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:52:24.939 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 12ms reading results.
2025-11-24 01:52:24.941 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:52:24.941 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:52:24.944 +02:00 [WRN] Specialization 'Neurology' already exists in branch 'adam7'
2025-11-24 01:52:25.002 +02:00 [INF] Adding specialization: Pediatrics
2025-11-24 01:52:25.008 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:52:25.009 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:52:25.012 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:52:25.016 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2025-11-24 01:52:25.020 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (7ms).
2025-11-24 01:52:25.021 +02:00 [DBG] Executing DbCommand [Parameters=[@__branchIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [b0].[value]
    FROM OPENJSON(@__branchIds_0) WITH ([value] int '$') AS [b0]
)
2025-11-24 01:52:25.029 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[@__branchIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [b0].[value]
    FROM OPENJSON(@__branchIds_0) WITH ([value] int '$') AS [b0]
)
2025-11-24 01:52:25.036 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:52:25.038 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 2ms reading results.
2025-11-24 01:52:25.040 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:52:25.041 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 01:52:25.092 +02:00 [INF] Adding specialization: Orthopedics
2025-11-24 01:52:25.097 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:52:25.100 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:52:25.105 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:52:25.109 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2025-11-24 01:52:25.110 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (5ms).
2025-11-24 01:52:25.112 +02:00 [DBG] Executing DbCommand [Parameters=[@__branchIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [b0].[value]
    FROM OPENJSON(@__branchIds_0) WITH ([value] int '$') AS [b0]
)
2025-11-24 01:52:25.119 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[@__branchIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [b0].[value]
    FROM OPENJSON(@__branchIds_0) WITH ([value] int '$') AS [b0]
)
2025-11-24 01:52:25.126 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:52:25.128 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 01:52:25.129 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:52:25.132 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (3ms).
2025-11-24 01:52:25.177 +02:00 [INF] Adding specialization: Dermatology
2025-11-24 01:52:25.180 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:52:25.183 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:52:25.185 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:52:25.186 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:52:25.187 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:52:25.189 +02:00 [DBG] Executing DbCommand [Parameters=[@__branchIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [b0].[value]
    FROM OPENJSON(@__branchIds_0) WITH ([value] int '$') AS [b0]
)
2025-11-24 01:52:25.196 +02:00 [INF] Executed DbCommand (8ms) [Parameters=[@__branchIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [b0].[value]
    FROM OPENJSON(@__branchIds_0) WITH ([value] int '$') AS [b0]
)
2025-11-24 01:52:25.201 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:52:25.204 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 3ms reading results.
2025-11-24 01:52:25.210 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:52:25.212 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (2ms).
2025-11-24 01:52:25.264 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:52:25.276 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:52:25.284 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:52:25.286 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:52:25.288 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 01:52:25.293 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-11-24 01:52:25.305 +02:00 [INF] Executed action Hospital.Controllers.SpecializationsController.AddSpecializationsFromExcel (Hospital) in 1450.6943ms
2025-11-24 01:52:25.308 +02:00 [INF] Executed endpoint 'Hospital.Controllers.SpecializationsController.AddSpecializationsFromExcel (Hospital)'
2025-11-24 01:52:25.314 +02:00 [DBG] Connection id "0HNHATCCAV4K5" completed keep alive response.
2025-11-24 01:52:25.318 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:52:25.320 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:52:25.326 +02:00 [DBG] Disposed connection to database '' on server '' (5ms).
2025-11-24 01:52:25.331 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Specializations/add-from-excel - 200 null application/json; charset=utf-8 1496.5927ms
2025-11-24 01:53:20.477 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Branch/Create - application/json 146
2025-11-24 01:53:20.482 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Branch/Create'
2025-11-24 01:53:20.484 +02:00 [DBG] Endpoint 'Hospital.Controllers.BranchController.Create (Hospital)' with route pattern 'api/Branch/Create' is valid for the request path '/api/Branch/Create'
2025-11-24 01:53:20.489 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.BranchController.Create (Hospital)'
2025-11-24 01:53:20.493 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:53:20.495 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:53:20.496 +02:00 [INF] Executing endpoint 'Hospital.Controllers.BranchController.Create (Hospital)'
2025-11-24 01:53:20.499 +02:00 [INF] Route matched with {action = "Create", controller = "Branch"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Create(Hospital.Application.DTO.Branch.CreateBranchDto) on controller Hospital.Controllers.BranchController (Hospital).
2025-11-24 01:53:20.502 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:53:20.502 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:53:20.503 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:53:20.505 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:53:20.505 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:53:20.507 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.BranchController (Hospital)
2025-11-24 01:53:20.508 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.BranchController (Hospital)
2025-11-24 01:53:20.508 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Branch.CreateBranchDto' ...
2025-11-24 01:53:20.511 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Branch.CreateBranchDto' using the name '' in request data ...
2025-11-24 01:53:20.513 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 01:53:20.518 +02:00 [DBG] Connection id "0HNHATCCAV4K5", Request id "0HNHATCCAV4K5:00000002": started reading request body.
2025-11-24 01:53:20.518 +02:00 [DBG] Connection id "0HNHATCCAV4K5", Request id "0HNHATCCAV4K5:00000002": done reading request body.
2025-11-24 01:53:20.532 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Branch.CreateBranchDto'
2025-11-24 01:53:20.535 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Branch.CreateBranchDto'.
2025-11-24 01:53:20.538 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Branch.CreateBranchDto'.
2025-11-24 01:53:20.540 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Branch.CreateBranchDto' ...
2025-11-24 01:53:20.551 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Branch.CreateBranchDto'.
2025-11-24 01:53:20.557 +02:00 [INF] Create Branch called at "2025-11-24T01:53:20.5575241+02:00"
2025-11-24 01:53:20.561 +02:00 [INF] Creating new branch with name: adam17
2025-11-24 01:53:20.564 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:53:20.570 +02:00 [DBG] Compiling query expression: 
'DbSet<Branch>()
    .AsNoTracking()'
2025-11-24 01:53:20.575 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Branch>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Branch.Address (string) MaxLength(250), 1], [Property: Branch.BranchName (string) Required MaxLength(150), 2], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 3], [Property: Branch.Description (string), 4], [Property: Branch.Email (string) MaxLength(200), 5], [Property: Branch.ImageURL (string) MaxLength(300), 6], [Property: Branch.Phone (string) MaxLength(25), 7], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 8] }
        SELECT b.BranchId, b.Address, b.BranchName, b.CreatedAt, b.Description, b.Email, b.ImageURL, b.Phone, b.UpdatedAt
        FROM Branches AS b), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Branch>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 01:53:20.577 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:53:20.579 +02:00 [DBG] Created DbConnection. (1ms).
2025-11-24 01:53:20.580 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:53:20.584 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:53:20.588 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:53:20.590 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:53:20.591 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:53:20.592 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
2025-11-24 01:53:20.599 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
2025-11-24 01:53:20.601 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:53:20.602 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 01:53:20.603 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:53:20.603 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:53:20.624 +02:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Branch.BranchId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:53:20.633 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:53:20.637 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:53:20.649 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:53:20.663 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 01:53:20.666 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:53:20.669 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:53:20.749 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:53:20.752 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:53:20.759 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:53:20.759 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:53:20.760 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:53:20.761 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (Size = 250), @p1='?' (Size = 150), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 200), @p5='?' (Size = 300), @p6='?' (Size = 25), @p7='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Branches] ([Address], [BranchName], [CreatedAt], [Description], [Email], [ImageURL], [Phone], [UpdatedAt])
OUTPUT INSERTED.[BranchId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-11-24 01:53:20.776 +02:00 [INF] Executed DbCommand (15ms) [Parameters=[@p0='?' (Size = 250), @p1='?' (Size = 150), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 200), @p5='?' (Size = 300), @p6='?' (Size = 25), @p7='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Branches] ([Address], [BranchName], [CreatedAt], [Description], [Email], [ImageURL], [Phone], [UpdatedAt])
OUTPUT INSERTED.[BranchId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-11-24 01:53:20.794 +02:00 [DBG] The foreign key property 'Branch.BranchId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 01:53:20.807 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:53:20.808 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 27ms reading results.
2025-11-24 01:53:20.811 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:53:20.812 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 01:53:20.823 +02:00 [DBG] An entity of type 'Branch' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:53:20.826 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 01:53:20.827 +02:00 [INF] Branch created successfully with ID: 3
2025-11-24 01:53:20.831 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:53:20.832 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:53:20.833 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:53:20.833 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:53:20.834 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 01:53:20.835 +02:00 [INF] Executing CreatedAtActionResult, writing value of type 'Hospital.Application.DTO.Branch.BranchDto'.
2025-11-24 01:53:20.851 +02:00 [DBG] Found the endpoints ["Hospital.Controllers.BranchController.GetById (Hospital)"] for address (id=[3],action=[GetById],controller=[Branch])
2025-11-24 01:53:20.856 +02:00 [DBG] Successfully processed template api/Branch/GetBy/{id} for Hospital.Controllers.BranchController.GetById (Hospital) resulting in /api/Branch/GetBy/3 and 
2025-11-24 01:53:20.858 +02:00 [DBG] Link generation succeeded for endpoints ["Hospital.Controllers.BranchController.GetById (Hospital)"] with result /api/Branch/GetBy/3
2025-11-24 01:53:20.861 +02:00 [INF] Executed action Hospital.Controllers.BranchController.Create (Hospital) in 354.8182ms
2025-11-24 01:53:20.862 +02:00 [INF] Executed endpoint 'Hospital.Controllers.BranchController.Create (Hospital)'
2025-11-24 01:53:20.863 +02:00 [DBG] Connection id "0HNHATCCAV4K5" completed keep alive response.
2025-11-24 01:53:20.865 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:53:20.865 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:53:20.866 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 01:53:20.867 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Branch/Create - 201 null application/json; charset=utf-8 392.0912ms
2025-11-24 01:53:38.768 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Specializations/Create - application/json 176
2025-11-24 01:53:38.772 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Specializations/Create'
2025-11-24 01:53:38.775 +02:00 [DBG] Endpoint 'Hospital.Controllers.SpecializationsController.Create (Hospital)' with route pattern 'api/Specializations/Create' is valid for the request path '/api/Specializations/Create'
2025-11-24 01:53:38.778 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.SpecializationsController.Create (Hospital)'
2025-11-24 01:53:38.780 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:53:38.783 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:53:38.786 +02:00 [INF] Executing endpoint 'Hospital.Controllers.SpecializationsController.Create (Hospital)'
2025-11-24 01:53:38.790 +02:00 [INF] Route matched with {action = "Create", controller = "Specializations"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Hospital.Application.DTO.Specialization.SpecializationDTO]] Create(Hospital.Application.DTO.Specialization.CreateSpecialization) on controller Hospital.Controllers.SpecializationsController (Hospital).
2025-11-24 01:53:38.797 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:53:38.800 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:53:38.803 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:53:38.805 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:53:38.805 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:53:38.807 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.SpecializationsController (Hospital)
2025-11-24 01:53:38.810 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.SpecializationsController (Hospital)
2025-11-24 01:53:38.811 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Specialization.CreateSpecialization' ...
2025-11-24 01:53:38.814 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Specialization.CreateSpecialization' using the name '' in request data ...
2025-11-24 01:53:38.817 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 01:53:38.820 +02:00 [DBG] Connection id "0HNHATCCAV4K5", Request id "0HNHATCCAV4K5:00000003": started reading request body.
2025-11-24 01:53:38.821 +02:00 [DBG] Connection id "0HNHATCCAV4K5", Request id "0HNHATCCAV4K5:00000003": done reading request body.
2025-11-24 01:53:38.826 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Specialization.CreateSpecialization'
2025-11-24 01:53:38.828 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Specialization.CreateSpecialization'.
2025-11-24 01:53:38.830 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Specialization.CreateSpecialization'.
2025-11-24 01:53:38.832 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Specialization.CreateSpecialization' ...
2025-11-24 01:53:38.837 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Specialization.CreateSpecialization'.
2025-11-24 01:53:38.839 +02:00 [INF] create Specialization called at "2025-11-24T01:53:38.8390520+02:00"
2025-11-24 01:53:38.839 +02:00 [INF] Adding specialization: legg
2025-11-24 01:53:38.840 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:53:38.841 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:53:38.842 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 01:53:38.842 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:53:38.843 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:53:38.844 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:53:38.846 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:53:38.846 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:53:38.847 +02:00 [DBG] Executing DbCommand [Parameters=[@__branchIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [b0].[value]
    FROM OPENJSON(@__branchIds_0) WITH ([value] int '$') AS [b0]
)
2025-11-24 01:53:38.853 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@__branchIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [b0].[value]
    FROM OPENJSON(@__branchIds_0) WITH ([value] int '$') AS [b0]
)
2025-11-24 01:53:38.856 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:53:38.857 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:53:38.858 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 01:53:38.859 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:53:38.860 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 01:53:38.862 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:53:38.862 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:53:38.863 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:53:38.864 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:53:38.865 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:53:38.866 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt], [t].[BranchId], [t].[SpecializationId], [t].[BranchId0], [t].[Address], [t].[BranchName], [t].[CreatedAt], [t].[Description], [t].[Email], [t].[ImageURL], [t].[Phone], [t].[UpdatedAt], [t0].[DoctorId], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt0], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt0], [t0].[UserName]
FROM [Specializations] AS [s]
LEFT JOIN (
    SELECT [b].[BranchId], [b].[SpecializationId], [b0].[BranchId] AS [BranchId0], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [BranchSpecializations] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
) AS [t] ON [s].[SpecializationId] = [t].[SpecializationId]
LEFT JOIN (
    SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
) AS [t0] ON [s].[SpecializationId] = [t0].[SpecializationId]
ORDER BY [s].[SpecializationId], [t].[BranchId], [t].[SpecializationId], [t].[BranchId0], [t0].[DoctorId]
2025-11-24 01:53:38.882 +02:00 [INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt], [t].[BranchId], [t].[SpecializationId], [t].[BranchId0], [t].[Address], [t].[BranchName], [t].[CreatedAt], [t].[Description], [t].[Email], [t].[ImageURL], [t].[Phone], [t].[UpdatedAt], [t0].[DoctorId], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt0], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt0], [t0].[UserName]
FROM [Specializations] AS [s]
LEFT JOIN (
    SELECT [b].[BranchId], [b].[SpecializationId], [b0].[BranchId] AS [BranchId0], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [BranchSpecializations] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
) AS [t] ON [s].[SpecializationId] = [t].[SpecializationId]
LEFT JOIN (
    SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
) AS [t0] ON [s].[SpecializationId] = [t0].[SpecializationId]
ORDER BY [s].[SpecializationId], [t].[BranchId], [t].[SpecializationId], [t].[BranchId0], [t0].[DoctorId]
2025-11-24 01:53:38.890 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:53:38.891 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchSpecialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:53:38.892 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:53:38.894 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:53:38.895 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:53:38.897 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:53:38.897 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 7ms reading results.
2025-11-24 01:53:38.898 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:53:38.899 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:53:38.904 +02:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Specialization.SpecializationId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:53:38.917 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:53:38.930 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchSpecialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:53:38.936 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:53:38.972 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:53:38.980 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 01:53:38.986 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:53:38.990 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:53:39.009 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:53:39.011 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:53:39.017 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 01:53:39.033 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 01:53:39.039 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:53:39.041 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:53:39.043 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2025-11-24 01:53:39.046 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (Size = 120), @p3='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Specializations] ([CreatedAt], [Description], [Name], [UpdatedAt])
OUTPUT INSERTED.[SpecializationId]
VALUES (@p0, @p1, @p2, @p3);
2025-11-24 01:53:39.051 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (Size = 120), @p3='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Specializations] ([CreatedAt], [Description], [Name], [UpdatedAt])
OUTPUT INSERTED.[SpecializationId]
VALUES (@p0, @p1, @p2, @p3);
2025-11-24 01:53:39.057 +02:00 [DBG] The foreign key property 'Specialization.SpecializationId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 01:53:39.061 +02:00 [DBG] The foreign key property 'BranchSpecialization.SpecializationId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 01:53:39.065 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:53:39.066 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 9ms reading results.
2025-11-24 01:53:39.067 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:53:39.067 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:53:39.069 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:53:39.069 +02:00 [DBG] Executing DbCommand [Parameters=[@p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [BranchSpecializations] ([BranchId], [SpecializationId])
VALUES (@p4, @p5);
2025-11-24 01:53:39.078 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[@p4='?' (DbType = Int32), @p5='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [BranchSpecializations] ([BranchId], [SpecializationId])
VALUES (@p4, @p5);
2025-11-24 01:53:39.081 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:53:39.082 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 01:53:39.086 +02:00 [DBG] Committing transaction.
2025-11-24 01:53:39.096 +02:00 [DBG] Committed transaction.
2025-11-24 01:53:39.099 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:53:39.101 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 01:53:39.104 +02:00 [DBG] Disposing transaction.
2025-11-24 01:53:39.105 +02:00 [DBG] An entity of type 'Specialization' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:53:39.106 +02:00 [DBG] An entity of type 'BranchSpecialization' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:53:39.108 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 2 entities written to the database.
2025-11-24 01:53:39.108 +02:00 [INF] Specialization 'legg' added successfully
2025-11-24 01:53:39.113 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:53:39.114 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:53:39.115 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:53:39.117 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:53:39.117 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 01:53:39.118 +02:00 [INF] Executing CreatedAtActionResult, writing value of type 'Hospital.Application.DTO.Specialization.SpecializationDTO'.
2025-11-24 01:53:39.119 +02:00 [DBG] Found the endpoints ["Hospital.Controllers.SpecializationsController.Get (Hospital)"] for address (id=[2],action=[Get],controller=[Specializations])
2025-11-24 01:53:39.121 +02:00 [DBG] Successfully processed template api/Specializations/Get/{id} for Hospital.Controllers.SpecializationsController.Get (Hospital) resulting in /api/Specializations/Get/2 and 
2025-11-24 01:53:39.122 +02:00 [DBG] Link generation succeeded for endpoints ["Hospital.Controllers.SpecializationsController.Get (Hospital)"] with result /api/Specializations/Get/2
2025-11-24 01:53:39.125 +02:00 [INF] Executed action Hospital.Controllers.SpecializationsController.Create (Hospital) in 317.952ms
2025-11-24 01:53:39.127 +02:00 [INF] Executed endpoint 'Hospital.Controllers.SpecializationsController.Create (Hospital)'
2025-11-24 01:53:39.129 +02:00 [DBG] Connection id "0HNHATCCAV4K5" completed keep alive response.
2025-11-24 01:53:39.129 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:53:39.130 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:53:39.131 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 01:53:39.131 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Specializations/Create - 201 null application/json; charset=utf-8 363.4384ms
2025-11-24 01:53:46.213 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Specializations/add-from-excel - multipart/form-data; boundary=--------------------------521882844268367394483156 5880
2025-11-24 01:53:46.224 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Specializations/add-from-excel'
2025-11-24 01:53:46.226 +02:00 [DBG] Endpoint 'Hospital.Controllers.SpecializationsController.AddSpecializationsFromExcel (Hospital)' with route pattern 'api/Specializations/add-from-excel' is valid for the request path '/api/Specializations/add-from-excel'
2025-11-24 01:53:46.233 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.SpecializationsController.AddSpecializationsFromExcel (Hospital)'
2025-11-24 01:53:46.236 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:53:46.239 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:53:46.244 +02:00 [INF] Executing endpoint 'Hospital.Controllers.SpecializationsController.AddSpecializationsFromExcel (Hospital)'
2025-11-24 01:53:46.250 +02:00 [INF] Route matched with {action = "AddSpecializationsFromExcel", controller = "Specializations"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddSpecializationsFromExcel(Microsoft.AspNetCore.Http.IFormFile) on controller Hospital.Controllers.SpecializationsController (Hospital).
2025-11-24 01:53:46.255 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:53:46.258 +02:00 [DBG] Execution plan of resource filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-11-24 01:53:46.259 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:53:46.262 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:53:46.266 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:53:46.267 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.SpecializationsController (Hospital)
2025-11-24 01:53:46.268 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.SpecializationsController (Hospital)
2025-11-24 01:53:46.269 +02:00 [DBG] Connection id "0HNHATCCAV4K5", Request id "0HNHATCCAV4K5:00000004": started reading request body.
2025-11-24 01:53:46.270 +02:00 [DBG] Connection id "0HNHATCCAV4K5", Request id "0HNHATCCAV4K5:00000004": done reading request body.
2025-11-24 01:53:46.271 +02:00 [DBG] Attempting to bind parameter 'file' of type 'Microsoft.AspNetCore.Http.IFormFile' ...
2025-11-24 01:53:46.273 +02:00 [DBG] Attempting to bind parameter 'file' of type 'Microsoft.AspNetCore.Http.IFormFile' using the name 'file' in request data ...
2025-11-24 01:53:46.274 +02:00 [DBG] Done attempting to bind parameter 'file' of type 'Microsoft.AspNetCore.Http.IFormFile'.
2025-11-24 01:53:46.275 +02:00 [DBG] Done attempting to bind parameter 'file' of type 'Microsoft.AspNetCore.Http.IFormFile'.
2025-11-24 01:53:46.275 +02:00 [DBG] Attempting to validate the bound parameter 'file' of type 'Microsoft.AspNetCore.Http.IFormFile' ...
2025-11-24 01:53:46.277 +02:00 [DBG] Done attempting to validate the bound parameter 'file' of type 'Microsoft.AspNetCore.Http.IFormFile'.
2025-11-24 01:53:46.278 +02:00 [INF] add Specialization by excel sheet called at "2025-11-24T01:53:46.2788404+02:00"
2025-11-24 01:53:46.296 +02:00 [INF] Adding specialization: Cardiology
2025-11-24 01:53:46.301 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:53:46.306 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:53:46.308 +02:00 [DBG] Created DbConnection. (1ms).
2025-11-24 01:53:46.312 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:53:46.320 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:53:46.325 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:53:46.327 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:53:46.334 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (9ms).
2025-11-24 01:53:46.341 +02:00 [DBG] Executing DbCommand [Parameters=[@__branchIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [b0].[value]
    FROM OPENJSON(@__branchIds_0) WITH ([value] int '$') AS [b0]
)
2025-11-24 01:53:46.357 +02:00 [INF] Executed DbCommand (14ms) [Parameters=[@__branchIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [b0].[value]
    FROM OPENJSON(@__branchIds_0) WITH ([value] int '$') AS [b0]
)
2025-11-24 01:53:46.363 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:53:46.367 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:53:46.368 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 5ms reading results.
2025-11-24 01:53:46.369 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:53:46.370 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 01:53:46.429 +02:00 [INF] Adding specialization: Neurology
2025-11-24 01:53:46.430 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:53:46.431 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:53:46.432 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:53:46.436 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (4ms).
2025-11-24 01:53:46.437 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (5ms).
2025-11-24 01:53:46.441 +02:00 [DBG] Executing DbCommand [Parameters=[@__branchIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [b0].[value]
    FROM OPENJSON(@__branchIds_0) WITH ([value] int '$') AS [b0]
)
2025-11-24 01:53:46.446 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@__branchIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [b0].[value]
    FROM OPENJSON(@__branchIds_0) WITH ([value] int '$') AS [b0]
)
2025-11-24 01:53:46.450 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:53:46.451 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 01:53:46.454 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:53:46.454 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:53:46.455 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:53:46.456 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:53:46.457 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:53:46.457 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:53:46.459 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:53:46.461 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt], [t].[BranchId], [t].[SpecializationId], [t].[BranchId0], [t].[Address], [t].[BranchName], [t].[CreatedAt], [t].[Description], [t].[Email], [t].[ImageURL], [t].[Phone], [t].[UpdatedAt], [t0].[DoctorId], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt0], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt0], [t0].[UserName]
FROM [Specializations] AS [s]
LEFT JOIN (
    SELECT [b].[BranchId], [b].[SpecializationId], [b0].[BranchId] AS [BranchId0], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [BranchSpecializations] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
) AS [t] ON [s].[SpecializationId] = [t].[SpecializationId]
LEFT JOIN (
    SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
) AS [t0] ON [s].[SpecializationId] = [t0].[SpecializationId]
ORDER BY [s].[SpecializationId], [t].[BranchId], [t].[SpecializationId], [t].[BranchId0], [t0].[DoctorId]
2025-11-24 01:53:46.464 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt], [t].[BranchId], [t].[SpecializationId], [t].[BranchId0], [t].[Address], [t].[BranchName], [t].[CreatedAt], [t].[Description], [t].[Email], [t].[ImageURL], [t].[Phone], [t].[UpdatedAt], [t0].[DoctorId], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt0], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt0], [t0].[UserName]
FROM [Specializations] AS [s]
LEFT JOIN (
    SELECT [b].[BranchId], [b].[SpecializationId], [b0].[BranchId] AS [BranchId0], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [BranchSpecializations] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
) AS [t] ON [s].[SpecializationId] = [t].[SpecializationId]
LEFT JOIN (
    SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
) AS [t0] ON [s].[SpecializationId] = [t0].[SpecializationId]
ORDER BY [s].[SpecializationId], [t].[BranchId], [t].[SpecializationId], [t].[BranchId0], [t0].[DoctorId]
2025-11-24 01:53:46.468 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:53:46.469 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchSpecialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:53:46.470 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:53:46.472 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:53:46.474 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:53:46.476 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:53:46.477 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchSpecialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:53:46.478 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:53:46.479 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 10ms reading results.
2025-11-24 01:53:46.479 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:53:46.480 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:53:46.481 +02:00 [WRN] Specialization 'Neurology' already exists in branch 'adam7'
2025-11-24 01:53:46.517 +02:00 [INF] Adding specialization: Pediatrics
2025-11-24 01:53:46.520 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:53:46.523 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:53:46.525 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:53:46.528 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:53:46.533 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (7ms).
2025-11-24 01:53:46.536 +02:00 [DBG] Executing DbCommand [Parameters=[@__branchIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [b0].[value]
    FROM OPENJSON(@__branchIds_0) WITH ([value] int '$') AS [b0]
)
2025-11-24 01:53:46.567 +02:00 [INF] Executed DbCommand (31ms) [Parameters=[@__branchIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [b0].[value]
    FROM OPENJSON(@__branchIds_0) WITH ([value] int '$') AS [b0]
)
2025-11-24 01:53:46.580 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:53:46.581 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:53:46.582 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 01:53:46.582 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:53:46.584 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 01:53:46.630 +02:00 [INF] Adding specialization: Orthopedics
2025-11-24 01:53:46.636 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:53:46.637 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:53:46.639 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:53:46.641 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:53:46.641 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:53:46.645 +02:00 [DBG] Executing DbCommand [Parameters=[@__branchIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [b0].[value]
    FROM OPENJSON(@__branchIds_0) WITH ([value] int '$') AS [b0]
)
2025-11-24 01:53:46.650 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__branchIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [b0].[value]
    FROM OPENJSON(@__branchIds_0) WITH ([value] int '$') AS [b0]
)
2025-11-24 01:53:46.656 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:53:46.659 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 3ms reading results.
2025-11-24 01:53:46.664 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:53:46.666 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 01:53:46.682 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:53:46.684 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:53:46.687 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:53:46.691 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2025-11-24 01:53:46.692 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2025-11-24 01:53:46.694 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt], [t].[BranchId], [t].[SpecializationId], [t].[BranchId0], [t].[Address], [t].[BranchName], [t].[CreatedAt], [t].[Description], [t].[Email], [t].[ImageURL], [t].[Phone], [t].[UpdatedAt], [t0].[DoctorId], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt0], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt0], [t0].[UserName]
FROM [Specializations] AS [s]
LEFT JOIN (
    SELECT [b].[BranchId], [b].[SpecializationId], [b0].[BranchId] AS [BranchId0], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [BranchSpecializations] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
) AS [t] ON [s].[SpecializationId] = [t].[SpecializationId]
LEFT JOIN (
    SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
) AS [t0] ON [s].[SpecializationId] = [t0].[SpecializationId]
ORDER BY [s].[SpecializationId], [t].[BranchId], [t].[SpecializationId], [t].[BranchId0], [t0].[DoctorId]
2025-11-24 01:53:46.698 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt], [t].[BranchId], [t].[SpecializationId], [t].[BranchId0], [t].[Address], [t].[BranchName], [t].[CreatedAt], [t].[Description], [t].[Email], [t].[ImageURL], [t].[Phone], [t].[UpdatedAt], [t0].[DoctorId], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt0], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt0], [t0].[UserName]
FROM [Specializations] AS [s]
LEFT JOIN (
    SELECT [b].[BranchId], [b].[SpecializationId], [b0].[BranchId] AS [BranchId0], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [BranchSpecializations] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
) AS [t] ON [s].[SpecializationId] = [t].[SpecializationId]
LEFT JOIN (
    SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
) AS [t0] ON [s].[SpecializationId] = [t0].[SpecializationId]
ORDER BY [s].[SpecializationId], [t].[BranchId], [t].[SpecializationId], [t].[BranchId0], [t0].[DoctorId]
2025-11-24 01:53:46.702 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:53:46.703 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 01:53:46.704 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:53:46.705 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:53:46.708 +02:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Specialization.SpecializationId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:53:46.716 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:53:46.718 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchSpecialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:53:46.719 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchSpecialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:53:46.720 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:53:46.722 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:53:46.724 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 01:53:46.727 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:53:46.730 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:53:46.736 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:53:46.737 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:53:46.738 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 01:53:46.739 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 01:53:46.743 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:53:46.744 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:53:46.746 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-11-24 01:53:46.748 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (Size = 120), @p3='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Specializations] ([CreatedAt], [Description], [Name], [UpdatedAt])
OUTPUT INSERTED.[SpecializationId]
VALUES (@p0, @p1, @p2, @p3);
2025-11-24 01:53:46.754 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (Size = 120), @p3='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Specializations] ([CreatedAt], [Description], [Name], [UpdatedAt])
OUTPUT INSERTED.[SpecializationId]
VALUES (@p0, @p1, @p2, @p3);
2025-11-24 01:53:46.757 +02:00 [DBG] The foreign key property 'Specialization.SpecializationId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 01:53:46.761 +02:00 [DBG] The foreign key property 'BranchSpecialization.SpecializationId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 01:53:46.763 +02:00 [DBG] The foreign key property 'BranchSpecialization.SpecializationId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 01:53:46.765 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:53:46.766 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 8ms reading results.
2025-11-24 01:53:46.770 +02:00 [DBG] Executing 2 update commands as a batch.
2025-11-24 01:53:46.772 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:53:46.773 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:53:46.775 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:53:46.777 +02:00 [DBG] Executing DbCommand [Parameters=[@p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [BranchSpecializations] ([BranchId], [SpecializationId])
VALUES (@p4, @p5),
(@p6, @p7);
2025-11-24 01:53:46.782 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [BranchSpecializations] ([BranchId], [SpecializationId])
VALUES (@p4, @p5),
(@p6, @p7);
2025-11-24 01:53:46.787 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:53:46.788 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 01:53:46.789 +02:00 [DBG] Committing transaction.
2025-11-24 01:53:46.795 +02:00 [DBG] Committed transaction.
2025-11-24 01:53:46.796 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:53:46.797 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:53:46.798 +02:00 [DBG] Disposing transaction.
2025-11-24 01:53:46.798 +02:00 [DBG] An entity of type 'Specialization' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:53:46.800 +02:00 [DBG] An entity of type 'BranchSpecialization' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:53:46.801 +02:00 [DBG] An entity of type 'BranchSpecialization' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:53:46.802 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 3 entities written to the database.
2025-11-24 01:53:46.802 +02:00 [INF] Specialization 'Orthopedics' added successfully
2025-11-24 01:53:46.803 +02:00 [INF] Adding specialization: Dermatology
2025-11-24 01:53:46.804 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:53:46.805 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:53:46.805 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:53:46.806 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:53:46.807 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:53:46.808 +02:00 [DBG] Executing DbCommand [Parameters=[@__branchIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [b0].[value]
    FROM OPENJSON(@__branchIds_0) WITH ([value] int '$') AS [b0]
)
2025-11-24 01:53:46.811 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__branchIds_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [b0].[value]
    FROM OPENJSON(@__branchIds_0) WITH ([value] int '$') AS [b0]
)
2025-11-24 01:53:46.814 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:53:46.815 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 01:53:46.816 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:53:46.817 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 01:53:46.857 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:53:46.862 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:53:46.865 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:53:46.867 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:53:46.867 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 01:53:46.872 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-11-24 01:53:46.875 +02:00 [INF] Executed action Hospital.Controllers.SpecializationsController.AddSpecializationsFromExcel (Hospital) in 608.3485ms
2025-11-24 01:53:46.877 +02:00 [INF] Executed endpoint 'Hospital.Controllers.SpecializationsController.AddSpecializationsFromExcel (Hospital)'
2025-11-24 01:53:46.880 +02:00 [DBG] Connection id "0HNHATCCAV4K5" completed keep alive response.
2025-11-24 01:53:46.882 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:53:46.884 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:53:46.885 +02:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-11-24 01:53:46.887 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Specializations/add-from-excel - 200 null application/json; charset=utf-8 674.0992ms
2025-11-24 01:54:07.663 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Services - null null
2025-11-24 01:54:07.668 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Services'
2025-11-24 01:54:07.670 +02:00 [DBG] Endpoint 'Hospital.Controllers.ServicesController.GetAll (Hospital)' with route pattern 'api/Services' is valid for the request path '/api/Services'
2025-11-24 01:54:07.674 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.ServicesController.GetAll (Hospital)'
2025-11-24 01:54:07.676 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:54:07.677 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:54:07.677 +02:00 [INF] Executing endpoint 'Hospital.Controllers.ServicesController.GetAll (Hospital)'
2025-11-24 01:54:07.680 +02:00 [INF] Route matched with {action = "GetAll", controller = "Services"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll() on controller Hospital.Controllers.ServicesController (Hospital).
2025-11-24 01:54:07.681 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:54:07.682 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:54:07.683 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:54:07.687 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:54:07.689 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:54:07.690 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.ServicesController (Hospital)
2025-11-24 01:54:07.693 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.ServicesController (Hospital)
2025-11-24 01:54:07.696 +02:00 [INF] get all services called at "2025-11-24T01:54:07.6964428+02:00"
2025-11-24 01:54:07.698 +02:00 [INF] Fetching all services
2025-11-24 01:54:07.699 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:54:07.702 +02:00 [DBG] Compiling query expression: 
'DbSet<Service>()
    .Include(s => s.Branches)'
2025-11-24 01:54:07.704 +02:00 [DBG] Including navigation: 'Service.Branches'.
2025-11-24 01:54:07.712 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Service>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Service.ServiceId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Service.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: Service.Description (string), 2], [Property: Service.ImageURL (string) MaxLength(300), 3], [Property: Service.Name (string) Required MaxLength(120), 4], [Property: Service.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 5] }
            1 -> 0
            2 -> Dictionary<IProperty, int> { [Property: BranchService (Dictionary<string, object>).BranchId (no field, int) Indexer Required PK FK AfterSave:Throw, 6], [Property: BranchService (Dictionary<string, object>).ServiceId (no field, int) Indexer Required PK FK Index AfterSave:Throw, 7] }
            3 -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 8], [Property: Branch.Address (string) MaxLength(250), 9], [Property: Branch.BranchName (string) Required MaxLength(150), 10], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 11], [Property: Branch.Description (string), 12], [Property: Branch.Email (string) MaxLength(200), 13], [Property: Branch.ImageURL (string) MaxLength(300), 14], [Property: Branch.Phone (string) MaxLength(25), 15], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 16] }
            4 -> 6
            5 -> 7
            6 -> 8
        SELECT s.ServiceId, s.CreatedAt, s.Description, s.ImageURL, s.Name, s.UpdatedAt, t.BranchId, t.ServiceId, t.BranchId0, t.Address, t.BranchName, t.CreatedAt, t.Description, t.Email, t.ImageURL, t.Phone, t.UpdatedAt
        FROM Services AS s
        LEFT JOIN 
        (
            SELECT b.BranchId, b.ServiceId, b0.BranchId AS BranchId0, b0.Address, b0.BranchName, b0.CreatedAt, b0.Description, b0.Email, b0.ImageURL, b0.Phone, b0.UpdatedAt
            FROM BranchServices AS b
            INNER JOIN Branches AS b0 ON b.BranchId == b0.BranchId
        ) AS t ON s.ServiceId == t.ServiceId
        ORDER BY s.ServiceId ASC, t.BranchId ASC, t.ServiceId ASC), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Service>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 01:54:07.716 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:54:07.717 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 01:54:07.717 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:54:07.719 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:54:07.720 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:54:07.720 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:54:07.721 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:54:07.721 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ServiceId], [s].[CreatedAt], [s].[Description], [s].[ImageURL], [s].[Name], [s].[UpdatedAt], [t].[BranchId], [t].[ServiceId], [t].[BranchId0], [t].[Address], [t].[BranchName], [t].[CreatedAt], [t].[Description], [t].[Email], [t].[ImageURL], [t].[Phone], [t].[UpdatedAt]
FROM [Services] AS [s]
LEFT JOIN (
    SELECT [b].[BranchId], [b].[ServiceId], [b0].[BranchId] AS [BranchId0], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [BranchServices] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
) AS [t] ON [s].[ServiceId] = [t].[ServiceId]
ORDER BY [s].[ServiceId], [t].[BranchId], [t].[ServiceId]
2025-11-24 01:54:07.731 +02:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ServiceId], [s].[CreatedAt], [s].[Description], [s].[ImageURL], [s].[Name], [s].[UpdatedAt], [t].[BranchId], [t].[ServiceId], [t].[BranchId0], [t].[Address], [t].[BranchName], [t].[CreatedAt], [t].[Description], [t].[Email], [t].[ImageURL], [t].[Phone], [t].[UpdatedAt]
FROM [Services] AS [s]
LEFT JOIN (
    SELECT [b].[BranchId], [b].[ServiceId], [b0].[BranchId] AS [BranchId0], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [BranchServices] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
) AS [t] ON [s].[ServiceId] = [t].[ServiceId]
ORDER BY [s].[ServiceId], [t].[BranchId], [t].[ServiceId]
2025-11-24 01:54:07.734 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:54:07.734 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 01:54:07.735 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:54:07.736 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:54:07.737 +02:00 [INF] 0 services retrieved
2025-11-24 01:54:07.742 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:54:07.745 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:54:07.745 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:54:07.746 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:54:07.746 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 01:54:07.747 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.ServiceDTOS.ServiceDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 01:54:07.750 +02:00 [INF] Executed action Hospital.Controllers.ServicesController.GetAll (Hospital) in 59.9732ms
2025-11-24 01:54:07.752 +02:00 [INF] Executed endpoint 'Hospital.Controllers.ServicesController.GetAll (Hospital)'
2025-11-24 01:54:07.753 +02:00 [DBG] Connection id "0HNHATCCAV4K5" completed keep alive response.
2025-11-24 01:54:07.754 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:54:07.755 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:54:07.755 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 01:54:07.756 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Services - 200 null application/json; charset=utf-8 93.4384ms
2025-11-24 01:54:18.166 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Services - application/json 191
2025-11-24 01:54:18.170 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Services'
2025-11-24 01:54:18.173 +02:00 [DBG] Endpoint 'Hospital.Controllers.ServicesController.Create (Hospital)' with route pattern 'api/Services' is valid for the request path '/api/Services'
2025-11-24 01:54:18.175 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.ServicesController.Create (Hospital)'
2025-11-24 01:54:18.178 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:54:18.180 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:54:18.182 +02:00 [INF] Executing endpoint 'Hospital.Controllers.ServicesController.Create (Hospital)'
2025-11-24 01:54:18.189 +02:00 [INF] Route matched with {action = "Create", controller = "Services"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Create(Hospital.Application.DTO.ServiceDTOS.CreateServiceDto) on controller Hospital.Controllers.ServicesController (Hospital).
2025-11-24 01:54:18.192 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:54:18.194 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:54:18.196 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:54:18.199 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:54:18.200 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:54:18.206 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.ServicesController (Hospital)
2025-11-24 01:54:18.211 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.ServicesController (Hospital)
2025-11-24 01:54:18.216 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.ServiceDTOS.CreateServiceDto' ...
2025-11-24 01:54:18.220 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.ServiceDTOS.CreateServiceDto' using the name '' in request data ...
2025-11-24 01:54:18.224 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 01:54:18.231 +02:00 [DBG] Connection id "0HNHATCCAV4K5", Request id "0HNHATCCAV4K5:00000006": started reading request body.
2025-11-24 01:54:18.235 +02:00 [DBG] Connection id "0HNHATCCAV4K5", Request id "0HNHATCCAV4K5:00000006": done reading request body.
2025-11-24 01:54:18.246 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.ServiceDTOS.CreateServiceDto'
2025-11-24 01:54:18.250 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.ServiceDTOS.CreateServiceDto'.
2025-11-24 01:54:18.258 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.ServiceDTOS.CreateServiceDto'.
2025-11-24 01:54:18.261 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.ServiceDTOS.CreateServiceDto' ...
2025-11-24 01:54:18.268 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.ServiceDTOS.CreateServiceDto'.
2025-11-24 01:54:18.271 +02:00 [INF] create services called at "2025-11-24T01:54:18.2711480+02:00"
2025-11-24 01:54:18.273 +02:00 [INF] Creating service with Name: mri 4
2025-11-24 01:54:18.278 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:54:18.281 +02:00 [DBG] Compiling query expression: 
'DbSet<Branch>()
    .Where(b => __ids_0
        .Contains(b.BranchId))'
2025-11-24 01:54:18.286 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Branch>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Branch.Address (string) MaxLength(250), 1], [Property: Branch.BranchName (string) Required MaxLength(150), 2], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 3], [Property: Branch.Description (string), 4], [Property: Branch.Email (string) MaxLength(200), 5], [Property: Branch.ImageURL (string) MaxLength(300), 6], [Property: Branch.Phone (string) MaxLength(25), 7], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 8] }
        SELECT b.BranchId, b.Address, b.BranchName, b.CreatedAt, b.Description, b.Email, b.ImageURL, b.Phone, b.UpdatedAt
        FROM Branches AS b
        WHERE b.BranchId IN (
            SELECT i.value
            FROM OPENJSON(@__ids_0) WITH (value int '') AS i)), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Branch>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 01:54:18.288 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:54:18.290 +02:00 [DBG] Created DbConnection. (1ms).
2025-11-24 01:54:18.292 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:54:18.293 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:54:18.294 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:54:18.295 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:54:18.297 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:54:18.298 +02:00 [DBG] Executing DbCommand [Parameters=[@__ids_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__ids_0) WITH ([value] int '$') AS [i]
)
2025-11-24 01:54:18.305 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[@__ids_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__ids_0) WITH ([value] int '$') AS [i]
)
2025-11-24 01:54:18.306 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:54:18.307 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:54:18.308 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 01:54:18.309 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:54:18.310 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:54:18.311 +02:00 [WRN] One or more branches do not exist for the new service
2025-11-24 01:54:18.357 +02:00 [INF] Executed action Hospital.Controllers.ServicesController.Create (Hospital) in 150.5854ms
2025-11-24 01:54:18.362 +02:00 [INF] Executed endpoint 'Hospital.Controllers.ServicesController.Create (Hospital)'
2025-11-24 01:54:18.421 +02:00 [ERR]  Exception caught: One or more branches do not exist.
System.ArgumentException: One or more branches do not exist.
   at Hospital.Infrastructure.Services.ServiceService.CreateAsync(CreateServiceDto dto) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\ServiceService.cs:line 67
   at Hospital.Controllers.ServicesController.Create(CreateServiceDto dto) in D:\Walaa\GP\Hospital\Hospital\Controllers\ServicesController.cs:line 54
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
2025-11-24 01:54:18.437 +02:00 [DBG] Connection id "0HNHATCCAV4K5" completed keep alive response.
2025-11-24 01:54:18.439 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:54:18.440 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:54:18.442 +02:00 [DBG] Disposed connection to database '' on server '' (2ms).
2025-11-24 01:54:18.444 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Services - 400 null application/json 278.0012ms
2025-11-24 01:54:24.705 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Services - application/json 191
2025-11-24 01:54:24.710 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Services'
2025-11-24 01:54:24.711 +02:00 [DBG] Endpoint 'Hospital.Controllers.ServicesController.Create (Hospital)' with route pattern 'api/Services' is valid for the request path '/api/Services'
2025-11-24 01:54:24.713 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.ServicesController.Create (Hospital)'
2025-11-24 01:54:24.714 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:54:24.715 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:54:24.716 +02:00 [INF] Executing endpoint 'Hospital.Controllers.ServicesController.Create (Hospital)'
2025-11-24 01:54:24.717 +02:00 [INF] Route matched with {action = "Create", controller = "Services"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Create(Hospital.Application.DTO.ServiceDTOS.CreateServiceDto) on controller Hospital.Controllers.ServicesController (Hospital).
2025-11-24 01:54:24.719 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:54:24.719 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:54:24.720 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:54:24.721 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:54:24.722 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:54:24.723 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.ServicesController (Hospital)
2025-11-24 01:54:24.726 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.ServicesController (Hospital)
2025-11-24 01:54:24.726 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.ServiceDTOS.CreateServiceDto' ...
2025-11-24 01:54:24.727 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.ServiceDTOS.CreateServiceDto' using the name '' in request data ...
2025-11-24 01:54:24.727 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 01:54:24.728 +02:00 [DBG] Connection id "0HNHATCCAV4K5", Request id "0HNHATCCAV4K5:00000007": started reading request body.
2025-11-24 01:54:24.729 +02:00 [DBG] Connection id "0HNHATCCAV4K5", Request id "0HNHATCCAV4K5:00000007": done reading request body.
2025-11-24 01:54:24.729 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.ServiceDTOS.CreateServiceDto'
2025-11-24 01:54:24.730 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.ServiceDTOS.CreateServiceDto'.
2025-11-24 01:54:24.730 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.ServiceDTOS.CreateServiceDto'.
2025-11-24 01:54:24.731 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.ServiceDTOS.CreateServiceDto' ...
2025-11-24 01:54:24.732 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.ServiceDTOS.CreateServiceDto'.
2025-11-24 01:54:24.734 +02:00 [INF] create services called at "2025-11-24T01:54:24.7347332+02:00"
2025-11-24 01:54:24.735 +02:00 [INF] Creating service with Name: mri 4
2025-11-24 01:54:24.736 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:54:24.737 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:54:24.738 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 01:54:24.739 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:54:24.739 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:54:24.741 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:54:24.742 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:54:24.743 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:54:24.744 +02:00 [DBG] Executing DbCommand [Parameters=[@__ids_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__ids_0) WITH ([value] int '$') AS [i]
)
2025-11-24 01:54:24.751 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@__ids_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__ids_0) WITH ([value] int '$') AS [i]
)
2025-11-24 01:54:24.761 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:54:24.762 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:54:24.765 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 4ms reading results.
2025-11-24 01:54:24.766 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:54:24.767 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:54:24.768 +02:00 [WRN] One or more branches do not exist for the new service
2025-11-24 01:54:24.805 +02:00 [INF] Executed action Hospital.Controllers.ServicesController.Create (Hospital) in 82.27ms
2025-11-24 01:54:24.807 +02:00 [INF] Executed endpoint 'Hospital.Controllers.ServicesController.Create (Hospital)'
2025-11-24 01:54:24.859 +02:00 [ERR]  Exception caught: One or more branches do not exist.
System.ArgumentException: One or more branches do not exist.
   at Hospital.Infrastructure.Services.ServiceService.CreateAsync(CreateServiceDto dto) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\ServiceService.cs:line 67
   at Hospital.Controllers.ServicesController.Create(CreateServiceDto dto) in D:\Walaa\GP\Hospital\Hospital\Controllers\ServicesController.cs:line 54
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
2025-11-24 01:54:24.875 +02:00 [DBG] Connection id "0HNHATCCAV4K5" completed keep alive response.
2025-11-24 01:54:24.878 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:54:24.879 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:54:24.882 +02:00 [DBG] Disposed connection to database '' on server '' (2ms).
2025-11-24 01:54:24.883 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Services - 400 null application/json 177.8651ms
2025-11-24 01:54:45.375 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Branch/GetAll - null null
2025-11-24 01:54:45.379 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Branch/GetAll'
2025-11-24 01:54:45.381 +02:00 [DBG] Endpoint 'Hospital.Controllers.BranchController.GetAll (Hospital)' with route pattern 'api/Branch/GetAll' is valid for the request path '/api/Branch/GetAll'
2025-11-24 01:54:45.387 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.BranchController.GetAll (Hospital)'
2025-11-24 01:54:45.392 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:54:45.396 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:54:45.400 +02:00 [INF] Executing endpoint 'Hospital.Controllers.BranchController.GetAll (Hospital)'
2025-11-24 01:54:45.403 +02:00 [INF] Route matched with {action = "GetAll", controller = "Branch"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll() on controller Hospital.Controllers.BranchController (Hospital).
2025-11-24 01:54:45.407 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:54:45.411 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:54:45.412 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:54:45.415 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:54:45.416 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:54:45.417 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.BranchController (Hospital)
2025-11-24 01:54:45.418 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.BranchController (Hospital)
2025-11-24 01:54:45.421 +02:00 [INF] Get All Branch called at "2025-11-24T01:54:45.4213297+02:00"
2025-11-24 01:54:45.423 +02:00 [INF] Fetching all branches
2025-11-24 01:54:45.425 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:54:45.426 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:54:45.426 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 01:54:45.427 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:54:45.428 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:54:45.428 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:54:45.429 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:54:45.430 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:54:45.430 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
2025-11-24 01:54:45.435 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
2025-11-24 01:54:45.444 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:54:45.446 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 2ms reading results.
2025-11-24 01:54:45.448 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:54:45.449 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 01:54:45.453 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:54:45.455 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:54:45.456 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:54:45.457 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:54:45.457 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 01:54:45.459 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Branch.BranchDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 01:54:45.461 +02:00 [INF] Executed action Hospital.Controllers.BranchController.GetAll (Hospital) in 43.9682ms
2025-11-24 01:54:45.464 +02:00 [INF] Executed endpoint 'Hospital.Controllers.BranchController.GetAll (Hospital)'
2025-11-24 01:54:45.465 +02:00 [DBG] Connection id "0HNHATCCAV4K5" completed keep alive response.
2025-11-24 01:54:45.466 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:54:45.467 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:54:45.468 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 01:54:45.469 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Branch/GetAll - 200 null application/json; charset=utf-8 94.327ms
2025-11-24 01:55:00.781 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Services - application/json 191
2025-11-24 01:55:00.789 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Services'
2025-11-24 01:55:00.793 +02:00 [DBG] Endpoint 'Hospital.Controllers.ServicesController.Create (Hospital)' with route pattern 'api/Services' is valid for the request path '/api/Services'
2025-11-24 01:55:00.796 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.ServicesController.Create (Hospital)'
2025-11-24 01:55:00.797 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:55:00.798 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:55:00.800 +02:00 [INF] Executing endpoint 'Hospital.Controllers.ServicesController.Create (Hospital)'
2025-11-24 01:55:00.802 +02:00 [INF] Route matched with {action = "Create", controller = "Services"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Create(Hospital.Application.DTO.ServiceDTOS.CreateServiceDto) on controller Hospital.Controllers.ServicesController (Hospital).
2025-11-24 01:55:00.804 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:55:00.805 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:55:00.806 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:55:00.808 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:55:00.808 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:55:00.809 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.ServicesController (Hospital)
2025-11-24 01:55:00.810 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.ServicesController (Hospital)
2025-11-24 01:55:00.811 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.ServiceDTOS.CreateServiceDto' ...
2025-11-24 01:55:00.811 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.ServiceDTOS.CreateServiceDto' using the name '' in request data ...
2025-11-24 01:55:00.813 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 01:55:00.814 +02:00 [DBG] Connection id "0HNHATCCAV4K5", Request id "0HNHATCCAV4K5:00000009": started reading request body.
2025-11-24 01:55:00.815 +02:00 [DBG] Connection id "0HNHATCCAV4K5", Request id "0HNHATCCAV4K5:00000009": done reading request body.
2025-11-24 01:55:00.816 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.ServiceDTOS.CreateServiceDto'
2025-11-24 01:55:00.817 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.ServiceDTOS.CreateServiceDto'.
2025-11-24 01:55:00.817 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.ServiceDTOS.CreateServiceDto'.
2025-11-24 01:55:00.818 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.ServiceDTOS.CreateServiceDto' ...
2025-11-24 01:55:00.819 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.ServiceDTOS.CreateServiceDto'.
2025-11-24 01:55:00.820 +02:00 [INF] create services called at "2025-11-24T01:55:00.8200458+02:00"
2025-11-24 01:55:00.820 +02:00 [INF] Creating service with Name: mri 4
2025-11-24 01:55:00.822 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:55:00.825 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:55:00.825 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 01:55:00.826 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:55:00.827 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:55:00.828 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:55:00.828 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:55:00.829 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:55:00.831 +02:00 [DBG] Executing DbCommand [Parameters=[@__ids_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__ids_0) WITH ([value] int '$') AS [i]
)
2025-11-24 01:55:00.838 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[@__ids_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__ids_0) WITH ([value] int '$') AS [i]
)
2025-11-24 01:55:00.841 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:55:00.842 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:55:00.843 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:55:00.844 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 2ms reading results.
2025-11-24 01:55:00.845 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:55:00.847 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 01:55:00.861 +02:00 [DBG] Compiling query expression: 
'DbSet<Service>()
    .Where(s => s.Name.ToLower() == __ToLower_0)
    .Any(s => s.Branches
        .Any(b => __branchIds_1
            .Contains(b.BranchId)))'
2025-11-24 01:55:00.870 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Services AS s
                WHERE (LOWER(s.Name) == @__ToLower_0) && EXISTS (
                    SELECT 1
                    FROM BranchServices AS b
                    INNER JOIN Branches AS b0 ON b.BranchId == b0.BranchId
                    WHERE ((s.ServiceId != NULL) && (s.ServiceId == b.ServiceId)) && b0.BranchId IN (
                        SELECT b1.value
                        FROM OPENJSON(@__branchIds_1) WITH (value int '') AS b1)))), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 01:55:00.896 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:55:00.900 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:55:00.904 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:55:00.905 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:55:00.908 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2025-11-24 01:55:00.910 +02:00 [DBG] Executing DbCommand [Parameters=[@__ToLower_0='?' (Size = 120), @__branchIds_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Services] AS [s]
        WHERE LOWER([s].[Name]) = @__ToLower_0 AND EXISTS (
            SELECT 1
            FROM [BranchServices] AS [b]
            INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
            WHERE [s].[ServiceId] = [b].[ServiceId] AND [b0].[BranchId] IN (
                SELECT [b1].[value]
                FROM OPENJSON(@__branchIds_1) WITH ([value] int '$') AS [b1]
            ))) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-24 01:55:00.936 +02:00 [INF] Executed DbCommand (26ms) [Parameters=[@__ToLower_0='?' (Size = 120), @__branchIds_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Services] AS [s]
        WHERE LOWER([s].[Name]) = @__ToLower_0 AND EXISTS (
            SELECT 1
            FROM [BranchServices] AS [b]
            INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
            WHERE [s].[ServiceId] = [b].[ServiceId] AND [b0].[BranchId] IN (
                SELECT [b1].[value]
                FROM OPENJSON(@__branchIds_1) WITH ([value] int '$') AS [b1]
            ))) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-24 01:55:00.945 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:55:00.947 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 3ms reading results.
2025-11-24 01:55:00.948 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:55:00.949 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 01:55:00.957 +02:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Service.ServiceId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:55:00.976 +02:00 [DBG] Context 'AppDbContext' started tracking 'Service' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:55:00.988 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchService' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:55:00.991 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchService' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:55:00.993 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:55:01.001 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:55:01.005 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 01:55:01.006 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:55:01.011 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:55:01.017 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:55:01.018 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:55:01.020 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 01:55:01.021 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 01:55:01.024 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:55:01.027 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:55:01.028 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-11-24 01:55:01.029 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (Size = 300), @p3='?' (Size = 120), @p4='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Services] ([CreatedAt], [Description], [ImageURL], [Name], [UpdatedAt])
OUTPUT INSERTED.[ServiceId]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-11-24 01:55:01.036 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (Size = 300), @p3='?' (Size = 120), @p4='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Services] ([CreatedAt], [Description], [ImageURL], [Name], [UpdatedAt])
OUTPUT INSERTED.[ServiceId]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-11-24 01:55:01.042 +02:00 [DBG] The foreign key property 'Service.ServiceId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 01:55:01.045 +02:00 [DBG] The foreign key property 'BranchService.ServiceId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 01:55:01.047 +02:00 [DBG] The foreign key property 'BranchService.ServiceId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 01:55:01.047 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:55:01.048 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 7ms reading results.
2025-11-24 01:55:01.049 +02:00 [DBG] Executing 2 update commands as a batch.
2025-11-24 01:55:01.049 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:55:01.050 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:55:01.051 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:55:01.052 +02:00 [DBG] Executing DbCommand [Parameters=[@p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [BranchServices] ([BranchId], [ServiceId])
VALUES (@p5, @p6),
(@p7, @p8);
2025-11-24 01:55:01.069 +02:00 [INF] Executed DbCommand (18ms) [Parameters=[@p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [BranchServices] ([BranchId], [ServiceId])
VALUES (@p5, @p6),
(@p7, @p8);
2025-11-24 01:55:01.072 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:55:01.075 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 2ms reading results.
2025-11-24 01:55:01.076 +02:00 [DBG] Committing transaction.
2025-11-24 01:55:01.077 +02:00 [DBG] Committed transaction.
2025-11-24 01:55:01.078 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:55:01.078 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:55:01.079 +02:00 [DBG] Disposing transaction.
2025-11-24 01:55:01.083 +02:00 [DBG] An entity of type 'Service' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:55:01.085 +02:00 [DBG] An entity of type 'BranchService' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:55:01.086 +02:00 [DBG] An entity of type 'BranchService' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:55:01.089 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 3 entities written to the database.
2025-11-24 01:55:01.090 +02:00 [INF] Service 'mri 4' created successfully
2025-11-24 01:55:01.097 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:55:01.100 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:55:01.101 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:55:01.102 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:55:01.103 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 01:55:01.104 +02:00 [INF] Executing CreatedAtActionResult, writing value of type 'Hospital.Application.DTO.ServiceDTOS.ServiceDto'.
2025-11-24 01:55:01.105 +02:00 [DBG] Found the endpoints ["Hospital.Controllers.ServicesController.GetById (Hospital)"] for address (id=[1],action=[GetById],controller=[Services])
2025-11-24 01:55:01.106 +02:00 [DBG] Successfully processed template api/Services/{id} for Hospital.Controllers.ServicesController.GetById (Hospital) resulting in /api/Services/1 and 
2025-11-24 01:55:01.108 +02:00 [DBG] Link generation succeeded for endpoints ["Hospital.Controllers.ServicesController.GetById (Hospital)"] with result /api/Services/1
2025-11-24 01:55:01.110 +02:00 [INF] Executed action Hospital.Controllers.ServicesController.Create (Hospital) in 301.1696ms
2025-11-24 01:55:01.111 +02:00 [INF] Executed endpoint 'Hospital.Controllers.ServicesController.Create (Hospital)'
2025-11-24 01:55:01.111 +02:00 [DBG] Connection id "0HNHATCCAV4K5" completed keep alive response.
2025-11-24 01:55:01.112 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:55:01.113 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:55:01.115 +02:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-11-24 01:55:01.115 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Services - 201 null application/json; charset=utf-8 334.5028ms
2025-11-24 01:55:56.034 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Services/1 - null null
2025-11-24 01:55:56.047 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Services/1'
2025-11-24 01:55:56.049 +02:00 [DBG] Endpoint 'Hospital.Controllers.ServicesController.GetById (Hospital)' with route pattern 'api/Services/{id}' is valid for the request path '/api/Services/1'
2025-11-24 01:55:56.050 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.ServicesController.GetById (Hospital)'
2025-11-24 01:55:56.051 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:55:56.053 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:55:56.056 +02:00 [INF] Executing endpoint 'Hospital.Controllers.ServicesController.GetById (Hospital)'
2025-11-24 01:55:56.060 +02:00 [INF] Route matched with {action = "GetById", controller = "Services"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetById(Int32) on controller Hospital.Controllers.ServicesController (Hospital).
2025-11-24 01:55:56.064 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:55:56.065 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:55:56.066 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:55:56.068 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:55:56.069 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:55:56.073 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.ServicesController (Hospital)
2025-11-24 01:55:56.074 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.ServicesController (Hospital)
2025-11-24 01:55:56.075 +02:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-11-24 01:55:56.076 +02:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-11-24 01:55:56.077 +02:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-11-24 01:55:56.077 +02:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-11-24 01:55:56.078 +02:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-11-24 01:55:56.079 +02:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-11-24 01:55:56.080 +02:00 [INF] get service by id  called at "2025-11-24T01:55:56.0806319+02:00"
2025-11-24 01:55:56.081 +02:00 [INF] Fetching service with ID: 1
2025-11-24 01:55:56.083 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:55:56.085 +02:00 [DBG] Compiling query expression: 
'DbSet<Service>()
    .Include(s => s.Branches)
    .FirstOrDefault(s => s.ServiceId == __id_0)'
2025-11-24 01:55:56.087 +02:00 [DBG] Including navigation: 'Service.Branches'.
2025-11-24 01:55:56.097 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Service>(
    asyncEnumerable: new SingleQueryingEnumerable<Service>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Service.ServiceId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Service.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: Service.Description (string), 2], [Property: Service.ImageURL (string) MaxLength(300), 3], [Property: Service.Name (string) Required MaxLength(120), 4], [Property: Service.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 5] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: BranchService (Dictionary<string, object>).BranchId (no field, int) Indexer Required PK FK AfterSave:Throw, 6], [Property: BranchService (Dictionary<string, object>).ServiceId (no field, int) Indexer Required PK FK Index AfterSave:Throw, 7] }
                3 -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 8], [Property: Branch.Address (string) MaxLength(250), 9], [Property: Branch.BranchName (string) Required MaxLength(150), 10], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 11], [Property: Branch.Description (string), 12], [Property: Branch.Email (string) MaxLength(200), 13], [Property: Branch.ImageURL (string) MaxLength(300), 14], [Property: Branch.Phone (string) MaxLength(25), 15], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 16] }
                4 -> 6
                5 -> 7
                6 -> 8
            SELECT t.ServiceId, t.CreatedAt, t.Description, t.ImageURL, t.Name, t.UpdatedAt, t0.BranchId, t0.ServiceId, t0.BranchId0, t0.Address, t0.BranchName, t0.CreatedAt, t0.Description, t0.Email, t0.ImageURL, t0.Phone, t0.UpdatedAt
            FROM 
            (
                SELECT TOP(1) s.ServiceId, s.CreatedAt, s.Description, s.ImageURL, s.Name, s.UpdatedAt
                FROM Services AS s
                WHERE s.ServiceId == @__id_0
            ) AS t
            LEFT JOIN 
            (
                SELECT b.BranchId, b.ServiceId, b0.BranchId AS BranchId0, b0.Address, b0.BranchName, b0.CreatedAt, b0.Description, b0.Email, b0.ImageURL, b0.Phone, b0.UpdatedAt
                FROM BranchServices AS b
                INNER JOIN Branches AS b0 ON b.BranchId == b0.BranchId
            ) AS t0 ON t.ServiceId == t0.ServiceId
            ORDER BY t.ServiceId ASC, t0.BranchId ASC, t0.ServiceId ASC), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Service>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 01:55:56.099 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:55:56.099 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 01:55:56.100 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:55:56.101 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:55:56.102 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:55:56.103 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:55:56.105 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:55:56.106 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[ServiceId], [t].[CreatedAt], [t].[Description], [t].[ImageURL], [t].[Name], [t].[UpdatedAt], [t0].[BranchId], [t0].[ServiceId], [t0].[BranchId0], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt]
FROM (
    SELECT TOP(1) [s].[ServiceId], [s].[CreatedAt], [s].[Description], [s].[ImageURL], [s].[Name], [s].[UpdatedAt]
    FROM [Services] AS [s]
    WHERE [s].[ServiceId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [b].[BranchId], [b].[ServiceId], [b0].[BranchId] AS [BranchId0], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [BranchServices] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
) AS [t0] ON [t].[ServiceId] = [t0].[ServiceId]
ORDER BY [t].[ServiceId], [t0].[BranchId], [t0].[ServiceId]
2025-11-24 01:55:56.126 +02:00 [INF] Executed DbCommand (20ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[ServiceId], [t].[CreatedAt], [t].[Description], [t].[ImageURL], [t].[Name], [t].[UpdatedAt], [t0].[BranchId], [t0].[ServiceId], [t0].[BranchId0], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt]
FROM (
    SELECT TOP(1) [s].[ServiceId], [s].[CreatedAt], [s].[Description], [s].[ImageURL], [s].[Name], [s].[UpdatedAt]
    FROM [Services] AS [s]
    WHERE [s].[ServiceId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [b].[BranchId], [b].[ServiceId], [b0].[BranchId] AS [BranchId0], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [BranchServices] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
) AS [t0] ON [t].[ServiceId] = [t0].[ServiceId]
ORDER BY [t].[ServiceId], [t0].[BranchId], [t0].[ServiceId]
2025-11-24 01:55:56.139 +02:00 [DBG] Context 'AppDbContext' started tracking 'Service' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:55:56.141 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchService' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:55:56.144 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:55:56.145 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchService' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:55:56.146 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:55:56.148 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:55:56.152 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 13ms reading results.
2025-11-24 01:55:56.154 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:55:56.155 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 01:55:56.156 +02:00 [INF] Service with ID 1 retrieved successfully
2025-11-24 01:55:56.157 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:55:56.159 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:55:56.160 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:55:56.160 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:55:56.161 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 01:55:56.161 +02:00 [INF] Executing OkObjectResult, writing value of type 'Hospital.Application.DTO.ServiceDTOS.ServiceDto'.
2025-11-24 01:55:56.162 +02:00 [INF] Executed action Hospital.Controllers.ServicesController.GetById (Hospital) in 89.7939ms
2025-11-24 01:55:56.165 +02:00 [INF] Executed endpoint 'Hospital.Controllers.ServicesController.GetById (Hospital)'
2025-11-24 01:55:56.165 +02:00 [DBG] Connection id "0HNHATCCAV4K5" completed keep alive response.
2025-11-24 01:55:56.166 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:55:56.167 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:55:56.169 +02:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-11-24 01:55:56.170 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Services/1 - 200 null application/json; charset=utf-8 136.2596ms
2025-11-24 01:56:02.409 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Services - null null
2025-11-24 01:56:02.413 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Services'
2025-11-24 01:56:02.416 +02:00 [DBG] Endpoint 'Hospital.Controllers.ServicesController.GetAll (Hospital)' with route pattern 'api/Services' is valid for the request path '/api/Services'
2025-11-24 01:56:02.419 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.ServicesController.GetAll (Hospital)'
2025-11-24 01:56:02.424 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:56:02.427 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:56:02.430 +02:00 [INF] Executing endpoint 'Hospital.Controllers.ServicesController.GetAll (Hospital)'
2025-11-24 01:56:02.434 +02:00 [INF] Route matched with {action = "GetAll", controller = "Services"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll() on controller Hospital.Controllers.ServicesController (Hospital).
2025-11-24 01:56:02.439 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:56:02.446 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:56:02.452 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:56:02.456 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:56:02.460 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:56:02.463 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.ServicesController (Hospital)
2025-11-24 01:56:02.468 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.ServicesController (Hospital)
2025-11-24 01:56:02.473 +02:00 [INF] get all services called at "2025-11-24T01:56:02.4735246+02:00"
2025-11-24 01:56:02.476 +02:00 [INF] Fetching all services
2025-11-24 01:56:02.478 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:56:02.481 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:56:02.482 +02:00 [DBG] Created DbConnection. (1ms).
2025-11-24 01:56:02.483 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:56:02.486 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:56:02.488 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:56:02.490 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:56:02.491 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:56:02.492 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ServiceId], [s].[CreatedAt], [s].[Description], [s].[ImageURL], [s].[Name], [s].[UpdatedAt], [t].[BranchId], [t].[ServiceId], [t].[BranchId0], [t].[Address], [t].[BranchName], [t].[CreatedAt], [t].[Description], [t].[Email], [t].[ImageURL], [t].[Phone], [t].[UpdatedAt]
FROM [Services] AS [s]
LEFT JOIN (
    SELECT [b].[BranchId], [b].[ServiceId], [b0].[BranchId] AS [BranchId0], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [BranchServices] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
) AS [t] ON [s].[ServiceId] = [t].[ServiceId]
ORDER BY [s].[ServiceId], [t].[BranchId], [t].[ServiceId]
2025-11-24 01:56:02.506 +02:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ServiceId], [s].[CreatedAt], [s].[Description], [s].[ImageURL], [s].[Name], [s].[UpdatedAt], [t].[BranchId], [t].[ServiceId], [t].[BranchId0], [t].[Address], [t].[BranchName], [t].[CreatedAt], [t].[Description], [t].[Email], [t].[ImageURL], [t].[Phone], [t].[UpdatedAt]
FROM [Services] AS [s]
LEFT JOIN (
    SELECT [b].[BranchId], [b].[ServiceId], [b0].[BranchId] AS [BranchId0], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [BranchServices] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
) AS [t] ON [s].[ServiceId] = [t].[ServiceId]
ORDER BY [s].[ServiceId], [t].[BranchId], [t].[ServiceId]
2025-11-24 01:56:02.509 +02:00 [DBG] Context 'AppDbContext' started tracking 'Service' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:56:02.511 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchService' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:56:02.513 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:56:02.515 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchService' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:56:02.516 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:56:02.517 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:56:02.517 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 7ms reading results.
2025-11-24 01:56:02.518 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:56:02.518 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:56:02.519 +02:00 [INF] 1 services retrieved
2025-11-24 01:56:02.520 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:56:02.522 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:56:02.523 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:56:02.525 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:56:02.526 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 01:56:02.527 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.ServiceDTOS.ServiceDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 01:56:02.529 +02:00 [INF] Executed action Hospital.Controllers.ServicesController.GetAll (Hospital) in 65.8757ms
2025-11-24 01:56:02.533 +02:00 [INF] Executed endpoint 'Hospital.Controllers.ServicesController.GetAll (Hospital)'
2025-11-24 01:56:02.535 +02:00 [DBG] Connection id "0HNHATCCAV4K5" completed keep alive response.
2025-11-24 01:56:02.538 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:56:02.541 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:56:02.545 +02:00 [DBG] Disposed connection to database '' on server '' (4ms).
2025-11-24 01:56:02.548 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Services - 200 null application/json; charset=utf-8 139.0985ms
2025-11-24 01:56:10.214 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Services - application/json 191
2025-11-24 01:56:10.216 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Services'
2025-11-24 01:56:10.220 +02:00 [DBG] Endpoint 'Hospital.Controllers.ServicesController.Create (Hospital)' with route pattern 'api/Services' is valid for the request path '/api/Services'
2025-11-24 01:56:10.222 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.ServicesController.Create (Hospital)'
2025-11-24 01:56:10.224 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:56:10.227 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:56:10.231 +02:00 [INF] Executing endpoint 'Hospital.Controllers.ServicesController.Create (Hospital)'
2025-11-24 01:56:10.234 +02:00 [INF] Route matched with {action = "Create", controller = "Services"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Create(Hospital.Application.DTO.ServiceDTOS.CreateServiceDto) on controller Hospital.Controllers.ServicesController (Hospital).
2025-11-24 01:56:10.237 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:56:10.238 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:56:10.240 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:56:10.243 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:56:10.246 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:56:10.247 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.ServicesController (Hospital)
2025-11-24 01:56:10.249 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.ServicesController (Hospital)
2025-11-24 01:56:10.251 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.ServiceDTOS.CreateServiceDto' ...
2025-11-24 01:56:10.253 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.ServiceDTOS.CreateServiceDto' using the name '' in request data ...
2025-11-24 01:56:10.254 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 01:56:10.255 +02:00 [DBG] Connection id "0HNHATCCAV4K5", Request id "0HNHATCCAV4K5:0000000C": started reading request body.
2025-11-24 01:56:10.255 +02:00 [DBG] Connection id "0HNHATCCAV4K5", Request id "0HNHATCCAV4K5:0000000C": done reading request body.
2025-11-24 01:56:10.256 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.ServiceDTOS.CreateServiceDto'
2025-11-24 01:56:10.256 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.ServiceDTOS.CreateServiceDto'.
2025-11-24 01:56:10.257 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.ServiceDTOS.CreateServiceDto'.
2025-11-24 01:56:10.258 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.ServiceDTOS.CreateServiceDto' ...
2025-11-24 01:56:10.258 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.ServiceDTOS.CreateServiceDto'.
2025-11-24 01:56:10.260 +02:00 [INF] create services called at "2025-11-24T01:56:10.2601856+02:00"
2025-11-24 01:56:10.260 +02:00 [INF] Creating service with Name: mri 4
2025-11-24 01:56:10.261 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:56:10.263 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:56:10.264 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 01:56:10.264 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:56:10.266 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:56:10.267 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:56:10.269 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:56:10.270 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-11-24 01:56:10.271 +02:00 [DBG] Executing DbCommand [Parameters=[@__ids_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__ids_0) WITH ([value] int '$') AS [i]
)
2025-11-24 01:56:10.280 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[@__ids_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__ids_0) WITH ([value] int '$') AS [i]
)
2025-11-24 01:56:10.281 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:56:10.282 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:56:10.283 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:56:10.284 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 3ms reading results.
2025-11-24 01:56:10.285 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:56:10.287 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (2ms).
2025-11-24 01:56:10.289 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:56:10.292 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:56:10.295 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:56:10.297 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:56:10.297 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:56:10.298 +02:00 [DBG] Executing DbCommand [Parameters=[@__ToLower_0='?' (Size = 120), @__branchIds_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Services] AS [s]
        WHERE LOWER([s].[Name]) = @__ToLower_0 AND EXISTS (
            SELECT 1
            FROM [BranchServices] AS [b]
            INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
            WHERE [s].[ServiceId] = [b].[ServiceId] AND [b0].[BranchId] IN (
                SELECT [b1].[value]
                FROM OPENJSON(@__branchIds_1) WITH ([value] int '$') AS [b1]
            ))) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-24 01:56:10.327 +02:00 [INF] Executed DbCommand (29ms) [Parameters=[@__ToLower_0='?' (Size = 120), @__branchIds_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Services] AS [s]
        WHERE LOWER([s].[Name]) = @__ToLower_0 AND EXISTS (
            SELECT 1
            FROM [BranchServices] AS [b]
            INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
            WHERE [s].[ServiceId] = [b].[ServiceId] AND [b0].[BranchId] IN (
                SELECT [b1].[value]
                FROM OPENJSON(@__branchIds_1) WITH ([value] int '$') AS [b1]
            ))) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-24 01:56:10.332 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:56:10.334 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 2ms reading results.
2025-11-24 01:56:10.337 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:56:10.339 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (2ms).
2025-11-24 01:56:10.341 +02:00 [WRN] Service 'mri 4' already exists in one or more selected branches
2025-11-24 01:56:10.394 +02:00 [INF] Executed action Hospital.Controllers.ServicesController.Create (Hospital) in 146.7587ms
2025-11-24 01:56:10.396 +02:00 [INF] Executed endpoint 'Hospital.Controllers.ServicesController.Create (Hospital)'
2025-11-24 01:56:10.465 +02:00 [ERR]  Exception caught: Service 'mri 4' already exists in one or more of the selected branches.
System.ArgumentException: Service 'mri 4' already exists in one or more of the selected branches.
   at Hospital.Infrastructure.Services.ServiceService.CreateAsync(CreateServiceDto dto) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\ServiceService.cs:line 74
   at Hospital.Controllers.ServicesController.Create(CreateServiceDto dto) in D:\Walaa\GP\Hospital\Hospital\Controllers\ServicesController.cs:line 54
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
2025-11-24 01:56:10.512 +02:00 [DBG] Connection id "0HNHATCCAV4K5" completed keep alive response.
2025-11-24 01:56:10.519 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:56:10.522 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:56:10.527 +02:00 [DBG] Disposed connection to database '' on server '' (4ms).
2025-11-24 01:56:10.530 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Services - 400 null application/json 315.8566ms
2025-11-24 01:56:17.569 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Services - application/json 192
2025-11-24 01:56:17.579 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Services'
2025-11-24 01:56:17.585 +02:00 [DBG] Endpoint 'Hospital.Controllers.ServicesController.Create (Hospital)' with route pattern 'api/Services' is valid for the request path '/api/Services'
2025-11-24 01:56:17.587 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.ServicesController.Create (Hospital)'
2025-11-24 01:56:17.588 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:56:17.588 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:56:17.589 +02:00 [INF] Executing endpoint 'Hospital.Controllers.ServicesController.Create (Hospital)'
2025-11-24 01:56:17.591 +02:00 [INF] Route matched with {action = "Create", controller = "Services"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Create(Hospital.Application.DTO.ServiceDTOS.CreateServiceDto) on controller Hospital.Controllers.ServicesController (Hospital).
2025-11-24 01:56:17.596 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:56:17.597 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:56:17.598 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:56:17.599 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:56:17.600 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:56:17.602 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.ServicesController (Hospital)
2025-11-24 01:56:17.605 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.ServicesController (Hospital)
2025-11-24 01:56:17.606 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.ServiceDTOS.CreateServiceDto' ...
2025-11-24 01:56:17.608 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.ServiceDTOS.CreateServiceDto' using the name '' in request data ...
2025-11-24 01:56:17.609 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 01:56:17.610 +02:00 [DBG] Connection id "0HNHATCCAV4K5", Request id "0HNHATCCAV4K5:0000000D": started reading request body.
2025-11-24 01:56:17.611 +02:00 [DBG] Connection id "0HNHATCCAV4K5", Request id "0HNHATCCAV4K5:0000000D": done reading request body.
2025-11-24 01:56:17.612 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.ServiceDTOS.CreateServiceDto'
2025-11-24 01:56:17.613 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.ServiceDTOS.CreateServiceDto'.
2025-11-24 01:56:17.614 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.ServiceDTOS.CreateServiceDto'.
2025-11-24 01:56:17.615 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.ServiceDTOS.CreateServiceDto' ...
2025-11-24 01:56:17.616 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.ServiceDTOS.CreateServiceDto'.
2025-11-24 01:56:17.616 +02:00 [INF] create services called at "2025-11-24T01:56:17.6167770+02:00"
2025-11-24 01:56:17.617 +02:00 [INF] Creating service with Name: mri 43
2025-11-24 01:56:17.618 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:56:17.621 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:56:17.621 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 01:56:17.622 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:56:17.624 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:56:17.625 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:56:17.626 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:56:17.627 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:56:17.627 +02:00 [DBG] Executing DbCommand [Parameters=[@__ids_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__ids_0) WITH ([value] int '$') AS [i]
)
2025-11-24 01:56:17.632 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__ids_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__ids_0) WITH ([value] int '$') AS [i]
)
2025-11-24 01:56:17.643 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:56:17.645 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:56:17.646 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:56:17.647 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 4ms reading results.
2025-11-24 01:56:17.647 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:56:17.648 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:56:17.649 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:56:17.650 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:56:17.650 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:56:17.651 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:56:17.652 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:56:17.653 +02:00 [DBG] Executing DbCommand [Parameters=[@__ToLower_0='?' (Size = 120), @__branchIds_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Services] AS [s]
        WHERE LOWER([s].[Name]) = @__ToLower_0 AND EXISTS (
            SELECT 1
            FROM [BranchServices] AS [b]
            INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
            WHERE [s].[ServiceId] = [b].[ServiceId] AND [b0].[BranchId] IN (
                SELECT [b1].[value]
                FROM OPENJSON(@__branchIds_1) WITH ([value] int '$') AS [b1]
            ))) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-24 01:56:17.656 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__ToLower_0='?' (Size = 120), @__branchIds_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Services] AS [s]
        WHERE LOWER([s].[Name]) = @__ToLower_0 AND EXISTS (
            SELECT 1
            FROM [BranchServices] AS [b]
            INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
            WHERE [s].[ServiceId] = [b].[ServiceId] AND [b0].[BranchId] IN (
                SELECT [b1].[value]
                FROM OPENJSON(@__branchIds_1) WITH ([value] int '$') AS [b1]
            ))) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-24 01:56:17.659 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:56:17.660 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 01:56:17.662 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:56:17.663 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:56:17.665 +02:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Service.ServiceId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:56:17.668 +02:00 [DBG] Context 'AppDbContext' started tracking 'Service' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:56:17.670 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchService' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:56:17.671 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchService' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:56:17.672 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:56:17.673 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:56:17.674 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 01:56:17.675 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:56:17.675 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:56:17.676 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:56:17.677 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:56:17.678 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 01:56:17.678 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 01:56:17.679 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:56:17.679 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:56:17.680 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:56:17.681 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (Size = 300), @p3='?' (Size = 120), @p4='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Services] ([CreatedAt], [Description], [ImageURL], [Name], [UpdatedAt])
OUTPUT INSERTED.[ServiceId]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-11-24 01:56:17.684 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (Size = 300), @p3='?' (Size = 120), @p4='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Services] ([CreatedAt], [Description], [ImageURL], [Name], [UpdatedAt])
OUTPUT INSERTED.[ServiceId]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-11-24 01:56:17.686 +02:00 [DBG] The foreign key property 'Service.ServiceId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 01:56:17.687 +02:00 [DBG] The foreign key property 'BranchService.ServiceId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 01:56:17.688 +02:00 [DBG] The foreign key property 'BranchService.ServiceId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 01:56:17.688 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:56:17.689 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 3ms reading results.
2025-11-24 01:56:17.690 +02:00 [DBG] Executing 2 update commands as a batch.
2025-11-24 01:56:17.690 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:56:17.691 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:56:17.691 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:56:17.692 +02:00 [DBG] Executing DbCommand [Parameters=[@p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [BranchServices] ([BranchId], [ServiceId])
VALUES (@p5, @p6),
(@p7, @p8);
2025-11-24 01:56:17.698 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [BranchServices] ([BranchId], [ServiceId])
VALUES (@p5, @p6),
(@p7, @p8);
2025-11-24 01:56:17.700 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:56:17.701 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 01:56:17.702 +02:00 [DBG] Committing transaction.
2025-11-24 01:56:17.709 +02:00 [DBG] Committed transaction.
2025-11-24 01:56:17.710 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:56:17.710 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:56:17.711 +02:00 [DBG] Disposing transaction.
2025-11-24 01:56:17.712 +02:00 [DBG] An entity of type 'Service' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:56:17.713 +02:00 [DBG] An entity of type 'BranchService' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:56:17.714 +02:00 [DBG] An entity of type 'BranchService' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:56:17.718 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 3 entities written to the database.
2025-11-24 01:56:17.719 +02:00 [INF] Service 'mri 43' created successfully
2025-11-24 01:56:17.720 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:56:17.722 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:56:17.723 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:56:17.724 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:56:17.724 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 01:56:17.726 +02:00 [INF] Executing CreatedAtActionResult, writing value of type 'Hospital.Application.DTO.ServiceDTOS.ServiceDto'.
2025-11-24 01:56:17.728 +02:00 [DBG] Found the endpoints ["Hospital.Controllers.ServicesController.GetById (Hospital)"] for address (id=[2],action=[GetById],controller=[Services])
2025-11-24 01:56:17.729 +02:00 [DBG] Successfully processed template api/Services/{id} for Hospital.Controllers.ServicesController.GetById (Hospital) resulting in /api/Services/2 and 
2025-11-24 01:56:17.731 +02:00 [DBG] Link generation succeeded for endpoints ["Hospital.Controllers.ServicesController.GetById (Hospital)"] with result /api/Services/2
2025-11-24 01:56:17.732 +02:00 [INF] Executed action Hospital.Controllers.ServicesController.Create (Hospital) in 130.312ms
2025-11-24 01:56:17.733 +02:00 [INF] Executed endpoint 'Hospital.Controllers.ServicesController.Create (Hospital)'
2025-11-24 01:56:17.734 +02:00 [DBG] Connection id "0HNHATCCAV4K5" completed keep alive response.
2025-11-24 01:56:17.735 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:56:17.736 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:56:17.737 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 01:56:17.737 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Services - 201 null application/json; charset=utf-8 167.9762ms
2025-11-24 01:56:23.023 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Services - null null
2025-11-24 01:56:23.031 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Services'
2025-11-24 01:56:23.034 +02:00 [DBG] Endpoint 'Hospital.Controllers.ServicesController.GetAll (Hospital)' with route pattern 'api/Services' is valid for the request path '/api/Services'
2025-11-24 01:56:23.039 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.ServicesController.GetAll (Hospital)'
2025-11-24 01:56:23.039 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:56:23.044 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:56:23.045 +02:00 [INF] Executing endpoint 'Hospital.Controllers.ServicesController.GetAll (Hospital)'
2025-11-24 01:56:23.047 +02:00 [INF] Route matched with {action = "GetAll", controller = "Services"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll() on controller Hospital.Controllers.ServicesController (Hospital).
2025-11-24 01:56:23.049 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:56:23.049 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:56:23.050 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:56:23.053 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:56:23.055 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:56:23.057 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.ServicesController (Hospital)
2025-11-24 01:56:23.058 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.ServicesController (Hospital)
2025-11-24 01:56:23.060 +02:00 [INF] get all services called at "2025-11-24T01:56:23.0608686+02:00"
2025-11-24 01:56:23.061 +02:00 [INF] Fetching all services
2025-11-24 01:56:23.064 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:56:23.066 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:56:23.068 +02:00 [DBG] Created DbConnection. (1ms).
2025-11-24 01:56:23.069 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:56:23.070 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:56:23.070 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:56:23.071 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:56:23.071 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:56:23.072 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ServiceId], [s].[CreatedAt], [s].[Description], [s].[ImageURL], [s].[Name], [s].[UpdatedAt], [t].[BranchId], [t].[ServiceId], [t].[BranchId0], [t].[Address], [t].[BranchName], [t].[CreatedAt], [t].[Description], [t].[Email], [t].[ImageURL], [t].[Phone], [t].[UpdatedAt]
FROM [Services] AS [s]
LEFT JOIN (
    SELECT [b].[BranchId], [b].[ServiceId], [b0].[BranchId] AS [BranchId0], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [BranchServices] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
) AS [t] ON [s].[ServiceId] = [t].[ServiceId]
ORDER BY [s].[ServiceId], [t].[BranchId], [t].[ServiceId]
2025-11-24 01:56:23.080 +02:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ServiceId], [s].[CreatedAt], [s].[Description], [s].[ImageURL], [s].[Name], [s].[UpdatedAt], [t].[BranchId], [t].[ServiceId], [t].[BranchId0], [t].[Address], [t].[BranchName], [t].[CreatedAt], [t].[Description], [t].[Email], [t].[ImageURL], [t].[Phone], [t].[UpdatedAt]
FROM [Services] AS [s]
LEFT JOIN (
    SELECT [b].[BranchId], [b].[ServiceId], [b0].[BranchId] AS [BranchId0], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [BranchServices] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
) AS [t] ON [s].[ServiceId] = [t].[ServiceId]
ORDER BY [s].[ServiceId], [t].[BranchId], [t].[ServiceId]
2025-11-24 01:56:23.081 +02:00 [DBG] Context 'AppDbContext' started tracking 'Service' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:56:23.082 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchService' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:56:23.083 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:56:23.084 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchService' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:56:23.086 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:56:23.087 +02:00 [DBG] Context 'AppDbContext' started tracking 'Service' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:56:23.088 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchService' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:56:23.089 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchService' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:56:23.090 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:56:23.090 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 9ms reading results.
2025-11-24 01:56:23.091 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:56:23.091 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:56:23.093 +02:00 [INF] 2 services retrieved
2025-11-24 01:56:23.093 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:56:23.095 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:56:23.095 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:56:23.096 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:56:23.096 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 01:56:23.097 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.ServiceDTOS.ServiceDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 01:56:23.098 +02:00 [INF] Executed action Hospital.Controllers.ServicesController.GetAll (Hospital) in 41.2687ms
2025-11-24 01:56:23.099 +02:00 [INF] Executed endpoint 'Hospital.Controllers.ServicesController.GetAll (Hospital)'
2025-11-24 01:56:23.100 +02:00 [DBG] Connection id "0HNHATCCAV4K5" completed keep alive response.
2025-11-24 01:56:23.102 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:56:23.104 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:56:23.105 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 01:56:23.106 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Services - 200 null application/json; charset=utf-8 82.5833ms
2025-11-24 01:57:45.408 +02:00 [DBG] Connection id "0HNHATCCAV4K6" accepted.
2025-11-24 01:57:45.411 +02:00 [DBG] Connection id "0HNHATCCAV4K6" received FIN.
2025-11-24 01:57:45.416 +02:00 [DBG] Connection id "0HNHATCCAV4K6" started.
2025-11-24 01:57:45.424 +02:00 [DBG] Connection id "0HNHATCCAV4K7" accepted.
2025-11-24 01:57:45.437 +02:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-11-24 01:57:45.438 +02:00 [DBG] Connection id "0HNHATCCAV4K7" started.
2025-11-24 01:57:45.443 +02:00 [DBG] Connection id "0HNHATCCAV4K6" stopped.
2025-11-24 01:57:45.446 +02:00 [DBG] Connection id "0HNHATCCAV4K6" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-11-24 01:57:45.451 +02:00 [DBG] Connection 0HNHATCCAV4K7 established using the following protocol: "Tls12"
2025-11-24 01:57:45.454 +02:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7217/api/Services - application/json 195
2025-11-24 01:57:45.459 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Services'
2025-11-24 01:57:45.459 +02:00 [DBG] Endpoint 'Hospital.Controllers.ServicesController.Update (Hospital)' with route pattern 'api/Services' is valid for the request path '/api/Services'
2025-11-24 01:57:45.460 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.ServicesController.Update (Hospital)'
2025-11-24 01:57:45.461 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:57:45.465 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:57:45.465 +02:00 [INF] Executing endpoint 'Hospital.Controllers.ServicesController.Update (Hospital)'
2025-11-24 01:57:45.468 +02:00 [INF] Route matched with {action = "Update", controller = "Services"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Update(Hospital.Application.DTO.ServiceDTOS.UpdateServiceDto) on controller Hospital.Controllers.ServicesController (Hospital).
2025-11-24 01:57:45.469 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:57:45.470 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:57:45.471 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:57:45.475 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:57:45.475 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:57:45.476 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.ServicesController (Hospital)
2025-11-24 01:57:45.482 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.ServicesController (Hospital)
2025-11-24 01:57:45.485 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.ServiceDTOS.UpdateServiceDto' ...
2025-11-24 01:57:45.489 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.ServiceDTOS.UpdateServiceDto' using the name '' in request data ...
2025-11-24 01:57:45.490 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 01:57:45.495 +02:00 [DBG] Connection id "0HNHATCCAV4K7", Request id "0HNHATCCAV4K7:00000001": started reading request body.
2025-11-24 01:57:45.496 +02:00 [DBG] Connection id "0HNHATCCAV4K7", Request id "0HNHATCCAV4K7:00000001": done reading request body.
2025-11-24 01:57:45.500 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.ServiceDTOS.UpdateServiceDto'
2025-11-24 01:57:45.506 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.ServiceDTOS.UpdateServiceDto'.
2025-11-24 01:57:45.508 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.ServiceDTOS.UpdateServiceDto'.
2025-11-24 01:57:45.510 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.ServiceDTOS.UpdateServiceDto' ...
2025-11-24 01:57:45.518 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.ServiceDTOS.UpdateServiceDto'.
2025-11-24 01:57:45.521 +02:00 [INF] update services called at "2025-11-24T01:57:45.5209891+02:00"
2025-11-24 01:57:45.522 +02:00 [INF] Updating service with ID: 2
2025-11-24 01:57:45.525 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:57:45.528 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:57:45.528 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 01:57:45.529 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:57:45.533 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:57:45.535 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:57:45.537 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:57:45.540 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2025-11-24 01:57:45.541 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[ServiceId], [t].[CreatedAt], [t].[Description], [t].[ImageURL], [t].[Name], [t].[UpdatedAt], [t0].[BranchId], [t0].[ServiceId], [t0].[BranchId0], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt]
FROM (
    SELECT TOP(1) [s].[ServiceId], [s].[CreatedAt], [s].[Description], [s].[ImageURL], [s].[Name], [s].[UpdatedAt]
    FROM [Services] AS [s]
    WHERE [s].[ServiceId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [b].[BranchId], [b].[ServiceId], [b0].[BranchId] AS [BranchId0], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [BranchServices] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
) AS [t0] ON [t].[ServiceId] = [t0].[ServiceId]
ORDER BY [t].[ServiceId], [t0].[BranchId], [t0].[ServiceId]
2025-11-24 01:57:45.554 +02:00 [INF] Executed DbCommand (13ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[ServiceId], [t].[CreatedAt], [t].[Description], [t].[ImageURL], [t].[Name], [t].[UpdatedAt], [t0].[BranchId], [t0].[ServiceId], [t0].[BranchId0], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt]
FROM (
    SELECT TOP(1) [s].[ServiceId], [s].[CreatedAt], [s].[Description], [s].[ImageURL], [s].[Name], [s].[UpdatedAt]
    FROM [Services] AS [s]
    WHERE [s].[ServiceId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [b].[BranchId], [b].[ServiceId], [b0].[BranchId] AS [BranchId0], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [BranchServices] AS [b]
    INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
) AS [t0] ON [t].[ServiceId] = [t0].[ServiceId]
ORDER BY [t].[ServiceId], [t0].[BranchId], [t0].[ServiceId]
2025-11-24 01:57:45.560 +02:00 [DBG] Context 'AppDbContext' started tracking 'Service' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:57:45.561 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchService' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:57:45.564 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:57:45.566 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchService' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:57:45.569 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:57:45.575 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:57:45.576 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 16ms reading results.
2025-11-24 01:57:45.577 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:57:45.577 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:57:45.579 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:57:45.582 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:57:45.583 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:57:45.584 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:57:45.585 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:57:45.586 +02:00 [DBG] Executing DbCommand [Parameters=[@__ids_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__ids_0) WITH ([value] int '$') AS [i]
)
2025-11-24 01:57:45.594 +02:00 [INF] Executed DbCommand (8ms) [Parameters=[@__ids_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__ids_0) WITH ([value] int '$') AS [i]
)
2025-11-24 01:57:45.597 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:57:45.598 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 01:57:45.599 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:57:45.599 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:57:45.601 +02:00 [DBG] An entity of type 'Service' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:57:45.603 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:57:45.607 +02:00 [DBG] 0 entities were added and 1 entities were removed from skip navigation 'Service.Branches'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:57:45.611 +02:00 [DBG] An entity of type 'BranchService' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Deleted"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:57:45.614 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:57:45.615 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 01:57:45.616 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:57:45.616 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:57:45.626 +02:00 [DBG] Executing 2 update commands as a batch.
2025-11-24 01:57:45.627 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:57:45.628 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:57:45.628 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 01:57:45.629 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 01:57:45.630 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:57:45.631 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:57:45.631 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:57:45.632 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p7='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 300), @p5='?' (Size = 120), @p6='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
DELETE FROM [BranchServices]
OUTPUT 1
WHERE [BranchId] = @p0 AND [ServiceId] = @p1;
UPDATE [Services] SET [CreatedAt] = @p2, [Description] = @p3, [ImageURL] = @p4, [Name] = @p5, [UpdatedAt] = @p6
OUTPUT 1
WHERE [ServiceId] = @p7;
2025-11-24 01:57:45.645 +02:00 [INF] Executed DbCommand (13ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p7='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 300), @p5='?' (Size = 120), @p6='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
DELETE FROM [BranchServices]
OUTPUT 1
WHERE [BranchId] = @p0 AND [ServiceId] = @p1;
UPDATE [Services] SET [CreatedAt] = @p2, [Description] = @p3, [ImageURL] = @p4, [Name] = @p5, [UpdatedAt] = @p6
OUTPUT 1
WHERE [ServiceId] = @p7;
2025-11-24 01:57:45.649 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:57:45.650 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 01:57:45.652 +02:00 [DBG] Committing transaction.
2025-11-24 01:57:45.654 +02:00 [DBG] Committed transaction.
2025-11-24 01:57:45.655 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:57:45.655 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:57:45.656 +02:00 [DBG] Disposing transaction.
2025-11-24 01:57:45.658 +02:00 [DBG] An entity of type 'Service' tracked by 'AppDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:57:45.665 +02:00 [DBG] An entity of type 'BranchService' tracked by 'AppDbContext' changed state from '"Deleted"' to '"Detached"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:57:45.666 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 2 entities written to the database.
2025-11-24 01:57:45.668 +02:00 [INF] Service with ID 2 updated successfully
2025-11-24 01:57:45.669 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:57:45.670 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:57:45.671 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:57:45.671 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:57:45.672 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter' and content type 'text/plain' to write the response.
2025-11-24 01:57:45.674 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.String'.
2025-11-24 01:57:45.675 +02:00 [INF] Executed action Hospital.Controllers.ServicesController.Update (Hospital) in 198.5608ms
2025-11-24 01:57:45.676 +02:00 [INF] Executed endpoint 'Hospital.Controllers.ServicesController.Update (Hospital)'
2025-11-24 01:57:45.677 +02:00 [DBG] Connection id "0HNHATCCAV4K7" completed keep alive response.
2025-11-24 01:57:45.678 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:57:45.678 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:57:45.679 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 01:57:45.680 +02:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7217/api/Services - 200 null text/plain; charset=utf-8 225.8159ms
2025-11-24 01:58:47.990 +02:00 [DBG] Connection id "0HNHATCCAV4K8" received FIN.
2025-11-24 01:58:47.999 +02:00 [DBG] Connection id "0HNHATCCAV4K8" accepted.
2025-11-24 01:58:48.000 +02:00 [DBG] Connection id "0HNHATCCAV4K8" started.
2025-11-24 01:58:48.007 +02:00 [DBG] Connection id "0HNHATCCAV4K9" accepted.
2025-11-24 01:58:48.014 +02:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-11-24 01:58:48.016 +02:00 [DBG] Connection id "0HNHATCCAV4K9" started.
2025-11-24 01:58:48.022 +02:00 [DBG] Connection id "0HNHATCCAV4K8" stopped.
2025-11-24 01:58:48.029 +02:00 [DBG] Connection id "0HNHATCCAV4K8" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-11-24 01:58:48.036 +02:00 [DBG] Connection 0HNHATCCAV4K9 established using the following protocol: "Tls12"
2025-11-24 01:58:48.040 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Services/add-services-from-excel - multipart/form-data; boundary=--------------------------561689441938714939081580 10365
2025-11-24 01:58:48.046 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Services/add-services-from-excel'
2025-11-24 01:58:48.048 +02:00 [DBG] Endpoint 'Hospital.Controllers.ServicesController.AddServicesFromExcel (Hospital)' with route pattern 'api/Services/add-services-from-excel' is valid for the request path '/api/Services/add-services-from-excel'
2025-11-24 01:58:48.056 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.ServicesController.AddServicesFromExcel (Hospital)'
2025-11-24 01:58:48.061 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:58:48.063 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:58:48.064 +02:00 [INF] Executing endpoint 'Hospital.Controllers.ServicesController.AddServicesFromExcel (Hospital)'
2025-11-24 01:58:48.067 +02:00 [INF] Route matched with {action = "AddServicesFromExcel", controller = "Services"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddServicesFromExcel(Microsoft.AspNetCore.Http.IFormFile) on controller Hospital.Controllers.ServicesController (Hospital).
2025-11-24 01:58:48.070 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:58:48.071 +02:00 [DBG] Execution plan of resource filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-11-24 01:58:48.073 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:58:48.076 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:58:48.077 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:58:48.079 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.ServicesController (Hospital)
2025-11-24 01:58:48.080 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.ServicesController (Hospital)
2025-11-24 01:58:48.081 +02:00 [DBG] Connection id "0HNHATCCAV4K9", Request id "0HNHATCCAV4K9:00000001": started reading request body.
2025-11-24 01:58:48.082 +02:00 [DBG] Connection id "0HNHATCCAV4K9", Request id "0HNHATCCAV4K9:00000001": done reading request body.
2025-11-24 01:58:48.083 +02:00 [DBG] Attempting to bind parameter 'file' of type 'Microsoft.AspNetCore.Http.IFormFile' ...
2025-11-24 01:58:48.085 +02:00 [DBG] Attempting to bind parameter 'file' of type 'Microsoft.AspNetCore.Http.IFormFile' using the name 'file' in request data ...
2025-11-24 01:58:48.086 +02:00 [DBG] Done attempting to bind parameter 'file' of type 'Microsoft.AspNetCore.Http.IFormFile'.
2025-11-24 01:58:48.087 +02:00 [DBG] Done attempting to bind parameter 'file' of type 'Microsoft.AspNetCore.Http.IFormFile'.
2025-11-24 01:58:48.087 +02:00 [DBG] Attempting to validate the bound parameter 'file' of type 'Microsoft.AspNetCore.Http.IFormFile' ...
2025-11-24 01:58:48.088 +02:00 [DBG] Done attempting to validate the bound parameter 'file' of type 'Microsoft.AspNetCore.Http.IFormFile'.
2025-11-24 01:58:48.093 +02:00 [INF] all services by excel sheet services called at "2025-11-24T01:58:48.0933556+02:00"
2025-11-24 01:58:48.849 +02:00 [INF] Creating service with Name: General Checkup
2025-11-24 01:58:48.851 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:58:48.856 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:58:48.859 +02:00 [DBG] Created DbConnection. (3ms).
2025-11-24 01:58:48.862 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:58:48.866 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:58:48.868 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:58:48.869 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:58:48.880 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (11ms).
2025-11-24 01:58:48.888 +02:00 [DBG] Executing DbCommand [Parameters=[@__ids_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__ids_0) WITH ([value] int '$') AS [i]
)
2025-11-24 01:58:48.908 +02:00 [INF] Executed DbCommand (20ms) [Parameters=[@__ids_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__ids_0) WITH ([value] int '$') AS [i]
)
2025-11-24 01:58:48.914 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:58:48.923 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:58:48.935 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 21ms reading results.
2025-11-24 01:58:48.938 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:58:48.940 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 01:58:48.940 +02:00 [WRN] One or more branches do not exist for the new service
2025-11-24 01:58:49.007 +02:00 [INF] Creating service with Name: Blood Test
2025-11-24 01:58:49.009 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:58:49.013 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:58:49.019 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:58:49.022 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2025-11-24 01:58:49.024 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2025-11-24 01:58:49.025 +02:00 [DBG] Executing DbCommand [Parameters=[@__ids_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__ids_0) WITH ([value] int '$') AS [i]
)
2025-11-24 01:58:49.028 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__ids_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__ids_0) WITH ([value] int '$') AS [i]
)
2025-11-24 01:58:49.031 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:58:49.032 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 01:58:49.035 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:58:49.037 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 01:58:49.039 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:58:49.040 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:58:49.041 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:58:49.042 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:58:49.045 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-11-24 01:58:49.046 +02:00 [DBG] Executing DbCommand [Parameters=[@__ToLower_0='?' (Size = 120), @__branchIds_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Services] AS [s]
        WHERE LOWER([s].[Name]) = @__ToLower_0 AND EXISTS (
            SELECT 1
            FROM [BranchServices] AS [b]
            INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
            WHERE [s].[ServiceId] = [b].[ServiceId] AND [b0].[BranchId] IN (
                SELECT [b1].[value]
                FROM OPENJSON(@__branchIds_1) WITH ([value] int '$') AS [b1]
            ))) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-24 01:58:49.069 +02:00 [INF] Executed DbCommand (23ms) [Parameters=[@__ToLower_0='?' (Size = 120), @__branchIds_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Services] AS [s]
        WHERE LOWER([s].[Name]) = @__ToLower_0 AND EXISTS (
            SELECT 1
            FROM [BranchServices] AS [b]
            INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
            WHERE [s].[ServiceId] = [b].[ServiceId] AND [b0].[BranchId] IN (
                SELECT [b1].[value]
                FROM OPENJSON(@__branchIds_1) WITH ([value] int '$') AS [b1]
            ))) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-24 01:58:49.075 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:58:49.077 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 2ms reading results.
2025-11-24 01:58:49.081 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:58:49.086 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (4ms).
2025-11-24 01:58:49.088 +02:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Service.ServiceId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:58:49.088 +02:00 [DBG] Context 'AppDbContext' started tracking 'Service' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:58:49.089 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchService' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:58:49.090 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:58:49.091 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:58:49.093 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 01:58:49.095 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:58:49.097 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:58:49.098 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:58:49.099 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:58:49.100 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 01:58:49.101 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 01:58:49.104 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:58:49.105 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:58:49.107 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:58:49.108 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (Size = 300), @p3='?' (Size = 120), @p4='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Services] ([CreatedAt], [Description], [ImageURL], [Name], [UpdatedAt])
OUTPUT INSERTED.[ServiceId]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-11-24 01:58:49.115 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (Size = 300), @p3='?' (Size = 120), @p4='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Services] ([CreatedAt], [Description], [ImageURL], [Name], [UpdatedAt])
OUTPUT INSERTED.[ServiceId]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-11-24 01:58:49.117 +02:00 [DBG] The foreign key property 'Service.ServiceId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 01:58:49.118 +02:00 [DBG] The foreign key property 'BranchService.ServiceId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 01:58:49.120 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:58:49.121 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 4ms reading results.
2025-11-24 01:58:49.122 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:58:49.122 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:58:49.125 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-11-24 01:58:49.129 +02:00 [DBG] Executing DbCommand [Parameters=[@p5='?' (DbType = Int32), @p6='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [BranchServices] ([BranchId], [ServiceId])
VALUES (@p5, @p6);
2025-11-24 01:58:49.135 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@p5='?' (DbType = Int32), @p6='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [BranchServices] ([BranchId], [ServiceId])
VALUES (@p5, @p6);
2025-11-24 01:58:49.141 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:58:49.141 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 01:58:49.145 +02:00 [DBG] Committing transaction.
2025-11-24 01:58:49.147 +02:00 [DBG] Committed transaction.
2025-11-24 01:58:49.148 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:58:49.149 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 01:58:49.149 +02:00 [DBG] Disposing transaction.
2025-11-24 01:58:49.150 +02:00 [DBG] An entity of type 'Service' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:58:49.151 +02:00 [DBG] An entity of type 'BranchService' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:58:49.153 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 2 entities written to the database.
2025-11-24 01:58:49.155 +02:00 [INF] Service 'Blood Test' created successfully
2025-11-24 01:58:49.156 +02:00 [INF] Creating service with Name: X-Ray
2025-11-24 01:58:49.157 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:58:49.158 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:58:49.160 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:58:49.161 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:58:49.163 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-11-24 01:58:49.164 +02:00 [DBG] Executing DbCommand [Parameters=[@__ids_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__ids_0) WITH ([value] int '$') AS [i]
)
2025-11-24 01:58:49.167 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__ids_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__ids_0) WITH ([value] int '$') AS [i]
)
2025-11-24 01:58:49.172 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:58:49.173 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:58:49.175 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 3ms reading results.
2025-11-24 01:58:49.179 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:58:49.182 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (3ms).
2025-11-24 01:58:49.183 +02:00 [WRN] One or more branches do not exist for the new service
2025-11-24 01:58:49.229 +02:00 [INF] Creating service with Name: Physiotherapy
2025-11-24 01:58:49.235 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:58:49.239 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:58:49.241 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:58:49.243 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:58:49.248 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (6ms).
2025-11-24 01:58:49.250 +02:00 [DBG] Executing DbCommand [Parameters=[@__ids_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__ids_0) WITH ([value] int '$') AS [i]
)
2025-11-24 01:58:49.254 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__ids_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__ids_0) WITH ([value] int '$') AS [i]
)
2025-11-24 01:58:49.256 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:58:49.256 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 01:58:49.257 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:58:49.258 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:58:49.259 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:58:49.266 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:58:49.268 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:58:49.269 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:58:49.270 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:58:49.272 +02:00 [DBG] Executing DbCommand [Parameters=[@__ToLower_0='?' (Size = 120), @__branchIds_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Services] AS [s]
        WHERE LOWER([s].[Name]) = @__ToLower_0 AND EXISTS (
            SELECT 1
            FROM [BranchServices] AS [b]
            INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
            WHERE [s].[ServiceId] = [b].[ServiceId] AND [b0].[BranchId] IN (
                SELECT [b1].[value]
                FROM OPENJSON(@__branchIds_1) WITH ([value] int '$') AS [b1]
            ))) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-24 01:58:49.276 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__ToLower_0='?' (Size = 120), @__branchIds_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Services] AS [s]
        WHERE LOWER([s].[Name]) = @__ToLower_0 AND EXISTS (
            SELECT 1
            FROM [BranchServices] AS [b]
            INNER JOIN [Branches] AS [b0] ON [b].[BranchId] = [b0].[BranchId]
            WHERE [s].[ServiceId] = [b].[ServiceId] AND [b0].[BranchId] IN (
                SELECT [b1].[value]
                FROM OPENJSON(@__branchIds_1) WITH ([value] int '$') AS [b1]
            ))) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-24 01:58:49.281 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:58:49.282 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 01:58:49.283 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:58:49.284 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 01:58:49.286 +02:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Service.ServiceId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:58:49.287 +02:00 [DBG] Context 'AppDbContext' started tracking 'Service' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:58:49.288 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchService' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:58:49.288 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchService' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:58:49.289 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:58:49.290 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:58:49.290 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 01:58:49.290 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:58:49.291 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:58:49.292 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:58:49.293 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:58:49.294 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 01:58:49.296 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 01:58:49.297 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:58:49.297 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:58:49.298 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:58:49.298 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (Size = 300), @p3='?' (Size = 120), @p4='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Services] ([CreatedAt], [Description], [ImageURL], [Name], [UpdatedAt])
OUTPUT INSERTED.[ServiceId]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-11-24 01:58:49.302 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (Size = 300), @p3='?' (Size = 120), @p4='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Services] ([CreatedAt], [Description], [ImageURL], [Name], [UpdatedAt])
OUTPUT INSERTED.[ServiceId]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-11-24 01:58:49.304 +02:00 [DBG] The foreign key property 'Service.ServiceId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 01:58:49.306 +02:00 [DBG] The foreign key property 'BranchService.ServiceId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 01:58:49.307 +02:00 [DBG] The foreign key property 'BranchService.ServiceId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 01:58:49.311 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:58:49.312 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 8ms reading results.
2025-11-24 01:58:49.314 +02:00 [DBG] Executing 2 update commands as a batch.
2025-11-24 01:58:49.316 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:58:49.317 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:58:49.320 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-11-24 01:58:49.322 +02:00 [DBG] Executing DbCommand [Parameters=[@p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [BranchServices] ([BranchId], [ServiceId])
VALUES (@p5, @p6),
(@p7, @p8);
2025-11-24 01:58:49.331 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[@p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [BranchServices] ([BranchId], [ServiceId])
VALUES (@p5, @p6),
(@p7, @p8);
2025-11-24 01:58:49.336 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:58:49.337 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 01:58:49.338 +02:00 [DBG] Committing transaction.
2025-11-24 01:58:49.349 +02:00 [DBG] Committed transaction.
2025-11-24 01:58:49.350 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:58:49.351 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:58:49.356 +02:00 [DBG] Disposing transaction.
2025-11-24 01:58:49.358 +02:00 [DBG] An entity of type 'Service' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:58:49.359 +02:00 [DBG] An entity of type 'BranchService' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:58:49.365 +02:00 [DBG] An entity of type 'BranchService' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:58:49.366 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 3 entities written to the database.
2025-11-24 01:58:49.371 +02:00 [INF] Service 'Physiotherapy' created successfully
2025-11-24 01:58:49.374 +02:00 [INF] Creating service with Name: Vaccination
2025-11-24 01:58:49.377 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:58:49.379 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:58:49.380 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:58:49.381 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:58:49.382 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:58:49.384 +02:00 [DBG] Executing DbCommand [Parameters=[@__ids_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__ids_0) WITH ([value] int '$') AS [i]
)
2025-11-24 01:58:49.387 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__ids_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__ids_0) WITH ([value] int '$') AS [i]
)
2025-11-24 01:58:49.391 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:58:49.392 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 01:58:49.393 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:58:49.394 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:58:49.395 +02:00 [WRN] One or more branches do not exist for the new service
2025-11-24 01:58:49.436 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:58:49.439 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:58:49.440 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:58:49.443 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:58:49.446 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 01:58:49.449 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-11-24 01:58:49.452 +02:00 [INF] Executed action Hospital.Controllers.ServicesController.AddServicesFromExcel (Hospital) in 1373.5156ms
2025-11-24 01:58:49.456 +02:00 [INF] Executed endpoint 'Hospital.Controllers.ServicesController.AddServicesFromExcel (Hospital)'
2025-11-24 01:58:49.458 +02:00 [DBG] Connection id "0HNHATCCAV4K9" completed keep alive response.
2025-11-24 01:58:49.459 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:58:49.460 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:58:49.461 +02:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-11-24 01:58:49.463 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Services/add-services-from-excel - 200 null application/json; charset=utf-8 1423.0821ms
2025-11-24 01:59:45.978 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Banners - application/json 165
2025-11-24 01:59:45.989 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Banners'
2025-11-24 01:59:45.992 +02:00 [DBG] Endpoint 'Hospital.Controllers.BannersController.Create (Hospital)' with route pattern 'api/Banners' is valid for the request path '/api/Banners'
2025-11-24 01:59:45.994 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.BannersController.Create (Hospital)'
2025-11-24 01:59:45.995 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:59:45.996 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:59:45.996 +02:00 [INF] Executing endpoint 'Hospital.Controllers.BannersController.Create (Hospital)'
2025-11-24 01:59:46.001 +02:00 [INF] Route matched with {action = "Create", controller = "Banners"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Create(Hospital.Application.DTO.Banner.CreateBannerDto) on controller Hospital.Controllers.BannersController (Hospital).
2025-11-24 01:59:46.004 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:59:46.013 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:59:46.018 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:59:46.020 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:59:46.025 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:59:46.032 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.BannersController (Hospital)
2025-11-24 01:59:46.038 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.BannersController (Hospital)
2025-11-24 01:59:46.040 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Banner.CreateBannerDto' ...
2025-11-24 01:59:46.043 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Banner.CreateBannerDto' using the name '' in request data ...
2025-11-24 01:59:46.046 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 01:59:46.049 +02:00 [DBG] Connection id "0HNHATCCAV4K9", Request id "0HNHATCCAV4K9:00000002": started reading request body.
2025-11-24 01:59:46.050 +02:00 [DBG] Connection id "0HNHATCCAV4K9", Request id "0HNHATCCAV4K9:00000002": done reading request body.
2025-11-24 01:59:46.055 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Banner.CreateBannerDto'
2025-11-24 01:59:46.055 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Banner.CreateBannerDto'.
2025-11-24 01:59:46.056 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Banner.CreateBannerDto'.
2025-11-24 01:59:46.058 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Banner.CreateBannerDto' ...
2025-11-24 01:59:46.061 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Banner.CreateBannerDto'.
2025-11-24 01:59:46.066 +02:00 [INF] Creating new banner with title: banner name
2025-11-24 01:59:46.069 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:59:46.073 +02:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Banner.BannerId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:59:46.085 +02:00 [DBG] Context 'AppDbContext' started tracking 'Banner' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:59:46.086 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:59:46.091 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:59:46.093 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 01:59:46.097 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 01:59:46.100 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 01:59:46.102 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:59:46.103 +02:00 [DBG] Created DbConnection. (1ms).
2025-11-24 01:59:46.104 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:59:46.104 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:59:46.105 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:59:46.105 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:59:46.108 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 01:59:46.108 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 300), @p2='?' (Size = 300), @p3='?' (Size = 150), @p4='?' (Size = 20), @p5='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Banners] ([CreatedAt], [ImageURL], [LinkURL], [Title], [Type], [UpdatedAt])
OUTPUT INSERTED.[BannerId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-24 01:59:46.126 +02:00 [INF] Executed DbCommand (18ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 300), @p2='?' (Size = 300), @p3='?' (Size = 150), @p4='?' (Size = 20), @p5='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Banners] ([CreatedAt], [ImageURL], [LinkURL], [Title], [Type], [UpdatedAt])
OUTPUT INSERTED.[BannerId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-24 01:59:46.130 +02:00 [DBG] The foreign key property 'Banner.BannerId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 01:59:46.132 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:59:46.132 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 3ms reading results.
2025-11-24 01:59:46.133 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:59:46.134 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:59:46.137 +02:00 [DBG] An entity of type 'Banner' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 01:59:46.138 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 01:59:46.139 +02:00 [INF] Banner created successfully with ID: 1
2025-11-24 01:59:46.143 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:59:46.145 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:59:46.145 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 01:59:46.146 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 01:59:46.146 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 01:59:46.147 +02:00 [INF] Executing CreatedAtActionResult, writing value of type 'Hospital.Application.DTO.Banner.BannerDto'.
2025-11-24 01:59:46.148 +02:00 [DBG] Found the endpoints ["Hospital.Controllers.BannersController.Get (Hospital)"] for address (id=[1],action=[Get],controller=[Banners])
2025-11-24 01:59:46.149 +02:00 [DBG] Successfully processed template api/Banners/{id} for Hospital.Controllers.BannersController.Get (Hospital) resulting in /api/Banners/1 and 
2025-11-24 01:59:46.150 +02:00 [DBG] Link generation succeeded for endpoints ["Hospital.Controllers.BannersController.Get (Hospital)"] with result /api/Banners/1
2025-11-24 01:59:46.160 +02:00 [INF] Executed action Hospital.Controllers.BannersController.Create (Hospital) in 127.2179ms
2025-11-24 01:59:46.161 +02:00 [INF] Executed endpoint 'Hospital.Controllers.BannersController.Create (Hospital)'
2025-11-24 01:59:46.162 +02:00 [DBG] Connection id "0HNHATCCAV4K9" completed keep alive response.
2025-11-24 01:59:46.163 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:59:46.163 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:59:46.164 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 01:59:46.165 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Banners - 201 null application/json; charset=utf-8 188.6069ms
2025-11-24 01:59:58.142 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Banners/2 - null null
2025-11-24 01:59:58.145 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Banners/2'
2025-11-24 01:59:58.146 +02:00 [DBG] Endpoint 'Hospital.Controllers.BannersController.Get (Hospital)' with route pattern 'api/Banners/{id}' is valid for the request path '/api/Banners/2'
2025-11-24 01:59:58.147 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.BannersController.Get (Hospital)'
2025-11-24 01:59:58.149 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 01:59:58.149 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 01:59:58.150 +02:00 [INF] Executing endpoint 'Hospital.Controllers.BannersController.Get (Hospital)'
2025-11-24 01:59:58.155 +02:00 [INF] Route matched with {action = "Get", controller = "Banners"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Get(Int32) on controller Hospital.Controllers.BannersController (Hospital).
2025-11-24 01:59:58.158 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 01:59:58.162 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 01:59:58.166 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 01:59:58.167 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 01:59:58.168 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 01:59:58.171 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.BannersController (Hospital)
2025-11-24 01:59:58.173 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.BannersController (Hospital)
2025-11-24 01:59:58.179 +02:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-11-24 01:59:58.187 +02:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-11-24 01:59:58.189 +02:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-11-24 01:59:58.190 +02:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-11-24 01:59:58.191 +02:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-11-24 01:59:58.192 +02:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-11-24 01:59:58.194 +02:00 [INF] Fetching banner by ID: 2
2025-11-24 01:59:58.196 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 01:59:58.204 +02:00 [DBG] Compiling query expression: 
'DbSet<Banner>()
    .FirstOrDefault(e => EF.Property<int>(e, "BannerId") == __p_0)'
2025-11-24 01:59:58.210 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Banner>(
    asyncEnumerable: new SingleQueryingEnumerable<Banner>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Banner.BannerId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Banner.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: Banner.ImageURL (string) MaxLength(300), 2], [Property: Banner.LinkURL (string) MaxLength(300), 3], [Property: Banner.Title (string) Required MaxLength(150), 4], [Property: Banner.Type (BannerType?) MaxLength(20), 5], [Property: Banner.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 6] }
            SELECT TOP(1) b.BannerId, b.CreatedAt, b.ImageURL, b.LinkURL, b.Title, b.Type, b.UpdatedAt
            FROM Banners AS b
            WHERE b.BannerId == @__p_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Banner>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 01:59:58.213 +02:00 [DBG] Creating DbConnection.
2025-11-24 01:59:58.213 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 01:59:58.214 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 01:59:58.215 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 01:59:58.215 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 01:59:58.216 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 01:59:58.217 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 01:59:58.217 +02:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BannerId], [b].[CreatedAt], [b].[ImageURL], [b].[LinkURL], [b].[Title], [b].[Type], [b].[UpdatedAt]
FROM [Banners] AS [b]
WHERE [b].[BannerId] = @__p_0
2025-11-24 01:59:58.230 +02:00 [INF] Executed DbCommand (13ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BannerId], [b].[CreatedAt], [b].[ImageURL], [b].[LinkURL], [b].[Title], [b].[Type], [b].[UpdatedAt]
FROM [Banners] AS [b]
WHERE [b].[BannerId] = @__p_0
2025-11-24 01:59:58.233 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 01:59:58.238 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 5ms reading results.
2025-11-24 01:59:58.244 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:59:58.245 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 01:59:58.245 +02:00 [WRN] Banner with ID 2 not found
2025-11-24 01:59:58.248 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 01:59:58.251 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 01:59:58.253 +02:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2025-11-24 01:59:58.255 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2025-11-24 01:59:58.256 +02:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-11-24 01:59:58.260 +02:00 [INF] Executed action Hospital.Controllers.BannersController.Get (Hospital) in 88.7031ms
2025-11-24 01:59:58.261 +02:00 [INF] Executed endpoint 'Hospital.Controllers.BannersController.Get (Hospital)'
2025-11-24 01:59:58.263 +02:00 [DBG] Connection id "0HNHATCCAV4K9" completed keep alive response.
2025-11-24 01:59:58.264 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 01:59:58.265 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 01:59:58.266 +02:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-11-24 01:59:58.267 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Banners/2 - 404 null application/problem+json; charset=utf-8 125.0471ms
2025-11-24 02:00:04.856 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Banners/1 - null null
2025-11-24 02:00:04.864 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Banners/1'
2025-11-24 02:00:04.865 +02:00 [DBG] Endpoint 'Hospital.Controllers.BannersController.Get (Hospital)' with route pattern 'api/Banners/{id}' is valid for the request path '/api/Banners/1'
2025-11-24 02:00:04.866 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.BannersController.Get (Hospital)'
2025-11-24 02:00:04.867 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:00:04.868 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:00:04.868 +02:00 [INF] Executing endpoint 'Hospital.Controllers.BannersController.Get (Hospital)'
2025-11-24 02:00:04.871 +02:00 [INF] Route matched with {action = "Get", controller = "Banners"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Get(Int32) on controller Hospital.Controllers.BannersController (Hospital).
2025-11-24 02:00:04.875 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:00:04.877 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:00:04.878 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:00:04.879 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:00:04.880 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:00:04.881 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.BannersController (Hospital)
2025-11-24 02:00:04.884 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.BannersController (Hospital)
2025-11-24 02:00:04.885 +02:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-11-24 02:00:04.886 +02:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-11-24 02:00:04.887 +02:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-11-24 02:00:04.888 +02:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-11-24 02:00:04.889 +02:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-11-24 02:00:04.890 +02:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-11-24 02:00:04.891 +02:00 [INF] Fetching banner by ID: 1
2025-11-24 02:00:04.893 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:00:04.898 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:00:04.898 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:00:04.899 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:00:04.901 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:00:04.902 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:00:04.903 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:00:04.904 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 02:00:04.905 +02:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BannerId], [b].[CreatedAt], [b].[ImageURL], [b].[LinkURL], [b].[Title], [b].[Type], [b].[UpdatedAt]
FROM [Banners] AS [b]
WHERE [b].[BannerId] = @__p_0
2025-11-24 02:00:04.909 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BannerId], [b].[CreatedAt], [b].[ImageURL], [b].[LinkURL], [b].[Title], [b].[Type], [b].[UpdatedAt]
FROM [Banners] AS [b]
WHERE [b].[BannerId] = @__p_0
2025-11-24 02:00:04.914 +02:00 [DBG] Context 'AppDbContext' started tracking 'Banner' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:00:04.916 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:00:04.919 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 6ms reading results.
2025-11-24 02:00:04.920 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:00:04.921 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:00:04.923 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:00:04.925 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:00:04.925 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:00:04.927 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:00:04.928 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:00:04.929 +02:00 [INF] Executing OkObjectResult, writing value of type 'Hospital.Application.DTO.Banner.BannerDto'.
2025-11-24 02:00:04.932 +02:00 [INF] Executed action Hospital.Controllers.BannersController.Get (Hospital) in 51.343ms
2025-11-24 02:00:04.934 +02:00 [INF] Executed endpoint 'Hospital.Controllers.BannersController.Get (Hospital)'
2025-11-24 02:00:04.935 +02:00 [DBG] Connection id "0HNHATCCAV4K9" completed keep alive response.
2025-11-24 02:00:04.936 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:00:04.936 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:00:04.937 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:00:04.938 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Banners/1 - 200 null application/json; charset=utf-8 81.7204ms
2025-11-24 02:00:13.550 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Banners - application/json 165
2025-11-24 02:00:13.555 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Banners'
2025-11-24 02:00:13.557 +02:00 [DBG] Endpoint 'Hospital.Controllers.BannersController.Create (Hospital)' with route pattern 'api/Banners' is valid for the request path '/api/Banners'
2025-11-24 02:00:13.558 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.BannersController.Create (Hospital)'
2025-11-24 02:00:13.560 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:00:13.561 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:00:13.564 +02:00 [INF] Executing endpoint 'Hospital.Controllers.BannersController.Create (Hospital)'
2025-11-24 02:00:13.565 +02:00 [INF] Route matched with {action = "Create", controller = "Banners"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Create(Hospital.Application.DTO.Banner.CreateBannerDto) on controller Hospital.Controllers.BannersController (Hospital).
2025-11-24 02:00:13.566 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:00:13.566 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:00:13.569 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:00:13.573 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:00:13.574 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:00:13.575 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.BannersController (Hospital)
2025-11-24 02:00:13.576 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.BannersController (Hospital)
2025-11-24 02:00:13.576 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Banner.CreateBannerDto' ...
2025-11-24 02:00:13.577 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Banner.CreateBannerDto' using the name '' in request data ...
2025-11-24 02:00:13.579 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:00:13.580 +02:00 [DBG] Connection id "0HNHATCCAV4K9", Request id "0HNHATCCAV4K9:00000005": started reading request body.
2025-11-24 02:00:13.580 +02:00 [DBG] Connection id "0HNHATCCAV4K9", Request id "0HNHATCCAV4K9:00000005": done reading request body.
2025-11-24 02:00:13.581 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Banner.CreateBannerDto'
2025-11-24 02:00:13.582 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Banner.CreateBannerDto'.
2025-11-24 02:00:13.583 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Banner.CreateBannerDto'.
2025-11-24 02:00:13.584 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Banner.CreateBannerDto' ...
2025-11-24 02:00:13.585 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Banner.CreateBannerDto'.
2025-11-24 02:00:13.586 +02:00 [INF] Creating new banner with title: banner name
2025-11-24 02:00:13.588 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:00:13.590 +02:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Banner.BannerId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:00:13.592 +02:00 [DBG] Context 'AppDbContext' started tracking 'Banner' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:00:13.594 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:00:13.595 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:00:13.596 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 02:00:13.597 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:00:13.598 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:00:13.599 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:00:13.600 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:00:13.601 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:00:13.602 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:00:13.604 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:00:13.604 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:00:13.606 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 02:00:13.606 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 300), @p2='?' (Size = 300), @p3='?' (Size = 150), @p4='?' (Size = 20), @p5='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Banners] ([CreatedAt], [ImageURL], [LinkURL], [Title], [Type], [UpdatedAt])
OUTPUT INSERTED.[BannerId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-24 02:00:13.612 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 300), @p2='?' (Size = 300), @p3='?' (Size = 150), @p4='?' (Size = 20), @p5='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Banners] ([CreatedAt], [ImageURL], [LinkURL], [Title], [Type], [UpdatedAt])
OUTPUT INSERTED.[BannerId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-11-24 02:00:13.619 +02:00 [DBG] The foreign key property 'Banner.BannerId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 02:00:13.620 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:00:13.621 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 02:00:13.622 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:00:13.624 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 02:00:13.627 +02:00 [DBG] An entity of type 'Banner' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:00:13.630 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 02:00:13.631 +02:00 [INF] Banner created successfully with ID: 2
2025-11-24 02:00:13.632 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:00:13.634 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:00:13.635 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:00:13.636 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:00:13.636 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:00:13.638 +02:00 [INF] Executing CreatedAtActionResult, writing value of type 'Hospital.Application.DTO.Banner.BannerDto'.
2025-11-24 02:00:13.640 +02:00 [DBG] Found the endpoints ["Hospital.Controllers.BannersController.Get (Hospital)"] for address (id=[2],action=[Get],controller=[Banners])
2025-11-24 02:00:13.641 +02:00 [DBG] Successfully processed template api/Banners/{id} for Hospital.Controllers.BannersController.Get (Hospital) resulting in /api/Banners/2 and 
2025-11-24 02:00:13.642 +02:00 [DBG] Link generation succeeded for endpoints ["Hospital.Controllers.BannersController.Get (Hospital)"] with result /api/Banners/2
2025-11-24 02:00:13.645 +02:00 [INF] Executed action Hospital.Controllers.BannersController.Create (Hospital) in 69.8366ms
2025-11-24 02:00:13.647 +02:00 [INF] Executed endpoint 'Hospital.Controllers.BannersController.Create (Hospital)'
2025-11-24 02:00:13.648 +02:00 [DBG] Connection id "0HNHATCCAV4K9" completed keep alive response.
2025-11-24 02:00:13.650 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:00:13.650 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:00:13.651 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:00:13.652 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Banners - 201 null application/json; charset=utf-8 101.3637ms
2025-11-24 02:00:34.695 +02:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7217/api/Banners - application/json 106
2025-11-24 02:00:34.699 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Banners'
2025-11-24 02:00:34.705 +02:00 [DBG] Endpoint 'Hospital.Controllers.BannersController.Update (Hospital)' with route pattern 'api/Banners' is valid for the request path '/api/Banners'
2025-11-24 02:00:34.712 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.BannersController.Update (Hospital)'
2025-11-24 02:00:34.713 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:00:34.714 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:00:34.715 +02:00 [INF] Executing endpoint 'Hospital.Controllers.BannersController.Update (Hospital)'
2025-11-24 02:00:34.718 +02:00 [INF] Route matched with {action = "Update", controller = "Banners"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Update(Hospital.Application.DTO.Banner.UpdateBannerDto) on controller Hospital.Controllers.BannersController (Hospital).
2025-11-24 02:00:34.719 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:00:34.720 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:00:34.722 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:00:34.723 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:00:34.724 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:00:34.727 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.BannersController (Hospital)
2025-11-24 02:00:34.728 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.BannersController (Hospital)
2025-11-24 02:00:34.729 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Banner.UpdateBannerDto' ...
2025-11-24 02:00:34.730 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Banner.UpdateBannerDto' using the name '' in request data ...
2025-11-24 02:00:34.730 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:00:34.732 +02:00 [DBG] Connection id "0HNHATCCAV4K9", Request id "0HNHATCCAV4K9:00000006": started reading request body.
2025-11-24 02:00:34.734 +02:00 [DBG] Connection id "0HNHATCCAV4K9", Request id "0HNHATCCAV4K9:00000006": done reading request body.
2025-11-24 02:00:34.736 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Banner.UpdateBannerDto'
2025-11-24 02:00:34.737 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Banner.UpdateBannerDto'.
2025-11-24 02:00:34.739 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Banner.UpdateBannerDto'.
2025-11-24 02:00:34.741 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Banner.UpdateBannerDto' ...
2025-11-24 02:00:34.744 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Banner.UpdateBannerDto'.
2025-11-24 02:00:34.745 +02:00 [DBG] The request has model state errors, returning an error response.
2025-11-24 02:00:34.745 +02:00 [DBG] Request was short circuited at action filter 'Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter'.
2025-11-24 02:00:34.748 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:00:34.750 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:00:34.751 +02:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2025-11-24 02:00:34.752 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2025-11-24 02:00:34.753 +02:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-11-24 02:00:34.754 +02:00 [INF] Executed action Hospital.Controllers.BannersController.Update (Hospital) in 27.7109ms
2025-11-24 02:00:34.756 +02:00 [INF] Executed endpoint 'Hospital.Controllers.BannersController.Update (Hospital)'
2025-11-24 02:00:34.757 +02:00 [DBG] Connection id "0HNHATCCAV4K9" completed keep alive response.
2025-11-24 02:00:34.758 +02:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7217/api/Banners - 400 null application/problem+json; charset=utf-8 63.5263ms
2025-11-24 02:00:41.204 +02:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7217/api/Banners - application/json 106
2025-11-24 02:00:41.207 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Banners'
2025-11-24 02:00:41.211 +02:00 [DBG] Endpoint 'Hospital.Controllers.BannersController.Update (Hospital)' with route pattern 'api/Banners' is valid for the request path '/api/Banners'
2025-11-24 02:00:41.213 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.BannersController.Update (Hospital)'
2025-11-24 02:00:41.215 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:00:41.217 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:00:41.218 +02:00 [INF] Executing endpoint 'Hospital.Controllers.BannersController.Update (Hospital)'
2025-11-24 02:00:41.219 +02:00 [INF] Route matched with {action = "Update", controller = "Banners"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Update(Hospital.Application.DTO.Banner.UpdateBannerDto) on controller Hospital.Controllers.BannersController (Hospital).
2025-11-24 02:00:41.220 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:00:41.221 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:00:41.222 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:00:41.223 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:00:41.223 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:00:41.224 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.BannersController (Hospital)
2025-11-24 02:00:41.225 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.BannersController (Hospital)
2025-11-24 02:00:41.227 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Banner.UpdateBannerDto' ...
2025-11-24 02:00:41.228 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Banner.UpdateBannerDto' using the name '' in request data ...
2025-11-24 02:00:41.228 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:00:41.229 +02:00 [DBG] Connection id "0HNHATCCAV4K9", Request id "0HNHATCCAV4K9:00000007": started reading request body.
2025-11-24 02:00:41.230 +02:00 [DBG] Connection id "0HNHATCCAV4K9", Request id "0HNHATCCAV4K9:00000007": done reading request body.
2025-11-24 02:00:41.230 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Banner.UpdateBannerDto'
2025-11-24 02:00:41.231 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Banner.UpdateBannerDto'.
2025-11-24 02:00:41.232 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Banner.UpdateBannerDto'.
2025-11-24 02:00:41.233 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Banner.UpdateBannerDto' ...
2025-11-24 02:00:41.234 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Banner.UpdateBannerDto'.
2025-11-24 02:00:41.235 +02:00 [DBG] The request has model state errors, returning an error response.
2025-11-24 02:00:41.235 +02:00 [DBG] Request was short circuited at action filter 'Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter'.
2025-11-24 02:00:41.236 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:00:41.238 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:00:41.238 +02:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2025-11-24 02:00:41.239 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2025-11-24 02:00:41.240 +02:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-11-24 02:00:41.241 +02:00 [INF] Executed action Hospital.Controllers.BannersController.Update (Hospital) in 17.3265ms
2025-11-24 02:00:41.243 +02:00 [INF] Executed endpoint 'Hospital.Controllers.BannersController.Update (Hospital)'
2025-11-24 02:00:41.244 +02:00 [DBG] Connection id "0HNHATCCAV4K9" completed keep alive response.
2025-11-24 02:00:41.244 +02:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7217/api/Banners - 400 null application/problem+json; charset=utf-8 40.2106ms
2025-11-24 02:00:43.943 +02:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7217/api/Banners - application/json 106
2025-11-24 02:00:43.950 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Banners'
2025-11-24 02:00:43.951 +02:00 [DBG] Endpoint 'Hospital.Controllers.BannersController.Update (Hospital)' with route pattern 'api/Banners' is valid for the request path '/api/Banners'
2025-11-24 02:00:43.953 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.BannersController.Update (Hospital)'
2025-11-24 02:00:43.953 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:00:43.955 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:00:43.956 +02:00 [INF] Executing endpoint 'Hospital.Controllers.BannersController.Update (Hospital)'
2025-11-24 02:00:43.957 +02:00 [INF] Route matched with {action = "Update", controller = "Banners"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Update(Hospital.Application.DTO.Banner.UpdateBannerDto) on controller Hospital.Controllers.BannersController (Hospital).
2025-11-24 02:00:43.958 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:00:43.959 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:00:43.960 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:00:43.962 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:00:43.962 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:00:43.963 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.BannersController (Hospital)
2025-11-24 02:00:43.964 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.BannersController (Hospital)
2025-11-24 02:00:43.965 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Banner.UpdateBannerDto' ...
2025-11-24 02:00:43.966 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Banner.UpdateBannerDto' using the name '' in request data ...
2025-11-24 02:00:43.967 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:00:43.968 +02:00 [DBG] Connection id "0HNHATCCAV4K9", Request id "0HNHATCCAV4K9:00000008": started reading request body.
2025-11-24 02:00:43.968 +02:00 [DBG] Connection id "0HNHATCCAV4K9", Request id "0HNHATCCAV4K9:00000008": done reading request body.
2025-11-24 02:00:43.969 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Banner.UpdateBannerDto'
2025-11-24 02:00:43.970 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Banner.UpdateBannerDto'.
2025-11-24 02:00:43.971 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Banner.UpdateBannerDto'.
2025-11-24 02:00:43.972 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Banner.UpdateBannerDto' ...
2025-11-24 02:00:43.973 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Banner.UpdateBannerDto'.
2025-11-24 02:00:43.974 +02:00 [DBG] The request has model state errors, returning an error response.
2025-11-24 02:00:43.974 +02:00 [DBG] Request was short circuited at action filter 'Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter'.
2025-11-24 02:00:43.975 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:00:43.977 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:00:43.978 +02:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2025-11-24 02:00:43.980 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2025-11-24 02:00:43.981 +02:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-11-24 02:00:43.982 +02:00 [INF] Executed action Hospital.Controllers.BannersController.Update (Hospital) in 18.5465ms
2025-11-24 02:00:43.983 +02:00 [INF] Executed endpoint 'Hospital.Controllers.BannersController.Update (Hospital)'
2025-11-24 02:00:43.983 +02:00 [DBG] Connection id "0HNHATCCAV4K9" completed keep alive response.
2025-11-24 02:00:43.984 +02:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7217/api/Banners - 400 null application/problem+json; charset=utf-8 41.1712ms
2025-11-24 02:01:04.863 +02:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7217/api/Banners - application/json 178
2025-11-24 02:01:04.873 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Banners'
2025-11-24 02:01:04.876 +02:00 [DBG] Endpoint 'Hospital.Controllers.BannersController.Update (Hospital)' with route pattern 'api/Banners' is valid for the request path '/api/Banners'
2025-11-24 02:01:04.882 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.BannersController.Update (Hospital)'
2025-11-24 02:01:04.883 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:01:04.885 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:01:04.889 +02:00 [INF] Executing endpoint 'Hospital.Controllers.BannersController.Update (Hospital)'
2025-11-24 02:01:04.894 +02:00 [INF] Route matched with {action = "Update", controller = "Banners"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Update(Hospital.Application.DTO.Banner.UpdateBannerDto) on controller Hospital.Controllers.BannersController (Hospital).
2025-11-24 02:01:04.895 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:01:04.896 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:01:04.898 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:01:04.903 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:01:04.904 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:01:04.905 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.BannersController (Hospital)
2025-11-24 02:01:04.906 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.BannersController (Hospital)
2025-11-24 02:01:04.906 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Banner.UpdateBannerDto' ...
2025-11-24 02:01:04.907 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Banner.UpdateBannerDto' using the name '' in request data ...
2025-11-24 02:01:04.909 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:01:04.911 +02:00 [DBG] Connection id "0HNHATCCAV4K9", Request id "0HNHATCCAV4K9:00000009": started reading request body.
2025-11-24 02:01:04.912 +02:00 [DBG] Connection id "0HNHATCCAV4K9", Request id "0HNHATCCAV4K9:00000009": done reading request body.
2025-11-24 02:01:04.914 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Banner.UpdateBannerDto'
2025-11-24 02:01:04.914 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Banner.UpdateBannerDto'.
2025-11-24 02:01:04.915 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Banner.UpdateBannerDto'.
2025-11-24 02:01:04.916 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Banner.UpdateBannerDto' ...
2025-11-24 02:01:04.918 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Banner.UpdateBannerDto'.
2025-11-24 02:01:04.920 +02:00 [INF] Updating banner with ID: 2
2025-11-24 02:01:04.922 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:01:04.924 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:01:04.925 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:01:04.925 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:01:04.926 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:01:04.926 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:01:04.927 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:01:04.927 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:01:04.928 +02:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BannerId], [b].[CreatedAt], [b].[ImageURL], [b].[LinkURL], [b].[Title], [b].[Type], [b].[UpdatedAt]
FROM [Banners] AS [b]
WHERE [b].[BannerId] = @__p_0
2025-11-24 02:01:04.933 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BannerId], [b].[CreatedAt], [b].[ImageURL], [b].[LinkURL], [b].[Title], [b].[Type], [b].[UpdatedAt]
FROM [Banners] AS [b]
WHERE [b].[BannerId] = @__p_0
2025-11-24 02:01:04.934 +02:00 [DBG] Context 'AppDbContext' started tracking 'Banner' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:01:04.935 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:01:04.935 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 02:01:04.936 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:01:04.937 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:01:04.939 +02:00 [DBG] An entity of type 'Banner' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:01:04.940 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:01:04.941 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:01:04.942 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 02:01:04.943 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:01:04.943 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:01:04.944 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:01:04.945 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:01:04.945 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:01:04.946 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:01:04.946 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:01:04.947 +02:00 [DBG] Executing DbCommand [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (Size = 300), @p2='?' (Size = 300), @p3='?' (Size = 150), @p4='?' (Size = 20), @p5='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Banners] SET [CreatedAt] = @p0, [ImageURL] = @p1, [LinkURL] = @p2, [Title] = @p3, [Type] = @p4, [UpdatedAt] = @p5
OUTPUT 1
WHERE [BannerId] = @p6;
2025-11-24 02:01:04.953 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (Size = 300), @p2='?' (Size = 300), @p3='?' (Size = 150), @p4='?' (Size = 20), @p5='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Banners] SET [CreatedAt] = @p0, [ImageURL] = @p1, [LinkURL] = @p2, [Title] = @p3, [Type] = @p4, [UpdatedAt] = @p5
OUTPUT 1
WHERE [BannerId] = @p6;
2025-11-24 02:01:04.955 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:01:04.956 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:01:04.956 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:01:04.957 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:01:04.958 +02:00 [DBG] An entity of type 'Banner' tracked by 'AppDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:01:04.959 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 02:01:04.960 +02:00 [INF] Banner with ID 2 updated successfully
2025-11-24 02:01:04.960 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:01:04.962 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:01:04.962 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:01:04.963 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:01:04.963 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter' and content type 'text/plain' to write the response.
2025-11-24 02:01:04.964 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.String'.
2025-11-24 02:01:04.965 +02:00 [INF] Executed action Hospital.Controllers.BannersController.Update (Hospital) in 60.1052ms
2025-11-24 02:01:04.965 +02:00 [INF] Executed endpoint 'Hospital.Controllers.BannersController.Update (Hospital)'
2025-11-24 02:01:04.966 +02:00 [DBG] Connection id "0HNHATCCAV4K9" completed keep alive response.
2025-11-24 02:01:04.966 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:01:04.967 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:01:04.968 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:01:04.968 +02:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7217/api/Banners - 200 null text/plain; charset=utf-8 106.5269ms
2025-11-24 02:01:17.758 +02:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7217/api/Banners/2 - null null
2025-11-24 02:01:17.760 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Banners/2'
2025-11-24 02:01:17.761 +02:00 [DBG] Endpoint 'Hospital.Controllers.BannersController.Delete (Hospital)' with route pattern 'api/Banners/{id}' is valid for the request path '/api/Banners/2'
2025-11-24 02:01:17.762 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.BannersController.Delete (Hospital)'
2025-11-24 02:01:17.763 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:01:17.763 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:01:17.765 +02:00 [INF] Executing endpoint 'Hospital.Controllers.BannersController.Delete (Hospital)'
2025-11-24 02:01:17.768 +02:00 [INF] Route matched with {action = "Delete", controller = "Banners"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Delete(Int32) on controller Hospital.Controllers.BannersController (Hospital).
2025-11-24 02:01:17.771 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:01:17.772 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:01:17.773 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:01:17.775 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:01:17.775 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:01:17.776 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.BannersController (Hospital)
2025-11-24 02:01:17.778 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.BannersController (Hospital)
2025-11-24 02:01:17.780 +02:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-11-24 02:01:17.781 +02:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-11-24 02:01:17.781 +02:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-11-24 02:01:17.782 +02:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-11-24 02:01:17.783 +02:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-11-24 02:01:17.785 +02:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-11-24 02:01:17.788 +02:00 [INF] Deleting banner with ID: 2
2025-11-24 02:01:17.789 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:01:17.790 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:01:17.791 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:01:17.791 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:01:17.792 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:01:17.794 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:01:17.794 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:01:17.795 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:01:17.796 +02:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BannerId], [b].[CreatedAt], [b].[ImageURL], [b].[LinkURL], [b].[Title], [b].[Type], [b].[UpdatedAt]
FROM [Banners] AS [b]
WHERE [b].[BannerId] = @__p_0
2025-11-24 02:01:17.799 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BannerId], [b].[CreatedAt], [b].[ImageURL], [b].[LinkURL], [b].[Title], [b].[Type], [b].[UpdatedAt]
FROM [Banners] AS [b]
WHERE [b].[BannerId] = @__p_0
2025-11-24 02:01:17.814 +02:00 [DBG] Context 'AppDbContext' started tracking 'Banner' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:01:17.818 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:01:17.819 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 4ms reading results.
2025-11-24 02:01:17.821 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:01:17.822 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 02:01:17.829 +02:00 [DBG] An entity of type 'Banner' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Deleted"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:01:17.830 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:01:17.831 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:01:17.831 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 02:01:17.832 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:01:17.832 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:01:17.834 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:01:17.835 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:01:17.836 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:01:17.836 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:01:17.837 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:01:17.838 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [Banners]
OUTPUT 1
WHERE [BannerId] = @p0;
2025-11-24 02:01:17.852 +02:00 [INF] Executed DbCommand (14ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [Banners]
OUTPUT 1
WHERE [BannerId] = @p0;
2025-11-24 02:01:17.855 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:01:17.855 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:01:17.857 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:01:17.859 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (2ms).
2025-11-24 02:01:17.862 +02:00 [DBG] An entity of type 'Banner' tracked by 'AppDbContext' changed state from '"Deleted"' to '"Detached"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:01:17.863 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 02:01:17.864 +02:00 [INF] Banner with ID 2 deleted successfully
2025-11-24 02:01:17.865 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:01:17.867 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:01:17.867 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:01:17.868 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:01:17.868 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter' and content type 'text/plain' to write the response.
2025-11-24 02:01:17.869 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.String'.
2025-11-24 02:01:17.870 +02:00 [INF] Executed action Hospital.Controllers.BannersController.Delete (Hospital) in 93.8662ms
2025-11-24 02:01:17.871 +02:00 [INF] Executed endpoint 'Hospital.Controllers.BannersController.Delete (Hospital)'
2025-11-24 02:01:17.872 +02:00 [DBG] Connection id "0HNHATCCAV4K9" completed keep alive response.
2025-11-24 02:01:17.872 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:01:17.873 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:01:17.873 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:01:17.874 +02:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7217/api/Banners/2 - 200 null text/plain; charset=utf-8 116.2344ms
2025-11-24 02:01:27.179 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Banners - null null
2025-11-24 02:01:27.181 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Banners'
2025-11-24 02:01:27.182 +02:00 [DBG] Endpoint 'Hospital.Controllers.BannersController.GetAll (Hospital)' with route pattern 'api/Banners' is valid for the request path '/api/Banners'
2025-11-24 02:01:27.185 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.BannersController.GetAll (Hospital)'
2025-11-24 02:01:27.188 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:01:27.189 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:01:27.190 +02:00 [INF] Executing endpoint 'Hospital.Controllers.BannersController.GetAll (Hospital)'
2025-11-24 02:01:27.193 +02:00 [INF] Route matched with {action = "GetAll", controller = "Banners"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll() on controller Hospital.Controllers.BannersController (Hospital).
2025-11-24 02:01:27.195 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:01:27.198 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:01:27.199 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:01:27.200 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:01:27.204 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:01:27.205 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.BannersController (Hospital)
2025-11-24 02:01:27.209 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.BannersController (Hospital)
2025-11-24 02:01:27.211 +02:00 [INF] Fetching all banners
2025-11-24 02:01:27.213 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:01:27.216 +02:00 [DBG] Compiling query expression: 
'DbSet<Banner>()'
2025-11-24 02:01:27.220 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Banner>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Banner.BannerId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Banner.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: Banner.ImageURL (string) MaxLength(300), 2], [Property: Banner.LinkURL (string) MaxLength(300), 3], [Property: Banner.Title (string) Required MaxLength(150), 4], [Property: Banner.Type (BannerType?) MaxLength(20), 5], [Property: Banner.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 6] }
        SELECT b.BannerId, b.CreatedAt, b.ImageURL, b.LinkURL, b.Title, b.Type, b.UpdatedAt
        FROM Banners AS b), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Banner>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 02:01:27.224 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:01:27.225 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:01:27.225 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:01:27.226 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:01:27.231 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:01:27.234 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-11-24 02:01:27.235 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-11-24 02:01:27.236 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BannerId], [b].[CreatedAt], [b].[ImageURL], [b].[LinkURL], [b].[Title], [b].[Type], [b].[UpdatedAt]
FROM [Banners] AS [b]
2025-11-24 02:01:27.241 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BannerId], [b].[CreatedAt], [b].[ImageURL], [b].[LinkURL], [b].[Title], [b].[Type], [b].[UpdatedAt]
FROM [Banners] AS [b]
2025-11-24 02:01:27.244 +02:00 [DBG] Context 'AppDbContext' started tracking 'Banner' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:01:27.246 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:01:27.246 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 2ms reading results.
2025-11-24 02:01:27.247 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:01:27.249 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 02:01:27.255 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:01:27.259 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:01:27.260 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:01:27.261 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:01:27.263 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:01:27.265 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Banner.BannerDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 02:01:27.266 +02:00 [INF] Executed action Hospital.Controllers.BannersController.GetAll (Hospital) in 61.1642ms
2025-11-24 02:01:27.268 +02:00 [INF] Executed endpoint 'Hospital.Controllers.BannersController.GetAll (Hospital)'
2025-11-24 02:01:27.271 +02:00 [DBG] Connection id "0HNHATCCAV4K9" completed keep alive response.
2025-11-24 02:01:27.273 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:01:27.274 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:01:27.277 +02:00 [DBG] Disposed connection to database '' on server '' (2ms).
2025-11-24 02:01:27.280 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Banners - 200 null application/json; charset=utf-8 100.8553ms
2025-11-24 02:01:50.575 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Schedule - application/json 75
2025-11-24 02:01:50.576 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Schedule'
2025-11-24 02:01:50.577 +02:00 [DBG] Endpoint 'Hospital.Controllers.ScheduleController.Create (Hospital)' with route pattern 'api/Schedule' is valid for the request path '/api/Schedule'
2025-11-24 02:01:50.577 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.ScheduleController.Create (Hospital)'
2025-11-24 02:01:50.578 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:01:50.578 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:01:50.579 +02:00 [INF] Executing endpoint 'Hospital.Controllers.ScheduleController.Create (Hospital)'
2025-11-24 02:01:50.581 +02:00 [INF] Route matched with {action = "Create", controller = "Schedule"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Hospital.Application.DTO.Schedule.ScheduleDto]] Create(Hospital.Application.DTO.Schedule.CreateScheduleDto) on controller Hospital.Controllers.ScheduleController (Hospital).
2025-11-24 02:01:50.585 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:01:50.587 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:01:50.590 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:01:50.596 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:01:50.602 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:01:50.605 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:01:50.609 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:01:50.611 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto' ...
2025-11-24 02:01:50.612 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto' using the name '' in request data ...
2025-11-24 02:01:50.615 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:01:50.619 +02:00 [DBG] Connection id "0HNHATCCAV4K9", Request id "0HNHATCCAV4K9:0000000C": started reading request body.
2025-11-24 02:01:50.620 +02:00 [DBG] Connection id "0HNHATCCAV4K9", Request id "0HNHATCCAV4K9:0000000C": done reading request body.
2025-11-24 02:01:50.622 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Schedule.CreateScheduleDto'
2025-11-24 02:01:50.627 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto'.
2025-11-24 02:01:50.628 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto'.
2025-11-24 02:01:50.629 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto' ...
2025-11-24 02:01:50.635 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto'.
2025-11-24 02:01:50.639 +02:00 [INF] create schedule  called at "2025-11-24T02:01:50.6395268+02:00"
2025-11-24 02:01:50.644 +02:00 [INF] Creating schedule for DoctorId: 1, Day: saturday, Shift: "Morning"
2025-11-24 02:01:50.648 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:01:50.652 +02:00 [DBG] Compiling query expression: 
'DbSet<Doctor>()
    .Include(d => d.User)
    .Include(d => d.Specialization)
    .Include(d => d.Branches)
    .Include(d => d.Schedules)
    .FirstOrDefault(d => d.DoctorId == __doctorId_0)'
2025-11-24 02:01:50.654 +02:00 [DBG] Including navigation: 'Doctor.User'.
2025-11-24 02:01:50.656 +02:00 [DBG] Including navigation: 'Doctor.Specialization'.
2025-11-24 02:01:50.657 +02:00 [DBG] Including navigation: 'Doctor.Branches'.
2025-11-24 02:01:50.658 +02:00 [DBG] Including navigation: 'Doctor.Schedules'.
2025-11-24 02:01:50.674 +02:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-11-24 02:01:50.680 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Doctor>(
    asyncEnumerable: new SingleQueryingEnumerable<Doctor>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Doctor.DoctorId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Doctor.Available (bool?), 1], [Property: Doctor.Biography (string), 2], [Property: Doctor.ConsultationFees (decimal) Required, 3], [Property: Doctor.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: Doctor.ExperienceYears (int?), 5], [Property: Doctor.ImageURL (string) MaxLength(300), 6], [Property: Doctor.SpecializationId (int) Required FK Index, 7], [Property: Doctor.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 8], [Property: Doctor.UserId (string) Required FK Index, 9] }
                1 -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 10], [Property: User.AccessFailedCount (int) Required, 11], [Property: User.ConcurrencyStamp (string) Concurrency, 12], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 13], [Property: User.DateOfBirth (DateOnly?), 14], [Property: User.Email (string) Index MaxLength(256), 15], [Property: User.EmailConfirmed (bool) Required, 16], [Property: User.FullName (string) Required MaxLength(150), 17], [Property: User.Gender (GenderType?) MaxLength(10), 18], [Property: User.LockoutEnabled (bool) Required, 19], [Property: User.LockoutEnd (DateTimeOffset?), 20], [Property: User.NormalizedEmail (string) Index MaxLength(256), 21], [Property: User.NormalizedUserName (string) Index MaxLength(256), 22], [Property: User.PasswordHash (string), 23], [Property: User.PhoneNumber (string), 24], [Property: User.PhoneNumberConfirmed (bool) Required, 25], [Property: User.RefreshToken (string), 26], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 27], [Property: User.Role (string) Required MaxLength(50), 28], [Property: User.SecurityStamp (string), 29], [Property: User.TwoFactorEnabled (bool) Required, 30], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 31], [Property: User.UserName (string) MaxLength(256), 32] }
                2 -> Dictionary<IProperty, int> { [Property: Specialization.SpecializationId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 33], [Property: Specialization.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 34], [Property: Specialization.Description (string), 35], [Property: Specialization.Name (string) Required MaxLength(120), 36], [Property: Specialization.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 37] }
                3 -> 0
                4 -> 10
                5 -> 33
                6 -> Dictionary<IProperty, int> { [Property: BranchDoctor (Dictionary<string, object>).BranchesBranchId (no field, int) Indexer Required PK FK AfterSave:Throw, 38], [Property: BranchDoctor (Dictionary<string, object>).DoctorsDoctorId (no field, int) Indexer Required PK FK Index AfterSave:Throw, 39] }
                7 -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 40], [Property: Branch.Address (string) MaxLength(250), 41], [Property: Branch.BranchName (string) Required MaxLength(150), 42], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 43], [Property: Branch.Description (string), 44], [Property: Branch.Email (string) MaxLength(200), 45], [Property: Branch.ImageURL (string) MaxLength(300), 46], [Property: Branch.Phone (string) MaxLength(25), 47], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 48] }
                8 -> 38
                9 -> 39
                10 -> 40
                11 -> Dictionary<IProperty, int> { [Property: Schedule.ScheduleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 49], [Property: Schedule.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 50], [Property: Schedule.DayOfWeek (string) Required MaxLength(20), 51], [Property: Schedule.DoctorId (int) Required FK Index, 52], [Property: Schedule.EndTime (DateTime) Required, 53], [Property: Schedule.Shift (AppointmentShift) Required, 54], [Property: Schedule.StartTime (DateTime) Required, 55], [Property: Schedule.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 56] }
                12 -> 49
            SELECT t.DoctorId, t.Available, t.Biography, t.ConsultationFees, t.CreatedAt, t.ExperienceYears, t.ImageURL, t.SpecializationId, t.UpdatedAt, t.UserId, t.Id, t.AccessFailedCount, t.ConcurrencyStamp, t.CreatedAt0, t.DateOfBirth, t.Email, t.EmailConfirmed, t.FullName, t.Gender, t.LockoutEnabled, t.LockoutEnd, t.NormalizedEmail, t.NormalizedUserName, t.PasswordHash, t.PhoneNumber, t.PhoneNumberConfirmed, t.RefreshToken, t.RefreshTokenExpiryTime, t.Role, t.SecurityStamp, t.TwoFactorEnabled, t.UpdatedAt0, t.UserName, t.SpecializationId0, t.CreatedAt1, t.Description, t.Name, t.UpdatedAt1, t0.BranchesBranchId, t0.DoctorsDoctorId, t0.BranchId, t0.Address, t0.BranchName, t0.CreatedAt, t0.Description, t0.Email, t0.ImageURL, t0.Phone, t0.UpdatedAt, s0.ScheduleId, s0.CreatedAt, s0.DayOfWeek, s0.DoctorId, s0.EndTime, s0.Shift, s0.StartTime, s0.UpdatedAt
            FROM 
            (
                SELECT TOP(1) d.DoctorId, d.Available, d.Biography, d.ConsultationFees, d.CreatedAt, d.ExperienceYears, d.ImageURL, d.SpecializationId, d.UpdatedAt, d.UserId, u.Id, u.AccessFailedCount, u.ConcurrencyStamp, u.CreatedAt AS CreatedAt0, u.DateOfBirth, u.Email, u.EmailConfirmed, u.FullName, u.Gender, u.LockoutEnabled, u.LockoutEnd, u.NormalizedEmail, u.NormalizedUserName, u.PasswordHash, u.PhoneNumber, u.PhoneNumberConfirmed, u.RefreshToken, u.RefreshTokenExpiryTime, u.Role, u.SecurityStamp, u.TwoFactorEnabled, u.UpdatedAt AS UpdatedAt0, u.UserName, s.SpecializationId AS SpecializationId0, s.CreatedAt AS CreatedAt1, s.Description, s.Name, s.UpdatedAt AS UpdatedAt1
                FROM Doctors AS d
                INNER JOIN Users AS u ON d.UserId == u.Id
                INNER JOIN Specializations AS s ON d.SpecializationId == s.SpecializationId
                WHERE d.DoctorId == @__doctorId_0
            ) AS t
            LEFT JOIN 
            (
                SELECT d0.BranchesBranchId, d0.DoctorsDoctorId, b.BranchId, b.Address, b.BranchName, b.CreatedAt, b.Description, b.Email, b.ImageURL, b.Phone, b.UpdatedAt
                FROM DoctorBranches AS d0
                INNER JOIN Branches AS b ON d0.BranchesBranchId == b.BranchId
            ) AS t0 ON t.DoctorId == t0.DoctorsDoctorId
            LEFT JOIN Schedules AS s0 ON t.DoctorId == s0.DoctorId
            ORDER BY t.DoctorId ASC, t.Id ASC, t.SpecializationId0 ASC, t0.BranchesBranchId ASC, t0.DoctorsDoctorId ASC, t0.BranchId ASC), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Doctor>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 02:01:50.686 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:01:50.686 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:01:50.687 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:01:50.690 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:01:50.691 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:01:50.691 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:01:50.693 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 02:01:50.696 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:01:50.724 +02:00 [INF] Executed DbCommand (28ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:01:50.730 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:01:50.732 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:01:50.734 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:01:50.739 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:01:50.742 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:01:50.746 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:01:50.748 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:01:50.749 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:01:50.750 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 20ms reading results.
2025-11-24 02:01:50.751 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:01:50.752 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:01:50.764 +02:00 [DBG] Compiling query expression: 
'DbSet<Schedule>()
    .Where(s => s.DayOfWeek.ToLower() == __ToLower_0)
    .Include(s => s.Doctor)
    .ThenInclude(d => d.User)'
2025-11-24 02:01:50.766 +02:00 [DBG] Including navigation: 'Schedule.Doctor'.
2025-11-24 02:01:50.768 +02:00 [DBG] Including navigation: 'Doctor.User'.
2025-11-24 02:01:50.774 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Schedule>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Schedule.ScheduleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Schedule.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: Schedule.DayOfWeek (string) Required MaxLength(20), 2], [Property: Schedule.DoctorId (int) Required FK Index, 3], [Property: Schedule.EndTime (DateTime) Required, 4], [Property: Schedule.Shift (AppointmentShift) Required, 5], [Property: Schedule.StartTime (DateTime) Required, 6], [Property: Schedule.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 7] }
            1 -> Dictionary<IProperty, int> { [Property: Doctor.DoctorId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 8], [Property: Doctor.Available (bool?), 9], [Property: Doctor.Biography (string), 10], [Property: Doctor.ConsultationFees (decimal) Required, 11], [Property: Doctor.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 12], [Property: Doctor.ExperienceYears (int?), 13], [Property: Doctor.ImageURL (string) MaxLength(300), 14], [Property: Doctor.SpecializationId (int) Required FK Index, 15], [Property: Doctor.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 16], [Property: Doctor.UserId (string) Required FK Index, 17] }
            2 -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 18], [Property: User.AccessFailedCount (int) Required, 19], [Property: User.ConcurrencyStamp (string) Concurrency, 20], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 21], [Property: User.DateOfBirth (DateOnly?), 22], [Property: User.Email (string) Index MaxLength(256), 23], [Property: User.EmailConfirmed (bool) Required, 24], [Property: User.FullName (string) Required MaxLength(150), 25], [Property: User.Gender (GenderType?) MaxLength(10), 26], [Property: User.LockoutEnabled (bool) Required, 27], [Property: User.LockoutEnd (DateTimeOffset?), 28], [Property: User.NormalizedEmail (string) Index MaxLength(256), 29], [Property: User.NormalizedUserName (string) Index MaxLength(256), 30], [Property: User.PasswordHash (string), 31], [Property: User.PhoneNumber (string), 32], [Property: User.PhoneNumberConfirmed (bool) Required, 33], [Property: User.RefreshToken (string), 34], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 35], [Property: User.Role (string) Required MaxLength(50), 36], [Property: User.SecurityStamp (string), 37], [Property: User.TwoFactorEnabled (bool) Required, 38], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 39], [Property: User.UserName (string) MaxLength(256), 40] }
        SELECT s.ScheduleId, s.CreatedAt, s.DayOfWeek, s.DoctorId, s.EndTime, s.Shift, s.StartTime, s.UpdatedAt, d.DoctorId, d.Available, d.Biography, d.ConsultationFees, d.CreatedAt, d.ExperienceYears, d.ImageURL, d.SpecializationId, d.UpdatedAt, d.UserId, u.Id, u.AccessFailedCount, u.ConcurrencyStamp, u.CreatedAt, u.DateOfBirth, u.Email, u.EmailConfirmed, u.FullName, u.Gender, u.LockoutEnabled, u.LockoutEnd, u.NormalizedEmail, u.NormalizedUserName, u.PasswordHash, u.PhoneNumber, u.PhoneNumberConfirmed, u.RefreshToken, u.RefreshTokenExpiryTime, u.Role, u.SecurityStamp, u.TwoFactorEnabled, u.UpdatedAt, u.UserName
        FROM Schedules AS s
        INNER JOIN Doctors AS d ON s.DoctorId == d.DoctorId
        INNER JOIN Users AS u ON d.UserId == u.Id
        WHERE LOWER(s.DayOfWeek) == @__ToLower_0), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Schedule>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 02:01:50.779 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:01:50.780 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:01:50.780 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:01:50.781 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:01:50.781 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:01:50.782 +02:00 [DBG] Executing DbCommand [Parameters=[@__ToLower_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE LOWER([s].[DayOfWeek]) = @__ToLower_0
2025-11-24 02:01:50.788 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@__ToLower_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE LOWER([s].[DayOfWeek]) = @__ToLower_0
2025-11-24 02:01:50.789 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:01:50.791 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 02:01:50.793 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:01:50.795 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 02:01:50.801 +02:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Schedule.ScheduleId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:01:50.819 +02:00 [DBG] The navigation 'Schedule.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:01:50.823 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:01:50.826 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:01:50.832 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:01:50.837 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 02:01:50.841 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:01:50.846 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:01:50.854 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:01:50.855 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:01:50.856 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:01:50.857 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:01:50.859 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 02:01:50.862 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 20), @p2='?' (DbType = Int32), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = DateTime2), @p6='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Schedules] ([CreatedAt], [DayOfWeek], [DoctorId], [EndTime], [Shift], [StartTime], [UpdatedAt])
OUTPUT INSERTED.[ScheduleId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-11-24 02:01:50.875 +02:00 [INF] Executed DbCommand (13ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 20), @p2='?' (DbType = Int32), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = DateTime2), @p6='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Schedules] ([CreatedAt], [DayOfWeek], [DoctorId], [EndTime], [Shift], [StartTime], [UpdatedAt])
OUTPUT INSERTED.[ScheduleId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-11-24 02:01:50.879 +02:00 [DBG] The foreign key property 'Schedule.ScheduleId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 02:01:50.882 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:01:50.884 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 6ms reading results.
2025-11-24 02:01:50.887 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:01:50.887 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:01:50.890 +02:00 [DBG] An entity of type 'Schedule' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:01:50.891 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 02:01:50.891 +02:00 [INF] Schedule created successfully for DoctorId 1
2025-11-24 02:01:50.897 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:01:50.898 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:01:50.899 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:01:50.899 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:01:50.902 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:01:50.905 +02:00 [INF] Executing OkObjectResult, writing value of type 'Hospital.Application.DTO.Schedule.ScheduleDto'.
2025-11-24 02:01:50.909 +02:00 [INF] Executed action Hospital.Controllers.ScheduleController.Create (Hospital) in 303.8145ms
2025-11-24 02:01:50.909 +02:00 [INF] Executed endpoint 'Hospital.Controllers.ScheduleController.Create (Hospital)'
2025-11-24 02:01:50.910 +02:00 [DBG] Connection id "0HNHATCCAV4K9" completed keep alive response.
2025-11-24 02:01:50.911 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:01:50.912 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:01:50.913 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:01:50.914 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Schedule - 200 null application/json; charset=utf-8 338.7405ms
2025-11-24 02:02:04.189 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Schedule - application/json 75
2025-11-24 02:02:04.197 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Schedule'
2025-11-24 02:02:04.201 +02:00 [DBG] Endpoint 'Hospital.Controllers.ScheduleController.Create (Hospital)' with route pattern 'api/Schedule' is valid for the request path '/api/Schedule'
2025-11-24 02:02:04.203 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.ScheduleController.Create (Hospital)'
2025-11-24 02:02:04.206 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:02:04.208 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:02:04.208 +02:00 [INF] Executing endpoint 'Hospital.Controllers.ScheduleController.Create (Hospital)'
2025-11-24 02:02:04.210 +02:00 [INF] Route matched with {action = "Create", controller = "Schedule"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Hospital.Application.DTO.Schedule.ScheduleDto]] Create(Hospital.Application.DTO.Schedule.CreateScheduleDto) on controller Hospital.Controllers.ScheduleController (Hospital).
2025-11-24 02:02:04.210 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:02:04.211 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:02:04.212 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:02:04.215 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:02:04.216 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:02:04.218 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:02:04.221 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:02:04.222 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto' ...
2025-11-24 02:02:04.223 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto' using the name '' in request data ...
2025-11-24 02:02:04.224 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:02:04.225 +02:00 [DBG] Connection id "0HNHATCCAV4K9", Request id "0HNHATCCAV4K9:0000000D": started reading request body.
2025-11-24 02:02:04.226 +02:00 [DBG] Connection id "0HNHATCCAV4K9", Request id "0HNHATCCAV4K9:0000000D": done reading request body.
2025-11-24 02:02:04.226 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Schedule.CreateScheduleDto'
2025-11-24 02:02:04.227 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto'.
2025-11-24 02:02:04.227 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto'.
2025-11-24 02:02:04.229 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto' ...
2025-11-24 02:02:04.230 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto'.
2025-11-24 02:02:04.231 +02:00 [INF] create schedule  called at "2025-11-24T02:02:04.2314837+02:00"
2025-11-24 02:02:04.232 +02:00 [INF] Creating schedule for DoctorId: 1, Day: saturday, Shift: "Morning"
2025-11-24 02:02:04.234 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:02:04.235 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:02:04.236 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:02:04.237 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:02:04.238 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:02:04.239 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:02:04.239 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:02:04.240 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:02:04.241 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:02:04.261 +02:00 [INF] Executed DbCommand (20ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:02:04.268 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:02:04.269 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:02:04.270 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:02:04.270 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:02:04.271 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:02:04.272 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:02:04.273 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:02:04.275 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:02:04.277 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:02:04.278 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 9ms reading results.
2025-11-24 02:02:04.279 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:02:04.280 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:02:04.281 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:02:04.283 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:02:04.286 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:02:04.287 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:02:04.287 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:02:04.288 +02:00 [DBG] Executing DbCommand [Parameters=[@__ToLower_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE LOWER([s].[DayOfWeek]) = @__ToLower_0
2025-11-24 02:02:04.297 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[@__ToLower_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE LOWER([s].[DayOfWeek]) = @__ToLower_0
2025-11-24 02:02:04.301 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:02:04.303 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 2ms reading results.
2025-11-24 02:02:04.307 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:02:04.308 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 02:02:04.309 +02:00 [WRN] Duplicate schedule detected for DoctorId 1 on saturday shift "Morning"
2025-11-24 02:02:04.360 +02:00 [INF] Executed action Hospital.Controllers.ScheduleController.Create (Hospital) in 142.0033ms
2025-11-24 02:02:04.363 +02:00 [INF] Executed endpoint 'Hospital.Controllers.ScheduleController.Create (Hospital)'
2025-11-24 02:02:04.419 +02:00 [ERR]  Exception caught: Doctor already has a schedule for this day and shift.
System.InvalidOperationException: Doctor already has a schedule for this day and shift.
   at Hospital.Infrastructure.Services.ScheduleService.CreateAsync(CreateScheduleDto dto) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\ScheduleService.cs:line 51
   at Hospital.Controllers.ScheduleController.Create(CreateScheduleDto dto) in D:\Walaa\GP\Hospital\Hospital\Controllers\ScheduleController.cs:line 27
   at lambda_method1067(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
2025-11-24 02:02:04.434 +02:00 [DBG] Connection id "0HNHATCCAV4K9" completed keep alive response.
2025-11-24 02:02:04.437 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:02:04.438 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:02:04.440 +02:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-11-24 02:02:04.443 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Schedule - 500 null application/json 254.2905ms
2025-11-24 02:02:12.947 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Schedule - application/json 73
2025-11-24 02:02:12.950 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Schedule'
2025-11-24 02:02:12.952 +02:00 [DBG] Endpoint 'Hospital.Controllers.ScheduleController.Create (Hospital)' with route pattern 'api/Schedule' is valid for the request path '/api/Schedule'
2025-11-24 02:02:12.957 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.ScheduleController.Create (Hospital)'
2025-11-24 02:02:12.959 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:02:12.960 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:02:12.960 +02:00 [INF] Executing endpoint 'Hospital.Controllers.ScheduleController.Create (Hospital)'
2025-11-24 02:02:12.961 +02:00 [INF] Route matched with {action = "Create", controller = "Schedule"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Hospital.Application.DTO.Schedule.ScheduleDto]] Create(Hospital.Application.DTO.Schedule.CreateScheduleDto) on controller Hospital.Controllers.ScheduleController (Hospital).
2025-11-24 02:02:12.962 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:02:12.964 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:02:12.967 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:02:12.969 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:02:12.970 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:02:12.971 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:02:12.974 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:02:12.976 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto' ...
2025-11-24 02:02:12.977 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto' using the name '' in request data ...
2025-11-24 02:02:12.980 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:02:12.981 +02:00 [DBG] Connection id "0HNHATCCAV4K9", Request id "0HNHATCCAV4K9:0000000E": started reading request body.
2025-11-24 02:02:12.982 +02:00 [DBG] Connection id "0HNHATCCAV4K9", Request id "0HNHATCCAV4K9:0000000E": done reading request body.
2025-11-24 02:02:12.984 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Schedule.CreateScheduleDto'
2025-11-24 02:02:12.986 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto'.
2025-11-24 02:02:12.987 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto'.
2025-11-24 02:02:12.988 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto' ...
2025-11-24 02:02:12.991 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto'.
2025-11-24 02:02:12.992 +02:00 [INF] create schedule  called at "2025-11-24T02:02:12.9922643+02:00"
2025-11-24 02:02:12.993 +02:00 [INF] Creating schedule for DoctorId: 1, Day: friday, Shift: "Morning"
2025-11-24 02:02:12.995 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:02:12.997 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:02:12.997 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:02:12.997 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:02:12.998 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:02:12.998 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:02:12.999 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:02:13.000 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:02:13.000 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:02:13.005 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:02:13.015 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:02:13.017 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:02:13.021 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:02:13.022 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:02:13.024 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:02:13.025 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:02:13.026 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:02:13.027 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:02:13.029 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:02:13.030 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 14ms reading results.
2025-11-24 02:02:13.031 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:02:13.032 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 02:02:13.034 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:02:13.035 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:02:13.035 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:02:13.037 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:02:13.039 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-11-24 02:02:13.039 +02:00 [DBG] Executing DbCommand [Parameters=[@__ToLower_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE LOWER([s].[DayOfWeek]) = @__ToLower_0
2025-11-24 02:02:13.043 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__ToLower_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE LOWER([s].[DayOfWeek]) = @__ToLower_0
2025-11-24 02:02:13.045 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:02:13.045 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:02:13.046 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:02:13.046 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:02:13.047 +02:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Schedule.ScheduleId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:02:13.049 +02:00 [DBG] The navigation 'Schedule.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:02:13.050 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:02:13.051 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:02:13.052 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:02:13.053 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 02:02:13.053 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:02:13.054 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:02:13.055 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:02:13.055 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:02:13.056 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:02:13.057 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:02:13.057 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:02:13.058 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 20), @p2='?' (DbType = Int32), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = DateTime2), @p6='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Schedules] ([CreatedAt], [DayOfWeek], [DoctorId], [EndTime], [Shift], [StartTime], [UpdatedAt])
OUTPUT INSERTED.[ScheduleId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-11-24 02:02:13.061 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 20), @p2='?' (DbType = Int32), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = DateTime2), @p6='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Schedules] ([CreatedAt], [DayOfWeek], [DoctorId], [EndTime], [Shift], [StartTime], [UpdatedAt])
OUTPUT INSERTED.[ScheduleId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-11-24 02:02:13.062 +02:00 [DBG] The foreign key property 'Schedule.ScheduleId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 02:02:13.062 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:02:13.063 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 02:02:13.064 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:02:13.065 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:02:13.066 +02:00 [DBG] An entity of type 'Schedule' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:02:13.067 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 02:02:13.068 +02:00 [INF] Schedule created successfully for DoctorId 1
2025-11-24 02:02:13.068 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:02:13.070 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:02:13.070 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:02:13.070 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:02:13.071 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:02:13.072 +02:00 [INF] Executing OkObjectResult, writing value of type 'Hospital.Application.DTO.Schedule.ScheduleDto'.
2025-11-24 02:02:13.073 +02:00 [INF] Executed action Hospital.Controllers.ScheduleController.Create (Hospital) in 101.9146ms
2025-11-24 02:02:13.074 +02:00 [INF] Executed endpoint 'Hospital.Controllers.ScheduleController.Create (Hospital)'
2025-11-24 02:02:13.074 +02:00 [DBG] Connection id "0HNHATCCAV4K9" completed keep alive response.
2025-11-24 02:02:13.075 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:02:13.077 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:02:13.077 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:02:13.078 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Schedule - 200 null application/json; charset=utf-8 130.5925ms
2025-11-24 02:02:21.523 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Schedule - application/json 73
2025-11-24 02:02:21.526 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Schedule'
2025-11-24 02:02:21.529 +02:00 [DBG] Endpoint 'Hospital.Controllers.ScheduleController.Create (Hospital)' with route pattern 'api/Schedule' is valid for the request path '/api/Schedule'
2025-11-24 02:02:21.530 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.ScheduleController.Create (Hospital)'
2025-11-24 02:02:21.531 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:02:21.531 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:02:21.533 +02:00 [INF] Executing endpoint 'Hospital.Controllers.ScheduleController.Create (Hospital)'
2025-11-24 02:02:21.535 +02:00 [INF] Route matched with {action = "Create", controller = "Schedule"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Hospital.Application.DTO.Schedule.ScheduleDto]] Create(Hospital.Application.DTO.Schedule.CreateScheduleDto) on controller Hospital.Controllers.ScheduleController (Hospital).
2025-11-24 02:02:21.538 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:02:21.539 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:02:21.540 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:02:21.541 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:02:21.542 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:02:21.543 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:02:21.544 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:02:21.545 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto' ...
2025-11-24 02:02:21.545 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto' using the name '' in request data ...
2025-11-24 02:02:21.546 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:02:21.547 +02:00 [DBG] Connection id "0HNHATCCAV4K9", Request id "0HNHATCCAV4K9:0000000F": started reading request body.
2025-11-24 02:02:21.547 +02:00 [DBG] Connection id "0HNHATCCAV4K9", Request id "0HNHATCCAV4K9:0000000F": done reading request body.
2025-11-24 02:02:21.548 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Schedule.CreateScheduleDto'
2025-11-24 02:02:21.549 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto'.
2025-11-24 02:02:21.551 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto'.
2025-11-24 02:02:21.552 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto' ...
2025-11-24 02:02:21.553 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto'.
2025-11-24 02:02:21.554 +02:00 [INF] create schedule  called at "2025-11-24T02:02:21.5549611+02:00"
2025-11-24 02:02:21.555 +02:00 [INF] Creating schedule for DoctorId: 1, Day: friday, Shift: "Afternoon"
2025-11-24 02:02:21.557 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:02:21.559 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:02:21.559 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:02:21.560 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:02:21.561 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:02:21.561 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:02:21.563 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:02:21.564 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 02:02:21.565 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:02:21.571 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:02:21.575 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:02:21.576 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:02:21.576 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:02:21.577 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:02:21.578 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:02:21.578 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:02:21.579 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:02:21.580 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:02:21.581 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:02:21.585 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:02:21.586 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 11ms reading results.
2025-11-24 02:02:21.587 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:02:21.589 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (2ms).
2025-11-24 02:02:21.592 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:02:21.594 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:02:21.595 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:02:21.597 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:02:21.600 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2025-11-24 02:02:21.601 +02:00 [DBG] Executing DbCommand [Parameters=[@__ToLower_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE LOWER([s].[DayOfWeek]) = @__ToLower_0
2025-11-24 02:02:21.606 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__ToLower_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE LOWER([s].[DayOfWeek]) = @__ToLower_0
2025-11-24 02:02:21.608 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:02:21.608 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:02:21.609 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:02:21.610 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:02:21.610 +02:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Schedule.ScheduleId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:02:21.611 +02:00 [DBG] The navigation 'Schedule.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:02:21.612 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:02:21.615 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:02:21.617 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:02:21.620 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 02:02:21.620 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:02:21.621 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:02:21.622 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:02:21.623 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:02:21.624 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:02:21.625 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:02:21.626 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 02:02:21.627 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 20), @p2='?' (DbType = Int32), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = DateTime2), @p6='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Schedules] ([CreatedAt], [DayOfWeek], [DoctorId], [EndTime], [Shift], [StartTime], [UpdatedAt])
OUTPUT INSERTED.[ScheduleId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-11-24 02:02:21.630 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 20), @p2='?' (DbType = Int32), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = DateTime2), @p6='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Schedules] ([CreatedAt], [DayOfWeek], [DoctorId], [EndTime], [Shift], [StartTime], [UpdatedAt])
OUTPUT INSERTED.[ScheduleId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-11-24 02:02:21.634 +02:00 [DBG] The foreign key property 'Schedule.ScheduleId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 02:02:21.636 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:02:21.637 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 3ms reading results.
2025-11-24 02:02:21.638 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:02:21.638 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:02:21.639 +02:00 [DBG] An entity of type 'Schedule' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:02:21.641 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 02:02:21.641 +02:00 [INF] Schedule created successfully for DoctorId 1
2025-11-24 02:02:21.642 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:02:21.643 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:02:21.644 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:02:21.644 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:02:21.645 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:02:21.646 +02:00 [INF] Executing OkObjectResult, writing value of type 'Hospital.Application.DTO.Schedule.ScheduleDto'.
2025-11-24 02:02:21.647 +02:00 [INF] Executed action Hospital.Controllers.ScheduleController.Create (Hospital) in 103.3727ms
2025-11-24 02:02:21.647 +02:00 [INF] Executed endpoint 'Hospital.Controllers.ScheduleController.Create (Hospital)'
2025-11-24 02:02:21.648 +02:00 [DBG] Connection id "0HNHATCCAV4K9" completed keep alive response.
2025-11-24 02:02:21.651 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:02:21.652 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:02:21.652 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:02:21.654 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Schedule - 200 null application/json; charset=utf-8 130.7353ms
2025-11-24 02:02:33.093 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Schedule - null null
2025-11-24 02:02:33.095 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Schedule'
2025-11-24 02:02:33.097 +02:00 [DBG] Endpoint 'Hospital.Controllers.ScheduleController.GetAll (Hospital)' with route pattern 'api/Schedule' is valid for the request path '/api/Schedule'
2025-11-24 02:02:33.101 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.ScheduleController.GetAll (Hospital)'
2025-11-24 02:02:33.104 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:02:33.106 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:02:33.107 +02:00 [INF] Executing endpoint 'Hospital.Controllers.ScheduleController.GetAll (Hospital)'
2025-11-24 02:02:33.110 +02:00 [INF] Route matched with {action = "GetAll", controller = "Schedule"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IEnumerable`1[Hospital.Application.DTO.Schedule.ScheduleDto]]] GetAll() on controller Hospital.Controllers.ScheduleController (Hospital).
2025-11-24 02:02:33.111 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:02:33.112 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:02:33.113 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:02:33.114 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:02:33.115 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:02:33.116 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:02:33.117 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:02:33.118 +02:00 [INF] get all schedule called at "2025-11-24T02:02:33.1188246+02:00"
2025-11-24 02:02:33.119 +02:00 [INF] Fetching all schedules
2025-11-24 02:02:33.121 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:02:33.123 +02:00 [DBG] Compiling query expression: 
'DbSet<Schedule>()
    .Include(s => s.Doctor)
    .ThenInclude(d => d.User)'
2025-11-24 02:02:33.124 +02:00 [DBG] Including navigation: 'Schedule.Doctor'.
2025-11-24 02:02:33.125 +02:00 [DBG] Including navigation: 'Doctor.User'.
2025-11-24 02:02:33.130 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Schedule>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Schedule.ScheduleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Schedule.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: Schedule.DayOfWeek (string) Required MaxLength(20), 2], [Property: Schedule.DoctorId (int) Required FK Index, 3], [Property: Schedule.EndTime (DateTime) Required, 4], [Property: Schedule.Shift (AppointmentShift) Required, 5], [Property: Schedule.StartTime (DateTime) Required, 6], [Property: Schedule.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 7] }
            1 -> Dictionary<IProperty, int> { [Property: Doctor.DoctorId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 8], [Property: Doctor.Available (bool?), 9], [Property: Doctor.Biography (string), 10], [Property: Doctor.ConsultationFees (decimal) Required, 11], [Property: Doctor.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 12], [Property: Doctor.ExperienceYears (int?), 13], [Property: Doctor.ImageURL (string) MaxLength(300), 14], [Property: Doctor.SpecializationId (int) Required FK Index, 15], [Property: Doctor.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 16], [Property: Doctor.UserId (string) Required FK Index, 17] }
            2 -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 18], [Property: User.AccessFailedCount (int) Required, 19], [Property: User.ConcurrencyStamp (string) Concurrency, 20], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 21], [Property: User.DateOfBirth (DateOnly?), 22], [Property: User.Email (string) Index MaxLength(256), 23], [Property: User.EmailConfirmed (bool) Required, 24], [Property: User.FullName (string) Required MaxLength(150), 25], [Property: User.Gender (GenderType?) MaxLength(10), 26], [Property: User.LockoutEnabled (bool) Required, 27], [Property: User.LockoutEnd (DateTimeOffset?), 28], [Property: User.NormalizedEmail (string) Index MaxLength(256), 29], [Property: User.NormalizedUserName (string) Index MaxLength(256), 30], [Property: User.PasswordHash (string), 31], [Property: User.PhoneNumber (string), 32], [Property: User.PhoneNumberConfirmed (bool) Required, 33], [Property: User.RefreshToken (string), 34], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 35], [Property: User.Role (string) Required MaxLength(50), 36], [Property: User.SecurityStamp (string), 37], [Property: User.TwoFactorEnabled (bool) Required, 38], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 39], [Property: User.UserName (string) MaxLength(256), 40] }
        SELECT s.ScheduleId, s.CreatedAt, s.DayOfWeek, s.DoctorId, s.EndTime, s.Shift, s.StartTime, s.UpdatedAt, d.DoctorId, d.Available, d.Biography, d.ConsultationFees, d.CreatedAt, d.ExperienceYears, d.ImageURL, d.SpecializationId, d.UpdatedAt, d.UserId, u.Id, u.AccessFailedCount, u.ConcurrencyStamp, u.CreatedAt, u.DateOfBirth, u.Email, u.EmailConfirmed, u.FullName, u.Gender, u.LockoutEnabled, u.LockoutEnd, u.NormalizedEmail, u.NormalizedUserName, u.PasswordHash, u.PhoneNumber, u.PhoneNumberConfirmed, u.RefreshToken, u.RefreshTokenExpiryTime, u.Role, u.SecurityStamp, u.TwoFactorEnabled, u.UpdatedAt, u.UserName
        FROM Schedules AS s
        INNER JOIN Doctors AS d ON s.DoctorId == d.DoctorId
        INNER JOIN Users AS u ON d.UserId == u.Id), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Schedule>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 02:02:33.137 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:02:33.137 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:02:33.138 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:02:33.139 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:02:33.140 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:02:33.140 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:02:33.140 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:02:33.141 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
2025-11-24 02:02:33.148 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
2025-11-24 02:02:33.152 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:02:33.153 +02:00 [DBG] The navigation 'Schedule.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:02:33.155 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:02:33.157 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:02:33.158 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:02:33.159 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:02:33.162 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:02:33.165 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:02:33.168 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 15ms reading results.
2025-11-24 02:02:33.169 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:02:33.171 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (2ms).
2025-11-24 02:02:33.181 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:02:33.187 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:02:33.188 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:02:33.188 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:02:33.189 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:02:33.190 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Schedule.ScheduleDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 02:02:33.196 +02:00 [INF] Executed action Hospital.Controllers.ScheduleController.GetAll (Hospital) in 79.9048ms
2025-11-24 02:02:33.201 +02:00 [INF] Executed endpoint 'Hospital.Controllers.ScheduleController.GetAll (Hospital)'
2025-11-24 02:02:33.204 +02:00 [DBG] Connection id "0HNHATCCAV4K9" completed keep alive response.
2025-11-24 02:02:33.207 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:02:33.209 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:02:33.210 +02:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-11-24 02:02:33.212 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Schedule - 200 null application/json; charset=utf-8 119.1329ms
2025-11-24 02:02:44.693 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Schedule/1 - null null
2025-11-24 02:02:44.696 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Schedule/1'
2025-11-24 02:02:44.699 +02:00 [DBG] Endpoint 'Hospital.Controllers.ScheduleController.GetById (Hospital)' with route pattern 'api/Schedule/{id}' is valid for the request path '/api/Schedule/1'
2025-11-24 02:02:44.700 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.ScheduleController.GetById (Hospital)'
2025-11-24 02:02:44.701 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:02:44.702 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:02:44.704 +02:00 [INF] Executing endpoint 'Hospital.Controllers.ScheduleController.GetById (Hospital)'
2025-11-24 02:02:44.707 +02:00 [INF] Route matched with {action = "GetById", controller = "Schedule"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Hospital.Application.DTO.Schedule.ScheduleDto]] GetById(Int32) on controller Hospital.Controllers.ScheduleController (Hospital).
2025-11-24 02:02:44.708 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:02:44.709 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:02:44.711 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:02:44.712 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:02:44.713 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:02:44.714 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:02:44.715 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:02:44.716 +02:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-11-24 02:02:44.717 +02:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-11-24 02:02:44.718 +02:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-11-24 02:02:44.719 +02:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-11-24 02:02:44.719 +02:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-11-24 02:02:44.720 +02:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-11-24 02:02:44.722 +02:00 [INF] get schedule by id called at "2025-11-24T02:02:44.7219772+02:00"
2025-11-24 02:02:44.723 +02:00 [INF] Fetching schedule with ScheduleId: 1
2025-11-24 02:02:44.726 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:02:44.728 +02:00 [DBG] Compiling query expression: 
'DbSet<Schedule>()
    .Include(s => s.Doctor)
    .ThenInclude(d => d.User)
    .FirstOrDefault(s => s.ScheduleId == __scheduleId_0)'
2025-11-24 02:02:44.729 +02:00 [DBG] Including navigation: 'Schedule.Doctor'.
2025-11-24 02:02:44.731 +02:00 [DBG] Including navigation: 'Doctor.User'.
2025-11-24 02:02:44.737 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Schedule>(
    asyncEnumerable: new SingleQueryingEnumerable<Schedule>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Schedule.ScheduleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Schedule.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: Schedule.DayOfWeek (string) Required MaxLength(20), 2], [Property: Schedule.DoctorId (int) Required FK Index, 3], [Property: Schedule.EndTime (DateTime) Required, 4], [Property: Schedule.Shift (AppointmentShift) Required, 5], [Property: Schedule.StartTime (DateTime) Required, 6], [Property: Schedule.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 7] }
                1 -> Dictionary<IProperty, int> { [Property: Doctor.DoctorId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 8], [Property: Doctor.Available (bool?), 9], [Property: Doctor.Biography (string), 10], [Property: Doctor.ConsultationFees (decimal) Required, 11], [Property: Doctor.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 12], [Property: Doctor.ExperienceYears (int?), 13], [Property: Doctor.ImageURL (string) MaxLength(300), 14], [Property: Doctor.SpecializationId (int) Required FK Index, 15], [Property: Doctor.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 16], [Property: Doctor.UserId (string) Required FK Index, 17] }
                2 -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 18], [Property: User.AccessFailedCount (int) Required, 19], [Property: User.ConcurrencyStamp (string) Concurrency, 20], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 21], [Property: User.DateOfBirth (DateOnly?), 22], [Property: User.Email (string) Index MaxLength(256), 23], [Property: User.EmailConfirmed (bool) Required, 24], [Property: User.FullName (string) Required MaxLength(150), 25], [Property: User.Gender (GenderType?) MaxLength(10), 26], [Property: User.LockoutEnabled (bool) Required, 27], [Property: User.LockoutEnd (DateTimeOffset?), 28], [Property: User.NormalizedEmail (string) Index MaxLength(256), 29], [Property: User.NormalizedUserName (string) Index MaxLength(256), 30], [Property: User.PasswordHash (string), 31], [Property: User.PhoneNumber (string), 32], [Property: User.PhoneNumberConfirmed (bool) Required, 33], [Property: User.RefreshToken (string), 34], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 35], [Property: User.Role (string) Required MaxLength(50), 36], [Property: User.SecurityStamp (string), 37], [Property: User.TwoFactorEnabled (bool) Required, 38], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 39], [Property: User.UserName (string) MaxLength(256), 40] }
            SELECT TOP(1) s.ScheduleId, s.CreatedAt, s.DayOfWeek, s.DoctorId, s.EndTime, s.Shift, s.StartTime, s.UpdatedAt, d.DoctorId, d.Available, d.Biography, d.ConsultationFees, d.CreatedAt, d.ExperienceYears, d.ImageURL, d.SpecializationId, d.UpdatedAt, d.UserId, u.Id, u.AccessFailedCount, u.ConcurrencyStamp, u.CreatedAt, u.DateOfBirth, u.Email, u.EmailConfirmed, u.FullName, u.Gender, u.LockoutEnabled, u.LockoutEnd, u.NormalizedEmail, u.NormalizedUserName, u.PasswordHash, u.PhoneNumber, u.PhoneNumberConfirmed, u.RefreshToken, u.RefreshTokenExpiryTime, u.Role, u.SecurityStamp, u.TwoFactorEnabled, u.UpdatedAt, u.UserName
            FROM Schedules AS s
            INNER JOIN Doctors AS d ON s.DoctorId == d.DoctorId
            INNER JOIN Users AS u ON d.UserId == u.Id
            WHERE s.ScheduleId == @__scheduleId_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Schedule>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 02:02:44.741 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:02:44.741 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:02:44.742 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:02:44.744 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:02:44.745 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:02:44.746 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:02:44.747 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:02:44.748 +02:00 [DBG] Executing DbCommand [Parameters=[@__scheduleId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE [s].[ScheduleId] = @__scheduleId_0
2025-11-24 02:02:44.759 +02:00 [INF] Executed DbCommand (11ms) [Parameters=[@__scheduleId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE [s].[ScheduleId] = @__scheduleId_0
2025-11-24 02:02:44.762 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:02:44.763 +02:00 [DBG] The navigation 'Schedule.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:02:44.764 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:02:44.765 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:02:44.766 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:02:44.767 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:02:44.768 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 6ms reading results.
2025-11-24 02:02:44.769 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:02:44.769 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:02:44.771 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:02:44.773 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:02:44.773 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:02:44.774 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:02:44.775 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:02:44.776 +02:00 [INF] Executing OkObjectResult, writing value of type 'Hospital.Application.DTO.Schedule.ScheduleDto'.
2025-11-24 02:02:44.777 +02:00 [INF] Executed action Hospital.Controllers.ScheduleController.GetById (Hospital) in 62.9647ms
2025-11-24 02:02:44.778 +02:00 [INF] Executed endpoint 'Hospital.Controllers.ScheduleController.GetById (Hospital)'
2025-11-24 02:02:44.778 +02:00 [DBG] Connection id "0HNHATCCAV4K9" completed keep alive response.
2025-11-24 02:02:44.779 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:02:44.780 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:02:44.782 +02:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-11-24 02:02:44.782 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Schedule/1 - 200 null application/json; charset=utf-8 89.9219ms
2025-11-24 02:02:49.024 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Schedule/9 - null null
2025-11-24 02:02:49.027 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Schedule/9'
2025-11-24 02:02:49.028 +02:00 [DBG] Endpoint 'Hospital.Controllers.ScheduleController.GetById (Hospital)' with route pattern 'api/Schedule/{id}' is valid for the request path '/api/Schedule/9'
2025-11-24 02:02:49.031 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.ScheduleController.GetById (Hospital)'
2025-11-24 02:02:49.034 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:02:49.036 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:02:49.037 +02:00 [INF] Executing endpoint 'Hospital.Controllers.ScheduleController.GetById (Hospital)'
2025-11-24 02:02:49.038 +02:00 [INF] Route matched with {action = "GetById", controller = "Schedule"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Hospital.Application.DTO.Schedule.ScheduleDto]] GetById(Int32) on controller Hospital.Controllers.ScheduleController (Hospital).
2025-11-24 02:02:49.040 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:02:49.041 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:02:49.042 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:02:49.046 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:02:49.048 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:02:49.049 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:02:49.050 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:02:49.051 +02:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-11-24 02:02:49.051 +02:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-11-24 02:02:49.052 +02:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-11-24 02:02:49.053 +02:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-11-24 02:02:49.054 +02:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-11-24 02:02:49.055 +02:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-11-24 02:02:49.056 +02:00 [INF] get schedule by id called at "2025-11-24T02:02:49.0563280+02:00"
2025-11-24 02:02:49.056 +02:00 [INF] Fetching schedule with ScheduleId: 9
2025-11-24 02:02:49.058 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:02:49.059 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:02:49.059 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:02:49.060 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:02:49.060 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:02:49.061 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:02:49.062 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:02:49.063 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:02:49.064 +02:00 [DBG] Executing DbCommand [Parameters=[@__scheduleId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE [s].[ScheduleId] = @__scheduleId_0
2025-11-24 02:02:49.068 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__scheduleId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE [s].[ScheduleId] = @__scheduleId_0
2025-11-24 02:02:49.074 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:02:49.074 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:02:49.075 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:02:49.076 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:02:49.078 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:02:49.079 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:02:49.080 +02:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2025-11-24 02:02:49.081 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2025-11-24 02:02:49.082 +02:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-11-24 02:02:49.083 +02:00 [INF] Executed action Hospital.Controllers.ScheduleController.GetById (Hospital) in 34.5061ms
2025-11-24 02:02:49.084 +02:00 [INF] Executed endpoint 'Hospital.Controllers.ScheduleController.GetById (Hospital)'
2025-11-24 02:02:49.085 +02:00 [DBG] Connection id "0HNHATCCAV4K9" completed keep alive response.
2025-11-24 02:02:49.086 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:02:49.087 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:02:49.087 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:02:49.088 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Schedule/9 - 404 null application/problem+json; charset=utf-8 64.2561ms
2025-11-24 02:03:00.951 +02:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7217/api/Schedule - application/json 75
2025-11-24 02:03:00.956 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Schedule'
2025-11-24 02:03:00.957 +02:00 [DBG] Endpoint 'Hospital.Controllers.ScheduleController.Update (Hospital)' with route pattern 'api/Schedule' is valid for the request path '/api/Schedule'
2025-11-24 02:03:00.959 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.ScheduleController.Update (Hospital)'
2025-11-24 02:03:00.959 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:03:00.959 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:03:00.960 +02:00 [INF] Executing endpoint 'Hospital.Controllers.ScheduleController.Update (Hospital)'
2025-11-24 02:03:00.963 +02:00 [INF] Route matched with {action = "Update", controller = "Schedule"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Hospital.Application.DTO.Schedule.ScheduleDto]] Update(Hospital.Application.DTO.Schedule.UpdateScheduleDto) on controller Hospital.Controllers.ScheduleController (Hospital).
2025-11-24 02:03:00.970 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:03:00.973 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:03:00.974 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:03:00.976 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:03:00.977 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:03:00.978 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:03:00.980 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:03:00.981 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.UpdateScheduleDto' ...
2025-11-24 02:03:00.982 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.UpdateScheduleDto' using the name '' in request data ...
2025-11-24 02:03:00.983 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:03:00.988 +02:00 [DBG] Connection id "0HNHATCCAV4K9", Request id "0HNHATCCAV4K9:00000013": started reading request body.
2025-11-24 02:03:00.989 +02:00 [DBG] Connection id "0HNHATCCAV4K9", Request id "0HNHATCCAV4K9:00000013": done reading request body.
2025-11-24 02:03:00.992 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Schedule.UpdateScheduleDto'
2025-11-24 02:03:00.993 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.UpdateScheduleDto'.
2025-11-24 02:03:00.994 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.UpdateScheduleDto'.
2025-11-24 02:03:00.996 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Schedule.UpdateScheduleDto' ...
2025-11-24 02:03:00.999 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Schedule.UpdateScheduleDto'.
2025-11-24 02:03:01.001 +02:00 [INF] update schedule  called at "2025-11-24T02:03:01.0011970+02:00"
2025-11-24 02:03:01.003 +02:00 [INF] Updating schedule with ScheduleId: 1
2025-11-24 02:03:01.004 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:03:01.006 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:03:01.007 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:03:01.007 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:03:01.008 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:03:01.009 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:03:01.009 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:03:01.010 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:03:01.011 +02:00 [DBG] Executing DbCommand [Parameters=[@__scheduleId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE [s].[ScheduleId] = @__scheduleId_0
2025-11-24 02:03:01.014 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__scheduleId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE [s].[ScheduleId] = @__scheduleId_0
2025-11-24 02:03:01.016 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:03:01.018 +02:00 [DBG] The navigation 'Schedule.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:03:01.019 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:03:01.019 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:03:01.020 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:03:01.021 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:03:01.022 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 5ms reading results.
2025-11-24 02:03:01.023 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:03:01.025 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 02:03:01.027 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:03:01.028 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:03:01.028 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:03:01.029 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:03:01.029 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:03:01.030 +02:00 [DBG] Executing DbCommand [Parameters=[@__ToLower_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE LOWER([s].[DayOfWeek]) = @__ToLower_0
2025-11-24 02:03:01.037 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@__ToLower_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE LOWER([s].[DayOfWeek]) = @__ToLower_0
2025-11-24 02:03:01.038 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:03:01.039 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:03:01.040 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:03:01.041 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:03:01.044 +02:00 [DBG] An entity of type 'Schedule' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:03:01.045 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:03:01.045 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:03:01.046 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 02:03:01.047 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:03:01.048 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:03:01.049 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:03:01.050 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:03:01.051 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:03:01.051 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:03:01.052 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:03:01.053 +02:00 [DBG] Executing DbCommand [Parameters=[@p7='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (Size = 20), @p2='?' (DbType = Int32), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = DateTime2), @p6='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Schedules] SET [CreatedAt] = @p0, [DayOfWeek] = @p1, [DoctorId] = @p2, [EndTime] = @p3, [Shift] = @p4, [StartTime] = @p5, [UpdatedAt] = @p6
OUTPUT 1
WHERE [ScheduleId] = @p7;
2025-11-24 02:03:01.058 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p7='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (Size = 20), @p2='?' (DbType = Int32), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = DateTime2), @p6='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Schedules] SET [CreatedAt] = @p0, [DayOfWeek] = @p1, [DoctorId] = @p2, [EndTime] = @p3, [Shift] = @p4, [StartTime] = @p5, [UpdatedAt] = @p6
OUTPUT 1
WHERE [ScheduleId] = @p7;
2025-11-24 02:03:01.059 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:03:01.060 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:03:01.061 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:03:01.061 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:03:01.062 +02:00 [DBG] An entity of type 'Schedule' tracked by 'AppDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:03:01.065 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 02:03:01.066 +02:00 [INF] Schedule with ScheduleId 1 updated successfully
2025-11-24 02:03:01.067 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:03:01.068 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:03:01.068 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:03:01.069 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:03:01.070 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:03:01.072 +02:00 [INF] Executing OkObjectResult, writing value of type 'Hospital.Application.DTO.Schedule.ScheduleDto'.
2025-11-24 02:03:01.074 +02:00 [INF] Executed action Hospital.Controllers.ScheduleController.Update (Hospital) in 96.2714ms
2025-11-24 02:03:01.077 +02:00 [INF] Executed endpoint 'Hospital.Controllers.ScheduleController.Update (Hospital)'
2025-11-24 02:03:01.078 +02:00 [DBG] Connection id "0HNHATCCAV4K9" completed keep alive response.
2025-11-24 02:03:01.080 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:03:01.083 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:03:01.087 +02:00 [DBG] Disposed connection to database '' on server '' (3ms).
2025-11-24 02:03:01.089 +02:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7217/api/Schedule - 200 null application/json; charset=utf-8 138.3783ms
2025-11-24 02:03:11.143 +02:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7217/api/Schedule - application/json 76
2025-11-24 02:03:11.151 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Schedule'
2025-11-24 02:03:11.156 +02:00 [DBG] Endpoint 'Hospital.Controllers.ScheduleController.Update (Hospital)' with route pattern 'api/Schedule' is valid for the request path '/api/Schedule'
2025-11-24 02:03:11.158 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.ScheduleController.Update (Hospital)'
2025-11-24 02:03:11.159 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:03:11.161 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:03:11.161 +02:00 [INF] Executing endpoint 'Hospital.Controllers.ScheduleController.Update (Hospital)'
2025-11-24 02:03:11.164 +02:00 [INF] Route matched with {action = "Update", controller = "Schedule"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Hospital.Application.DTO.Schedule.ScheduleDto]] Update(Hospital.Application.DTO.Schedule.UpdateScheduleDto) on controller Hospital.Controllers.ScheduleController (Hospital).
2025-11-24 02:03:11.165 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:03:11.167 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:03:11.168 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:03:11.170 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:03:11.171 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:03:11.174 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:03:11.175 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:03:11.176 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.UpdateScheduleDto' ...
2025-11-24 02:03:11.176 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.UpdateScheduleDto' using the name '' in request data ...
2025-11-24 02:03:11.178 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:03:11.181 +02:00 [DBG] Connection id "0HNHATCCAV4K9", Request id "0HNHATCCAV4K9:00000014": started reading request body.
2025-11-24 02:03:11.182 +02:00 [DBG] Connection id "0HNHATCCAV4K9", Request id "0HNHATCCAV4K9:00000014": done reading request body.
2025-11-24 02:03:11.184 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Schedule.UpdateScheduleDto'
2025-11-24 02:03:11.185 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.UpdateScheduleDto'.
2025-11-24 02:03:11.186 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.UpdateScheduleDto'.
2025-11-24 02:03:11.187 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Schedule.UpdateScheduleDto' ...
2025-11-24 02:03:11.188 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Schedule.UpdateScheduleDto'.
2025-11-24 02:03:11.189 +02:00 [INF] update schedule  called at "2025-11-24T02:03:11.1897398+02:00"
2025-11-24 02:03:11.190 +02:00 [INF] Updating schedule with ScheduleId: 1
2025-11-24 02:03:11.191 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:03:11.195 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:03:11.196 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:03:11.196 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:03:11.197 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:03:11.198 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:03:11.198 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:03:11.199 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:03:11.200 +02:00 [DBG] Executing DbCommand [Parameters=[@__scheduleId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE [s].[ScheduleId] = @__scheduleId_0
2025-11-24 02:03:11.203 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__scheduleId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE [s].[ScheduleId] = @__scheduleId_0
2025-11-24 02:03:11.206 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:03:11.207 +02:00 [DBG] The navigation 'Schedule.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:03:11.208 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:03:11.209 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:03:11.210 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:03:11.211 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:03:11.212 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 6ms reading results.
2025-11-24 02:03:11.213 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:03:11.214 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 02:03:11.216 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:03:11.217 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:03:11.218 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:03:11.219 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:03:11.219 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:03:11.221 +02:00 [DBG] Executing DbCommand [Parameters=[@__ToLower_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE LOWER([s].[DayOfWeek]) = @__ToLower_0
2025-11-24 02:03:11.226 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__ToLower_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE LOWER([s].[DayOfWeek]) = @__ToLower_0
2025-11-24 02:03:11.232 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:03:11.232 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:03:11.234 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:03:11.235 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 02:03:11.236 +02:00 [DBG] An entity of type 'Schedule' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:03:11.238 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:03:11.239 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:03:11.241 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 02:03:11.241 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:03:11.242 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:03:11.244 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:03:11.245 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:03:11.246 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:03:11.248 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-11-24 02:03:11.249 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-11-24 02:03:11.250 +02:00 [DBG] Executing DbCommand [Parameters=[@p7='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (Size = 20), @p2='?' (DbType = Int32), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = DateTime2), @p6='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Schedules] SET [CreatedAt] = @p0, [DayOfWeek] = @p1, [DoctorId] = @p2, [EndTime] = @p3, [Shift] = @p4, [StartTime] = @p5, [UpdatedAt] = @p6
OUTPUT 1
WHERE [ScheduleId] = @p7;
2025-11-24 02:03:11.259 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[@p7='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (Size = 20), @p2='?' (DbType = Int32), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = DateTime2), @p6='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Schedules] SET [CreatedAt] = @p0, [DayOfWeek] = @p1, [DoctorId] = @p2, [EndTime] = @p3, [Shift] = @p4, [StartTime] = @p5, [UpdatedAt] = @p6
OUTPUT 1
WHERE [ScheduleId] = @p7;
2025-11-24 02:03:11.261 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:03:11.262 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 02:03:11.265 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:03:11.266 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 02:03:11.268 +02:00 [DBG] An entity of type 'Schedule' tracked by 'AppDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:03:11.272 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 02:03:11.274 +02:00 [INF] Schedule with ScheduleId 1 updated successfully
2025-11-24 02:03:11.276 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:03:11.278 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:03:11.278 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:03:11.279 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:03:11.279 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:03:11.280 +02:00 [INF] Executing OkObjectResult, writing value of type 'Hospital.Application.DTO.Schedule.ScheduleDto'.
2025-11-24 02:03:11.281 +02:00 [INF] Executed action Hospital.Controllers.ScheduleController.Update (Hospital) in 106.9898ms
2025-11-24 02:03:11.282 +02:00 [INF] Executed endpoint 'Hospital.Controllers.ScheduleController.Update (Hospital)'
2025-11-24 02:03:11.282 +02:00 [DBG] Connection id "0HNHATCCAV4K9" completed keep alive response.
2025-11-24 02:03:11.284 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:03:11.284 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:03:11.285 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:03:11.286 +02:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7217/api/Schedule - 200 null application/json; charset=utf-8 143.4805ms
2025-11-24 02:04:00.103 +02:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7217/api/Schedule - application/json 76
2025-11-24 02:04:00.119 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Schedule'
2025-11-24 02:04:00.121 +02:00 [DBG] Endpoint 'Hospital.Controllers.ScheduleController.Update (Hospital)' with route pattern 'api/Schedule' is valid for the request path '/api/Schedule'
2025-11-24 02:04:00.124 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.ScheduleController.Update (Hospital)'
2025-11-24 02:04:00.127 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:04:00.128 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:04:00.130 +02:00 [INF] Executing endpoint 'Hospital.Controllers.ScheduleController.Update (Hospital)'
2025-11-24 02:04:00.131 +02:00 [INF] Route matched with {action = "Update", controller = "Schedule"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Hospital.Application.DTO.Schedule.ScheduleDto]] Update(Hospital.Application.DTO.Schedule.UpdateScheduleDto) on controller Hospital.Controllers.ScheduleController (Hospital).
2025-11-24 02:04:00.133 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:04:00.133 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:04:00.134 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:04:00.135 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:04:00.136 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:04:00.136 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:04:00.138 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:04:00.138 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.UpdateScheduleDto' ...
2025-11-24 02:04:00.139 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.UpdateScheduleDto' using the name '' in request data ...
2025-11-24 02:04:00.140 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:04:00.141 +02:00 [DBG] Connection id "0HNHATCCAV4K9", Request id "0HNHATCCAV4K9:00000015": started reading request body.
2025-11-24 02:04:00.141 +02:00 [DBG] Connection id "0HNHATCCAV4K9", Request id "0HNHATCCAV4K9:00000015": done reading request body.
2025-11-24 02:04:00.142 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Schedule.UpdateScheduleDto'
2025-11-24 02:04:00.143 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.UpdateScheduleDto'.
2025-11-24 02:04:00.144 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.UpdateScheduleDto'.
2025-11-24 02:04:00.144 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Schedule.UpdateScheduleDto' ...
2025-11-24 02:04:00.146 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Schedule.UpdateScheduleDto'.
2025-11-24 02:04:00.146 +02:00 [INF] update schedule  called at "2025-11-24T02:04:00.1468690+02:00"
2025-11-24 02:04:00.147 +02:00 [INF] Updating schedule with ScheduleId: 10
2025-11-24 02:04:00.148 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:04:00.149 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:04:00.149 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:04:00.150 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:04:00.151 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:04:00.151 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:04:00.152 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:04:00.152 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:04:00.153 +02:00 [DBG] Executing DbCommand [Parameters=[@__scheduleId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE [s].[ScheduleId] = @__scheduleId_0
2025-11-24 02:04:00.160 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[@__scheduleId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE [s].[ScheduleId] = @__scheduleId_0
2025-11-24 02:04:00.162 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:04:00.163 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 02:04:00.163 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:04:00.164 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:04:00.165 +02:00 [WRN] Schedule with ID 10 not found
2025-11-24 02:04:00.206 +02:00 [INF] Executed action Hospital.Controllers.ScheduleController.Update (Hospital) in 69.2694ms
2025-11-24 02:04:00.208 +02:00 [INF] Executed endpoint 'Hospital.Controllers.ScheduleController.Update (Hospital)'
2025-11-24 02:04:00.275 +02:00 [ERR]  Exception caught: Schedule not found.
System.Collections.Generic.KeyNotFoundException: Schedule not found.
   at Hospital.Infrastructure.Services.ScheduleService.UpdateAsync(UpdateScheduleDto dto) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\ScheduleService.cs:line 76
   at Hospital.Controllers.ScheduleController.Update(UpdateScheduleDto dto) in D:\Walaa\GP\Hospital\Hospital\Controllers\ScheduleController.cs:line 37
   at lambda_method1234(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
2025-11-24 02:04:00.296 +02:00 [DBG] Connection id "0HNHATCCAV4K9" completed keep alive response.
2025-11-24 02:04:00.297 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:04:00.298 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:04:00.301 +02:00 [DBG] Disposed connection to database '' on server '' (2ms).
2025-11-24 02:04:00.304 +02:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7217/api/Schedule - 404 null application/json 200.3069ms
2025-11-24 02:04:08.048 +02:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7217/api/Schedule - application/json 75
2025-11-24 02:04:08.050 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Schedule'
2025-11-24 02:04:08.052 +02:00 [DBG] Endpoint 'Hospital.Controllers.ScheduleController.Update (Hospital)' with route pattern 'api/Schedule' is valid for the request path '/api/Schedule'
2025-11-24 02:04:08.055 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.ScheduleController.Update (Hospital)'
2025-11-24 02:04:08.057 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:04:08.058 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:04:08.060 +02:00 [INF] Executing endpoint 'Hospital.Controllers.ScheduleController.Update (Hospital)'
2025-11-24 02:04:08.062 +02:00 [INF] Route matched with {action = "Update", controller = "Schedule"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Hospital.Application.DTO.Schedule.ScheduleDto]] Update(Hospital.Application.DTO.Schedule.UpdateScheduleDto) on controller Hospital.Controllers.ScheduleController (Hospital).
2025-11-24 02:04:08.068 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:04:08.070 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:04:08.075 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:04:08.080 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:04:08.082 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:04:08.084 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:04:08.086 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:04:08.086 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.UpdateScheduleDto' ...
2025-11-24 02:04:08.087 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.UpdateScheduleDto' using the name '' in request data ...
2025-11-24 02:04:08.088 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:04:08.089 +02:00 [DBG] Connection id "0HNHATCCAV4K9", Request id "0HNHATCCAV4K9:00000016": started reading request body.
2025-11-24 02:04:08.090 +02:00 [DBG] Connection id "0HNHATCCAV4K9", Request id "0HNHATCCAV4K9:00000016": done reading request body.
2025-11-24 02:04:08.092 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Schedule.UpdateScheduleDto'
2025-11-24 02:04:08.093 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.UpdateScheduleDto'.
2025-11-24 02:04:08.094 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.UpdateScheduleDto'.
2025-11-24 02:04:08.095 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Schedule.UpdateScheduleDto' ...
2025-11-24 02:04:08.097 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Schedule.UpdateScheduleDto'.
2025-11-24 02:04:08.098 +02:00 [INF] update schedule  called at "2025-11-24T02:04:08.0986434+02:00"
2025-11-24 02:04:08.099 +02:00 [INF] Updating schedule with ScheduleId: 1
2025-11-24 02:04:08.100 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:04:08.103 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:04:08.104 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:04:08.105 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:04:08.106 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:04:08.107 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:04:08.108 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:04:08.109 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 02:04:08.110 +02:00 [DBG] Executing DbCommand [Parameters=[@__scheduleId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE [s].[ScheduleId] = @__scheduleId_0
2025-11-24 02:04:08.116 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@__scheduleId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE [s].[ScheduleId] = @__scheduleId_0
2025-11-24 02:04:08.125 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:04:08.126 +02:00 [DBG] The navigation 'Schedule.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:04:08.129 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:04:08.130 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:04:08.130 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:04:08.131 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:04:08.132 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 6ms reading results.
2025-11-24 02:04:08.133 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:04:08.133 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:04:08.172 +02:00 [INF] Executed action Hospital.Controllers.ScheduleController.Update (Hospital) in 87.9803ms
2025-11-24 02:04:08.175 +02:00 [INF] Executed endpoint 'Hospital.Controllers.ScheduleController.Update (Hospital)'
2025-11-24 02:04:08.231 +02:00 [ERR]  Exception caught: Invalid appointment shift.
System.ArgumentException: Invalid appointment shift.
   at Hospital.Infrastructure.Services.ScheduleService.UpdateAsync(UpdateScheduleDto dto) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\ScheduleService.cs:line 82
   at Hospital.Controllers.ScheduleController.Update(UpdateScheduleDto dto) in D:\Walaa\GP\Hospital\Hospital\Controllers\ScheduleController.cs:line 37
   at lambda_method1234(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
2025-11-24 02:04:08.246 +02:00 [DBG] Connection id "0HNHATCCAV4K9" completed keep alive response.
2025-11-24 02:04:08.252 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:04:08.255 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:04:08.257 +02:00 [DBG] Disposed connection to database '' on server '' (2ms).
2025-11-24 02:04:08.259 +02:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7217/api/Schedule - 400 null application/json 211.1731ms
2025-11-24 02:04:28.601 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Schedule - application/json 71
2025-11-24 02:04:28.605 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Schedule'
2025-11-24 02:04:28.606 +02:00 [DBG] Endpoint 'Hospital.Controllers.ScheduleController.Create (Hospital)' with route pattern 'api/Schedule' is valid for the request path '/api/Schedule'
2025-11-24 02:04:28.611 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.ScheduleController.Create (Hospital)'
2025-11-24 02:04:28.612 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:04:28.613 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:04:28.615 +02:00 [INF] Executing endpoint 'Hospital.Controllers.ScheduleController.Create (Hospital)'
2025-11-24 02:04:28.617 +02:00 [INF] Route matched with {action = "Create", controller = "Schedule"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Hospital.Application.DTO.Schedule.ScheduleDto]] Create(Hospital.Application.DTO.Schedule.CreateScheduleDto) on controller Hospital.Controllers.ScheduleController (Hospital).
2025-11-24 02:04:28.619 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:04:28.621 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:04:28.625 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:04:28.628 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:04:28.629 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:04:28.629 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:04:28.630 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:04:28.633 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto' ...
2025-11-24 02:04:28.635 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto' using the name '' in request data ...
2025-11-24 02:04:28.637 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:04:28.637 +02:00 [DBG] Connection id "0HNHATCCAV4K9", Request id "0HNHATCCAV4K9:00000017": started reading request body.
2025-11-24 02:04:28.638 +02:00 [DBG] Connection id "0HNHATCCAV4K9", Request id "0HNHATCCAV4K9:00000017": done reading request body.
2025-11-24 02:04:28.638 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Schedule.CreateScheduleDto'
2025-11-24 02:04:28.639 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto'.
2025-11-24 02:04:28.641 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto'.
2025-11-24 02:04:28.643 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto' ...
2025-11-24 02:04:28.645 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto'.
2025-11-24 02:04:28.646 +02:00 [INF] create schedule  called at "2025-11-24T02:04:28.6469019+02:00"
2025-11-24 02:04:28.647 +02:00 [INF] Creating schedule for DoctorId: 1, Day: iday, Shift: "Afternoon"
2025-11-24 02:04:28.650 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:04:28.653 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:04:28.653 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:04:28.655 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:04:28.656 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:04:28.656 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:04:28.657 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:04:28.658 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:04:28.658 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:04:28.679 +02:00 [INF] Executed DbCommand (20ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:04:28.682 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:04:28.684 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:04:28.685 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:04:28.686 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:04:28.688 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:04:28.688 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:04:28.689 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:04:28.691 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:04:28.693 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:04:28.697 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:04:28.698 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:04:28.700 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 17ms reading results.
2025-11-24 02:04:28.702 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:04:28.704 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 02:04:28.751 +02:00 [INF] Executed action Hospital.Controllers.ScheduleController.Create (Hospital) in 121.6732ms
2025-11-24 02:04:28.753 +02:00 [INF] Executed endpoint 'Hospital.Controllers.ScheduleController.Create (Hospital)'
2025-11-24 02:04:28.794 +02:00 [ERR]  Exception caught: Invalid day of the week.
System.ArgumentException: Invalid day of the week.
   at Hospital.Infrastructure.Services.ScheduleService.CreateAsync(CreateScheduleDto dto) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\ScheduleService.cs:line 42
   at Hospital.Controllers.ScheduleController.Create(CreateScheduleDto dto) in D:\Walaa\GP\Hospital\Hospital\Controllers\ScheduleController.cs:line 27
   at lambda_method1067(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
2025-11-24 02:04:28.814 +02:00 [DBG] Connection id "0HNHATCCAV4K9" completed keep alive response.
2025-11-24 02:04:28.817 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:04:28.821 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:04:28.824 +02:00 [DBG] Disposed connection to database '' on server '' (3ms).
2025-11-24 02:04:28.829 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Schedule - 400 null application/json 227.7584ms
2025-11-24 02:09:46.335 +02:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-11-24 02:09:46.468 +02:00 [DBG] Hosting starting
2025-11-24 02:09:46.513 +02:00 [INF] User profile is available. Using 'C:\Users\E-Mad\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-24 02:09:46.528 +02:00 [DBG] Reading data from file 'C:\Users\E-Mad\AppData\Local\ASP.NET\DataProtection-Keys\key-b85f0939-0825-4b2b-b21a-67409aec9db0.xml'.
2025-11-24 02:09:46.537 +02:00 [DBG] Found key {b85f0939-0825-4b2b-b21a-67409aec9db0}.
2025-11-24 02:09:46.546 +02:00 [DBG] Considering key {b85f0939-0825-4b2b-b21a-67409aec9db0} with expiration date 2026-02-09 12:52:20Z as default key.
2025-11-24 02:09:46.553 +02:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-11-24 02:09:46.555 +02:00 [DBG] Decrypting secret element using Windows DPAPI.
2025-11-24 02:09:46.557 +02:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-11-24 02:09:46.560 +02:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-11-24 02:09:46.561 +02:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-11-24 02:09:46.563 +02:00 [DBG] Using key {b85f0939-0825-4b2b-b21a-67409aec9db0} as the default key.
2025-11-24 02:09:46.563 +02:00 [DBG] Key ring with default key {b85f0939-0825-4b2b-b21a-67409aec9db0} was loaded during application startup.
2025-11-24 02:09:46.567 +02:00 [DBG] Middleware loaded
2025-11-24 02:09:46.569 +02:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16501 B).
2025-11-24 02:09:46.570 +02:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-11-24 02:09:46.656 +02:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-11-24 02:09:46.760 +02:00 [INF] Now listening on: https://localhost:7217
2025-11-24 02:09:46.766 +02:00 [INF] Now listening on: http://localhost:5163
2025-11-24 02:09:46.770 +02:00 [DBG] Loaded hosting startup assembly Hospital
2025-11-24 02:09:46.774 +02:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-11-24 02:09:46.774 +02:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-11-24 02:09:46.775 +02:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-11-24 02:09:46.848 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-24 02:09:46.852 +02:00 [INF] Hosting environment: Development
2025-11-24 02:09:46.855 +02:00 [INF] Content root path: D:\Walaa\GP\Hospital\Hospital
2025-11-24 02:09:46.856 +02:00 [DBG] Hosting started
2025-11-24 02:09:47.195 +02:00 [DBG] Connection id "0HNHATN3K8HQT" accepted.
2025-11-24 02:09:47.195 +02:00 [DBG] Connection id "0HNHATN3K8HQU" accepted.
2025-11-24 02:09:47.200 +02:00 [DBG] Connection id "0HNHATN3K8HQT" started.
2025-11-24 02:09:47.208 +02:00 [DBG] Connection id "0HNHATN3K8HQU" started.
2025-11-24 02:09:47.210 +02:00 [DBG] Connection id "0HNHATN3K8HQT" received FIN.
2025-11-24 02:09:47.210 +02:00 [DBG] Connection id "0HNHATN3K8HQU" received FIN.
2025-11-24 02:09:47.227 +02:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-11-24 02:09:47.227 +02:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-11-24 02:09:47.264 +02:00 [DBG] Connection id "0HNHATN3K8HQU" stopped.
2025-11-24 02:09:47.265 +02:00 [DBG] Connection id "0HNHATN3K8HQT" stopped.
2025-11-24 02:09:47.268 +02:00 [DBG] Connection id "0HNHATN3K8HQU" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-11-24 02:09:47.268 +02:00 [DBG] Connection id "0HNHATN3K8HQT" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-11-24 02:09:47.405 +02:00 [DBG] Connection id "0HNHATN3K8HQV" accepted.
2025-11-24 02:09:47.409 +02:00 [DBG] Connection id "0HNHATN3K8HQV" started.
2025-11-24 02:09:47.463 +02:00 [DBG] Connection 0HNHATN3K8HQV established using the following protocol: "Tls12"
2025-11-24 02:09:47.536 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/swagger/index.html - null null
2025-11-24 02:09:47.630 +02:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-11-24 02:09:47.662 +02:00 [DBG] No candidates found for the request path '/swagger/index.html'
2025-11-24 02:09:47.665 +02:00 [DBG] Request did not match any endpoints
2025-11-24 02:09:47.726 +02:00 [DBG] Response markup is scheduled to include Browser Link script injection.
2025-11-24 02:09:47.731 +02:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2025-11-24 02:09:47.750 +02:00 [DBG] Response markup was updated to include Browser Link script injection.
2025-11-24 02:09:47.753 +02:00 [DBG] Response markup was updated to include browser refresh script injection.
2025-11-24 02:09:47.758 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/swagger/index.html - 200 null text/html;charset=utf-8 229.9379ms
2025-11-24 02:09:47.767 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/_framework/aspnetcore-browser-refresh.js - null null
2025-11-24 02:09:47.767 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/_vs/browserLink - null null
2025-11-24 02:09:47.773 +02:00 [DBG] Script injected: /_framework/aspnetcore-browser-refresh.js
2025-11-24 02:09:47.775 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/_framework/aspnetcore-browser-refresh.js - 200 16501 application/javascript; charset=utf-8 8.5729ms
2025-11-24 02:09:47.809 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/_vs/browserLink - 200 null text/javascript; charset=UTF-8 42.7572ms
2025-11-24 02:09:47.863 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/swagger/v1/swagger.json - null null
2025-11-24 02:09:47.867 +02:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2025-11-24 02:09:47.867 +02:00 [DBG] Request did not match any endpoints
2025-11-24 02:09:47.917 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 54.7642ms
2025-11-24 02:09:52.170 +02:00 [DBG] Connection id "0HNHATN3K8HR0" accepted.
2025-11-24 02:09:52.170 +02:00 [DBG] Connection id "0HNHATN3K8HR0" received FIN.
2025-11-24 02:09:52.175 +02:00 [DBG] Connection id "0HNHATN3K8HR0" started.
2025-11-24 02:09:52.176 +02:00 [DBG] Connection id "0HNHATN3K8HR1" accepted.
2025-11-24 02:09:52.186 +02:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-11-24 02:09:52.190 +02:00 [DBG] Connection id "0HNHATN3K8HR1" started.
2025-11-24 02:09:52.197 +02:00 [DBG] Connection id "0HNHATN3K8HR0" stopped.
2025-11-24 02:09:52.201 +02:00 [DBG] Connection id "0HNHATN3K8HR0" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-11-24 02:09:52.205 +02:00 [DBG] Connection 0HNHATN3K8HR1 established using the following protocol: "Tls12"
2025-11-24 02:09:52.213 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Schedule - application/json 73
2025-11-24 02:09:52.220 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Schedule'
2025-11-24 02:09:52.227 +02:00 [DBG] Endpoint 'Hospital.Controllers.ScheduleController.Create (Hospital)' with route pattern 'api/Schedule' is valid for the request path '/api/Schedule'
2025-11-24 02:09:52.229 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.ScheduleController.Create (Hospital)'
2025-11-24 02:09:52.231 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:09:52.299 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:09:52.307 +02:00 [INF] Executing endpoint 'Hospital.Controllers.ScheduleController.Create (Hospital)'
2025-11-24 02:09:52.348 +02:00 [INF] Route matched with {action = "Create", controller = "Schedule"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Hospital.Application.DTO.Schedule.ScheduleDto]] Create(Hospital.Application.DTO.Schedule.CreateScheduleDto) on controller Hospital.Controllers.ScheduleController (Hospital).
2025-11-24 02:09:52.360 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:09:52.365 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:09:52.371 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:09:52.380 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:09:52.385 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:09:52.392 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:09:52.541 +02:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-11-24 02:09:52.915 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:09:52.936 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto' ...
2025-11-24 02:09:52.943 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto' using the name '' in request data ...
2025-11-24 02:09:52.954 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:09:52.975 +02:00 [DBG] Connection id "0HNHATN3K8HR1", Request id "0HNHATN3K8HR1:00000001": started reading request body.
2025-11-24 02:09:52.981 +02:00 [DBG] Connection id "0HNHATN3K8HR1", Request id "0HNHATN3K8HR1:00000001": done reading request body.
2025-11-24 02:09:53.000 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Schedule.CreateScheduleDto'
2025-11-24 02:09:53.009 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto'.
2025-11-24 02:09:53.015 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto'.
2025-11-24 02:09:53.017 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto' ...
2025-11-24 02:09:53.043 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto'.
2025-11-24 02:09:53.061 +02:00 [INF] create schedule  called at "2025-11-24T02:09:53.0607728+02:00"
2025-11-24 02:09:53.070 +02:00 [INF] Creating schedule for DoctorId: 1, Day: friday, Shift: "Afternoon"
2025-11-24 02:09:53.778 +02:00 [DBG] The index {'BranchesBranchId'} was not created on entity type 'BranchDoctor (Dictionary<string, object>)' as the properties are already covered by the index {'BranchesBranchId', 'DoctorsDoctorId'}.
2025-11-24 02:09:53.781 +02:00 [DBG] The index {'BranchId'} was not created on entity type 'BranchService (Dictionary<string, object>)' as the properties are already covered by the index {'BranchId', 'ServiceId'}.
2025-11-24 02:09:53.784 +02:00 [DBG] The index {'BranchId'} was not created on entity type 'BranchSpecialization (Dictionary<string, object>)' as the properties are already covered by the index {'BranchId', 'SpecializationId'}.
2025-11-24 02:09:53.786 +02:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserRole<string>' as the properties are already covered by the index {'UserId', 'RoleId'}.
2025-11-24 02:09:53.787 +02:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserToken<string>' as the properties are already covered by the index {'UserId', 'LoginProvider', 'Name'}.
2025-11-24 02:09:53.932 +02:00 [DBG] The property 'BranchDoctor (Dictionary<string, object>).BranchesBranchId' was created in shadow state because there are no eligible CLR members with a matching name.
2025-11-24 02:09:53.934 +02:00 [DBG] The property 'BranchDoctor (Dictionary<string, object>).DoctorsDoctorId' was created in shadow state because there are no eligible CLR members with a matching name.
2025-11-24 02:09:54.104 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:09:54.198 +02:00 [DBG] Compiling query expression: 
'DbSet<Doctor>()
    .Include(d => d.User)
    .Include(d => d.Specialization)
    .Include(d => d.Branches)
    .Include(d => d.Schedules)
    .FirstOrDefault(d => d.DoctorId == __doctorId_0)'
2025-11-24 02:09:54.265 +02:00 [DBG] Including navigation: 'Doctor.User'.
2025-11-24 02:09:54.272 +02:00 [DBG] Including navigation: 'Doctor.Specialization'.
2025-11-24 02:09:54.277 +02:00 [DBG] Including navigation: 'Doctor.Branches'.
2025-11-24 02:09:54.282 +02:00 [DBG] Including navigation: 'Doctor.Schedules'.
2025-11-24 02:09:54.551 +02:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-11-24 02:09:54.579 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Doctor>(
    asyncEnumerable: new SingleQueryingEnumerable<Doctor>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Doctor.DoctorId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Doctor.Available (bool?), 1], [Property: Doctor.Biography (string), 2], [Property: Doctor.ConsultationFees (decimal) Required, 3], [Property: Doctor.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: Doctor.ExperienceYears (int?), 5], [Property: Doctor.ImageURL (string) MaxLength(300), 6], [Property: Doctor.SpecializationId (int) Required FK Index, 7], [Property: Doctor.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 8], [Property: Doctor.UserId (string) Required FK Index, 9] }
                1 -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 10], [Property: User.AccessFailedCount (int) Required, 11], [Property: User.ConcurrencyStamp (string) Concurrency, 12], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 13], [Property: User.DateOfBirth (DateOnly?), 14], [Property: User.Email (string) Index MaxLength(256), 15], [Property: User.EmailConfirmed (bool) Required, 16], [Property: User.FullName (string) Required MaxLength(150), 17], [Property: User.Gender (GenderType?) MaxLength(10), 18], [Property: User.LockoutEnabled (bool) Required, 19], [Property: User.LockoutEnd (DateTimeOffset?), 20], [Property: User.NormalizedEmail (string) Index MaxLength(256), 21], [Property: User.NormalizedUserName (string) Index MaxLength(256), 22], [Property: User.PasswordHash (string), 23], [Property: User.PhoneNumber (string), 24], [Property: User.PhoneNumberConfirmed (bool) Required, 25], [Property: User.RefreshToken (string), 26], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 27], [Property: User.Role (string) Required MaxLength(50), 28], [Property: User.SecurityStamp (string), 29], [Property: User.TwoFactorEnabled (bool) Required, 30], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 31], [Property: User.UserName (string) MaxLength(256), 32] }
                2 -> Dictionary<IProperty, int> { [Property: Specialization.SpecializationId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 33], [Property: Specialization.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 34], [Property: Specialization.Description (string), 35], [Property: Specialization.Name (string) Required MaxLength(120), 36], [Property: Specialization.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 37] }
                3 -> 0
                4 -> 10
                5 -> 33
                6 -> Dictionary<IProperty, int> { [Property: BranchDoctor (Dictionary<string, object>).BranchesBranchId (no field, int) Indexer Required PK FK AfterSave:Throw, 38], [Property: BranchDoctor (Dictionary<string, object>).DoctorsDoctorId (no field, int) Indexer Required PK FK Index AfterSave:Throw, 39] }
                7 -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 40], [Property: Branch.Address (string) MaxLength(250), 41], [Property: Branch.BranchName (string) Required MaxLength(150), 42], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 43], [Property: Branch.Description (string), 44], [Property: Branch.Email (string) MaxLength(200), 45], [Property: Branch.ImageURL (string) MaxLength(300), 46], [Property: Branch.Phone (string) MaxLength(25), 47], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 48] }
                8 -> 38
                9 -> 39
                10 -> 40
                11 -> Dictionary<IProperty, int> { [Property: Schedule.ScheduleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 49], [Property: Schedule.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 50], [Property: Schedule.DayOfWeek (string) Required MaxLength(20), 51], [Property: Schedule.DoctorId (int) Required FK Index, 52], [Property: Schedule.EndTime (DateTime) Required, 53], [Property: Schedule.Shift (AppointmentShift) Required, 54], [Property: Schedule.StartTime (DateTime) Required, 55], [Property: Schedule.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 56] }
                12 -> 49
            SELECT t.DoctorId, t.Available, t.Biography, t.ConsultationFees, t.CreatedAt, t.ExperienceYears, t.ImageURL, t.SpecializationId, t.UpdatedAt, t.UserId, t.Id, t.AccessFailedCount, t.ConcurrencyStamp, t.CreatedAt0, t.DateOfBirth, t.Email, t.EmailConfirmed, t.FullName, t.Gender, t.LockoutEnabled, t.LockoutEnd, t.NormalizedEmail, t.NormalizedUserName, t.PasswordHash, t.PhoneNumber, t.PhoneNumberConfirmed, t.RefreshToken, t.RefreshTokenExpiryTime, t.Role, t.SecurityStamp, t.TwoFactorEnabled, t.UpdatedAt0, t.UserName, t.SpecializationId0, t.CreatedAt1, t.Description, t.Name, t.UpdatedAt1, t0.BranchesBranchId, t0.DoctorsDoctorId, t0.BranchId, t0.Address, t0.BranchName, t0.CreatedAt, t0.Description, t0.Email, t0.ImageURL, t0.Phone, t0.UpdatedAt, s0.ScheduleId, s0.CreatedAt, s0.DayOfWeek, s0.DoctorId, s0.EndTime, s0.Shift, s0.StartTime, s0.UpdatedAt
            FROM 
            (
                SELECT TOP(1) d.DoctorId, d.Available, d.Biography, d.ConsultationFees, d.CreatedAt, d.ExperienceYears, d.ImageURL, d.SpecializationId, d.UpdatedAt, d.UserId, u.Id, u.AccessFailedCount, u.ConcurrencyStamp, u.CreatedAt AS CreatedAt0, u.DateOfBirth, u.Email, u.EmailConfirmed, u.FullName, u.Gender, u.LockoutEnabled, u.LockoutEnd, u.NormalizedEmail, u.NormalizedUserName, u.PasswordHash, u.PhoneNumber, u.PhoneNumberConfirmed, u.RefreshToken, u.RefreshTokenExpiryTime, u.Role, u.SecurityStamp, u.TwoFactorEnabled, u.UpdatedAt AS UpdatedAt0, u.UserName, s.SpecializationId AS SpecializationId0, s.CreatedAt AS CreatedAt1, s.Description, s.Name, s.UpdatedAt AS UpdatedAt1
                FROM Doctors AS d
                INNER JOIN Users AS u ON d.UserId == u.Id
                INNER JOIN Specializations AS s ON d.SpecializationId == s.SpecializationId
                WHERE d.DoctorId == @__doctorId_0
            ) AS t
            LEFT JOIN 
            (
                SELECT d0.BranchesBranchId, d0.DoctorsDoctorId, b.BranchId, b.Address, b.BranchName, b.CreatedAt, b.Description, b.Email, b.ImageURL, b.Phone, b.UpdatedAt
                FROM DoctorBranches AS d0
                INNER JOIN Branches AS b ON d0.BranchesBranchId == b.BranchId
            ) AS t0 ON t.DoctorId == t0.DoctorsDoctorId
            LEFT JOIN Schedules AS s0 ON t.DoctorId == s0.DoctorId
            ORDER BY t.DoctorId ASC, t.Id ASC, t.SpecializationId0 ASC, t0.BranchesBranchId ASC, t0.DoctorsDoctorId ASC, t0.BranchId ASC), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Doctor>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 02:09:54.629 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:09:54.651 +02:00 [DBG] Created DbConnection. (20ms).
2025-11-24 02:09:54.658 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:09:55.003 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:09:55.013 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:09:55.029 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (8ms).
2025-11-24 02:09:55.044 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (31ms).
2025-11-24 02:09:55.064 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:09:55.155 +02:00 [INF] Executed DbCommand (97ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:09:55.220 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:09:55.304 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:09:55.309 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:09:55.356 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:09:55.365 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:09:55.396 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:09:55.436 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:09:55.465 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:09:55.480 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:09:55.485 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:09:55.500 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:09:55.514 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 345ms reading results.
2025-11-24 02:09:55.525 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:09:55.539 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (14ms).
2025-11-24 02:09:55.580 +02:00 [DBG] Compiling query expression: 
'DbSet<Schedule>()
    .Where(s => s.DayOfWeek.ToLower() == __ToLower_0)
    .Include(s => s.Doctor)
    .ThenInclude(d => d.User)'
2025-11-24 02:09:55.586 +02:00 [DBG] Including navigation: 'Schedule.Doctor'.
2025-11-24 02:09:55.588 +02:00 [DBG] Including navigation: 'Doctor.User'.
2025-11-24 02:09:55.612 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Schedule>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Schedule.ScheduleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Schedule.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: Schedule.DayOfWeek (string) Required MaxLength(20), 2], [Property: Schedule.DoctorId (int) Required FK Index, 3], [Property: Schedule.EndTime (DateTime) Required, 4], [Property: Schedule.Shift (AppointmentShift) Required, 5], [Property: Schedule.StartTime (DateTime) Required, 6], [Property: Schedule.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 7] }
            1 -> Dictionary<IProperty, int> { [Property: Doctor.DoctorId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 8], [Property: Doctor.Available (bool?), 9], [Property: Doctor.Biography (string), 10], [Property: Doctor.ConsultationFees (decimal) Required, 11], [Property: Doctor.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 12], [Property: Doctor.ExperienceYears (int?), 13], [Property: Doctor.ImageURL (string) MaxLength(300), 14], [Property: Doctor.SpecializationId (int) Required FK Index, 15], [Property: Doctor.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 16], [Property: Doctor.UserId (string) Required FK Index, 17] }
            2 -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 18], [Property: User.AccessFailedCount (int) Required, 19], [Property: User.ConcurrencyStamp (string) Concurrency, 20], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 21], [Property: User.DateOfBirth (DateOnly?), 22], [Property: User.Email (string) Index MaxLength(256), 23], [Property: User.EmailConfirmed (bool) Required, 24], [Property: User.FullName (string) Required MaxLength(150), 25], [Property: User.Gender (GenderType?) MaxLength(10), 26], [Property: User.LockoutEnabled (bool) Required, 27], [Property: User.LockoutEnd (DateTimeOffset?), 28], [Property: User.NormalizedEmail (string) Index MaxLength(256), 29], [Property: User.NormalizedUserName (string) Index MaxLength(256), 30], [Property: User.PasswordHash (string), 31], [Property: User.PhoneNumber (string), 32], [Property: User.PhoneNumberConfirmed (bool) Required, 33], [Property: User.RefreshToken (string), 34], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 35], [Property: User.Role (string) Required MaxLength(50), 36], [Property: User.SecurityStamp (string), 37], [Property: User.TwoFactorEnabled (bool) Required, 38], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 39], [Property: User.UserName (string) MaxLength(256), 40] }
        SELECT s.ScheduleId, s.CreatedAt, s.DayOfWeek, s.DoctorId, s.EndTime, s.Shift, s.StartTime, s.UpdatedAt, d.DoctorId, d.Available, d.Biography, d.ConsultationFees, d.CreatedAt, d.ExperienceYears, d.ImageURL, d.SpecializationId, d.UpdatedAt, d.UserId, u.Id, u.AccessFailedCount, u.ConcurrencyStamp, u.CreatedAt, u.DateOfBirth, u.Email, u.EmailConfirmed, u.FullName, u.Gender, u.LockoutEnabled, u.LockoutEnd, u.NormalizedEmail, u.NormalizedUserName, u.PasswordHash, u.PhoneNumber, u.PhoneNumberConfirmed, u.RefreshToken, u.RefreshTokenExpiryTime, u.Role, u.SecurityStamp, u.TwoFactorEnabled, u.UpdatedAt, u.UserName
        FROM Schedules AS s
        INNER JOIN Doctors AS d ON s.DoctorId == d.DoctorId
        INNER JOIN Users AS u ON d.UserId == u.Id
        WHERE LOWER(s.DayOfWeek) == @__ToLower_0), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Schedule>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 02:09:55.630 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:09:55.635 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:09:55.636 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:09:55.637 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:09:55.639 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 02:09:55.640 +02:00 [DBG] Executing DbCommand [Parameters=[@__ToLower_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE LOWER([s].[DayOfWeek]) = @__ToLower_0
2025-11-24 02:09:55.668 +02:00 [INF] Executed DbCommand (28ms) [Parameters=[@__ToLower_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE LOWER([s].[DayOfWeek]) = @__ToLower_0
2025-11-24 02:09:55.678 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:09:55.682 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 6ms reading results.
2025-11-24 02:09:55.684 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:09:55.686 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 02:09:55.687 +02:00 [WRN] Duplicate schedule detected for DoctorId 1 on friday shift "Afternoon"
2025-11-24 02:09:55.780 +02:00 [INF] Executed action Hospital.Controllers.ScheduleController.Create (Hospital) in 3387.0245ms
2025-11-24 02:09:55.783 +02:00 [INF] Executed endpoint 'Hospital.Controllers.ScheduleController.Create (Hospital)'
2025-11-24 02:09:55.850 +02:00 [ERR]  Exception caught: Doctor already has a schedule for this day and shift.
System.InvalidOperationException: Doctor already has a schedule for this day and shift.
   at Hospital.Infrastructure.Services.ScheduleService.CreateAsync(CreateScheduleDto dto) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\ScheduleService.cs:line 51
   at Hospital.Controllers.ScheduleController.Create(CreateScheduleDto dto) in D:\Walaa\GP\Hospital\Hospital\Controllers\ScheduleController.cs:line 27
   at lambda_method6(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
2025-11-24 02:09:55.899 +02:00 [DBG] Connection id "0HNHATN3K8HR1" completed keep alive response.
2025-11-24 02:09:55.910 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:09:55.920 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:09:55.923 +02:00 [DBG] Disposed connection to database '' on server '' (3ms).
2025-11-24 02:09:55.929 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Schedule - 500 null application/json 3716.1484ms
2025-11-24 02:11:12.876 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/swagger/index.html - null null
2025-11-24 02:11:12.886 +02:00 [DBG] No candidates found for the request path '/swagger/index.html'
2025-11-24 02:11:12.887 +02:00 [DBG] Request did not match any endpoints
2025-11-24 02:11:12.888 +02:00 [DBG] Response markup is scheduled to include Browser Link script injection.
2025-11-24 02:11:12.888 +02:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2025-11-24 02:11:12.892 +02:00 [DBG] Response markup was updated to include Browser Link script injection.
2025-11-24 02:11:12.892 +02:00 [DBG] Response markup was updated to include browser refresh script injection.
2025-11-24 02:11:12.893 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/swagger/index.html - 200 null text/html;charset=utf-8 16.4956ms
2025-11-24 02:11:12.915 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/_framework/aspnetcore-browser-refresh.js - null null
2025-11-24 02:11:12.918 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/_vs/browserLink - null null
2025-11-24 02:11:12.919 +02:00 [DBG] Script injected: /_framework/aspnetcore-browser-refresh.js
2025-11-24 02:11:12.924 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/_framework/aspnetcore-browser-refresh.js - 200 16501 application/javascript; charset=utf-8 10.9757ms
2025-11-24 02:11:12.938 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/_vs/browserLink - 200 null text/javascript; charset=UTF-8 20.5037ms
2025-11-24 02:11:12.992 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/swagger/v1/swagger.json - null null
2025-11-24 02:11:12.994 +02:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2025-11-24 02:11:12.995 +02:00 [DBG] Request did not match any endpoints
2025-11-24 02:11:13.035 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 42.9054ms
2025-11-24 02:11:18.944 +02:00 [DBG] Connection id "0HNHATN3K8HR2" received FIN.
2025-11-24 02:11:18.946 +02:00 [DBG] Connection id "0HNHATN3K8HR2" accepted.
2025-11-24 02:11:18.946 +02:00 [DBG] Connection id "0HNHATN3K8HR2" started.
2025-11-24 02:11:18.947 +02:00 [DBG] Connection id "0HNHATN3K8HR3" accepted.
2025-11-24 02:11:18.949 +02:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-11-24 02:11:18.949 +02:00 [DBG] Connection id "0HNHATN3K8HR3" started.
2025-11-24 02:11:18.951 +02:00 [DBG] Connection id "0HNHATN3K8HR2" stopped.
2025-11-24 02:11:18.952 +02:00 [DBG] Connection id "0HNHATN3K8HR2" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-11-24 02:11:18.956 +02:00 [DBG] Connection 0HNHATN3K8HR3 established using the following protocol: "Tls12"
2025-11-24 02:11:18.956 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Schedule - application/json 73
2025-11-24 02:11:18.958 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Schedule'
2025-11-24 02:11:18.958 +02:00 [DBG] Endpoint 'Hospital.Controllers.ScheduleController.Create (Hospital)' with route pattern 'api/Schedule' is valid for the request path '/api/Schedule'
2025-11-24 02:11:18.959 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.ScheduleController.Create (Hospital)'
2025-11-24 02:11:18.960 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:11:18.961 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:11:18.963 +02:00 [INF] Executing endpoint 'Hospital.Controllers.ScheduleController.Create (Hospital)'
2025-11-24 02:11:18.967 +02:00 [INF] Route matched with {action = "Create", controller = "Schedule"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Hospital.Application.DTO.Schedule.ScheduleDto]] Create(Hospital.Application.DTO.Schedule.CreateScheduleDto) on controller Hospital.Controllers.ScheduleController (Hospital).
2025-11-24 02:11:18.969 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:11:18.970 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:11:18.971 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:11:18.972 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:11:18.972 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:11:18.973 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:11:18.975 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:11:18.976 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto' ...
2025-11-24 02:11:18.977 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto' using the name '' in request data ...
2025-11-24 02:11:18.978 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:11:18.980 +02:00 [DBG] Connection id "0HNHATN3K8HR3", Request id "0HNHATN3K8HR3:00000001": started reading request body.
2025-11-24 02:11:18.981 +02:00 [DBG] Connection id "0HNHATN3K8HR3", Request id "0HNHATN3K8HR3:00000001": done reading request body.
2025-11-24 02:11:18.983 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Schedule.CreateScheduleDto'
2025-11-24 02:11:18.984 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto'.
2025-11-24 02:11:18.984 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto'.
2025-11-24 02:11:18.985 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto' ...
2025-11-24 02:11:18.987 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto'.
2025-11-24 02:11:18.987 +02:00 [INF] create schedule  called at "2025-11-24T02:11:18.9878693+02:00"
2025-11-24 02:11:18.989 +02:00 [INF] Creating schedule for DoctorId: 1, Day: friday, Shift: "Afternoon"
2025-11-24 02:11:19.033 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:11:19.037 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:11:19.037 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:11:19.038 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:11:19.039 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:11:19.040 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:11:19.041 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:11:19.042 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:11:19.044 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:11:19.058 +02:00 [INF] Executed DbCommand (14ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:11:19.061 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:11:19.062 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:11:19.063 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:11:19.064 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:11:19.064 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:11:19.065 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:11:19.066 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:11:19.066 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:11:19.067 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:11:19.068 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:11:19.068 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:11:19.069 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 7ms reading results.
2025-11-24 02:11:19.071 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:11:19.072 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 02:11:19.074 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:11:19.074 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:11:19.075 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:11:19.075 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:11:19.076 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:11:19.077 +02:00 [DBG] Executing DbCommand [Parameters=[@__ToLower_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE LOWER([s].[DayOfWeek]) = @__ToLower_0
2025-11-24 02:11:19.082 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__ToLower_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE LOWER([s].[DayOfWeek]) = @__ToLower_0
2025-11-24 02:11:19.085 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:11:19.085 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 02:11:19.086 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:11:19.087 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:11:19.088 +02:00 [WRN] Duplicate schedule detected for DoctorId 1 on friday shift "Afternoon"
2025-11-24 02:11:19.130 +02:00 [INF] Executed action Hospital.Controllers.ScheduleController.Create (Hospital) in 156.4561ms
2025-11-24 02:11:19.130 +02:00 [INF] Executed endpoint 'Hospital.Controllers.ScheduleController.Create (Hospital)'
2025-11-24 02:11:19.170 +02:00 [ERR]  Exception caught: Doctor already has a schedule for this day and shift.
System.ComponentModel.DataAnnotations.ValidationException: Doctor already has a schedule for this day and shift.
   at Hospital.Infrastructure.Services.ScheduleService.CreateAsync(CreateScheduleDto dto)
   at Hospital.Controllers.ScheduleController.Create(CreateScheduleDto dto) in D:\Walaa\GP\Hospital\Hospital\Controllers\ScheduleController.cs:line 27
   at lambda_method473(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
2025-11-24 02:11:19.177 +02:00 [DBG] Connection id "0HNHATN3K8HR3" completed keep alive response.
2025-11-24 02:11:19.177 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:11:19.178 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:11:19.179 +02:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-11-24 02:11:19.180 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Schedule - 400 null application/json 223.4048ms
2025-11-24 02:11:32.033 +02:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7217/api/Schedule - application/json 73
2025-11-24 02:11:32.036 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Schedule'
2025-11-24 02:11:32.037 +02:00 [DBG] Endpoint 'Hospital.Controllers.ScheduleController.Update (Hospital)' with route pattern 'api/Schedule' is valid for the request path '/api/Schedule'
2025-11-24 02:11:32.038 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.ScheduleController.Update (Hospital)'
2025-11-24 02:11:32.038 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:11:32.041 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:11:32.042 +02:00 [INF] Executing endpoint 'Hospital.Controllers.ScheduleController.Update (Hospital)'
2025-11-24 02:11:32.046 +02:00 [INF] Route matched with {action = "Update", controller = "Schedule"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Hospital.Application.DTO.Schedule.ScheduleDto]] Update(Hospital.Application.DTO.Schedule.UpdateScheduleDto) on controller Hospital.Controllers.ScheduleController (Hospital).
2025-11-24 02:11:32.049 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:11:32.050 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:11:32.051 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:11:32.053 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:11:32.054 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:11:32.055 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:11:32.059 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:11:32.060 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.UpdateScheduleDto' ...
2025-11-24 02:11:32.061 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.UpdateScheduleDto' using the name '' in request data ...
2025-11-24 02:11:32.063 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:11:32.068 +02:00 [DBG] Connection id "0HNHATN3K8HR3", Request id "0HNHATN3K8HR3:00000002": started reading request body.
2025-11-24 02:11:32.069 +02:00 [DBG] Connection id "0HNHATN3K8HR3", Request id "0HNHATN3K8HR3:00000002": done reading request body.
2025-11-24 02:11:32.071 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Schedule.UpdateScheduleDto'
2025-11-24 02:11:32.072 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.UpdateScheduleDto'.
2025-11-24 02:11:32.073 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.UpdateScheduleDto'.
2025-11-24 02:11:32.074 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Schedule.UpdateScheduleDto' ...
2025-11-24 02:11:32.076 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Schedule.UpdateScheduleDto'.
2025-11-24 02:11:32.077 +02:00 [INF] update schedule  called at "2025-11-24T02:11:32.0778530+02:00"
2025-11-24 02:11:32.080 +02:00 [INF] Updating schedule with ScheduleId: 1
2025-11-24 02:11:32.092 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:11:32.096 +02:00 [DBG] Compiling query expression: 
'DbSet<Schedule>()
    .Include(s => s.Doctor)
    .ThenInclude(d => d.User)
    .FirstOrDefault(s => s.ScheduleId == __scheduleId_0)'
2025-11-24 02:11:32.098 +02:00 [DBG] Including navigation: 'Schedule.Doctor'.
2025-11-24 02:11:32.099 +02:00 [DBG] Including navigation: 'Doctor.User'.
2025-11-24 02:11:32.109 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Schedule>(
    asyncEnumerable: new SingleQueryingEnumerable<Schedule>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Schedule.ScheduleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Schedule.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: Schedule.DayOfWeek (string) Required MaxLength(20), 2], [Property: Schedule.DoctorId (int) Required FK Index, 3], [Property: Schedule.EndTime (DateTime) Required, 4], [Property: Schedule.Shift (AppointmentShift) Required, 5], [Property: Schedule.StartTime (DateTime) Required, 6], [Property: Schedule.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 7] }
                1 -> Dictionary<IProperty, int> { [Property: Doctor.DoctorId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 8], [Property: Doctor.Available (bool?), 9], [Property: Doctor.Biography (string), 10], [Property: Doctor.ConsultationFees (decimal) Required, 11], [Property: Doctor.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 12], [Property: Doctor.ExperienceYears (int?), 13], [Property: Doctor.ImageURL (string) MaxLength(300), 14], [Property: Doctor.SpecializationId (int) Required FK Index, 15], [Property: Doctor.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 16], [Property: Doctor.UserId (string) Required FK Index, 17] }
                2 -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 18], [Property: User.AccessFailedCount (int) Required, 19], [Property: User.ConcurrencyStamp (string) Concurrency, 20], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 21], [Property: User.DateOfBirth (DateOnly?), 22], [Property: User.Email (string) Index MaxLength(256), 23], [Property: User.EmailConfirmed (bool) Required, 24], [Property: User.FullName (string) Required MaxLength(150), 25], [Property: User.Gender (GenderType?) MaxLength(10), 26], [Property: User.LockoutEnabled (bool) Required, 27], [Property: User.LockoutEnd (DateTimeOffset?), 28], [Property: User.NormalizedEmail (string) Index MaxLength(256), 29], [Property: User.NormalizedUserName (string) Index MaxLength(256), 30], [Property: User.PasswordHash (string), 31], [Property: User.PhoneNumber (string), 32], [Property: User.PhoneNumberConfirmed (bool) Required, 33], [Property: User.RefreshToken (string), 34], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 35], [Property: User.Role (string) Required MaxLength(50), 36], [Property: User.SecurityStamp (string), 37], [Property: User.TwoFactorEnabled (bool) Required, 38], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 39], [Property: User.UserName (string) MaxLength(256), 40] }
            SELECT TOP(1) s.ScheduleId, s.CreatedAt, s.DayOfWeek, s.DoctorId, s.EndTime, s.Shift, s.StartTime, s.UpdatedAt, d.DoctorId, d.Available, d.Biography, d.ConsultationFees, d.CreatedAt, d.ExperienceYears, d.ImageURL, d.SpecializationId, d.UpdatedAt, d.UserId, u.Id, u.AccessFailedCount, u.ConcurrencyStamp, u.CreatedAt, u.DateOfBirth, u.Email, u.EmailConfirmed, u.FullName, u.Gender, u.LockoutEnabled, u.LockoutEnd, u.NormalizedEmail, u.NormalizedUserName, u.PasswordHash, u.PhoneNumber, u.PhoneNumberConfirmed, u.RefreshToken, u.RefreshTokenExpiryTime, u.Role, u.SecurityStamp, u.TwoFactorEnabled, u.UpdatedAt, u.UserName
            FROM Schedules AS s
            INNER JOIN Doctors AS d ON s.DoctorId == d.DoctorId
            INNER JOIN Users AS u ON d.UserId == u.Id
            WHERE s.ScheduleId == @__scheduleId_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Schedule>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 02:11:32.113 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:11:32.114 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:11:32.114 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:11:32.115 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:11:32.116 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:11:32.117 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:11:32.118 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:11:32.119 +02:00 [DBG] Executing DbCommand [Parameters=[@__scheduleId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE [s].[ScheduleId] = @__scheduleId_0
2025-11-24 02:11:32.125 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[@__scheduleId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE [s].[ScheduleId] = @__scheduleId_0
2025-11-24 02:11:32.128 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:11:32.129 +02:00 [DBG] The navigation 'Schedule.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:11:32.131 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:11:32.132 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:11:32.132 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:11:32.133 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:11:32.134 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 6ms reading results.
2025-11-24 02:11:32.135 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:11:32.136 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 02:11:32.137 +02:00 [WRN] Invalid day of the week.
2025-11-24 02:11:32.181 +02:00 [INF] Executed action Hospital.Controllers.ScheduleController.Update (Hospital) in 126.6185ms
2025-11-24 02:11:32.183 +02:00 [INF] Executed endpoint 'Hospital.Controllers.ScheduleController.Update (Hospital)'
2025-11-24 02:11:32.224 +02:00 [ERR]  Exception caught: Invalid day of the week.
System.ArgumentException: Invalid day of the week.
   at Hospital.Infrastructure.Services.ScheduleService.UpdateAsync(UpdateScheduleDto dto)
   at Hospital.Controllers.ScheduleController.Update(UpdateScheduleDto dto) in D:\Walaa\GP\Hospital\Hospital\Controllers\ScheduleController.cs:line 37
   at lambda_method481(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
2025-11-24 02:11:32.230 +02:00 [DBG] Connection id "0HNHATN3K8HR3" completed keep alive response.
2025-11-24 02:11:32.231 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:11:32.231 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:11:32.232 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:11:32.233 +02:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7217/api/Schedule - 400 null application/json 200.1401ms
2025-11-24 02:11:39.376 +02:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7217/api/Schedule - application/json 75
2025-11-24 02:11:39.377 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Schedule'
2025-11-24 02:11:39.378 +02:00 [DBG] Endpoint 'Hospital.Controllers.ScheduleController.Update (Hospital)' with route pattern 'api/Schedule' is valid for the request path '/api/Schedule'
2025-11-24 02:11:39.378 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.ScheduleController.Update (Hospital)'
2025-11-24 02:11:39.379 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:11:39.381 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:11:39.382 +02:00 [INF] Executing endpoint 'Hospital.Controllers.ScheduleController.Update (Hospital)'
2025-11-24 02:11:39.383 +02:00 [INF] Route matched with {action = "Update", controller = "Schedule"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Hospital.Application.DTO.Schedule.ScheduleDto]] Update(Hospital.Application.DTO.Schedule.UpdateScheduleDto) on controller Hospital.Controllers.ScheduleController (Hospital).
2025-11-24 02:11:39.384 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:11:39.385 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:11:39.386 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:11:39.387 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:11:39.388 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:11:39.389 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:11:39.390 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:11:39.391 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.UpdateScheduleDto' ...
2025-11-24 02:11:39.392 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.UpdateScheduleDto' using the name '' in request data ...
2025-11-24 02:11:39.393 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:11:39.393 +02:00 [DBG] Connection id "0HNHATN3K8HR3", Request id "0HNHATN3K8HR3:00000003": started reading request body.
2025-11-24 02:11:39.394 +02:00 [DBG] Connection id "0HNHATN3K8HR3", Request id "0HNHATN3K8HR3:00000003": done reading request body.
2025-11-24 02:11:39.395 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Schedule.UpdateScheduleDto'
2025-11-24 02:11:39.396 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.UpdateScheduleDto'.
2025-11-24 02:11:39.396 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.UpdateScheduleDto'.
2025-11-24 02:11:39.397 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Schedule.UpdateScheduleDto' ...
2025-11-24 02:11:39.398 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Schedule.UpdateScheduleDto'.
2025-11-24 02:11:39.399 +02:00 [INF] update schedule  called at "2025-11-24T02:11:39.3993259+02:00"
2025-11-24 02:11:39.399 +02:00 [INF] Updating schedule with ScheduleId: 1
2025-11-24 02:11:39.400 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:11:39.401 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:11:39.402 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:11:39.403 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:11:39.403 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:11:39.404 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:11:39.404 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:11:39.405 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:11:39.405 +02:00 [DBG] Executing DbCommand [Parameters=[@__scheduleId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE [s].[ScheduleId] = @__scheduleId_0
2025-11-24 02:11:39.408 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__scheduleId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE [s].[ScheduleId] = @__scheduleId_0
2025-11-24 02:11:39.411 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:11:39.412 +02:00 [DBG] The navigation 'Schedule.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:11:39.413 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:11:39.414 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:11:39.415 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:11:39.415 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:11:39.416 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 5ms reading results.
2025-11-24 02:11:39.417 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:11:39.417 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:11:39.420 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:11:39.420 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:11:39.421 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:11:39.421 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:11:39.422 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:11:39.422 +02:00 [DBG] Executing DbCommand [Parameters=[@__ToLower_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE LOWER([s].[DayOfWeek]) = @__ToLower_0
2025-11-24 02:11:39.428 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__ToLower_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE LOWER([s].[DayOfWeek]) = @__ToLower_0
2025-11-24 02:11:39.429 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:11:39.429 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:11:39.430 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:11:39.430 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:11:39.442 +02:00 [DBG] An entity of type 'Schedule' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:11:39.448 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:11:39.475 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:11:39.484 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 02:11:39.486 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:11:39.488 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:11:39.537 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:11:39.538 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:11:39.540 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:11:39.541 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:11:39.544 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-11-24 02:11:39.545 +02:00 [DBG] Executing DbCommand [Parameters=[@p7='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (Size = 20), @p2='?' (DbType = Int32), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = DateTime2), @p6='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Schedules] SET [CreatedAt] = @p0, [DayOfWeek] = @p1, [DoctorId] = @p2, [EndTime] = @p3, [Shift] = @p4, [StartTime] = @p5, [UpdatedAt] = @p6
OUTPUT 1
WHERE [ScheduleId] = @p7;
2025-11-24 02:11:39.556 +02:00 [INF] Executed DbCommand (11ms) [Parameters=[@p7='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (Size = 20), @p2='?' (DbType = Int32), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = DateTime2), @p6='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Schedules] SET [CreatedAt] = @p0, [DayOfWeek] = @p1, [DoctorId] = @p2, [EndTime] = @p3, [Shift] = @p4, [StartTime] = @p5, [UpdatedAt] = @p6
OUTPUT 1
WHERE [ScheduleId] = @p7;
2025-11-24 02:11:39.561 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:11:39.561 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 3ms reading results.
2025-11-24 02:11:39.563 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:11:39.564 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:11:39.566 +02:00 [DBG] An entity of type 'Schedule' tracked by 'AppDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:11:39.568 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 02:11:39.569 +02:00 [INF] Schedule with ScheduleId 1 updated successfully
2025-11-24 02:11:39.573 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:11:39.575 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:11:39.576 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:11:39.576 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:11:39.577 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:11:39.578 +02:00 [INF] Executing OkObjectResult, writing value of type 'Hospital.Application.DTO.Schedule.ScheduleDto'.
2025-11-24 02:11:39.582 +02:00 [INF] Executed action Hospital.Controllers.ScheduleController.Update (Hospital) in 192.8406ms
2025-11-24 02:11:39.583 +02:00 [INF] Executed endpoint 'Hospital.Controllers.ScheduleController.Update (Hospital)'
2025-11-24 02:11:39.584 +02:00 [DBG] Connection id "0HNHATN3K8HR3" completed keep alive response.
2025-11-24 02:11:39.585 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:11:39.586 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:11:39.586 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:11:39.587 +02:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7217/api/Schedule - 200 null application/json; charset=utf-8 211.0732ms
2025-11-24 02:11:50.888 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Schedule/doctor/1 - null null
2025-11-24 02:11:50.889 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Schedule/doctor/1'
2025-11-24 02:11:50.890 +02:00 [DBG] Endpoint 'Hospital.Controllers.ScheduleController.GetByDoctorId (Hospital)' with route pattern 'api/Schedule/doctor/{doctorId}' is valid for the request path '/api/Schedule/doctor/1'
2025-11-24 02:11:50.890 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.ScheduleController.GetByDoctorId (Hospital)'
2025-11-24 02:11:50.891 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:11:50.891 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:11:50.892 +02:00 [INF] Executing endpoint 'Hospital.Controllers.ScheduleController.GetByDoctorId (Hospital)'
2025-11-24 02:11:50.895 +02:00 [INF] Route matched with {action = "GetByDoctorId", controller = "Schedule"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IEnumerable`1[Hospital.Application.DTO.Schedule.ScheduleDto]]] GetByDoctorId(Int32) on controller Hospital.Controllers.ScheduleController (Hospital).
2025-11-24 02:11:50.896 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:11:50.897 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:11:50.897 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:11:50.898 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:11:50.899 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:11:50.899 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:11:50.900 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:11:50.900 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 02:11:50.901 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' using the name 'doctorId' in request data ...
2025-11-24 02:11:50.903 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 02:11:50.903 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 02:11:50.905 +02:00 [DBG] Attempting to validate the bound parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 02:11:50.905 +02:00 [DBG] Done attempting to validate the bound parameter 'doctorId' of type 'System.Int32'.
2025-11-24 02:11:50.907 +02:00 [INF] get schedule by doctor id called at "2025-11-24T02:11:50.9071506+02:00"
2025-11-24 02:11:50.908 +02:00 [INF] Fetching schedules for DoctorId: 1
2025-11-24 02:11:50.910 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:11:50.911 +02:00 [DBG] Compiling query expression: 
'DbSet<Schedule>()
    .Where(s => s.DoctorId == __doctorId_0)
    .Include(s => s.Doctor)
    .ThenInclude(d => d.User)'
2025-11-24 02:11:50.912 +02:00 [DBG] Including navigation: 'Schedule.Doctor'.
2025-11-24 02:11:50.913 +02:00 [DBG] Including navigation: 'Doctor.User'.
2025-11-24 02:11:50.920 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Schedule>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Schedule.ScheduleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Schedule.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: Schedule.DayOfWeek (string) Required MaxLength(20), 2], [Property: Schedule.DoctorId (int) Required FK Index, 3], [Property: Schedule.EndTime (DateTime) Required, 4], [Property: Schedule.Shift (AppointmentShift) Required, 5], [Property: Schedule.StartTime (DateTime) Required, 6], [Property: Schedule.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 7] }
            1 -> Dictionary<IProperty, int> { [Property: Doctor.DoctorId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 8], [Property: Doctor.Available (bool?), 9], [Property: Doctor.Biography (string), 10], [Property: Doctor.ConsultationFees (decimal) Required, 11], [Property: Doctor.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 12], [Property: Doctor.ExperienceYears (int?), 13], [Property: Doctor.ImageURL (string) MaxLength(300), 14], [Property: Doctor.SpecializationId (int) Required FK Index, 15], [Property: Doctor.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 16], [Property: Doctor.UserId (string) Required FK Index, 17] }
            2 -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 18], [Property: User.AccessFailedCount (int) Required, 19], [Property: User.ConcurrencyStamp (string) Concurrency, 20], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 21], [Property: User.DateOfBirth (DateOnly?), 22], [Property: User.Email (string) Index MaxLength(256), 23], [Property: User.EmailConfirmed (bool) Required, 24], [Property: User.FullName (string) Required MaxLength(150), 25], [Property: User.Gender (GenderType?) MaxLength(10), 26], [Property: User.LockoutEnabled (bool) Required, 27], [Property: User.LockoutEnd (DateTimeOffset?), 28], [Property: User.NormalizedEmail (string) Index MaxLength(256), 29], [Property: User.NormalizedUserName (string) Index MaxLength(256), 30], [Property: User.PasswordHash (string), 31], [Property: User.PhoneNumber (string), 32], [Property: User.PhoneNumberConfirmed (bool) Required, 33], [Property: User.RefreshToken (string), 34], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 35], [Property: User.Role (string) Required MaxLength(50), 36], [Property: User.SecurityStamp (string), 37], [Property: User.TwoFactorEnabled (bool) Required, 38], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 39], [Property: User.UserName (string) MaxLength(256), 40] }
        SELECT s.ScheduleId, s.CreatedAt, s.DayOfWeek, s.DoctorId, s.EndTime, s.Shift, s.StartTime, s.UpdatedAt, d.DoctorId, d.Available, d.Biography, d.ConsultationFees, d.CreatedAt, d.ExperienceYears, d.ImageURL, d.SpecializationId, d.UpdatedAt, d.UserId, u.Id, u.AccessFailedCount, u.ConcurrencyStamp, u.CreatedAt, u.DateOfBirth, u.Email, u.EmailConfirmed, u.FullName, u.Gender, u.LockoutEnabled, u.LockoutEnd, u.NormalizedEmail, u.NormalizedUserName, u.PasswordHash, u.PhoneNumber, u.PhoneNumberConfirmed, u.RefreshToken, u.RefreshTokenExpiryTime, u.Role, u.SecurityStamp, u.TwoFactorEnabled, u.UpdatedAt, u.UserName
        FROM Schedules AS s
        INNER JOIN Doctors AS d ON s.DoctorId == d.DoctorId
        INNER JOIN Users AS u ON d.UserId == u.Id
        WHERE s.DoctorId == @__doctorId_0), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Schedule>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 02:11:50.923 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:11:50.924 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:11:50.924 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:11:50.925 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:11:50.925 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:11:50.926 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:11:50.927 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:11:50.928 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE [s].[DoctorId] = @__doctorId_0
2025-11-24 02:11:50.938 +02:00 [INF] Executed DbCommand (10ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE [s].[DoctorId] = @__doctorId_0
2025-11-24 02:11:50.940 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:11:50.941 +02:00 [DBG] The navigation 'Schedule.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:11:50.942 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:11:50.943 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:11:50.944 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:11:50.945 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:11:50.946 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:11:50.946 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:11:50.947 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 6ms reading results.
2025-11-24 02:11:50.948 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:11:50.948 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:11:50.955 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:11:50.957 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:11:50.958 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:11:50.958 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:11:50.958 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:11:50.959 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Schedule.ScheduleDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 02:11:50.961 +02:00 [INF] Executed action Hospital.Controllers.ScheduleController.GetByDoctorId (Hospital) in 61.6872ms
2025-11-24 02:11:50.962 +02:00 [INF] Executed endpoint 'Hospital.Controllers.ScheduleController.GetByDoctorId (Hospital)'
2025-11-24 02:11:50.962 +02:00 [DBG] Connection id "0HNHATN3K8HR3" completed keep alive response.
2025-11-24 02:11:50.962 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:11:50.963 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:11:50.963 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:11:50.964 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Schedule/doctor/1 - 200 null application/json; charset=utf-8 76.1562ms
2025-11-24 02:12:05.105 +02:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7217/api/Schedule/4 - null null
2025-11-24 02:12:05.107 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Schedule/4'
2025-11-24 02:12:05.107 +02:00 [DBG] Endpoint 'Hospital.Controllers.ScheduleController.Delete (Hospital)' with route pattern 'api/Schedule/{id}' is valid for the request path '/api/Schedule/4'
2025-11-24 02:12:05.108 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.ScheduleController.Delete (Hospital)'
2025-11-24 02:12:05.108 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:12:05.109 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:12:05.110 +02:00 [INF] Executing endpoint 'Hospital.Controllers.ScheduleController.Delete (Hospital)'
2025-11-24 02:12:05.113 +02:00 [INF] Route matched with {action = "Delete", controller = "Schedule"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] Delete(Int32) on controller Hospital.Controllers.ScheduleController (Hospital).
2025-11-24 02:12:05.114 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:12:05.114 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:12:05.115 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:12:05.116 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:12:05.116 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:12:05.117 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:12:05.118 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:12:05.119 +02:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-11-24 02:12:05.119 +02:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-11-24 02:12:05.120 +02:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-11-24 02:12:05.122 +02:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-11-24 02:12:05.122 +02:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-11-24 02:12:05.123 +02:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-11-24 02:12:05.125 +02:00 [INF] delete schedule  called at "2025-11-24T02:12:05.1253456+02:00"
2025-11-24 02:12:05.126 +02:00 [INF] Deleting schedule with ScheduleId: 4
2025-11-24 02:12:05.127 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:12:05.133 +02:00 [DBG] Compiling query expression: 
'DbSet<Schedule>()
    .FirstOrDefault(e => EF.Property<int>(e, "ScheduleId") == __p_0)'
2025-11-24 02:12:05.137 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Schedule>(
    asyncEnumerable: new SingleQueryingEnumerable<Schedule>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Schedule.ScheduleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Schedule.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: Schedule.DayOfWeek (string) Required MaxLength(20), 2], [Property: Schedule.DoctorId (int) Required FK Index, 3], [Property: Schedule.EndTime (DateTime) Required, 4], [Property: Schedule.Shift (AppointmentShift) Required, 5], [Property: Schedule.StartTime (DateTime) Required, 6], [Property: Schedule.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 7] }
            SELECT TOP(1) s.ScheduleId, s.CreatedAt, s.DayOfWeek, s.DoctorId, s.EndTime, s.Shift, s.StartTime, s.UpdatedAt
            FROM Schedules AS s
            WHERE s.ScheduleId == @__p_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Schedule>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 02:12:05.139 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:12:05.139 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:12:05.139 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:12:05.140 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:12:05.140 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:12:05.141 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:12:05.142 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:12:05.143 +02:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt]
FROM [Schedules] AS [s]
WHERE [s].[ScheduleId] = @__p_0
2025-11-24 02:12:05.152 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt]
FROM [Schedules] AS [s]
WHERE [s].[ScheduleId] = @__p_0
2025-11-24 02:12:05.154 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:12:05.155 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:12:05.155 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:12:05.156 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:12:05.157 +02:00 [INF] Failed to delete schedule
2025-11-24 02:12:05.159 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:12:05.160 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:12:05.161 +02:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2025-11-24 02:12:05.162 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2025-11-24 02:12:05.163 +02:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-11-24 02:12:05.176 +02:00 [INF] Executed action Hospital.Controllers.ScheduleController.Delete (Hospital) in 59.6522ms
2025-11-24 02:12:05.177 +02:00 [INF] Executed endpoint 'Hospital.Controllers.ScheduleController.Delete (Hospital)'
2025-11-24 02:12:05.177 +02:00 [DBG] Connection id "0HNHATN3K8HR3" completed keep alive response.
2025-11-24 02:12:05.178 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:12:05.178 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:12:05.179 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:12:05.179 +02:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7217/api/Schedule/4 - 404 null application/problem+json; charset=utf-8 74.8378ms
2025-11-24 02:12:10.492 +02:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7217/api/Schedule/3 - null null
2025-11-24 02:12:10.495 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Schedule/3'
2025-11-24 02:12:10.497 +02:00 [DBG] Endpoint 'Hospital.Controllers.ScheduleController.Delete (Hospital)' with route pattern 'api/Schedule/{id}' is valid for the request path '/api/Schedule/3'
2025-11-24 02:12:10.498 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.ScheduleController.Delete (Hospital)'
2025-11-24 02:12:10.499 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:12:10.499 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:12:10.500 +02:00 [INF] Executing endpoint 'Hospital.Controllers.ScheduleController.Delete (Hospital)'
2025-11-24 02:12:10.501 +02:00 [INF] Route matched with {action = "Delete", controller = "Schedule"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] Delete(Int32) on controller Hospital.Controllers.ScheduleController (Hospital).
2025-11-24 02:12:10.502 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:12:10.503 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:12:10.504 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:12:10.504 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:12:10.505 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:12:10.506 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:12:10.507 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:12:10.507 +02:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-11-24 02:12:10.508 +02:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-11-24 02:12:10.508 +02:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-11-24 02:12:10.509 +02:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-11-24 02:12:10.509 +02:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-11-24 02:12:10.510 +02:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-11-24 02:12:10.510 +02:00 [INF] delete schedule  called at "2025-11-24T02:12:10.5105741+02:00"
2025-11-24 02:12:10.511 +02:00 [INF] Deleting schedule with ScheduleId: 3
2025-11-24 02:12:10.512 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:12:10.513 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:12:10.514 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:12:10.514 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:12:10.515 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:12:10.515 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:12:10.516 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:12:10.516 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:12:10.517 +02:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt]
FROM [Schedules] AS [s]
WHERE [s].[ScheduleId] = @__p_0
2025-11-24 02:12:10.523 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt]
FROM [Schedules] AS [s]
WHERE [s].[ScheduleId] = @__p_0
2025-11-24 02:12:10.527 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:12:10.527 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:12:10.528 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 02:12:10.529 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:12:10.529 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:12:10.531 +02:00 [DBG] An entity of type 'Schedule' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Deleted"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:12:10.534 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:12:10.536 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:12:10.536 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 02:12:10.537 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:12:10.538 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:12:10.542 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:12:10.543 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:12:10.543 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:12:10.544 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:12:10.544 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:12:10.545 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [Schedules]
OUTPUT 1
WHERE [ScheduleId] = @p0;
2025-11-24 02:12:10.552 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [Schedules]
OUTPUT 1
WHERE [ScheduleId] = @p0;
2025-11-24 02:12:10.553 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:12:10.554 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:12:10.555 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:12:10.555 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:12:10.559 +02:00 [DBG] An entity of type 'Schedule' tracked by 'AppDbContext' changed state from '"Deleted"' to '"Detached"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:12:10.559 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 02:12:10.560 +02:00 [INF] Schedule deleted successfully
2025-11-24 02:12:10.561 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:12:10.562 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:12:10.562 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:12:10.563 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:12:10.563 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter' and content type 'text/plain' to write the response.
2025-11-24 02:12:10.564 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.String'.
2025-11-24 02:12:10.565 +02:00 [INF] Executed action Hospital.Controllers.ScheduleController.Delete (Hospital) in 59.1045ms
2025-11-24 02:12:10.566 +02:00 [INF] Executed endpoint 'Hospital.Controllers.ScheduleController.Delete (Hospital)'
2025-11-24 02:12:10.566 +02:00 [DBG] Connection id "0HNHATN3K8HR3" completed keep alive response.
2025-11-24 02:12:10.567 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:12:10.567 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:12:10.568 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:12:10.569 +02:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7217/api/Schedule/3 - 200 null text/plain; charset=utf-8 76.5737ms
2025-11-24 02:12:21.705 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Schedule/day/friday - null null
2025-11-24 02:12:21.707 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Schedule/day/friday'
2025-11-24 02:12:21.708 +02:00 [DBG] Endpoint 'Hospital.Controllers.ScheduleController.GetDoctorsByDay (Hospital)' with route pattern 'api/Schedule/day/{dayOfWeek}' is valid for the request path '/api/Schedule/day/friday'
2025-11-24 02:12:21.709 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.ScheduleController.GetDoctorsByDay (Hospital)'
2025-11-24 02:12:21.710 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:12:21.711 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:12:21.712 +02:00 [INF] Executing endpoint 'Hospital.Controllers.ScheduleController.GetDoctorsByDay (Hospital)'
2025-11-24 02:12:21.715 +02:00 [INF] Route matched with {action = "GetDoctorsByDay", controller = "Schedule"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IEnumerable`1[Hospital.Application.DTO.Schedule.ScheduleDto]]] GetDoctorsByDay(System.String) on controller Hospital.Controllers.ScheduleController (Hospital).
2025-11-24 02:12:21.716 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:12:21.717 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:12:21.717 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:12:21.718 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:12:21.719 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:12:21.720 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:12:21.721 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:12:21.722 +02:00 [DBG] Attempting to bind parameter 'dayOfWeek' of type 'System.String' ...
2025-11-24 02:12:21.723 +02:00 [DBG] Attempting to bind parameter 'dayOfWeek' of type 'System.String' using the name 'dayOfWeek' in request data ...
2025-11-24 02:12:21.723 +02:00 [DBG] Done attempting to bind parameter 'dayOfWeek' of type 'System.String'.
2025-11-24 02:12:21.724 +02:00 [DBG] Done attempting to bind parameter 'dayOfWeek' of type 'System.String'.
2025-11-24 02:12:21.724 +02:00 [DBG] Attempting to validate the bound parameter 'dayOfWeek' of type 'System.String' ...
2025-11-24 02:12:21.726 +02:00 [DBG] Done attempting to validate the bound parameter 'dayOfWeek' of type 'System.String'.
2025-11-24 02:12:21.727 +02:00 [INF] get schedule to doctor by day called at "2025-11-24T02:12:21.7276632+02:00"
2025-11-24 02:12:21.728 +02:00 [INF] Fetching schedules for DayOfWeek: friday
2025-11-24 02:12:21.729 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:12:21.730 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:12:21.730 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:12:21.731 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:12:21.731 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:12:21.732 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:12:21.733 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:12:21.734 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:12:21.735 +02:00 [DBG] Executing DbCommand [Parameters=[@__ToLower_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE LOWER([s].[DayOfWeek]) = @__ToLower_0
2025-11-24 02:12:21.737 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__ToLower_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE LOWER([s].[DayOfWeek]) = @__ToLower_0
2025-11-24 02:12:21.739 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:12:21.740 +02:00 [DBG] The navigation 'Schedule.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:12:21.740 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:12:21.741 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:12:21.742 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:12:21.743 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:12:21.743 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 4ms reading results.
2025-11-24 02:12:21.744 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:12:21.745 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:12:21.746 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:12:21.748 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:12:21.748 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:12:21.749 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:12:21.750 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:12:21.751 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Schedule.ScheduleDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 02:12:21.751 +02:00 [INF] Executed action Hospital.Controllers.ScheduleController.GetDoctorsByDay (Hospital) in 31.9738ms
2025-11-24 02:12:21.752 +02:00 [INF] Executed endpoint 'Hospital.Controllers.ScheduleController.GetDoctorsByDay (Hospital)'
2025-11-24 02:12:21.753 +02:00 [DBG] Connection id "0HNHATN3K8HR3" completed keep alive response.
2025-11-24 02:12:21.753 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:12:21.754 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:12:21.754 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:12:21.755 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Schedule/day/friday - 200 null application/json; charset=utf-8 49.397ms
2025-11-24 02:12:31.742 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Schedule/date/11-21-2025 - null null
2025-11-24 02:12:31.744 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Schedule/date/11-21-2025'
2025-11-24 02:12:31.745 +02:00 [DBG] Endpoint 'Hospital.Controllers.ScheduleController.GetDoctorsByDate (Hospital)' with route pattern 'api/Schedule/date/{date}' is valid for the request path '/api/Schedule/date/11-21-2025'
2025-11-24 02:12:31.746 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.ScheduleController.GetDoctorsByDate (Hospital)'
2025-11-24 02:12:31.747 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:12:31.747 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:12:31.748 +02:00 [INF] Executing endpoint 'Hospital.Controllers.ScheduleController.GetDoctorsByDate (Hospital)'
2025-11-24 02:12:31.752 +02:00 [INF] Route matched with {action = "GetDoctorsByDate", controller = "Schedule"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IEnumerable`1[Hospital.Application.DTO.Schedule.ScheduleDto]]] GetDoctorsByDate(System.DateOnly) on controller Hospital.Controllers.ScheduleController (Hospital).
2025-11-24 02:12:31.754 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:12:31.756 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:12:31.757 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:12:31.758 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:12:31.759 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:12:31.760 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:12:31.761 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:12:31.762 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateOnly' ...
2025-11-24 02:12:31.763 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateOnly' using the name 'date' in request data ...
2025-11-24 02:12:31.767 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateOnly'.
2025-11-24 02:12:31.768 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateOnly'.
2025-11-24 02:12:31.768 +02:00 [DBG] Attempting to validate the bound parameter 'date' of type 'System.DateOnly' ...
2025-11-24 02:12:31.769 +02:00 [DBG] Done attempting to validate the bound parameter 'date' of type 'System.DateOnly'.
2025-11-24 02:12:31.771 +02:00 [INF] get schedule to doctor by date called at "2025-11-24T02:12:31.7713020+02:00"
2025-11-24 02:12:31.772 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:12:31.774 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:12:31.774 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:12:31.775 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:12:31.776 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter' and content type 'text/plain' to write the response.
2025-11-24 02:12:31.777 +02:00 [INF] Executing BadRequestObjectResult, writing value of type 'System.String'.
2025-11-24 02:12:31.778 +02:00 [INF] Executed action Hospital.Controllers.ScheduleController.GetDoctorsByDate (Hospital) in 17.4875ms
2025-11-24 02:12:31.779 +02:00 [INF] Executed endpoint 'Hospital.Controllers.ScheduleController.GetDoctorsByDate (Hospital)'
2025-11-24 02:12:31.780 +02:00 [DBG] Connection id "0HNHATN3K8HR3" completed keep alive response.
2025-11-24 02:12:31.781 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Schedule/date/11-21-2025 - 400 null text/plain; charset=utf-8 38.6532ms
2025-11-24 02:12:43.273 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Schedule/date/11-24-2025 - null null
2025-11-24 02:12:43.274 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Schedule/date/11-24-2025'
2025-11-24 02:12:43.275 +02:00 [DBG] Endpoint 'Hospital.Controllers.ScheduleController.GetDoctorsByDate (Hospital)' with route pattern 'api/Schedule/date/{date}' is valid for the request path '/api/Schedule/date/11-24-2025'
2025-11-24 02:12:43.277 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.ScheduleController.GetDoctorsByDate (Hospital)'
2025-11-24 02:12:43.277 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:12:43.278 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:12:43.278 +02:00 [INF] Executing endpoint 'Hospital.Controllers.ScheduleController.GetDoctorsByDate (Hospital)'
2025-11-24 02:12:43.278 +02:00 [INF] Route matched with {action = "GetDoctorsByDate", controller = "Schedule"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IEnumerable`1[Hospital.Application.DTO.Schedule.ScheduleDto]]] GetDoctorsByDate(System.DateOnly) on controller Hospital.Controllers.ScheduleController (Hospital).
2025-11-24 02:12:43.279 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:12:43.280 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:12:43.280 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:12:43.283 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:12:43.284 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:12:43.286 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:12:43.287 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:12:43.288 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateOnly' ...
2025-11-24 02:12:43.288 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateOnly' using the name 'date' in request data ...
2025-11-24 02:12:43.289 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateOnly'.
2025-11-24 02:12:43.289 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateOnly'.
2025-11-24 02:12:43.290 +02:00 [DBG] Attempting to validate the bound parameter 'date' of type 'System.DateOnly' ...
2025-11-24 02:12:43.290 +02:00 [DBG] Done attempting to validate the bound parameter 'date' of type 'System.DateOnly'.
2025-11-24 02:12:43.292 +02:00 [INF] get schedule to doctor by date called at "2025-11-24T02:12:43.2925736+02:00"
2025-11-24 02:12:43.293 +02:00 [INF] Fetching schedules for DayOfWeek: Monday
2025-11-24 02:12:43.294 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:12:43.295 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:12:43.296 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:12:43.296 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:12:43.296 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:12:43.297 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:12:43.297 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:12:43.298 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:12:43.299 +02:00 [DBG] Executing DbCommand [Parameters=[@__ToLower_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE LOWER([s].[DayOfWeek]) = @__ToLower_0
2025-11-24 02:12:43.305 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[@__ToLower_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE LOWER([s].[DayOfWeek]) = @__ToLower_0
2025-11-24 02:12:43.306 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:12:43.307 +02:00 [DBG] The navigation 'Schedule.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:12:43.308 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:12:43.308 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:12:43.309 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:12:43.309 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:12:43.310 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 3ms reading results.
2025-11-24 02:12:43.311 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:12:43.311 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:12:43.312 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:12:43.314 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:12:43.314 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:12:43.315 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:12:43.316 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:12:43.316 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Schedule.ScheduleDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 02:12:43.317 +02:00 [INF] Executed action Hospital.Controllers.ScheduleController.GetDoctorsByDate (Hospital) in 31.1494ms
2025-11-24 02:12:43.318 +02:00 [INF] Executed endpoint 'Hospital.Controllers.ScheduleController.GetDoctorsByDate (Hospital)'
2025-11-24 02:12:43.318 +02:00 [DBG] Connection id "0HNHATN3K8HR3" completed keep alive response.
2025-11-24 02:12:43.319 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:12:43.319 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:12:43.320 +02:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-11-24 02:12:43.322 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Schedule/date/11-24-2025 - 200 null application/json; charset=utf-8 48.7594ms
2025-11-24 02:13:42.113 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Schedule/date/11-21-2025/shift/1 - null null
2025-11-24 02:13:42.120 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Schedule/date/11-21-2025/shift/1'
2025-11-24 02:13:42.121 +02:00 [DBG] Endpoint 'Hospital.Controllers.ScheduleController.GetDoctorsByDateAndShift (Hospital)' with route pattern 'api/Schedule/date/{date}/shift/{shift}' is valid for the request path '/api/Schedule/date/11-21-2025/shift/1'
2025-11-24 02:13:42.122 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.ScheduleController.GetDoctorsByDateAndShift (Hospital)'
2025-11-24 02:13:42.124 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:13:42.124 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:13:42.125 +02:00 [INF] Executing endpoint 'Hospital.Controllers.ScheduleController.GetDoctorsByDateAndShift (Hospital)'
2025-11-24 02:13:42.127 +02:00 [INF] Route matched with {action = "GetDoctorsByDateAndShift", controller = "Schedule"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IEnumerable`1[Hospital.Application.DTO.Schedule.ScheduleDto]]] GetDoctorsByDateAndShift(System.DateOnly, Hospital.Domain.Enum.AppointmentShift) on controller Hospital.Controllers.ScheduleController (Hospital).
2025-11-24 02:13:42.128 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:13:42.129 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:13:42.129 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:13:42.130 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:13:42.131 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:13:42.132 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:13:42.133 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:13:42.133 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateOnly' ...
2025-11-24 02:13:42.134 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateOnly' using the name 'date' in request data ...
2025-11-24 02:13:42.135 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateOnly'.
2025-11-24 02:13:42.135 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateOnly'.
2025-11-24 02:13:42.136 +02:00 [DBG] Attempting to validate the bound parameter 'date' of type 'System.DateOnly' ...
2025-11-24 02:13:42.136 +02:00 [DBG] Done attempting to validate the bound parameter 'date' of type 'System.DateOnly'.
2025-11-24 02:13:42.137 +02:00 [DBG] Attempting to bind parameter 'shift' of type 'Hospital.Domain.Enum.AppointmentShift' ...
2025-11-24 02:13:42.137 +02:00 [DBG] Attempting to bind parameter 'shift' of type 'Hospital.Domain.Enum.AppointmentShift' using the name 'shift' in request data ...
2025-11-24 02:13:42.139 +02:00 [DBG] Done attempting to bind parameter 'shift' of type 'Hospital.Domain.Enum.AppointmentShift'.
2025-11-24 02:13:42.140 +02:00 [DBG] Done attempting to bind parameter 'shift' of type 'Hospital.Domain.Enum.AppointmentShift'.
2025-11-24 02:13:42.141 +02:00 [DBG] Attempting to validate the bound parameter 'shift' of type 'Hospital.Domain.Enum.AppointmentShift' ...
2025-11-24 02:13:42.141 +02:00 [DBG] Done attempting to validate the bound parameter 'shift' of type 'Hospital.Domain.Enum.AppointmentShift'.
2025-11-24 02:13:42.142 +02:00 [INF] get schedule to doctor by data and shift called at "2025-11-24T02:13:42.1429562+02:00"
2025-11-24 02:13:42.143 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:13:42.144 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:13:42.145 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:13:42.146 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:13:42.147 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter' and content type 'text/plain' to write the response.
2025-11-24 02:13:42.148 +02:00 [INF] Executing BadRequestObjectResult, writing value of type 'System.String'.
2025-11-24 02:13:42.149 +02:00 [INF] Executed action Hospital.Controllers.ScheduleController.GetDoctorsByDateAndShift (Hospital) in 17.2146ms
2025-11-24 02:13:42.150 +02:00 [INF] Executed endpoint 'Hospital.Controllers.ScheduleController.GetDoctorsByDateAndShift (Hospital)'
2025-11-24 02:13:42.150 +02:00 [DBG] Connection id "0HNHATN3K8HR3" completed keep alive response.
2025-11-24 02:13:42.151 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Schedule/date/11-21-2025/shift/1 - 400 null text/plain; charset=utf-8 38.7954ms
2025-11-24 02:13:48.888 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Schedule/date/11-24-2025/shift/1 - null null
2025-11-24 02:13:48.889 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Schedule/date/11-24-2025/shift/1'
2025-11-24 02:13:48.890 +02:00 [DBG] Endpoint 'Hospital.Controllers.ScheduleController.GetDoctorsByDateAndShift (Hospital)' with route pattern 'api/Schedule/date/{date}/shift/{shift}' is valid for the request path '/api/Schedule/date/11-24-2025/shift/1'
2025-11-24 02:13:48.892 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.ScheduleController.GetDoctorsByDateAndShift (Hospital)'
2025-11-24 02:13:48.893 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:13:48.893 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:13:48.893 +02:00 [INF] Executing endpoint 'Hospital.Controllers.ScheduleController.GetDoctorsByDateAndShift (Hospital)'
2025-11-24 02:13:48.894 +02:00 [INF] Route matched with {action = "GetDoctorsByDateAndShift", controller = "Schedule"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IEnumerable`1[Hospital.Application.DTO.Schedule.ScheduleDto]]] GetDoctorsByDateAndShift(System.DateOnly, Hospital.Domain.Enum.AppointmentShift) on controller Hospital.Controllers.ScheduleController (Hospital).
2025-11-24 02:13:48.895 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:13:48.896 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:13:48.897 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:13:48.897 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:13:48.898 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:13:48.899 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:13:48.900 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:13:48.900 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateOnly' ...
2025-11-24 02:13:48.901 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateOnly' using the name 'date' in request data ...
2025-11-24 02:13:48.902 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateOnly'.
2025-11-24 02:13:48.903 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateOnly'.
2025-11-24 02:13:48.903 +02:00 [DBG] Attempting to validate the bound parameter 'date' of type 'System.DateOnly' ...
2025-11-24 02:13:48.904 +02:00 [DBG] Done attempting to validate the bound parameter 'date' of type 'System.DateOnly'.
2025-11-24 02:13:48.904 +02:00 [DBG] Attempting to bind parameter 'shift' of type 'Hospital.Domain.Enum.AppointmentShift' ...
2025-11-24 02:13:48.905 +02:00 [DBG] Attempting to bind parameter 'shift' of type 'Hospital.Domain.Enum.AppointmentShift' using the name 'shift' in request data ...
2025-11-24 02:13:48.906 +02:00 [DBG] Done attempting to bind parameter 'shift' of type 'Hospital.Domain.Enum.AppointmentShift'.
2025-11-24 02:13:48.906 +02:00 [DBG] Done attempting to bind parameter 'shift' of type 'Hospital.Domain.Enum.AppointmentShift'.
2025-11-24 02:13:48.907 +02:00 [DBG] Attempting to validate the bound parameter 'shift' of type 'Hospital.Domain.Enum.AppointmentShift' ...
2025-11-24 02:13:48.909 +02:00 [DBG] Done attempting to validate the bound parameter 'shift' of type 'Hospital.Domain.Enum.AppointmentShift'.
2025-11-24 02:13:48.909 +02:00 [INF] get schedule to doctor by data and shift called at "2025-11-24T02:13:48.9097660+02:00"
2025-11-24 02:13:48.911 +02:00 [INF] Fetching schedules for DayOfWeek: Monday and Shift: "Morning"
2025-11-24 02:13:48.913 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:13:48.914 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:13:48.914 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:13:48.915 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:13:48.915 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:13:48.916 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:13:48.916 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:13:48.917 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:13:48.917 +02:00 [DBG] Executing DbCommand [Parameters=[@__ToLower_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE LOWER([s].[DayOfWeek]) = @__ToLower_0
2025-11-24 02:13:48.925 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[@__ToLower_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE LOWER([s].[DayOfWeek]) = @__ToLower_0
2025-11-24 02:13:48.926 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:13:48.927 +02:00 [DBG] The navigation 'Schedule.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:13:48.928 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:13:48.929 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:13:48.930 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:13:48.930 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:13:48.931 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 4ms reading results.
2025-11-24 02:13:48.932 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:13:48.932 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:13:48.933 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:13:48.934 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:13:48.935 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:13:48.935 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:13:48.936 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:13:48.936 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Schedule.ScheduleDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 02:13:48.937 +02:00 [INF] Executed action Hospital.Controllers.ScheduleController.GetDoctorsByDateAndShift (Hospital) in 38.1801ms
2025-11-24 02:13:48.938 +02:00 [INF] Executed endpoint 'Hospital.Controllers.ScheduleController.GetDoctorsByDateAndShift (Hospital)'
2025-11-24 02:13:48.941 +02:00 [DBG] Connection id "0HNHATN3K8HR3" completed keep alive response.
2025-11-24 02:13:48.941 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:13:48.942 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:13:48.942 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:13:48.943 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Schedule/date/11-24-2025/shift/1 - 200 null application/json; charset=utf-8 55.1417ms
2025-11-24 02:13:56.018 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Schedule/date/11-24-2025/shift/3 - null null
2025-11-24 02:13:56.020 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Schedule/date/11-24-2025/shift/3'
2025-11-24 02:13:56.020 +02:00 [DBG] Endpoint 'Hospital.Controllers.ScheduleController.GetDoctorsByDateAndShift (Hospital)' with route pattern 'api/Schedule/date/{date}/shift/{shift}' is valid for the request path '/api/Schedule/date/11-24-2025/shift/3'
2025-11-24 02:13:56.022 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.ScheduleController.GetDoctorsByDateAndShift (Hospital)'
2025-11-24 02:13:56.023 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:13:56.024 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:13:56.024 +02:00 [INF] Executing endpoint 'Hospital.Controllers.ScheduleController.GetDoctorsByDateAndShift (Hospital)'
2025-11-24 02:13:56.025 +02:00 [INF] Route matched with {action = "GetDoctorsByDateAndShift", controller = "Schedule"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IEnumerable`1[Hospital.Application.DTO.Schedule.ScheduleDto]]] GetDoctorsByDateAndShift(System.DateOnly, Hospital.Domain.Enum.AppointmentShift) on controller Hospital.Controllers.ScheduleController (Hospital).
2025-11-24 02:13:56.026 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:13:56.027 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:13:56.027 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:13:56.028 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:13:56.029 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:13:56.030 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:13:56.032 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:13:56.033 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateOnly' ...
2025-11-24 02:13:56.033 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateOnly' using the name 'date' in request data ...
2025-11-24 02:13:56.034 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateOnly'.
2025-11-24 02:13:56.035 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateOnly'.
2025-11-24 02:13:56.035 +02:00 [DBG] Attempting to validate the bound parameter 'date' of type 'System.DateOnly' ...
2025-11-24 02:13:56.036 +02:00 [DBG] Done attempting to validate the bound parameter 'date' of type 'System.DateOnly'.
2025-11-24 02:13:56.036 +02:00 [DBG] Attempting to bind parameter 'shift' of type 'Hospital.Domain.Enum.AppointmentShift' ...
2025-11-24 02:13:56.036 +02:00 [DBG] Attempting to bind parameter 'shift' of type 'Hospital.Domain.Enum.AppointmentShift' using the name 'shift' in request data ...
2025-11-24 02:13:56.037 +02:00 [DBG] Done attempting to bind parameter 'shift' of type 'Hospital.Domain.Enum.AppointmentShift'.
2025-11-24 02:13:56.038 +02:00 [DBG] Done attempting to bind parameter 'shift' of type 'Hospital.Domain.Enum.AppointmentShift'.
2025-11-24 02:13:56.038 +02:00 [DBG] Attempting to validate the bound parameter 'shift' of type 'Hospital.Domain.Enum.AppointmentShift' ...
2025-11-24 02:13:56.039 +02:00 [DBG] Done attempting to validate the bound parameter 'shift' of type 'Hospital.Domain.Enum.AppointmentShift'.
2025-11-24 02:13:56.039 +02:00 [INF] get schedule to doctor by data and shift called at "2025-11-24T02:13:56.0399885+02:00"
2025-11-24 02:13:56.040 +02:00 [INF] Fetching schedules for DayOfWeek: Monday and Shift: "Evening"
2025-11-24 02:13:56.042 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:13:56.044 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:13:56.045 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:13:56.045 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:13:56.046 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:13:56.047 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:13:56.047 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:13:56.048 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:13:56.049 +02:00 [DBG] Executing DbCommand [Parameters=[@__ToLower_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE LOWER([s].[DayOfWeek]) = @__ToLower_0
2025-11-24 02:13:56.053 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__ToLower_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE LOWER([s].[DayOfWeek]) = @__ToLower_0
2025-11-24 02:13:56.058 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:13:56.059 +02:00 [DBG] The navigation 'Schedule.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:13:56.059 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:13:56.060 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:13:56.061 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:13:56.062 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:13:56.063 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 5ms reading results.
2025-11-24 02:13:56.063 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:13:56.064 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:13:56.065 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:13:56.066 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:13:56.066 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:13:56.067 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:13:56.067 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:13:56.068 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Schedule.ScheduleDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 02:13:56.069 +02:00 [INF] Executed action Hospital.Controllers.ScheduleController.GetDoctorsByDateAndShift (Hospital) in 38.5954ms
2025-11-24 02:13:56.069 +02:00 [INF] Executed endpoint 'Hospital.Controllers.ScheduleController.GetDoctorsByDateAndShift (Hospital)'
2025-11-24 02:13:56.070 +02:00 [DBG] Connection id "0HNHATN3K8HR3" completed keep alive response.
2025-11-24 02:13:56.071 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:13:56.071 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:13:56.072 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:13:56.073 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Schedule/date/11-24-2025/shift/3 - 200 null application/json; charset=utf-8 55.3374ms
2025-11-24 02:14:02.433 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Schedule/date/11-24-2025/shift/1 - null null
2025-11-24 02:14:02.434 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Schedule/date/11-24-2025/shift/1'
2025-11-24 02:14:02.435 +02:00 [DBG] Endpoint 'Hospital.Controllers.ScheduleController.GetDoctorsByDateAndShift (Hospital)' with route pattern 'api/Schedule/date/{date}/shift/{shift}' is valid for the request path '/api/Schedule/date/11-24-2025/shift/1'
2025-11-24 02:14:02.436 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.ScheduleController.GetDoctorsByDateAndShift (Hospital)'
2025-11-24 02:14:02.437 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:14:02.438 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:14:02.439 +02:00 [INF] Executing endpoint 'Hospital.Controllers.ScheduleController.GetDoctorsByDateAndShift (Hospital)'
2025-11-24 02:14:02.439 +02:00 [INF] Route matched with {action = "GetDoctorsByDateAndShift", controller = "Schedule"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IEnumerable`1[Hospital.Application.DTO.Schedule.ScheduleDto]]] GetDoctorsByDateAndShift(System.DateOnly, Hospital.Domain.Enum.AppointmentShift) on controller Hospital.Controllers.ScheduleController (Hospital).
2025-11-24 02:14:02.441 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:14:02.442 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:14:02.443 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:14:02.444 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:14:02.445 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:14:02.446 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:14:02.447 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:14:02.448 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateOnly' ...
2025-11-24 02:14:02.448 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateOnly' using the name 'date' in request data ...
2025-11-24 02:14:02.449 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateOnly'.
2025-11-24 02:14:02.450 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateOnly'.
2025-11-24 02:14:02.451 +02:00 [DBG] Attempting to validate the bound parameter 'date' of type 'System.DateOnly' ...
2025-11-24 02:14:02.451 +02:00 [DBG] Done attempting to validate the bound parameter 'date' of type 'System.DateOnly'.
2025-11-24 02:14:02.452 +02:00 [DBG] Attempting to bind parameter 'shift' of type 'Hospital.Domain.Enum.AppointmentShift' ...
2025-11-24 02:14:02.452 +02:00 [DBG] Attempting to bind parameter 'shift' of type 'Hospital.Domain.Enum.AppointmentShift' using the name 'shift' in request data ...
2025-11-24 02:14:02.453 +02:00 [DBG] Done attempting to bind parameter 'shift' of type 'Hospital.Domain.Enum.AppointmentShift'.
2025-11-24 02:14:02.454 +02:00 [DBG] Done attempting to bind parameter 'shift' of type 'Hospital.Domain.Enum.AppointmentShift'.
2025-11-24 02:14:02.454 +02:00 [DBG] Attempting to validate the bound parameter 'shift' of type 'Hospital.Domain.Enum.AppointmentShift' ...
2025-11-24 02:14:02.455 +02:00 [DBG] Done attempting to validate the bound parameter 'shift' of type 'Hospital.Domain.Enum.AppointmentShift'.
2025-11-24 02:14:02.455 +02:00 [INF] get schedule to doctor by data and shift called at "2025-11-24T02:14:02.4557789+02:00"
2025-11-24 02:14:02.456 +02:00 [INF] Fetching schedules for DayOfWeek: Monday and Shift: "Morning"
2025-11-24 02:14:02.457 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:14:02.458 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:14:02.458 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:14:02.459 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:14:02.459 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:14:02.460 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:14:02.460 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:14:02.461 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:14:02.461 +02:00 [DBG] Executing DbCommand [Parameters=[@__ToLower_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE LOWER([s].[DayOfWeek]) = @__ToLower_0
2025-11-24 02:14:02.464 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__ToLower_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE LOWER([s].[DayOfWeek]) = @__ToLower_0
2025-11-24 02:14:02.466 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:14:02.467 +02:00 [DBG] The navigation 'Schedule.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:14:02.468 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:14:02.468 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:14:02.469 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:14:02.470 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:14:02.470 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 4ms reading results.
2025-11-24 02:14:02.472 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:14:02.473 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 02:14:02.474 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:14:02.476 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:14:02.476 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:14:02.477 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:14:02.477 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:14:02.478 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Schedule.ScheduleDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 02:14:02.479 +02:00 [INF] Executed action Hospital.Controllers.ScheduleController.GetDoctorsByDateAndShift (Hospital) in 32.9243ms
2025-11-24 02:14:02.479 +02:00 [INF] Executed endpoint 'Hospital.Controllers.ScheduleController.GetDoctorsByDateAndShift (Hospital)'
2025-11-24 02:14:02.480 +02:00 [DBG] Connection id "0HNHATN3K8HR3" completed keep alive response.
2025-11-24 02:14:02.480 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:14:02.481 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:14:02.482 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:14:02.483 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Schedule/date/11-24-2025/shift/1 - 200 null application/json; charset=utf-8 49.8024ms
2025-11-24 02:14:31.525 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Schedule/day/friday/shift/1 - null null
2025-11-24 02:14:31.526 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Schedule/day/friday/shift/1'
2025-11-24 02:14:31.527 +02:00 [DBG] Endpoint 'Hospital.Controllers.ScheduleController.GetDoctorsByDayAndShift (Hospital)' with route pattern 'api/Schedule/day/{dayOfWeek}/shift/{shift}' is valid for the request path '/api/Schedule/day/friday/shift/1'
2025-11-24 02:14:31.528 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.ScheduleController.GetDoctorsByDayAndShift (Hospital)'
2025-11-24 02:14:31.529 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:14:31.530 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:14:31.531 +02:00 [INF] Executing endpoint 'Hospital.Controllers.ScheduleController.GetDoctorsByDayAndShift (Hospital)'
2025-11-24 02:14:31.534 +02:00 [INF] Route matched with {action = "GetDoctorsByDayAndShift", controller = "Schedule"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IEnumerable`1[Hospital.Application.DTO.Schedule.ScheduleDto]]] GetDoctorsByDayAndShift(System.String, Hospital.Domain.Enum.AppointmentShift) on controller Hospital.Controllers.ScheduleController (Hospital).
2025-11-24 02:14:31.535 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:14:31.536 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:14:31.536 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:14:31.537 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:14:31.538 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:14:31.538 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:14:31.539 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:14:31.539 +02:00 [DBG] Attempting to bind parameter 'dayOfWeek' of type 'System.String' ...
2025-11-24 02:14:31.540 +02:00 [DBG] Attempting to bind parameter 'dayOfWeek' of type 'System.String' using the name 'dayOfWeek' in request data ...
2025-11-24 02:14:31.540 +02:00 [DBG] Done attempting to bind parameter 'dayOfWeek' of type 'System.String'.
2025-11-24 02:14:31.541 +02:00 [DBG] Done attempting to bind parameter 'dayOfWeek' of type 'System.String'.
2025-11-24 02:14:31.542 +02:00 [DBG] Attempting to validate the bound parameter 'dayOfWeek' of type 'System.String' ...
2025-11-24 02:14:31.543 +02:00 [DBG] Done attempting to validate the bound parameter 'dayOfWeek' of type 'System.String'.
2025-11-24 02:14:31.543 +02:00 [DBG] Attempting to bind parameter 'shift' of type 'Hospital.Domain.Enum.AppointmentShift' ...
2025-11-24 02:14:31.544 +02:00 [DBG] Attempting to bind parameter 'shift' of type 'Hospital.Domain.Enum.AppointmentShift' using the name 'shift' in request data ...
2025-11-24 02:14:31.545 +02:00 [DBG] Done attempting to bind parameter 'shift' of type 'Hospital.Domain.Enum.AppointmentShift'.
2025-11-24 02:14:31.545 +02:00 [DBG] Done attempting to bind parameter 'shift' of type 'Hospital.Domain.Enum.AppointmentShift'.
2025-11-24 02:14:31.546 +02:00 [DBG] Attempting to validate the bound parameter 'shift' of type 'Hospital.Domain.Enum.AppointmentShift' ...
2025-11-24 02:14:31.547 +02:00 [DBG] Done attempting to validate the bound parameter 'shift' of type 'Hospital.Domain.Enum.AppointmentShift'.
2025-11-24 02:14:31.548 +02:00 [INF] get schedule to doctor by shift called at "2025-11-24T02:14:31.5487494+02:00"
2025-11-24 02:14:31.549 +02:00 [INF] Fetching schedules for DayOfWeek: friday and Shift: "Morning"
2025-11-24 02:14:31.550 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:14:31.552 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:14:31.553 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:14:31.553 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:14:31.554 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:14:31.554 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:14:31.555 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:14:31.555 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:14:31.556 +02:00 [DBG] Executing DbCommand [Parameters=[@__ToLower_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE LOWER([s].[DayOfWeek]) = @__ToLower_0
2025-11-24 02:14:31.560 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__ToLower_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE LOWER([s].[DayOfWeek]) = @__ToLower_0
2025-11-24 02:14:31.565 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:14:31.566 +02:00 [DBG] The navigation 'Schedule.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:14:31.566 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:14:31.567 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:14:31.568 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:14:31.568 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:14:31.569 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 4ms reading results.
2025-11-24 02:14:31.570 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:14:31.571 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:14:31.571 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:14:31.573 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:14:31.573 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:14:31.574 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:14:31.574 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:14:31.574 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Schedule.ScheduleDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 02:14:31.575 +02:00 [INF] Executed action Hospital.Controllers.ScheduleController.GetDoctorsByDayAndShift (Hospital) in 37.0973ms
2025-11-24 02:14:31.576 +02:00 [INF] Executed endpoint 'Hospital.Controllers.ScheduleController.GetDoctorsByDayAndShift (Hospital)'
2025-11-24 02:14:31.577 +02:00 [DBG] Connection id "0HNHATN3K8HR3" completed keep alive response.
2025-11-24 02:14:31.577 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:14:31.578 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:14:31.578 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:14:31.579 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Schedule/day/friday/shift/1 - 200 null application/json; charset=utf-8 53.9112ms
2025-11-24 02:14:40.448 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Schedule/day/friday/shift/3 - null null
2025-11-24 02:14:40.450 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Schedule/day/friday/shift/3'
2025-11-24 02:14:40.451 +02:00 [DBG] Endpoint 'Hospital.Controllers.ScheduleController.GetDoctorsByDayAndShift (Hospital)' with route pattern 'api/Schedule/day/{dayOfWeek}/shift/{shift}' is valid for the request path '/api/Schedule/day/friday/shift/3'
2025-11-24 02:14:40.453 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.ScheduleController.GetDoctorsByDayAndShift (Hospital)'
2025-11-24 02:14:40.454 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:14:40.454 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:14:40.455 +02:00 [INF] Executing endpoint 'Hospital.Controllers.ScheduleController.GetDoctorsByDayAndShift (Hospital)'
2025-11-24 02:14:40.456 +02:00 [INF] Route matched with {action = "GetDoctorsByDayAndShift", controller = "Schedule"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IEnumerable`1[Hospital.Application.DTO.Schedule.ScheduleDto]]] GetDoctorsByDayAndShift(System.String, Hospital.Domain.Enum.AppointmentShift) on controller Hospital.Controllers.ScheduleController (Hospital).
2025-11-24 02:14:40.458 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:14:40.459 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:14:40.460 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:14:40.461 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:14:40.462 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:14:40.463 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:14:40.464 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:14:40.465 +02:00 [DBG] Attempting to bind parameter 'dayOfWeek' of type 'System.String' ...
2025-11-24 02:14:40.466 +02:00 [DBG] Attempting to bind parameter 'dayOfWeek' of type 'System.String' using the name 'dayOfWeek' in request data ...
2025-11-24 02:14:40.467 +02:00 [DBG] Done attempting to bind parameter 'dayOfWeek' of type 'System.String'.
2025-11-24 02:14:40.468 +02:00 [DBG] Done attempting to bind parameter 'dayOfWeek' of type 'System.String'.
2025-11-24 02:14:40.468 +02:00 [DBG] Attempting to validate the bound parameter 'dayOfWeek' of type 'System.String' ...
2025-11-24 02:14:40.469 +02:00 [DBG] Done attempting to validate the bound parameter 'dayOfWeek' of type 'System.String'.
2025-11-24 02:14:40.471 +02:00 [DBG] Attempting to bind parameter 'shift' of type 'Hospital.Domain.Enum.AppointmentShift' ...
2025-11-24 02:14:40.472 +02:00 [DBG] Attempting to bind parameter 'shift' of type 'Hospital.Domain.Enum.AppointmentShift' using the name 'shift' in request data ...
2025-11-24 02:14:40.474 +02:00 [DBG] Done attempting to bind parameter 'shift' of type 'Hospital.Domain.Enum.AppointmentShift'.
2025-11-24 02:14:40.474 +02:00 [DBG] Done attempting to bind parameter 'shift' of type 'Hospital.Domain.Enum.AppointmentShift'.
2025-11-24 02:14:40.475 +02:00 [DBG] Attempting to validate the bound parameter 'shift' of type 'Hospital.Domain.Enum.AppointmentShift' ...
2025-11-24 02:14:40.476 +02:00 [DBG] Done attempting to validate the bound parameter 'shift' of type 'Hospital.Domain.Enum.AppointmentShift'.
2025-11-24 02:14:40.477 +02:00 [INF] get schedule to doctor by shift called at "2025-11-24T02:14:40.4773766+02:00"
2025-11-24 02:14:40.477 +02:00 [INF] Fetching schedules for DayOfWeek: friday and Shift: "Evening"
2025-11-24 02:14:40.479 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:14:40.480 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:14:40.481 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:14:40.481 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:14:40.482 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:14:40.483 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:14:40.484 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:14:40.484 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:14:40.485 +02:00 [DBG] Executing DbCommand [Parameters=[@__ToLower_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE LOWER([s].[DayOfWeek]) = @__ToLower_0
2025-11-24 02:14:40.493 +02:00 [INF] Executed DbCommand (8ms) [Parameters=[@__ToLower_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE LOWER([s].[DayOfWeek]) = @__ToLower_0
2025-11-24 02:14:40.496 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:14:40.497 +02:00 [DBG] The navigation 'Schedule.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:14:40.499 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:14:40.500 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:14:40.501 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:14:40.502 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:14:40.503 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 6ms reading results.
2025-11-24 02:14:40.504 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:14:40.504 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:14:40.505 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:14:40.507 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:14:40.507 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:14:40.509 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:14:40.509 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:14:40.510 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Schedule.ScheduleDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 02:14:40.511 +02:00 [INF] Executed action Hospital.Controllers.ScheduleController.GetDoctorsByDayAndShift (Hospital) in 48.4498ms
2025-11-24 02:14:40.512 +02:00 [INF] Executed endpoint 'Hospital.Controllers.ScheduleController.GetDoctorsByDayAndShift (Hospital)'
2025-11-24 02:14:40.513 +02:00 [DBG] Connection id "0HNHATN3K8HR3" completed keep alive response.
2025-11-24 02:14:40.514 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:14:40.515 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:14:40.515 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:14:40.516 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Schedule/day/friday/shift/3 - 200 null application/json; charset=utf-8 67.9511ms
2025-11-24 02:14:59.228 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Schedule/date/11-24-2025/shift/1 - null null
2025-11-24 02:14:59.230 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Schedule/date/11-24-2025/shift/1'
2025-11-24 02:14:59.232 +02:00 [DBG] Endpoint 'Hospital.Controllers.ScheduleController.GetDoctorsByDateAndShift (Hospital)' with route pattern 'api/Schedule/date/{date}/shift/{shift}' is valid for the request path '/api/Schedule/date/11-24-2025/shift/1'
2025-11-24 02:14:59.233 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.ScheduleController.GetDoctorsByDateAndShift (Hospital)'
2025-11-24 02:14:59.234 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:14:59.234 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:14:59.235 +02:00 [INF] Executing endpoint 'Hospital.Controllers.ScheduleController.GetDoctorsByDateAndShift (Hospital)'
2025-11-24 02:14:59.236 +02:00 [INF] Route matched with {action = "GetDoctorsByDateAndShift", controller = "Schedule"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IEnumerable`1[Hospital.Application.DTO.Schedule.ScheduleDto]]] GetDoctorsByDateAndShift(System.DateOnly, Hospital.Domain.Enum.AppointmentShift) on controller Hospital.Controllers.ScheduleController (Hospital).
2025-11-24 02:14:59.236 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:14:59.237 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:14:59.238 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:14:59.238 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:14:59.239 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:14:59.240 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:14:59.242 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:14:59.242 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateOnly' ...
2025-11-24 02:14:59.243 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateOnly' using the name 'date' in request data ...
2025-11-24 02:14:59.244 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateOnly'.
2025-11-24 02:14:59.244 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateOnly'.
2025-11-24 02:14:59.245 +02:00 [DBG] Attempting to validate the bound parameter 'date' of type 'System.DateOnly' ...
2025-11-24 02:14:59.245 +02:00 [DBG] Done attempting to validate the bound parameter 'date' of type 'System.DateOnly'.
2025-11-24 02:14:59.246 +02:00 [DBG] Attempting to bind parameter 'shift' of type 'Hospital.Domain.Enum.AppointmentShift' ...
2025-11-24 02:14:59.246 +02:00 [DBG] Attempting to bind parameter 'shift' of type 'Hospital.Domain.Enum.AppointmentShift' using the name 'shift' in request data ...
2025-11-24 02:14:59.247 +02:00 [DBG] Done attempting to bind parameter 'shift' of type 'Hospital.Domain.Enum.AppointmentShift'.
2025-11-24 02:14:59.247 +02:00 [DBG] Done attempting to bind parameter 'shift' of type 'Hospital.Domain.Enum.AppointmentShift'.
2025-11-24 02:14:59.248 +02:00 [DBG] Attempting to validate the bound parameter 'shift' of type 'Hospital.Domain.Enum.AppointmentShift' ...
2025-11-24 02:14:59.249 +02:00 [DBG] Done attempting to validate the bound parameter 'shift' of type 'Hospital.Domain.Enum.AppointmentShift'.
2025-11-24 02:14:59.249 +02:00 [INF] get schedule to doctor by data and shift called at "2025-11-24T02:14:59.2494820+02:00"
2025-11-24 02:14:59.249 +02:00 [INF] Fetching schedules for DayOfWeek: Monday and Shift: "Morning"
2025-11-24 02:14:59.250 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:14:59.251 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:14:59.252 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:14:59.252 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:14:59.253 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:14:59.253 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:14:59.254 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:14:59.255 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:14:59.256 +02:00 [DBG] Executing DbCommand [Parameters=[@__ToLower_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE LOWER([s].[DayOfWeek]) = @__ToLower_0
2025-11-24 02:14:59.261 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@__ToLower_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE LOWER([s].[DayOfWeek]) = @__ToLower_0
2025-11-24 02:14:59.263 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:14:59.263 +02:00 [DBG] The navigation 'Schedule.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:14:59.264 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:14:59.264 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:14:59.265 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:14:59.266 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:14:59.266 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 3ms reading results.
2025-11-24 02:14:59.267 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:14:59.267 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:14:59.268 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:14:59.268 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:14:59.269 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:14:59.269 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:14:59.269 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:14:59.270 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Schedule.ScheduleDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 02:14:59.271 +02:00 [INF] Executed action Hospital.Controllers.ScheduleController.GetDoctorsByDateAndShift (Hospital) in 30.8492ms
2025-11-24 02:14:59.272 +02:00 [INF] Executed endpoint 'Hospital.Controllers.ScheduleController.GetDoctorsByDateAndShift (Hospital)'
2025-11-24 02:14:59.273 +02:00 [DBG] Connection id "0HNHATN3K8HR3" completed keep alive response.
2025-11-24 02:14:59.274 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:14:59.275 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:14:59.276 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:14:59.276 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Schedule/date/11-24-2025/shift/1 - 200 null application/json; charset=utf-8 48.3481ms
2025-11-24 02:15:03.942 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Schedule/date/11-24-2025/shift/3 - null null
2025-11-24 02:15:03.943 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Schedule/date/11-24-2025/shift/3'
2025-11-24 02:15:03.944 +02:00 [DBG] Endpoint 'Hospital.Controllers.ScheduleController.GetDoctorsByDateAndShift (Hospital)' with route pattern 'api/Schedule/date/{date}/shift/{shift}' is valid for the request path '/api/Schedule/date/11-24-2025/shift/3'
2025-11-24 02:15:03.945 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.ScheduleController.GetDoctorsByDateAndShift (Hospital)'
2025-11-24 02:15:03.946 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:15:03.946 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:15:03.947 +02:00 [INF] Executing endpoint 'Hospital.Controllers.ScheduleController.GetDoctorsByDateAndShift (Hospital)'
2025-11-24 02:15:03.947 +02:00 [INF] Route matched with {action = "GetDoctorsByDateAndShift", controller = "Schedule"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IEnumerable`1[Hospital.Application.DTO.Schedule.ScheduleDto]]] GetDoctorsByDateAndShift(System.DateOnly, Hospital.Domain.Enum.AppointmentShift) on controller Hospital.Controllers.ScheduleController (Hospital).
2025-11-24 02:15:03.949 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:15:03.949 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:15:03.950 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:15:03.951 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:15:03.952 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:15:03.954 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:15:03.955 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:15:03.955 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateOnly' ...
2025-11-24 02:15:03.957 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateOnly' using the name 'date' in request data ...
2025-11-24 02:15:03.958 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateOnly'.
2025-11-24 02:15:03.959 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateOnly'.
2025-11-24 02:15:03.960 +02:00 [DBG] Attempting to validate the bound parameter 'date' of type 'System.DateOnly' ...
2025-11-24 02:15:03.960 +02:00 [DBG] Done attempting to validate the bound parameter 'date' of type 'System.DateOnly'.
2025-11-24 02:15:03.961 +02:00 [DBG] Attempting to bind parameter 'shift' of type 'Hospital.Domain.Enum.AppointmentShift' ...
2025-11-24 02:15:03.961 +02:00 [DBG] Attempting to bind parameter 'shift' of type 'Hospital.Domain.Enum.AppointmentShift' using the name 'shift' in request data ...
2025-11-24 02:15:03.962 +02:00 [DBG] Done attempting to bind parameter 'shift' of type 'Hospital.Domain.Enum.AppointmentShift'.
2025-11-24 02:15:03.963 +02:00 [DBG] Done attempting to bind parameter 'shift' of type 'Hospital.Domain.Enum.AppointmentShift'.
2025-11-24 02:15:03.964 +02:00 [DBG] Attempting to validate the bound parameter 'shift' of type 'Hospital.Domain.Enum.AppointmentShift' ...
2025-11-24 02:15:03.964 +02:00 [DBG] Done attempting to validate the bound parameter 'shift' of type 'Hospital.Domain.Enum.AppointmentShift'.
2025-11-24 02:15:03.965 +02:00 [INF] get schedule to doctor by data and shift called at "2025-11-24T02:15:03.9655089+02:00"
2025-11-24 02:15:03.965 +02:00 [INF] Fetching schedules for DayOfWeek: Monday and Shift: "Evening"
2025-11-24 02:15:03.966 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:15:03.968 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:15:03.968 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:15:03.969 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:15:03.969 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:15:03.970 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:15:03.970 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:15:03.971 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:15:03.972 +02:00 [DBG] Executing DbCommand [Parameters=[@__ToLower_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE LOWER([s].[DayOfWeek]) = @__ToLower_0
2025-11-24 02:15:03.975 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__ToLower_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE LOWER([s].[DayOfWeek]) = @__ToLower_0
2025-11-24 02:15:03.976 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:15:03.977 +02:00 [DBG] The navigation 'Schedule.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:15:03.978 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:15:03.978 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:15:03.979 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:15:03.980 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:15:03.981 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 4ms reading results.
2025-11-24 02:15:03.981 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:15:03.982 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:15:03.983 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:15:03.984 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:15:03.985 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:15:03.985 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:15:03.985 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:15:03.986 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Schedule.ScheduleDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 02:15:03.987 +02:00 [INF] Executed action Hospital.Controllers.ScheduleController.GetDoctorsByDateAndShift (Hospital) in 33.7214ms
2025-11-24 02:15:03.988 +02:00 [INF] Executed endpoint 'Hospital.Controllers.ScheduleController.GetDoctorsByDateAndShift (Hospital)'
2025-11-24 02:15:03.989 +02:00 [DBG] Connection id "0HNHATN3K8HR3" completed keep alive response.
2025-11-24 02:15:03.989 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:15:03.990 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:15:03.991 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:15:03.992 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Schedule/date/11-24-2025/shift/3 - 200 null application/json; charset=utf-8 49.7291ms
2025-11-24 02:15:13.052 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Schedule - null null
2025-11-24 02:15:13.055 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Schedule'
2025-11-24 02:15:13.057 +02:00 [DBG] Endpoint 'Hospital.Controllers.ScheduleController.GetAll (Hospital)' with route pattern 'api/Schedule' is valid for the request path '/api/Schedule'
2025-11-24 02:15:13.058 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.ScheduleController.GetAll (Hospital)'
2025-11-24 02:15:13.059 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:15:13.060 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:15:13.060 +02:00 [INF] Executing endpoint 'Hospital.Controllers.ScheduleController.GetAll (Hospital)'
2025-11-24 02:15:13.064 +02:00 [INF] Route matched with {action = "GetAll", controller = "Schedule"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IEnumerable`1[Hospital.Application.DTO.Schedule.ScheduleDto]]] GetAll() on controller Hospital.Controllers.ScheduleController (Hospital).
2025-11-24 02:15:13.065 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:15:13.065 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:15:13.066 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:15:13.067 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:15:13.067 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:15:13.068 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:15:13.068 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:15:13.070 +02:00 [INF] get all schedule called at "2025-11-24T02:15:13.0704102+02:00"
2025-11-24 02:15:13.071 +02:00 [INF] Fetching all schedules
2025-11-24 02:15:13.072 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:15:13.074 +02:00 [DBG] Compiling query expression: 
'DbSet<Schedule>()
    .Include(s => s.Doctor)
    .ThenInclude(d => d.User)'
2025-11-24 02:15:13.076 +02:00 [DBG] Including navigation: 'Schedule.Doctor'.
2025-11-24 02:15:13.076 +02:00 [DBG] Including navigation: 'Doctor.User'.
2025-11-24 02:15:13.081 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Schedule>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Schedule.ScheduleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Schedule.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: Schedule.DayOfWeek (string) Required MaxLength(20), 2], [Property: Schedule.DoctorId (int) Required FK Index, 3], [Property: Schedule.EndTime (DateTime) Required, 4], [Property: Schedule.Shift (AppointmentShift) Required, 5], [Property: Schedule.StartTime (DateTime) Required, 6], [Property: Schedule.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 7] }
            1 -> Dictionary<IProperty, int> { [Property: Doctor.DoctorId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 8], [Property: Doctor.Available (bool?), 9], [Property: Doctor.Biography (string), 10], [Property: Doctor.ConsultationFees (decimal) Required, 11], [Property: Doctor.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 12], [Property: Doctor.ExperienceYears (int?), 13], [Property: Doctor.ImageURL (string) MaxLength(300), 14], [Property: Doctor.SpecializationId (int) Required FK Index, 15], [Property: Doctor.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 16], [Property: Doctor.UserId (string) Required FK Index, 17] }
            2 -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 18], [Property: User.AccessFailedCount (int) Required, 19], [Property: User.ConcurrencyStamp (string) Concurrency, 20], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 21], [Property: User.DateOfBirth (DateOnly?), 22], [Property: User.Email (string) Index MaxLength(256), 23], [Property: User.EmailConfirmed (bool) Required, 24], [Property: User.FullName (string) Required MaxLength(150), 25], [Property: User.Gender (GenderType?) MaxLength(10), 26], [Property: User.LockoutEnabled (bool) Required, 27], [Property: User.LockoutEnd (DateTimeOffset?), 28], [Property: User.NormalizedEmail (string) Index MaxLength(256), 29], [Property: User.NormalizedUserName (string) Index MaxLength(256), 30], [Property: User.PasswordHash (string), 31], [Property: User.PhoneNumber (string), 32], [Property: User.PhoneNumberConfirmed (bool) Required, 33], [Property: User.RefreshToken (string), 34], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 35], [Property: User.Role (string) Required MaxLength(50), 36], [Property: User.SecurityStamp (string), 37], [Property: User.TwoFactorEnabled (bool) Required, 38], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 39], [Property: User.UserName (string) MaxLength(256), 40] }
        SELECT s.ScheduleId, s.CreatedAt, s.DayOfWeek, s.DoctorId, s.EndTime, s.Shift, s.StartTime, s.UpdatedAt, d.DoctorId, d.Available, d.Biography, d.ConsultationFees, d.CreatedAt, d.ExperienceYears, d.ImageURL, d.SpecializationId, d.UpdatedAt, d.UserId, u.Id, u.AccessFailedCount, u.ConcurrencyStamp, u.CreatedAt, u.DateOfBirth, u.Email, u.EmailConfirmed, u.FullName, u.Gender, u.LockoutEnabled, u.LockoutEnd, u.NormalizedEmail, u.NormalizedUserName, u.PasswordHash, u.PhoneNumber, u.PhoneNumberConfirmed, u.RefreshToken, u.RefreshTokenExpiryTime, u.Role, u.SecurityStamp, u.TwoFactorEnabled, u.UpdatedAt, u.UserName
        FROM Schedules AS s
        INNER JOIN Doctors AS d ON s.DoctorId == d.DoctorId
        INNER JOIN Users AS u ON d.UserId == u.Id), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Schedule>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 02:15:13.084 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:15:13.084 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:15:13.085 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:15:13.085 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:15:13.086 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:15:13.086 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:15:13.087 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:15:13.087 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
2025-11-24 02:15:13.093 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
2025-11-24 02:15:13.095 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:15:13.095 +02:00 [DBG] The navigation 'Schedule.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:15:13.096 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:15:13.096 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:15:13.097 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:15:13.098 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:15:13.098 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:15:13.098 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 3ms reading results.
2025-11-24 02:15:13.099 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:15:13.099 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:15:13.100 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:15:13.101 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:15:13.101 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:15:13.102 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:15:13.102 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:15:13.103 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Schedule.ScheduleDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 02:15:13.104 +02:00 [INF] Executed action Hospital.Controllers.ScheduleController.GetAll (Hospital) in 36.0339ms
2025-11-24 02:15:13.104 +02:00 [INF] Executed endpoint 'Hospital.Controllers.ScheduleController.GetAll (Hospital)'
2025-11-24 02:15:13.105 +02:00 [DBG] Connection id "0HNHATN3K8HR3" completed keep alive response.
2025-11-24 02:15:13.106 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:15:13.106 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:15:13.107 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:15:13.107 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Schedule - 200 null application/json; charset=utf-8 55.4582ms
2025-11-24 02:15:35.996 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Doctor/add - application/json 370
2025-11-24 02:15:36.001 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/add'
2025-11-24 02:15:36.001 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.AddDoctor (Hospital)' with route pattern 'api/Doctor/add' is valid for the request path '/api/Doctor/add'
2025-11-24 02:15:36.002 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.AddDoctor (Hospital)'
2025-11-24 02:15:36.003 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:15:36.003 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:15:36.004 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.AddDoctor (Hospital)'
2025-11-24 02:15:36.006 +02:00 [INF] Route matched with {action = "AddDoctor", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddDoctor(Hospital.Application.DTO.Doctor.AddDoctorDto) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 02:15:36.007 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:15:36.008 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:15:36.009 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:15:36.010 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:15:36.010 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:15:36.011 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 02:15:36.022 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 02:15:36.023 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.AddDoctorDto' ...
2025-11-24 02:15:36.023 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.AddDoctorDto' using the name '' in request data ...
2025-11-24 02:15:36.024 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:15:36.030 +02:00 [DBG] Connection id "0HNHATN3K8HR3", Request id "0HNHATN3K8HR3:00000013": started reading request body.
2025-11-24 02:15:36.031 +02:00 [DBG] Connection id "0HNHATN3K8HR3", Request id "0HNHATN3K8HR3:00000013": done reading request body.
2025-11-24 02:15:36.037 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Doctor.AddDoctorDto'
2025-11-24 02:15:36.037 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.AddDoctorDto'.
2025-11-24 02:15:36.038 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.AddDoctorDto'.
2025-11-24 02:15:36.038 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Doctor.AddDoctorDto' ...
2025-11-24 02:15:36.041 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Doctor.AddDoctorDto'.
2025-11-24 02:15:36.043 +02:00 [INF] add doctor called at "2025-11-24T02:15:36.0431493+02:00"
2025-11-24 02:15:36.046 +02:00 [INF] Adding new doctor: Walaa, Email: walaa.elbishl8awy1@gmail
2025-11-24 02:15:36.047 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:15:36.050 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:15:36.051 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:15:36.051 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:15:36.052 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:15:36.054 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 02:15:36.058 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 02:15:36.059 +02:00 [DBG] Compiling query expression: 
'DbSet<Specialization>()
    .FirstOrDefault(e => EF.Property<int>(e, "SpecializationId") == __p_0)'
2025-11-24 02:15:36.063 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Specialization>(
    asyncEnumerable: new SingleQueryingEnumerable<Specialization>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Specialization.SpecializationId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Specialization.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: Specialization.Description (string), 2], [Property: Specialization.Name (string) Required MaxLength(120), 3], [Property: Specialization.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 4] }
            SELECT TOP(1) s.SpecializationId, s.CreatedAt, s.Description, s.Name, s.UpdatedAt
            FROM Specializations AS s
            WHERE s.SpecializationId == @__p_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Specialization>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 02:15:36.066 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:15:36.067 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:15:36.068 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:15:36.068 +02:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt]
FROM [Specializations] AS [s]
WHERE [s].[SpecializationId] = @__p_0
2025-11-24 02:15:36.073 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt]
FROM [Specializations] AS [s]
WHERE [s].[SpecializationId] = @__p_0
2025-11-24 02:15:36.081 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:15:36.082 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:15:36.083 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 3ms reading results.
2025-11-24 02:15:36.089 +02:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(u => u.NormalizedEmail == __normalizedEmail_0)'
2025-11-24 02:15:36.093 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: new SingleQueryingEnumerable<User>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 0], [Property: User.AccessFailedCount (int) Required, 1], [Property: User.ConcurrencyStamp (string) Concurrency, 2], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 3], [Property: User.DateOfBirth (DateOnly?), 4], [Property: User.Email (string) Index MaxLength(256), 5], [Property: User.EmailConfirmed (bool) Required, 6], [Property: User.FullName (string) Required MaxLength(150), 7], [Property: User.Gender (GenderType?) MaxLength(10), 8], [Property: User.LockoutEnabled (bool) Required, 9], [Property: User.LockoutEnd (DateTimeOffset?), 10], [Property: User.NormalizedEmail (string) Index MaxLength(256), 11], [Property: User.NormalizedUserName (string) Index MaxLength(256), 12], [Property: User.PasswordHash (string), 13], [Property: User.PhoneNumber (string), 14], [Property: User.PhoneNumberConfirmed (bool) Required, 15], [Property: User.RefreshToken (string), 16], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 17], [Property: User.Role (string) Required MaxLength(50), 18], [Property: User.SecurityStamp (string), 19], [Property: User.TwoFactorEnabled (bool) Required, 20], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 21], [Property: User.UserName (string) MaxLength(256), 22] }
            SELECT TOP(2) u.Id, u.AccessFailedCount, u.ConcurrencyStamp, u.CreatedAt, u.DateOfBirth, u.Email, u.EmailConfirmed, u.FullName, u.Gender, u.LockoutEnabled, u.LockoutEnd, u.NormalizedEmail, u.NormalizedUserName, u.PasswordHash, u.PhoneNumber, u.PhoneNumberConfirmed, u.RefreshToken, u.RefreshTokenExpiryTime, u.Role, u.SecurityStamp, u.TwoFactorEnabled, u.UpdatedAt, u.UserName
            FROM Users AS u
            WHERE u.NormalizedEmail == @__normalizedEmail_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 02:15:36.095 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:15:36.096 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:15:36.097 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:15:36.097 +02:00 [DBG] Executing DbCommand [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedEmail] = @__normalizedEmail_0
2025-11-24 02:15:36.101 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedEmail] = @__normalizedEmail_0
2025-11-24 02:15:36.103 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:15:36.104 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:15:36.105 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 02:15:36.107 +02:00 [ERR] Failed to register user for doctor Walaa: Email already exists!
2025-11-24 02:15:36.145 +02:00 [DBG] Rolling back transaction.
2025-11-24 02:15:36.150 +02:00 [DBG] Rolled back transaction.
2025-11-24 02:15:36.152 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:15:36.153 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:15:36.153 +02:00 [ERR] Transaction rolled back while adding doctor Walaa
2025-11-24 02:15:36.171 +02:00 [DBG] Disposing transaction.
2025-11-24 02:15:36.194 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.AddDoctor (Hospital) in 182.5156ms
2025-11-24 02:15:36.195 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.AddDoctor (Hospital)'
2025-11-24 02:15:36.240 +02:00 [ERR]  Exception caught: Failed to create user: Email already exists!
System.InvalidOperationException: Failed to create user: Email already exists!
   at Hospital.Infrastructure.Services.DoctorService.AddAsync(AddDoctorDto dto)
   at Hospital.Infrastructure.Services.DoctorService.AddAsync(AddDoctorDto dto)
   at Hospital.Controllers.DoctorController.AddDoctor(AddDoctorDto dto) in D:\Walaa\GP\Hospital\Hospital\Controllers\DoctorController.cs:line 33
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
2025-11-24 02:15:36.247 +02:00 [DBG] Connection id "0HNHATN3K8HR3" completed keep alive response.
2025-11-24 02:15:36.248 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:15:36.249 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:15:36.249 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:15:36.250 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Doctor/add - 500 null application/json 254.4025ms
2025-11-24 02:15:50.959 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Doctor/add - application/json 372
2025-11-24 02:15:50.963 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/add'
2025-11-24 02:15:50.964 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.AddDoctor (Hospital)' with route pattern 'api/Doctor/add' is valid for the request path '/api/Doctor/add'
2025-11-24 02:15:50.965 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.AddDoctor (Hospital)'
2025-11-24 02:15:50.965 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:15:50.965 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:15:50.966 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.AddDoctor (Hospital)'
2025-11-24 02:15:50.966 +02:00 [INF] Route matched with {action = "AddDoctor", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddDoctor(Hospital.Application.DTO.Doctor.AddDoctorDto) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 02:15:50.967 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:15:50.968 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:15:50.968 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:15:50.969 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:15:50.970 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:15:50.970 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 02:15:50.974 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 02:15:50.974 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.AddDoctorDto' ...
2025-11-24 02:15:50.975 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.AddDoctorDto' using the name '' in request data ...
2025-11-24 02:15:50.976 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:15:50.977 +02:00 [DBG] Connection id "0HNHATN3K8HR3", Request id "0HNHATN3K8HR3:00000014": started reading request body.
2025-11-24 02:15:50.977 +02:00 [DBG] Connection id "0HNHATN3K8HR3", Request id "0HNHATN3K8HR3:00000014": done reading request body.
2025-11-24 02:15:50.978 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Doctor.AddDoctorDto'
2025-11-24 02:15:50.979 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.AddDoctorDto'.
2025-11-24 02:15:50.979 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.AddDoctorDto'.
2025-11-24 02:15:50.980 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Doctor.AddDoctorDto' ...
2025-11-24 02:15:50.980 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Doctor.AddDoctorDto'.
2025-11-24 02:15:50.981 +02:00 [INF] add doctor called at "2025-11-24T02:15:50.9813436+02:00"
2025-11-24 02:15:50.981 +02:00 [INF] Adding new doctor: Walaa, Email: walaa.elbishlawy@gmail.com
2025-11-24 02:15:50.982 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:15:50.984 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:15:50.984 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:15:50.985 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:15:50.985 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:15:50.986 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 02:15:50.987 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 02:15:50.987 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:15:50.988 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:15:50.988 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:15:50.989 +02:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt]
FROM [Specializations] AS [s]
WHERE [s].[SpecializationId] = @__p_0
2025-11-24 02:15:50.992 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt]
FROM [Specializations] AS [s]
WHERE [s].[SpecializationId] = @__p_0
2025-11-24 02:15:50.993 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:15:50.994 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:15:50.995 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 2ms reading results.
2025-11-24 02:15:50.997 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:15:50.997 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:15:50.999 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:15:51.000 +02:00 [DBG] Executing DbCommand [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedEmail] = @__normalizedEmail_0
2025-11-24 02:15:51.005 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedEmail] = @__normalizedEmail_0
2025-11-24 02:15:51.008 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:15:51.009 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:15:51.013 +02:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(u => u.NormalizedUserName == __normalizedUserName_0)'
2025-11-24 02:15:51.018 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: new SingleQueryingEnumerable<User>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 0], [Property: User.AccessFailedCount (int) Required, 1], [Property: User.ConcurrencyStamp (string) Concurrency, 2], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 3], [Property: User.DateOfBirth (DateOnly?), 4], [Property: User.Email (string) Index MaxLength(256), 5], [Property: User.EmailConfirmed (bool) Required, 6], [Property: User.FullName (string) Required MaxLength(150), 7], [Property: User.Gender (GenderType?) MaxLength(10), 8], [Property: User.LockoutEnabled (bool) Required, 9], [Property: User.LockoutEnd (DateTimeOffset?), 10], [Property: User.NormalizedEmail (string) Index MaxLength(256), 11], [Property: User.NormalizedUserName (string) Index MaxLength(256), 12], [Property: User.PasswordHash (string), 13], [Property: User.PhoneNumber (string), 14], [Property: User.PhoneNumberConfirmed (bool) Required, 15], [Property: User.RefreshToken (string), 16], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 17], [Property: User.Role (string) Required MaxLength(50), 18], [Property: User.SecurityStamp (string), 19], [Property: User.TwoFactorEnabled (bool) Required, 20], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 21], [Property: User.UserName (string) MaxLength(256), 22] }
            SELECT TOP(1) u.Id, u.AccessFailedCount, u.ConcurrencyStamp, u.CreatedAt, u.DateOfBirth, u.Email, u.EmailConfirmed, u.FullName, u.Gender, u.LockoutEnabled, u.LockoutEnd, u.NormalizedEmail, u.NormalizedUserName, u.PasswordHash, u.PhoneNumber, u.PhoneNumberConfirmed, u.RefreshToken, u.RefreshTokenExpiryTime, u.Role, u.SecurityStamp, u.TwoFactorEnabled, u.UpdatedAt, u.UserName
            FROM Users AS u
            WHERE u.NormalizedUserName == @__normalizedUserName_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 02:15:51.019 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:15:51.020 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:15:51.021 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:15:51.021 +02:00 [DBG] Executing DbCommand [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0
2025-11-24 02:15:51.026 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0
2025-11-24 02:15:51.028 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:15:51.029 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:15:51.029 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 02:15:51.031 +02:00 [ERR] Failed to register user for doctor Walaa: Username already exists!
2025-11-24 02:15:51.054 +02:00 [DBG] Rolling back transaction.
2025-11-24 02:15:51.055 +02:00 [DBG] Rolled back transaction.
2025-11-24 02:15:51.056 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:15:51.056 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:15:51.057 +02:00 [ERR] Transaction rolled back while adding doctor Walaa
2025-11-24 02:15:51.078 +02:00 [DBG] Disposing transaction.
2025-11-24 02:15:51.101 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.AddDoctor (Hospital) in 130.5212ms
2025-11-24 02:15:51.102 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.AddDoctor (Hospital)'
2025-11-24 02:15:51.138 +02:00 [ERR]  Exception caught: Failed to create user: Username already exists!
System.InvalidOperationException: Failed to create user: Username already exists!
   at Hospital.Infrastructure.Services.DoctorService.AddAsync(AddDoctorDto dto)
   at Hospital.Infrastructure.Services.DoctorService.AddAsync(AddDoctorDto dto)
   at Hospital.Controllers.DoctorController.AddDoctor(AddDoctorDto dto) in D:\Walaa\GP\Hospital\Hospital\Controllers\DoctorController.cs:line 33
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
2025-11-24 02:15:51.145 +02:00 [DBG] Connection id "0HNHATN3K8HR3" completed keep alive response.
2025-11-24 02:15:51.146 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:15:51.146 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:15:51.147 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:15:51.147 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Doctor/add - 500 null application/json 188.8555ms
2025-11-24 02:15:57.032 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Doctor/add - application/json 371
2025-11-24 02:15:57.034 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/add'
2025-11-24 02:15:57.035 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.AddDoctor (Hospital)' with route pattern 'api/Doctor/add' is valid for the request path '/api/Doctor/add'
2025-11-24 02:15:57.035 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.AddDoctor (Hospital)'
2025-11-24 02:15:57.035 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:15:57.036 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:15:57.036 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.AddDoctor (Hospital)'
2025-11-24 02:15:57.037 +02:00 [INF] Route matched with {action = "AddDoctor", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddDoctor(Hospital.Application.DTO.Doctor.AddDoctorDto) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 02:15:57.037 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:15:57.038 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:15:57.039 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:15:57.039 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:15:57.040 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:15:57.041 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 02:15:57.054 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 02:15:57.055 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.AddDoctorDto' ...
2025-11-24 02:15:57.056 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.AddDoctorDto' using the name '' in request data ...
2025-11-24 02:15:57.057 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:15:57.057 +02:00 [DBG] Connection id "0HNHATN3K8HR3", Request id "0HNHATN3K8HR3:00000015": started reading request body.
2025-11-24 02:15:57.058 +02:00 [DBG] Connection id "0HNHATN3K8HR3", Request id "0HNHATN3K8HR3:00000015": done reading request body.
2025-11-24 02:15:57.060 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Doctor.AddDoctorDto'
2025-11-24 02:15:57.060 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.AddDoctorDto'.
2025-11-24 02:15:57.061 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.AddDoctorDto'.
2025-11-24 02:15:57.062 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Doctor.AddDoctorDto' ...
2025-11-24 02:15:57.063 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Doctor.AddDoctorDto'.
2025-11-24 02:15:57.063 +02:00 [INF] add doctor called at "2025-11-24T02:15:57.0639060+02:00"
2025-11-24 02:15:57.064 +02:00 [INF] Adding new doctor: Walaa, Email: walaa.elbishlawy@gmail.com
2025-11-24 02:15:57.065 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:15:57.070 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:15:57.071 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:15:57.072 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:15:57.072 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:15:57.073 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 02:15:57.074 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 02:15:57.075 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:15:57.075 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:15:57.076 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:15:57.076 +02:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt]
FROM [Specializations] AS [s]
WHERE [s].[SpecializationId] = @__p_0
2025-11-24 02:15:57.079 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt]
FROM [Specializations] AS [s]
WHERE [s].[SpecializationId] = @__p_0
2025-11-24 02:15:57.080 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:15:57.081 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:15:57.081 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 02:15:57.083 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:15:57.083 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:15:57.085 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 02:15:57.086 +02:00 [DBG] Executing DbCommand [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedEmail] = @__normalizedEmail_0
2025-11-24 02:15:57.090 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedEmail] = @__normalizedEmail_0
2025-11-24 02:15:57.092 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:15:57.093 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:15:57.094 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:15:57.094 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:15:57.095 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:15:57.095 +02:00 [DBG] Executing DbCommand [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0
2025-11-24 02:15:57.099 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0
2025-11-24 02:15:57.100 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:15:57.101 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:15:57.103 +02:00 [DBG] Compiling query expression: 
'DbSet<IdentityRole>()
    .FirstOrDefault(r => r.NormalizedName == __normalizedName_0)'
2025-11-24 02:15:57.107 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<IdentityRole>(
    asyncEnumerable: new SingleQueryingEnumerable<IdentityRole>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: IdentityRole.Id (string) Required PK AfterSave:Throw, 0], [Property: IdentityRole.ConcurrencyStamp (string) Concurrency, 1], [Property: IdentityRole.Name (string) MaxLength(256), 2], [Property: IdentityRole.NormalizedName (string) Index MaxLength(256), 3] }
            SELECT TOP(1) a.Id, a.ConcurrencyStamp, a.Name, a.NormalizedName
            FROM AspNetRoles AS a
            WHERE a.NormalizedName == @__normalizedName_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, IdentityRole>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 02:15:57.109 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:15:57.109 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:15:57.110 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:15:57.110 +02:00 [DBG] Executing DbCommand [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-11-24 02:15:57.115 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-11-24 02:15:57.119 +02:00 [DBG] Context 'AppDbContext' started tracking 'IdentityRole' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:15:57.125 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:15:57.125 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 9ms reading results.
2025-11-24 02:15:57.203 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:15:57.205 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-11-24 02:15:57.206 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-11-24 02:15:57.208 +02:00 [DBG] Executing DbCommand [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0
2025-11-24 02:15:57.210 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0
2025-11-24 02:15:57.212 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:15:57.213 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:15:57.222 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:15:57.224 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:15:57.229 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:15:57.231 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 02:15:57.231 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:15:57.232 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:15:57.244 +02:00 [DBG] Creating transaction savepoint.
2025-11-24 02:15:57.253 +02:00 [DBG] Created transaction savepoint.
2025-11-24 02:15:57.254 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:15:57.255 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:15:57.258 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-11-24 02:15:57.259 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (Size = 450), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (DbType = DateTime2), @p5='?' (Size = 256), @p6='?' (DbType = Boolean), @p7='?' (Size = 150), @p8='?' (Size = 10), @p9='?' (DbType = Boolean), @p10='?' (DbType = DateTimeOffset), @p11='?' (Size = 256), @p12='?' (Size = 256), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Boolean), @p16='?' (Size = 4000), @p17='?' (DbType = DateTime2), @p18='?' (Size = 50), @p19='?' (Size = 4000), @p20='?' (DbType = Boolean), @p21='?' (DbType = DateTime2), @p22='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([Id], [AccessFailedCount], [ConcurrencyStamp], [CreatedAt], [DateOfBirth], [Email], [EmailConfirmed], [FullName], [Gender], [LockoutEnabled], [LockoutEnd], [NormalizedEmail], [NormalizedUserName], [PasswordHash], [PhoneNumber], [PhoneNumberConfirmed], [RefreshToken], [RefreshTokenExpiryTime], [Role], [SecurityStamp], [TwoFactorEnabled], [UpdatedAt], [UserName])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22);
2025-11-24 02:15:57.264 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Size = 450), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (DbType = DateTime2), @p5='?' (Size = 256), @p6='?' (DbType = Boolean), @p7='?' (Size = 150), @p8='?' (Size = 10), @p9='?' (DbType = Boolean), @p10='?' (DbType = DateTimeOffset), @p11='?' (Size = 256), @p12='?' (Size = 256), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Boolean), @p16='?' (Size = 4000), @p17='?' (DbType = DateTime2), @p18='?' (Size = 50), @p19='?' (Size = 4000), @p20='?' (DbType = Boolean), @p21='?' (DbType = DateTime2), @p22='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([Id], [AccessFailedCount], [ConcurrencyStamp], [CreatedAt], [DateOfBirth], [Email], [EmailConfirmed], [FullName], [Gender], [LockoutEnabled], [LockoutEnd], [NormalizedEmail], [NormalizedUserName], [PasswordHash], [PhoneNumber], [PhoneNumberConfirmed], [RefreshToken], [RefreshTokenExpiryTime], [Role], [SecurityStamp], [TwoFactorEnabled], [UpdatedAt], [UserName])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22);
2025-11-24 02:15:57.266 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:15:57.266 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:15:57.267 +02:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:15:57.268 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 02:15:57.274 +02:00 [DBG] Compiling query expression: 
'DbSet<IdentityRole>()
    .SingleOrDefault(r => r.NormalizedName == __normalizedRoleName_0)'
2025-11-24 02:15:57.277 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<IdentityRole>(
    asyncEnumerable: new SingleQueryingEnumerable<IdentityRole>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: IdentityRole.Id (string) Required PK AfterSave:Throw, 0], [Property: IdentityRole.ConcurrencyStamp (string) Concurrency, 1], [Property: IdentityRole.Name (string) MaxLength(256), 2], [Property: IdentityRole.NormalizedName (string) Index MaxLength(256), 3] }
            SELECT TOP(2) a.Id, a.ConcurrencyStamp, a.Name, a.NormalizedName
            FROM AspNetRoles AS a
            WHERE a.NormalizedName == @__normalizedRoleName_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, IdentityRole>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 02:15:57.279 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:15:57.279 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:15:57.280 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:15:57.281 +02:00 [DBG] Executing DbCommand [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedRoleName_0
2025-11-24 02:15:57.285 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedRoleName_0
2025-11-24 02:15:57.286 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:15:57.287 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:15:57.290 +02:00 [DBG] Compiling query expression: 
'DbSet<IdentityUserRole<string>>()
    .FirstOrDefault(e => EF.Property<string>(e, "UserId") == __p_0 && EF.Property<string>(e, "RoleId") == __p_1)'
2025-11-24 02:15:57.294 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<IdentityUserRole<string>>(
    asyncEnumerable: new SingleQueryingEnumerable<IdentityUserRole<string>>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: IdentityUserRole<string>.UserId (string) Required PK FK AfterSave:Throw, 0], [Property: IdentityUserRole<string>.RoleId (string) Required PK FK Index AfterSave:Throw, 1] }
            SELECT TOP(1) a.UserId, a.RoleId
            FROM AspNetUserRoles AS a
            WHERE (a.UserId == @__p_0) && (a.RoleId == @__p_1)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, IdentityUserRole<string>>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 02:15:57.297 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:15:57.297 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:15:57.298 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:15:57.298 +02:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (Size = 450), @__p_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[UserId], [a].[RoleId]
FROM [AspNetUserRoles] AS [a]
WHERE [a].[UserId] = @__p_0 AND [a].[RoleId] = @__p_1
2025-11-24 02:15:57.302 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (Size = 450), @__p_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[UserId], [a].[RoleId]
FROM [AspNetUserRoles] AS [a]
WHERE [a].[UserId] = @__p_0 AND [a].[RoleId] = @__p_1
2025-11-24 02:15:57.303 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:15:57.304 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:15:57.307 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:15:57.307 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:15:57.308 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:15:57.308 +02:00 [DBG] Executing DbCommand [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedRoleName_0
2025-11-24 02:15:57.310 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedRoleName_0
2025-11-24 02:15:57.312 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:15:57.312 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:15:57.317 +02:00 [DBG] Context 'AppDbContext' started tracking 'IdentityUserRole' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:15:57.318 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:15:57.319 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:15:57.320 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:15:57.320 +02:00 [DBG] Executing DbCommand [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0
2025-11-24 02:15:57.324 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0
2025-11-24 02:15:57.325 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:15:57.326 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:15:57.330 +02:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:15:57.330 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:15:57.331 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:15:57.332 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 02:15:57.332 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:15:57.332 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:15:57.340 +02:00 [DBG] Executing 2 update commands as a batch.
2025-11-24 02:15:57.340 +02:00 [DBG] Creating transaction savepoint.
2025-11-24 02:15:57.341 +02:00 [DBG] Created transaction savepoint.
2025-11-24 02:15:57.348 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:15:57.349 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:15:57.349 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:15:57.350 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (Size = 450), @p1='?' (Size = 450), @p24='?' (Size = 450), @p2='?' (DbType = Int32), @p3='?' (Size = 4000), @p25='?' (Size = 4000), @p4='?' (DbType = DateTime2), @p5='?' (DbType = DateTime2), @p6='?' (Size = 256), @p7='?' (DbType = Boolean), @p8='?' (Size = 150), @p9='?' (Size = 10), @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTimeOffset), @p12='?' (Size = 256), @p13='?' (Size = 256), @p14='?' (Size = 4000), @p15='?' (Size = 4000), @p16='?' (DbType = Boolean), @p17='?' (Size = 4000), @p18='?' (DbType = DateTime2), @p19='?' (Size = 50), @p20='?' (Size = 4000), @p21='?' (DbType = Boolean), @p22='?' (DbType = DateTime2), @p23='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [AspNetUserRoles] ([RoleId], [UserId])
VALUES (@p0, @p1);
UPDATE [Users] SET [AccessFailedCount] = @p2, [ConcurrencyStamp] = @p3, [CreatedAt] = @p4, [DateOfBirth] = @p5, [Email] = @p6, [EmailConfirmed] = @p7, [FullName] = @p8, [Gender] = @p9, [LockoutEnabled] = @p10, [LockoutEnd] = @p11, [NormalizedEmail] = @p12, [NormalizedUserName] = @p13, [PasswordHash] = @p14, [PhoneNumber] = @p15, [PhoneNumberConfirmed] = @p16, [RefreshToken] = @p17, [RefreshTokenExpiryTime] = @p18, [Role] = @p19, [SecurityStamp] = @p20, [TwoFactorEnabled] = @p21, [UpdatedAt] = @p22, [UserName] = @p23
OUTPUT 1
WHERE [Id] = @p24 AND [ConcurrencyStamp] = @p25;
2025-11-24 02:15:57.356 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (Size = 450), @p1='?' (Size = 450), @p24='?' (Size = 450), @p2='?' (DbType = Int32), @p3='?' (Size = 4000), @p25='?' (Size = 4000), @p4='?' (DbType = DateTime2), @p5='?' (DbType = DateTime2), @p6='?' (Size = 256), @p7='?' (DbType = Boolean), @p8='?' (Size = 150), @p9='?' (Size = 10), @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTimeOffset), @p12='?' (Size = 256), @p13='?' (Size = 256), @p14='?' (Size = 4000), @p15='?' (Size = 4000), @p16='?' (DbType = Boolean), @p17='?' (Size = 4000), @p18='?' (DbType = DateTime2), @p19='?' (Size = 50), @p20='?' (Size = 4000), @p21='?' (DbType = Boolean), @p22='?' (DbType = DateTime2), @p23='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [AspNetUserRoles] ([RoleId], [UserId])
VALUES (@p0, @p1);
UPDATE [Users] SET [AccessFailedCount] = @p2, [ConcurrencyStamp] = @p3, [CreatedAt] = @p4, [DateOfBirth] = @p5, [Email] = @p6, [EmailConfirmed] = @p7, [FullName] = @p8, [Gender] = @p9, [LockoutEnabled] = @p10, [LockoutEnd] = @p11, [NormalizedEmail] = @p12, [NormalizedUserName] = @p13, [PasswordHash] = @p14, [PhoneNumber] = @p15, [PhoneNumberConfirmed] = @p16, [RefreshToken] = @p17, [RefreshTokenExpiryTime] = @p18, [Role] = @p19, [SecurityStamp] = @p20, [TwoFactorEnabled] = @p21, [UpdatedAt] = @p22, [UserName] = @p23
OUTPUT 1
WHERE [Id] = @p24 AND [ConcurrencyStamp] = @p25;
2025-11-24 02:15:57.358 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:15:57.358 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:15:57.360 +02:00 [DBG] An entity of type 'IdentityUserRole' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:15:57.361 +02:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:15:57.363 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 2 entities written to the database.
2025-11-24 02:15:57.368 +02:00 [DBG] Compiling query expression: 
'DbSet<Branch>()
    .Where(b => __ids_0
        .Contains(b.BranchId))'
2025-11-24 02:15:57.389 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Branch>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Branch.Address (string) MaxLength(250), 1], [Property: Branch.BranchName (string) Required MaxLength(150), 2], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 3], [Property: Branch.Description (string), 4], [Property: Branch.Email (string) MaxLength(200), 5], [Property: Branch.ImageURL (string) MaxLength(300), 6], [Property: Branch.Phone (string) MaxLength(25), 7], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 8] }
        SELECT b.BranchId, b.Address, b.BranchName, b.CreatedAt, b.Description, b.Email, b.ImageURL, b.Phone, b.UpdatedAt
        FROM Branches AS b
        WHERE b.BranchId IN (
            SELECT i.value
            FROM OPENJSON(@__ids_0) WITH (value int '') AS i)), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Branch>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 02:15:57.400 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:15:57.401 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:15:57.405 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2025-11-24 02:15:57.406 +02:00 [DBG] Executing DbCommand [Parameters=[@__ids_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__ids_0) WITH ([value] int '$') AS [i]
)
2025-11-24 02:15:57.410 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__ids_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__ids_0) WITH ([value] int '$') AS [i]
)
2025-11-24 02:15:57.413 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:15:57.413 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:15:57.415 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 2ms reading results.
2025-11-24 02:15:57.429 +02:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Doctor.DoctorId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:15:57.433 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:15:57.434 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:15:57.436 +02:00 [DBG] The navigation 'User.DoctorProfile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:15:57.439 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:15:57.445 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:15:57.447 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:15:57.451 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:15:57.453 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 02:15:57.453 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:15:57.454 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:15:57.457 +02:00 [DBG] Creating transaction savepoint.
2025-11-24 02:15:57.458 +02:00 [DBG] Created transaction savepoint.
2025-11-24 02:15:57.459 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:15:57.459 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:15:57.460 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:15:57.461 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Boolean), @p1='?' (Size = 4000), @p2='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (Size = 300), @p6='?' (DbType = Int32), @p7='?' (DbType = DateTime2), @p8='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Doctors] ([Available], [Biography], [ConsultationFees], [CreatedAt], [ExperienceYears], [ImageURL], [SpecializationId], [UpdatedAt], [UserId])
OUTPUT INSERTED.[DoctorId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
2025-11-24 02:15:57.466 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = Boolean), @p1='?' (Size = 4000), @p2='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (Size = 300), @p6='?' (DbType = Int32), @p7='?' (DbType = DateTime2), @p8='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Doctors] ([Available], [Biography], [ConsultationFees], [CreatedAt], [ExperienceYears], [ImageURL], [SpecializationId], [UpdatedAt], [UserId])
OUTPUT INSERTED.[DoctorId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
2025-11-24 02:15:57.472 +02:00 [DBG] The foreign key property 'Doctor.DoctorId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 02:15:57.475 +02:00 [DBG] The foreign key property 'BranchDoctor.DoctorsDoctorId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 02:15:57.477 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:15:57.478 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 10ms reading results.
2025-11-24 02:15:57.478 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:15:57.479 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:15:57.479 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:15:57.480 +02:00 [DBG] Executing DbCommand [Parameters=[@p9='?' (DbType = Int32), @p10='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [DoctorBranches] ([BranchesBranchId], [DoctorsDoctorId])
VALUES (@p9, @p10);
2025-11-24 02:15:57.483 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@p9='?' (DbType = Int32), @p10='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [DoctorBranches] ([BranchesBranchId], [DoctorsDoctorId])
VALUES (@p9, @p10);
2025-11-24 02:15:57.485 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:15:57.485 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:15:57.487 +02:00 [DBG] An entity of type 'Doctor' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:15:57.489 +02:00 [DBG] An entity of type 'BranchDoctor' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:15:57.490 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 2 entities written to the database.
2025-11-24 02:15:57.492 +02:00 [DBG] Committing transaction.
2025-11-24 02:15:57.495 +02:00 [DBG] Committed transaction.
2025-11-24 02:15:57.496 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:15:57.497 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:15:59.483 +02:00 [INF] Sent registration email to walaa.elbishlawy@gmail.com
2025-11-24 02:15:59.490 +02:00 [DBG] Disposing transaction.
2025-11-24 02:15:59.490 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:15:59.491 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:15:59.492 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:15:59.492 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:15:59.493 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:15:59.493 +02:00 [INF] Executing OkObjectResult, writing value of type 'Hospital.Application.DTO.Doctor.DoctorDto'.
2025-11-24 02:15:59.501 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.AddDoctor (Hospital) in 2460.115ms
2025-11-24 02:15:59.502 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.AddDoctor (Hospital)'
2025-11-24 02:15:59.503 +02:00 [DBG] Connection id "0HNHATN3K8HR3" completed keep alive response.
2025-11-24 02:15:59.503 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:15:59.504 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:15:59.505 +02:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-11-24 02:15:59.507 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Doctor/add - 200 null application/json; charset=utf-8 2474.6647ms
2025-11-24 02:16:24.384 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Schedule - application/json 73
2025-11-24 02:16:24.385 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Schedule'
2025-11-24 02:16:24.386 +02:00 [DBG] Endpoint 'Hospital.Controllers.ScheduleController.Create (Hospital)' with route pattern 'api/Schedule' is valid for the request path '/api/Schedule'
2025-11-24 02:16:24.387 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.ScheduleController.Create (Hospital)'
2025-11-24 02:16:24.387 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:16:24.388 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:16:24.388 +02:00 [INF] Executing endpoint 'Hospital.Controllers.ScheduleController.Create (Hospital)'
2025-11-24 02:16:24.389 +02:00 [INF] Route matched with {action = "Create", controller = "Schedule"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Hospital.Application.DTO.Schedule.ScheduleDto]] Create(Hospital.Application.DTO.Schedule.CreateScheduleDto) on controller Hospital.Controllers.ScheduleController (Hospital).
2025-11-24 02:16:24.390 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:16:24.390 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:16:24.391 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:16:24.392 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:16:24.392 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:16:24.393 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:16:24.394 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 02:16:24.394 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto' ...
2025-11-24 02:16:24.395 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto' using the name '' in request data ...
2025-11-24 02:16:24.395 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:16:24.396 +02:00 [DBG] Connection id "0HNHATN3K8HR3", Request id "0HNHATN3K8HR3:00000016": started reading request body.
2025-11-24 02:16:24.396 +02:00 [DBG] Connection id "0HNHATN3K8HR3", Request id "0HNHATN3K8HR3:00000016": done reading request body.
2025-11-24 02:16:24.397 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Schedule.CreateScheduleDto'
2025-11-24 02:16:24.397 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto'.
2025-11-24 02:16:24.398 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto'.
2025-11-24 02:16:24.398 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto' ...
2025-11-24 02:16:24.399 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto'.
2025-11-24 02:16:24.399 +02:00 [INF] create schedule  called at "2025-11-24T02:16:24.3997063+02:00"
2025-11-24 02:16:24.400 +02:00 [INF] Creating schedule for DoctorId: 2, Day: friday, Shift: "Afternoon"
2025-11-24 02:16:24.401 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:16:24.402 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:16:24.404 +02:00 [DBG] Created DbConnection. (1ms).
2025-11-24 02:16:24.405 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:16:24.405 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:16:24.406 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:16:24.406 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:16:24.407 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:16:24.407 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:16:24.424 +02:00 [INF] Executed DbCommand (16ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:16:24.427 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:16:24.428 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:16:24.430 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:16:24.432 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:16:24.432 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:16:24.433 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:16:24.434 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:16:24.435 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:16:24.435 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 8ms reading results.
2025-11-24 02:16:24.436 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:16:24.436 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:16:24.438 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:16:24.438 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:16:24.439 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:16:24.439 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:16:24.440 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:16:24.440 +02:00 [DBG] Executing DbCommand [Parameters=[@__ToLower_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE LOWER([s].[DayOfWeek]) = @__ToLower_0
2025-11-24 02:16:24.444 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__ToLower_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE LOWER([s].[DayOfWeek]) = @__ToLower_0
2025-11-24 02:16:24.446 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:16:24.447 +02:00 [DBG] The navigation 'Schedule.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:16:24.447 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:16:24.448 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:16:24.448 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:16:24.449 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:16:24.449 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 3ms reading results.
2025-11-24 02:16:24.450 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:16:24.450 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:16:24.456 +02:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Schedule.ScheduleId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:16:24.458 +02:00 [DBG] The navigation 'Schedule.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:16:24.459 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:16:24.460 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:16:24.460 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:16:24.461 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 02:16:24.461 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:16:24.462 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:16:24.463 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:16:24.464 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:16:24.464 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:16:24.465 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:16:24.465 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:16:24.466 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 20), @p2='?' (DbType = Int32), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = DateTime2), @p6='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Schedules] ([CreatedAt], [DayOfWeek], [DoctorId], [EndTime], [Shift], [StartTime], [UpdatedAt])
OUTPUT INSERTED.[ScheduleId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-11-24 02:16:24.470 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 20), @p2='?' (DbType = Int32), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = DateTime2), @p6='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Schedules] ([CreatedAt], [DayOfWeek], [DoctorId], [EndTime], [Shift], [StartTime], [UpdatedAt])
OUTPUT INSERTED.[ScheduleId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-11-24 02:16:24.472 +02:00 [DBG] The foreign key property 'Schedule.ScheduleId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 02:16:24.473 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:16:24.474 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 2ms reading results.
2025-11-24 02:16:24.475 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:16:24.475 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:16:24.476 +02:00 [DBG] An entity of type 'Schedule' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:16:24.477 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 02:16:24.477 +02:00 [INF] Schedule created successfully for DoctorId 2
2025-11-24 02:16:24.478 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:16:24.479 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:16:24.479 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:16:24.479 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:16:24.480 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:16:24.481 +02:00 [INF] Executing OkObjectResult, writing value of type 'Hospital.Application.DTO.Schedule.ScheduleDto'.
2025-11-24 02:16:24.482 +02:00 [INF] Executed action Hospital.Controllers.ScheduleController.Create (Hospital) in 88.4928ms
2025-11-24 02:16:24.483 +02:00 [INF] Executed endpoint 'Hospital.Controllers.ScheduleController.Create (Hospital)'
2025-11-24 02:16:24.483 +02:00 [DBG] Connection id "0HNHATN3K8HR3" completed keep alive response.
2025-11-24 02:16:24.484 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:16:24.484 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:16:24.485 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:16:24.485 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Schedule - 200 null application/json; charset=utf-8 101.6776ms
2025-11-24 02:16:35.602 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Doctor/2 - null null
2025-11-24 02:16:35.605 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/2'
2025-11-24 02:16:35.606 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.GetDoctor (Hospital)' with route pattern 'api/Doctor/{doctorId}' is valid for the request path '/api/Doctor/2'
2025-11-24 02:16:35.608 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.GetDoctor (Hospital)'
2025-11-24 02:16:35.608 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:16:35.609 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:16:35.610 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.GetDoctor (Hospital)'
2025-11-24 02:16:35.613 +02:00 [INF] Route matched with {action = "GetDoctor", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetDoctor(Int32) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 02:16:35.614 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:16:35.615 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:16:35.616 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:16:35.616 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:16:35.617 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:16:35.617 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 02:16:35.618 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 02:16:35.619 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 02:16:35.620 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' using the name 'doctorId' in request data ...
2025-11-24 02:16:35.621 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 02:16:35.622 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 02:16:35.623 +02:00 [DBG] Attempting to validate the bound parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 02:16:35.624 +02:00 [DBG] Done attempting to validate the bound parameter 'doctorId' of type 'System.Int32'.
2025-11-24 02:16:35.625 +02:00 [INF] Get  doctor By Id called at "2025-11-24T02:16:35.6254674+02:00"
2025-11-24 02:16:35.626 +02:00 [INF] Fetching doctor with ID 2
2025-11-24 02:16:35.627 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:16:35.628 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:16:35.628 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:16:35.629 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:16:35.630 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:16:35.630 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:16:35.631 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:16:35.631 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:16:35.632 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:16:35.636 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:16:35.643 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:16:35.643 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:16:35.644 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:16:35.644 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:16:35.645 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:16:35.646 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:16:35.646 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:16:35.647 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:16:35.647 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:16:35.648 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 5ms reading results.
2025-11-24 02:16:35.648 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:16:35.649 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:16:35.650 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:16:35.651 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:16:35.651 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:16:35.651 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:16:35.652 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:16:35.652 +02:00 [INF] Executing OkObjectResult, writing value of type 'Hospital.Application.DTO.Doctor.DoctorDto'.
2025-11-24 02:16:35.654 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.GetDoctor (Hospital) in 36.4808ms
2025-11-24 02:16:35.655 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.GetDoctor (Hospital)'
2025-11-24 02:16:35.655 +02:00 [DBG] Connection id "0HNHATN3K8HR3" completed keep alive response.
2025-11-24 02:16:35.656 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:16:35.657 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:16:35.657 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:16:35.658 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Doctor/2 - 200 null application/json; charset=utf-8 56.6228ms
2025-11-24 02:17:14.807 +02:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7217/api/Doctor/update - application/json 407
2025-11-24 02:17:14.809 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/update'
2025-11-24 02:17:14.809 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.UpdateDoctor (Hospital)' with route pattern 'api/Doctor/update' is valid for the request path '/api/Doctor/update'
2025-11-24 02:17:14.810 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.UpdateDoctor (Hospital)'
2025-11-24 02:17:14.811 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:17:14.812 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:17:14.812 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.UpdateDoctor (Hospital)'
2025-11-24 02:17:14.815 +02:00 [INF] Route matched with {action = "UpdateDoctor", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateDoctor(Hospital.Application.DTO.Doctor.UpdateDoctorDto) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 02:17:14.817 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:17:14.818 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:17:14.819 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:17:14.820 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:17:14.821 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:17:14.822 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 02:17:14.824 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 02:17:14.824 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.UpdateDoctorDto' ...
2025-11-24 02:17:14.825 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.UpdateDoctorDto' using the name '' in request data ...
2025-11-24 02:17:14.826 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:17:14.828 +02:00 [DBG] Connection id "0HNHATN3K8HR3", Request id "0HNHATN3K8HR3:00000018": started reading request body.
2025-11-24 02:17:14.829 +02:00 [DBG] Connection id "0HNHATN3K8HR3", Request id "0HNHATN3K8HR3:00000018": done reading request body.
2025-11-24 02:17:14.833 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Doctor.UpdateDoctorDto'
2025-11-24 02:17:14.833 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.UpdateDoctorDto'.
2025-11-24 02:17:14.834 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.UpdateDoctorDto'.
2025-11-24 02:17:14.834 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Doctor.UpdateDoctorDto' ...
2025-11-24 02:17:14.837 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Doctor.UpdateDoctorDto'.
2025-11-24 02:17:14.839 +02:00 [INF] Update doctor called at "2025-11-24T02:17:14.8391879+02:00"
2025-11-24 02:17:14.841 +02:00 [INF] Updating doctor with ID 1
2025-11-24 02:17:14.842 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:17:14.843 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:17:14.844 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:17:14.845 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:17:14.846 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:17:14.846 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:17:14.847 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:17:14.847 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:17:14.848 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:17:14.858 +02:00 [INF] Executed DbCommand (10ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:17:14.861 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:17:14.862 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:17:14.863 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:17:14.864 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:17:14.864 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:17:14.865 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:17:14.865 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:17:14.866 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:17:14.867 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:17:14.868 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:17:14.868 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 7ms reading results.
2025-11-24 02:17:14.869 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:17:14.870 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:17:14.874 +02:00 [DBG] Compiling query expression: 
'DbSet<Branch>()
    .FirstOrDefault(e => e.BranchId == __id_0)'
2025-11-24 02:17:14.877 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Branch>(
    asyncEnumerable: new SingleQueryingEnumerable<Branch>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Branch.Address (string) MaxLength(250), 1], [Property: Branch.BranchName (string) Required MaxLength(150), 2], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 3], [Property: Branch.Description (string), 4], [Property: Branch.Email (string) MaxLength(200), 5], [Property: Branch.ImageURL (string) MaxLength(300), 6], [Property: Branch.Phone (string) MaxLength(25), 7], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 8] }
            SELECT TOP(1) b.BranchId, b.Address, b.BranchName, b.CreatedAt, b.Description, b.Email, b.ImageURL, b.Phone, b.UpdatedAt
            FROM Branches AS b
            WHERE b.BranchId == @__id_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Branch>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 02:17:14.879 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:17:14.879 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:17:14.880 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:17:14.881 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:17:14.882 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:17:14.882 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 02:17:14.885 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 02:17:14.886 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:17:14.887 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 02:17:14.888 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:17:14.888 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:17:14.889 +02:00 [WRN] Branch with ID 1 not found during update
2025-11-24 02:17:14.932 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.UpdateDoctor (Hospital) in 109.6148ms
2025-11-24 02:17:14.933 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.UpdateDoctor (Hospital)'
2025-11-24 02:17:14.971 +02:00 [ERR]  Exception caught: Cannot update doctor. Branch with ID 1 does not exist.
System.ArgumentException: Cannot update doctor. Branch with ID 1 does not exist.
   at Hospital.Infrastructure.Services.DoctorService.UpdateAsync(UpdateDoctorDto dto)
   at Hospital.Controllers.DoctorController.UpdateDoctor(UpdateDoctorDto dto) in D:\Walaa\GP\Hospital\Hospital\Controllers\DoctorController.cs:line 127
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
2025-11-24 02:17:14.975 +02:00 [DBG] Connection id "0HNHATN3K8HR3" completed keep alive response.
2025-11-24 02:17:14.976 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:17:14.976 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:17:14.976 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:17:14.977 +02:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7217/api/Doctor/update - 400 null application/json 169.7518ms
2025-11-24 02:17:21.808 +02:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7217/api/Doctor/update - application/json 407
2025-11-24 02:17:21.809 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/update'
2025-11-24 02:17:21.810 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.UpdateDoctor (Hospital)' with route pattern 'api/Doctor/update' is valid for the request path '/api/Doctor/update'
2025-11-24 02:17:21.811 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.UpdateDoctor (Hospital)'
2025-11-24 02:17:21.812 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:17:21.813 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:17:21.814 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.UpdateDoctor (Hospital)'
2025-11-24 02:17:21.814 +02:00 [INF] Route matched with {action = "UpdateDoctor", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateDoctor(Hospital.Application.DTO.Doctor.UpdateDoctorDto) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 02:17:21.815 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:17:21.816 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:17:21.817 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:17:21.818 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:17:21.819 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:17:21.819 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 02:17:21.820 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 02:17:21.821 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.UpdateDoctorDto' ...
2025-11-24 02:17:21.822 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.UpdateDoctorDto' using the name '' in request data ...
2025-11-24 02:17:21.823 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:17:21.823 +02:00 [DBG] Connection id "0HNHATN3K8HR3", Request id "0HNHATN3K8HR3:00000019": started reading request body.
2025-11-24 02:17:21.824 +02:00 [DBG] Connection id "0HNHATN3K8HR3", Request id "0HNHATN3K8HR3:00000019": done reading request body.
2025-11-24 02:17:21.825 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Doctor.UpdateDoctorDto'
2025-11-24 02:17:21.826 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.UpdateDoctorDto'.
2025-11-24 02:17:21.827 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.UpdateDoctorDto'.
2025-11-24 02:17:21.828 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Doctor.UpdateDoctorDto' ...
2025-11-24 02:17:21.828 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Doctor.UpdateDoctorDto'.
2025-11-24 02:17:21.830 +02:00 [INF] Update doctor called at "2025-11-24T02:17:21.8304290+02:00"
2025-11-24 02:17:21.831 +02:00 [INF] Updating doctor with ID 1
2025-11-24 02:17:21.831 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:17:21.833 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:17:21.833 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:17:21.834 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:17:21.834 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:17:21.835 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:17:21.835 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:17:21.836 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:17:21.836 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:17:21.840 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:17:21.848 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:17:21.848 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:17:21.849 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:17:21.850 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:17:21.851 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:17:21.852 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:17:21.852 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:17:21.853 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:17:21.854 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:17:21.855 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:17:21.855 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 7ms reading results.
2025-11-24 02:17:21.856 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:17:21.857 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 02:17:21.858 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:17:21.858 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:17:21.859 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:17:21.859 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:17:21.860 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:17:21.861 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 02:17:21.864 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 02:17:21.866 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:17:21.867 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:17:21.868 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:17:21.868 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:17:21.870 +02:00 [DBG] An entity of type 'Doctor' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:17:21.871 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:17:21.874 +02:00 [DBG] 0 entities were added and 2 entities were removed from navigation 'Doctor.Schedules'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:17:21.876 +02:00 [DBG] An entity of type 'Schedule' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:17:21.881 +02:00 [DBG] An entity of type 'Schedule' changed to '"Deleted"' state due to severed required relationship to its parent entity of type 'Doctor'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:17:21.881 +02:00 [DBG] An entity of type 'Schedule' tracked by 'AppDbContext' changed state from '"Modified"' to '"Deleted"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:17:21.882 +02:00 [DBG] The navigation 'Schedule.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:17:21.883 +02:00 [DBG] An entity of type 'Schedule' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:17:21.884 +02:00 [DBG] An entity of type 'Schedule' changed to '"Deleted"' state due to severed required relationship to its parent entity of type 'Doctor'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:17:21.885 +02:00 [DBG] An entity of type 'Schedule' tracked by 'AppDbContext' changed state from '"Modified"' to '"Deleted"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:17:21.885 +02:00 [DBG] The navigation 'Schedule.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:17:21.887 +02:00 [DBG] The unchanged property 'User.Email' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 02:17:21.887 +02:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:17:21.889 +02:00 [DBG] The unchanged property 'User.FullName' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 02:17:21.890 +02:00 [DBG] The unchanged property 'User.NormalizedEmail' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 02:17:21.890 +02:00 [DBG] The unchanged property 'User.NormalizedUserName' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 02:17:21.891 +02:00 [DBG] The unchanged property 'User.UserName' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 02:17:21.892 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:17:21.893 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 02:17:21.894 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:17:21.894 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:17:21.896 +02:00 [DBG] Executing 4 update commands as a batch.
2025-11-24 02:17:21.897 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:17:21.898 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:17:21.898 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 02:17:21.899 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 02:17:21.900 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:17:21.902 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:17:21.903 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 02:17:21.903 +02:00 [DBG] Executing DbCommand [Parameters=[@p9='?' (DbType = Int32), @p0='?' (DbType = Boolean), @p1='?' (Size = 4000), @p2='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (Size = 300), @p6='?' (DbType = Int32), @p7='?' (DbType = DateTime2), @p8='?' (Size = 450), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p18='?' (Size = 450), @p19='?' (Size = 4000), @p12='?' (Size = 256), @p13='?' (Size = 150), @p14='?' (Size = 256), @p15='?' (Size = 256), @p16='?' (DbType = DateTime2), @p17='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Doctors] SET [Available] = @p0, [Biography] = @p1, [ConsultationFees] = @p2, [CreatedAt] = @p3, [ExperienceYears] = @p4, [ImageURL] = @p5, [SpecializationId] = @p6, [UpdatedAt] = @p7, [UserId] = @p8
OUTPUT 1
WHERE [DoctorId] = @p9;
DELETE FROM [Schedules]
OUTPUT 1
WHERE [ScheduleId] = @p10;
DELETE FROM [Schedules]
OUTPUT 1
WHERE [ScheduleId] = @p11;
UPDATE [Users] SET [Email] = @p12, [FullName] = @p13, [NormalizedEmail] = @p14, [NormalizedUserName] = @p15, [UpdatedAt] = @p16, [UserName] = @p17
OUTPUT 1
WHERE [Id] = @p18 AND [ConcurrencyStamp] = @p19;
2025-11-24 02:17:21.923 +02:00 [INF] Executed DbCommand (19ms) [Parameters=[@p9='?' (DbType = Int32), @p0='?' (DbType = Boolean), @p1='?' (Size = 4000), @p2='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (Size = 300), @p6='?' (DbType = Int32), @p7='?' (DbType = DateTime2), @p8='?' (Size = 450), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p18='?' (Size = 450), @p19='?' (Size = 4000), @p12='?' (Size = 256), @p13='?' (Size = 150), @p14='?' (Size = 256), @p15='?' (Size = 256), @p16='?' (DbType = DateTime2), @p17='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Doctors] SET [Available] = @p0, [Biography] = @p1, [ConsultationFees] = @p2, [CreatedAt] = @p3, [ExperienceYears] = @p4, [ImageURL] = @p5, [SpecializationId] = @p6, [UpdatedAt] = @p7, [UserId] = @p8
OUTPUT 1
WHERE [DoctorId] = @p9;
DELETE FROM [Schedules]
OUTPUT 1
WHERE [ScheduleId] = @p10;
DELETE FROM [Schedules]
OUTPUT 1
WHERE [ScheduleId] = @p11;
UPDATE [Users] SET [Email] = @p12, [FullName] = @p13, [NormalizedEmail] = @p14, [NormalizedUserName] = @p15, [UpdatedAt] = @p16, [UserName] = @p17
OUTPUT 1
WHERE [Id] = @p18 AND [ConcurrencyStamp] = @p19;
2025-11-24 02:17:21.924 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:17:21.925 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:17:21.925 +02:00 [DBG] Committing transaction.
2025-11-24 02:17:21.926 +02:00 [DBG] Committed transaction.
2025-11-24 02:17:21.926 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:17:21.926 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:17:21.928 +02:00 [DBG] Disposing transaction.
2025-11-24 02:17:21.928 +02:00 [DBG] An entity of type 'Doctor' tracked by 'AppDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:17:21.929 +02:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:17:21.931 +02:00 [DBG] An entity of type 'Schedule' tracked by 'AppDbContext' changed state from '"Deleted"' to '"Detached"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:17:21.932 +02:00 [DBG] An entity of type 'Schedule' tracked by 'AppDbContext' changed state from '"Deleted"' to '"Detached"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:17:21.934 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 4 entities written to the database.
2025-11-24 02:17:21.934 +02:00 [INF] Doctor with ID 1 updated successfully
2025-11-24 02:17:21.935 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:17:21.936 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:17:21.936 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:17:21.937 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:17:21.937 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:17:21.938 +02:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType1`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-11-24 02:17:21.941 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.UpdateDoctor (Hospital) in 121.3389ms
2025-11-24 02:17:21.941 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.UpdateDoctor (Hospital)'
2025-11-24 02:17:21.942 +02:00 [DBG] Connection id "0HNHATN3K8HR3" completed keep alive response.
2025-11-24 02:17:21.943 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:17:21.943 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:17:21.944 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:17:21.945 +02:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7217/api/Doctor/update - 200 null application/json; charset=utf-8 136.9374ms
2025-11-24 02:17:35.420 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Doctor/branch/1 - null null
2025-11-24 02:17:35.422 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/branch/1'
2025-11-24 02:17:35.422 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.GetByBranch (Hospital)' with route pattern 'api/Doctor/branch/{branchId}' is valid for the request path '/api/Doctor/branch/1'
2025-11-24 02:17:35.423 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.GetByBranch (Hospital)'
2025-11-24 02:17:35.424 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:17:35.424 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:17:35.425 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.GetByBranch (Hospital)'
2025-11-24 02:17:35.427 +02:00 [INF] Route matched with {action = "GetByBranch", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetByBranch(Int32) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 02:17:35.429 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:17:35.430 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:17:35.430 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:17:35.432 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:17:35.433 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:17:35.434 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 02:17:35.435 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 02:17:35.435 +02:00 [DBG] Attempting to bind parameter 'branchId' of type 'System.Int32' ...
2025-11-24 02:17:35.436 +02:00 [DBG] Attempting to bind parameter 'branchId' of type 'System.Int32' using the name 'branchId' in request data ...
2025-11-24 02:17:35.436 +02:00 [DBG] Done attempting to bind parameter 'branchId' of type 'System.Int32'.
2025-11-24 02:17:35.437 +02:00 [DBG] Done attempting to bind parameter 'branchId' of type 'System.Int32'.
2025-11-24 02:17:35.438 +02:00 [DBG] Attempting to validate the bound parameter 'branchId' of type 'System.Int32' ...
2025-11-24 02:17:35.438 +02:00 [DBG] Done attempting to validate the bound parameter 'branchId' of type 'System.Int32'.
2025-11-24 02:17:35.440 +02:00 [INF] get doctor by Branch called at "2025-11-24T02:17:35.4405108+02:00"
2025-11-24 02:17:35.442 +02:00 [INF] Fetching all doctors for branch ID 1
2025-11-24 02:17:35.444 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:17:35.446 +02:00 [DBG] Compiling query expression: 
'DbSet<Doctor>()
    .Include(d => d.User)
    .Include(d => d.Specialization)
    .Include(d => d.Branches)
    .Include(d => d.Schedules)
    .Where(d => d.Branches
        .Any(b => b.BranchId == __branchId_0))'
2025-11-24 02:17:35.450 +02:00 [DBG] Including navigation: 'Doctor.User'.
2025-11-24 02:17:35.451 +02:00 [DBG] Including navigation: 'Doctor.Specialization'.
2025-11-24 02:17:35.452 +02:00 [DBG] Including navigation: 'Doctor.Branches'.
2025-11-24 02:17:35.453 +02:00 [DBG] Including navigation: 'Doctor.Schedules'.
2025-11-24 02:17:35.462 +02:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-11-24 02:17:35.471 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Doctor>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Doctor.DoctorId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Doctor.Available (bool?), 1], [Property: Doctor.Biography (string), 2], [Property: Doctor.ConsultationFees (decimal) Required, 3], [Property: Doctor.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: Doctor.ExperienceYears (int?), 5], [Property: Doctor.ImageURL (string) MaxLength(300), 6], [Property: Doctor.SpecializationId (int) Required FK Index, 7], [Property: Doctor.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 8], [Property: Doctor.UserId (string) Required FK Index, 9] }
            1 -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 10], [Property: User.AccessFailedCount (int) Required, 11], [Property: User.ConcurrencyStamp (string) Concurrency, 12], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 13], [Property: User.DateOfBirth (DateOnly?), 14], [Property: User.Email (string) Index MaxLength(256), 15], [Property: User.EmailConfirmed (bool) Required, 16], [Property: User.FullName (string) Required MaxLength(150), 17], [Property: User.Gender (GenderType?) MaxLength(10), 18], [Property: User.LockoutEnabled (bool) Required, 19], [Property: User.LockoutEnd (DateTimeOffset?), 20], [Property: User.NormalizedEmail (string) Index MaxLength(256), 21], [Property: User.NormalizedUserName (string) Index MaxLength(256), 22], [Property: User.PasswordHash (string), 23], [Property: User.PhoneNumber (string), 24], [Property: User.PhoneNumberConfirmed (bool) Required, 25], [Property: User.RefreshToken (string), 26], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 27], [Property: User.Role (string) Required MaxLength(50), 28], [Property: User.SecurityStamp (string), 29], [Property: User.TwoFactorEnabled (bool) Required, 30], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 31], [Property: User.UserName (string) MaxLength(256), 32] }
            2 -> Dictionary<IProperty, int> { [Property: Specialization.SpecializationId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 33], [Property: Specialization.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 34], [Property: Specialization.Description (string), 35], [Property: Specialization.Name (string) Required MaxLength(120), 36], [Property: Specialization.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 37] }
            3 -> 0
            4 -> 10
            5 -> 33
            6 -> Dictionary<IProperty, int> { [Property: BranchDoctor (Dictionary<string, object>).BranchesBranchId (no field, int) Indexer Required PK FK AfterSave:Throw, 38], [Property: BranchDoctor (Dictionary<string, object>).DoctorsDoctorId (no field, int) Indexer Required PK FK Index AfterSave:Throw, 39] }
            7 -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 40], [Property: Branch.Address (string) MaxLength(250), 41], [Property: Branch.BranchName (string) Required MaxLength(150), 42], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 43], [Property: Branch.Description (string), 44], [Property: Branch.Email (string) MaxLength(200), 45], [Property: Branch.ImageURL (string) MaxLength(300), 46], [Property: Branch.Phone (string) MaxLength(25), 47], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 48] }
            8 -> 38
            9 -> 39
            10 -> 40
            11 -> Dictionary<IProperty, int> { [Property: Schedule.ScheduleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 49], [Property: Schedule.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 50], [Property: Schedule.DayOfWeek (string) Required MaxLength(20), 51], [Property: Schedule.DoctorId (int) Required FK Index, 52], [Property: Schedule.EndTime (DateTime) Required, 53], [Property: Schedule.Shift (AppointmentShift) Required, 54], [Property: Schedule.StartTime (DateTime) Required, 55], [Property: Schedule.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 56] }
            12 -> 49
        SELECT d.DoctorId, d.Available, d.Biography, d.ConsultationFees, d.CreatedAt, d.ExperienceYears, d.ImageURL, d.SpecializationId, d.UpdatedAt, d.UserId, u.Id, u.AccessFailedCount, u.ConcurrencyStamp, u.CreatedAt, u.DateOfBirth, u.Email, u.EmailConfirmed, u.FullName, u.Gender, u.LockoutEnabled, u.LockoutEnd, u.NormalizedEmail, u.NormalizedUserName, u.PasswordHash, u.PhoneNumber, u.PhoneNumberConfirmed, u.RefreshToken, u.RefreshTokenExpiryTime, u.Role, u.SecurityStamp, u.TwoFactorEnabled, u.UpdatedAt, u.UserName, s.SpecializationId, s.CreatedAt, s.Description, s.Name, s.UpdatedAt, t.BranchesBranchId, t.DoctorsDoctorId, t.BranchId, t.Address, t.BranchName, t.CreatedAt, t.Description, t.Email, t.ImageURL, t.Phone, t.UpdatedAt, s0.ScheduleId, s0.CreatedAt, s0.DayOfWeek, s0.DoctorId, s0.EndTime, s0.Shift, s0.StartTime, s0.UpdatedAt
        FROM Doctors AS d
        INNER JOIN Users AS u ON d.UserId == u.Id
        INNER JOIN Specializations AS s ON d.SpecializationId == s.SpecializationId
        LEFT JOIN 
        (
            SELECT d1.BranchesBranchId, d1.DoctorsDoctorId, b0.BranchId, b0.Address, b0.BranchName, b0.CreatedAt, b0.Description, b0.Email, b0.ImageURL, b0.Phone, b0.UpdatedAt
            FROM DoctorBranches AS d1
            INNER JOIN Branches AS b0 ON d1.BranchesBranchId == b0.BranchId
        ) AS t ON d.DoctorId == t.DoctorsDoctorId
        LEFT JOIN Schedules AS s0 ON d.DoctorId == s0.DoctorId
        WHERE EXISTS (
            SELECT 1
            FROM DoctorBranches AS d0
            INNER JOIN Branches AS b ON d0.BranchesBranchId == b.BranchId
            WHERE ((d.DoctorId != NULL) && (d.DoctorId == d0.DoctorsDoctorId)) && (b.BranchId == @__branchId_0))
        ORDER BY d.DoctorId ASC, u.Id ASC, s.SpecializationId ASC, t.BranchesBranchId ASC, t.DoctorsDoctorId ASC, t.BranchId ASC), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Doctor>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 02:17:35.475 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:17:35.475 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:17:35.476 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:17:35.477 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:17:35.478 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:17:35.478 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:17:35.480 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:17:35.480 +02:00 [DBG] Executing DbCommand [Parameters=[@__branchId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt], [t].[BranchesBranchId], [t].[DoctorsDoctorId], [t].[BranchId], [t].[Address], [t].[BranchName], [t].[CreatedAt], [t].[Description], [t].[Email], [t].[ImageURL], [t].[Phone], [t].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM [Doctors] AS [d]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
LEFT JOIN (
    SELECT [d1].[BranchesBranchId], [d1].[DoctorsDoctorId], [b0].[BranchId], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [DoctorBranches] AS [d1]
    INNER JOIN [Branches] AS [b0] ON [d1].[BranchesBranchId] = [b0].[BranchId]
) AS [t] ON [d].[DoctorId] = [t].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [d].[DoctorId] = [s0].[DoctorId]
WHERE EXISTS (
    SELECT 1
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
    WHERE [d].[DoctorId] = [d0].[DoctorsDoctorId] AND [b].[BranchId] = @__branchId_0)
ORDER BY [d].[DoctorId], [u].[Id], [s].[SpecializationId], [t].[BranchesBranchId], [t].[DoctorsDoctorId], [t].[BranchId]
2025-11-24 02:17:35.494 +02:00 [INF] Executed DbCommand (14ms) [Parameters=[@__branchId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt], [t].[BranchesBranchId], [t].[DoctorsDoctorId], [t].[BranchId], [t].[Address], [t].[BranchName], [t].[CreatedAt], [t].[Description], [t].[Email], [t].[ImageURL], [t].[Phone], [t].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM [Doctors] AS [d]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
LEFT JOIN (
    SELECT [d1].[BranchesBranchId], [d1].[DoctorsDoctorId], [b0].[BranchId], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [DoctorBranches] AS [d1]
    INNER JOIN [Branches] AS [b0] ON [d1].[BranchesBranchId] = [b0].[BranchId]
) AS [t] ON [d].[DoctorId] = [t].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [d].[DoctorId] = [s0].[DoctorId]
WHERE EXISTS (
    SELECT 1
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
    WHERE [d].[DoctorId] = [d0].[DoctorsDoctorId] AND [b].[BranchId] = @__branchId_0)
ORDER BY [d].[DoctorId], [u].[Id], [s].[SpecializationId], [t].[BranchesBranchId], [t].[DoctorsDoctorId], [t].[BranchId]
2025-11-24 02:17:35.496 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:17:35.496 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:17:35.497 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:17:35.497 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:17:35.504 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:17:35.505 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:17:35.506 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:17:35.506 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:17:35.507 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:17:35.507 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Doctor.DoctorDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 02:17:35.508 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.GetByBranch (Hospital) in 74.2036ms
2025-11-24 02:17:35.509 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.GetByBranch (Hospital)'
2025-11-24 02:17:35.509 +02:00 [DBG] Connection id "0HNHATN3K8HR3" completed keep alive response.
2025-11-24 02:17:35.510 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:17:35.510 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:17:35.511 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:17:35.512 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Doctor/branch/1 - 200 null application/json; charset=utf-8 91.6933ms
2025-11-24 02:17:41.142 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Doctor/branch/5 - null null
2025-11-24 02:17:41.144 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/branch/5'
2025-11-24 02:17:41.144 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.GetByBranch (Hospital)' with route pattern 'api/Doctor/branch/{branchId}' is valid for the request path '/api/Doctor/branch/5'
2025-11-24 02:17:41.145 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.GetByBranch (Hospital)'
2025-11-24 02:17:41.146 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:17:41.147 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:17:41.148 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.GetByBranch (Hospital)'
2025-11-24 02:17:41.148 +02:00 [INF] Route matched with {action = "GetByBranch", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetByBranch(Int32) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 02:17:41.149 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:17:41.150 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:17:41.151 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:17:41.152 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:17:41.153 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:17:41.153 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 02:17:41.155 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 02:17:41.155 +02:00 [DBG] Attempting to bind parameter 'branchId' of type 'System.Int32' ...
2025-11-24 02:17:41.156 +02:00 [DBG] Attempting to bind parameter 'branchId' of type 'System.Int32' using the name 'branchId' in request data ...
2025-11-24 02:17:41.156 +02:00 [DBG] Done attempting to bind parameter 'branchId' of type 'System.Int32'.
2025-11-24 02:17:41.157 +02:00 [DBG] Done attempting to bind parameter 'branchId' of type 'System.Int32'.
2025-11-24 02:17:41.157 +02:00 [DBG] Attempting to validate the bound parameter 'branchId' of type 'System.Int32' ...
2025-11-24 02:17:41.158 +02:00 [DBG] Done attempting to validate the bound parameter 'branchId' of type 'System.Int32'.
2025-11-24 02:17:41.158 +02:00 [INF] get doctor by Branch called at "2025-11-24T02:17:41.1588293+02:00"
2025-11-24 02:17:41.159 +02:00 [INF] Fetching all doctors for branch ID 5
2025-11-24 02:17:41.159 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:17:41.161 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:17:41.161 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:17:41.163 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:17:41.163 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:17:41.164 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:17:41.165 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:17:41.167 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 02:17:41.167 +02:00 [DBG] Executing DbCommand [Parameters=[@__branchId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt], [t].[BranchesBranchId], [t].[DoctorsDoctorId], [t].[BranchId], [t].[Address], [t].[BranchName], [t].[CreatedAt], [t].[Description], [t].[Email], [t].[ImageURL], [t].[Phone], [t].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM [Doctors] AS [d]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
LEFT JOIN (
    SELECT [d1].[BranchesBranchId], [d1].[DoctorsDoctorId], [b0].[BranchId], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [DoctorBranches] AS [d1]
    INNER JOIN [Branches] AS [b0] ON [d1].[BranchesBranchId] = [b0].[BranchId]
) AS [t] ON [d].[DoctorId] = [t].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [d].[DoctorId] = [s0].[DoctorId]
WHERE EXISTS (
    SELECT 1
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
    WHERE [d].[DoctorId] = [d0].[DoctorsDoctorId] AND [b].[BranchId] = @__branchId_0)
ORDER BY [d].[DoctorId], [u].[Id], [s].[SpecializationId], [t].[BranchesBranchId], [t].[DoctorsDoctorId], [t].[BranchId]
2025-11-24 02:17:41.170 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__branchId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt], [t].[BranchesBranchId], [t].[DoctorsDoctorId], [t].[BranchId], [t].[Address], [t].[BranchName], [t].[CreatedAt], [t].[Description], [t].[Email], [t].[ImageURL], [t].[Phone], [t].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM [Doctors] AS [d]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
LEFT JOIN (
    SELECT [d1].[BranchesBranchId], [d1].[DoctorsDoctorId], [b0].[BranchId], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [DoctorBranches] AS [d1]
    INNER JOIN [Branches] AS [b0] ON [d1].[BranchesBranchId] = [b0].[BranchId]
) AS [t] ON [d].[DoctorId] = [t].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [d].[DoctorId] = [s0].[DoctorId]
WHERE EXISTS (
    SELECT 1
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
    WHERE [d].[DoctorId] = [d0].[DoctorsDoctorId] AND [b].[BranchId] = @__branchId_0)
ORDER BY [d].[DoctorId], [u].[Id], [s].[SpecializationId], [t].[BranchesBranchId], [t].[DoctorsDoctorId], [t].[BranchId]
2025-11-24 02:17:41.172 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:17:41.173 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:17:41.173 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:17:41.174 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 02:17:41.176 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:17:41.177 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:17:41.177 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:17:41.177 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:17:41.178 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:17:41.178 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Doctor.DoctorDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 02:17:41.179 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.GetByBranch (Hospital) in 25.5271ms
2025-11-24 02:17:41.180 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.GetByBranch (Hospital)'
2025-11-24 02:17:41.181 +02:00 [DBG] Connection id "0HNHATN3K8HR3" completed keep alive response.
2025-11-24 02:17:41.182 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:17:41.183 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:17:41.183 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:17:41.184 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Doctor/branch/5 - 200 null application/json; charset=utf-8 42.1714ms
2025-11-24 02:17:47.304 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Doctor/branch/2 - null null
2025-11-24 02:17:47.305 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/branch/2'
2025-11-24 02:17:47.306 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.GetByBranch (Hospital)' with route pattern 'api/Doctor/branch/{branchId}' is valid for the request path '/api/Doctor/branch/2'
2025-11-24 02:17:47.307 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.GetByBranch (Hospital)'
2025-11-24 02:17:47.307 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:17:47.307 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:17:47.308 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.GetByBranch (Hospital)'
2025-11-24 02:17:47.308 +02:00 [INF] Route matched with {action = "GetByBranch", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetByBranch(Int32) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 02:17:47.309 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:17:47.310 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:17:47.312 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:17:47.313 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:17:47.314 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:17:47.315 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 02:17:47.315 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 02:17:47.316 +02:00 [DBG] Attempting to bind parameter 'branchId' of type 'System.Int32' ...
2025-11-24 02:17:47.316 +02:00 [DBG] Attempting to bind parameter 'branchId' of type 'System.Int32' using the name 'branchId' in request data ...
2025-11-24 02:17:47.317 +02:00 [DBG] Done attempting to bind parameter 'branchId' of type 'System.Int32'.
2025-11-24 02:17:47.317 +02:00 [DBG] Done attempting to bind parameter 'branchId' of type 'System.Int32'.
2025-11-24 02:17:47.318 +02:00 [DBG] Attempting to validate the bound parameter 'branchId' of type 'System.Int32' ...
2025-11-24 02:17:47.318 +02:00 [DBG] Done attempting to validate the bound parameter 'branchId' of type 'System.Int32'.
2025-11-24 02:17:47.319 +02:00 [INF] get doctor by Branch called at "2025-11-24T02:17:47.3191584+02:00"
2025-11-24 02:17:47.319 +02:00 [INF] Fetching all doctors for branch ID 2
2025-11-24 02:17:47.320 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:17:47.321 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:17:47.321 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:17:47.321 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:17:47.322 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:17:47.323 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:17:47.324 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:17:47.324 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:17:47.325 +02:00 [DBG] Executing DbCommand [Parameters=[@__branchId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt], [t].[BranchesBranchId], [t].[DoctorsDoctorId], [t].[BranchId], [t].[Address], [t].[BranchName], [t].[CreatedAt], [t].[Description], [t].[Email], [t].[ImageURL], [t].[Phone], [t].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM [Doctors] AS [d]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
LEFT JOIN (
    SELECT [d1].[BranchesBranchId], [d1].[DoctorsDoctorId], [b0].[BranchId], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [DoctorBranches] AS [d1]
    INNER JOIN [Branches] AS [b0] ON [d1].[BranchesBranchId] = [b0].[BranchId]
) AS [t] ON [d].[DoctorId] = [t].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [d].[DoctorId] = [s0].[DoctorId]
WHERE EXISTS (
    SELECT 1
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
    WHERE [d].[DoctorId] = [d0].[DoctorsDoctorId] AND [b].[BranchId] = @__branchId_0)
ORDER BY [d].[DoctorId], [u].[Id], [s].[SpecializationId], [t].[BranchesBranchId], [t].[DoctorsDoctorId], [t].[BranchId]
2025-11-24 02:17:47.336 +02:00 [INF] Executed DbCommand (11ms) [Parameters=[@__branchId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt], [t].[BranchesBranchId], [t].[DoctorsDoctorId], [t].[BranchId], [t].[Address], [t].[BranchName], [t].[CreatedAt], [t].[Description], [t].[Email], [t].[ImageURL], [t].[Phone], [t].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM [Doctors] AS [d]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
LEFT JOIN (
    SELECT [d1].[BranchesBranchId], [d1].[DoctorsDoctorId], [b0].[BranchId], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [DoctorBranches] AS [d1]
    INNER JOIN [Branches] AS [b0] ON [d1].[BranchesBranchId] = [b0].[BranchId]
) AS [t] ON [d].[DoctorId] = [t].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [d].[DoctorId] = [s0].[DoctorId]
WHERE EXISTS (
    SELECT 1
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
    WHERE [d].[DoctorId] = [d0].[DoctorsDoctorId] AND [b].[BranchId] = @__branchId_0)
ORDER BY [d].[DoctorId], [u].[Id], [s].[SpecializationId], [t].[BranchesBranchId], [t].[DoctorsDoctorId], [t].[BranchId]
2025-11-24 02:17:47.337 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:17:47.338 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:17:47.339 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:17:47.339 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:17:47.340 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:17:47.341 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:17:47.344 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:17:47.345 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:17:47.345 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:17:47.346 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:17:47.347 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:17:47.347 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:17:47.348 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:17:47.349 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 11ms reading results.
2025-11-24 02:17:47.350 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:17:47.350 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:17:47.352 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:17:47.353 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:17:47.353 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:17:47.354 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:17:47.354 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:17:47.355 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Doctor.DoctorDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 02:17:47.356 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.GetByBranch (Hospital) in 41.2964ms
2025-11-24 02:17:47.356 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.GetByBranch (Hospital)'
2025-11-24 02:17:47.357 +02:00 [DBG] Connection id "0HNHATN3K8HR3" completed keep alive response.
2025-11-24 02:17:47.358 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:17:47.359 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:17:47.360 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:17:47.360 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Doctor/branch/2 - 200 null application/json; charset=utf-8 56.3841ms
2025-11-24 02:17:58.565 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Doctor/branch/7 - null null
2025-11-24 02:17:58.566 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/branch/7'
2025-11-24 02:17:58.567 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.GetByBranch (Hospital)' with route pattern 'api/Doctor/branch/{branchId}' is valid for the request path '/api/Doctor/branch/7'
2025-11-24 02:17:58.568 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.GetByBranch (Hospital)'
2025-11-24 02:17:58.569 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:17:58.569 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:17:58.570 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.GetByBranch (Hospital)'
2025-11-24 02:17:58.571 +02:00 [INF] Route matched with {action = "GetByBranch", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetByBranch(Int32) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 02:17:58.573 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:17:58.573 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:17:58.574 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:17:58.574 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:17:58.575 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:17:58.576 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 02:17:58.577 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 02:17:58.577 +02:00 [DBG] Attempting to bind parameter 'branchId' of type 'System.Int32' ...
2025-11-24 02:17:58.578 +02:00 [DBG] Attempting to bind parameter 'branchId' of type 'System.Int32' using the name 'branchId' in request data ...
2025-11-24 02:17:58.579 +02:00 [DBG] Done attempting to bind parameter 'branchId' of type 'System.Int32'.
2025-11-24 02:17:58.579 +02:00 [DBG] Done attempting to bind parameter 'branchId' of type 'System.Int32'.
2025-11-24 02:17:58.579 +02:00 [DBG] Attempting to validate the bound parameter 'branchId' of type 'System.Int32' ...
2025-11-24 02:17:58.580 +02:00 [DBG] Done attempting to validate the bound parameter 'branchId' of type 'System.Int32'.
2025-11-24 02:17:58.581 +02:00 [INF] get doctor by Branch called at "2025-11-24T02:17:58.5816913+02:00"
2025-11-24 02:17:58.582 +02:00 [INF] Fetching all doctors for branch ID 7
2025-11-24 02:17:58.583 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:17:58.584 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:17:58.584 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:17:58.585 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:17:58.585 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:17:58.586 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:17:58.586 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:17:58.587 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:17:58.588 +02:00 [DBG] Executing DbCommand [Parameters=[@__branchId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt], [t].[BranchesBranchId], [t].[DoctorsDoctorId], [t].[BranchId], [t].[Address], [t].[BranchName], [t].[CreatedAt], [t].[Description], [t].[Email], [t].[ImageURL], [t].[Phone], [t].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM [Doctors] AS [d]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
LEFT JOIN (
    SELECT [d1].[BranchesBranchId], [d1].[DoctorsDoctorId], [b0].[BranchId], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [DoctorBranches] AS [d1]
    INNER JOIN [Branches] AS [b0] ON [d1].[BranchesBranchId] = [b0].[BranchId]
) AS [t] ON [d].[DoctorId] = [t].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [d].[DoctorId] = [s0].[DoctorId]
WHERE EXISTS (
    SELECT 1
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
    WHERE [d].[DoctorId] = [d0].[DoctorsDoctorId] AND [b].[BranchId] = @__branchId_0)
ORDER BY [d].[DoctorId], [u].[Id], [s].[SpecializationId], [t].[BranchesBranchId], [t].[DoctorsDoctorId], [t].[BranchId]
2025-11-24 02:17:58.601 +02:00 [INF] Executed DbCommand (14ms) [Parameters=[@__branchId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt], [t].[BranchesBranchId], [t].[DoctorsDoctorId], [t].[BranchId], [t].[Address], [t].[BranchName], [t].[CreatedAt], [t].[Description], [t].[Email], [t].[ImageURL], [t].[Phone], [t].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM [Doctors] AS [d]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
LEFT JOIN (
    SELECT [d1].[BranchesBranchId], [d1].[DoctorsDoctorId], [b0].[BranchId], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [DoctorBranches] AS [d1]
    INNER JOIN [Branches] AS [b0] ON [d1].[BranchesBranchId] = [b0].[BranchId]
) AS [t] ON [d].[DoctorId] = [t].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [d].[DoctorId] = [s0].[DoctorId]
WHERE EXISTS (
    SELECT 1
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
    WHERE [d].[DoctorId] = [d0].[DoctorsDoctorId] AND [b].[BranchId] = @__branchId_0)
ORDER BY [d].[DoctorId], [u].[Id], [s].[SpecializationId], [t].[BranchesBranchId], [t].[DoctorsDoctorId], [t].[BranchId]
2025-11-24 02:17:58.604 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:17:58.604 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:17:58.605 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:17:58.606 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:17:58.606 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:17:58.607 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:17:58.608 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:17:58.608 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:17:58.608 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:17:58.609 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Doctor.DoctorDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 02:17:58.610 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.GetByBranch (Hospital) in 33.6407ms
2025-11-24 02:17:58.610 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.GetByBranch (Hospital)'
2025-11-24 02:17:58.611 +02:00 [DBG] Connection id "0HNHATN3K8HR3" completed keep alive response.
2025-11-24 02:17:58.611 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:17:58.612 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:17:58.613 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:17:58.613 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Doctor/branch/7 - 200 null application/json; charset=utf-8 48.6051ms
2025-11-24 02:21:25.292 +02:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-11-24 02:21:25.378 +02:00 [DBG] Hosting starting
2025-11-24 02:21:25.401 +02:00 [INF] User profile is available. Using 'C:\Users\E-Mad\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-24 02:21:25.409 +02:00 [DBG] Reading data from file 'C:\Users\E-Mad\AppData\Local\ASP.NET\DataProtection-Keys\key-b85f0939-0825-4b2b-b21a-67409aec9db0.xml'.
2025-11-24 02:21:25.415 +02:00 [DBG] Found key {b85f0939-0825-4b2b-b21a-67409aec9db0}.
2025-11-24 02:21:25.420 +02:00 [DBG] Considering key {b85f0939-0825-4b2b-b21a-67409aec9db0} with expiration date 2026-02-09 12:52:20Z as default key.
2025-11-24 02:21:25.423 +02:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-11-24 02:21:25.424 +02:00 [DBG] Decrypting secret element using Windows DPAPI.
2025-11-24 02:21:25.426 +02:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-11-24 02:21:25.430 +02:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-11-24 02:21:25.431 +02:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-11-24 02:21:25.433 +02:00 [DBG] Using key {b85f0939-0825-4b2b-b21a-67409aec9db0} as the default key.
2025-11-24 02:21:25.434 +02:00 [DBG] Key ring with default key {b85f0939-0825-4b2b-b21a-67409aec9db0} was loaded during application startup.
2025-11-24 02:21:25.440 +02:00 [DBG] Middleware loaded
2025-11-24 02:21:25.442 +02:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16501 B).
2025-11-24 02:21:25.443 +02:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-11-24 02:21:25.503 +02:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-11-24 02:21:25.566 +02:00 [INF] Now listening on: https://localhost:7217
2025-11-24 02:21:25.568 +02:00 [INF] Now listening on: http://localhost:5163
2025-11-24 02:21:25.569 +02:00 [DBG] Loaded hosting startup assembly Hospital
2025-11-24 02:21:25.571 +02:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-11-24 02:21:25.571 +02:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-11-24 02:21:25.572 +02:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-11-24 02:21:25.574 +02:00 [DBG] Connection id "0HNHATTJOH6T2" accepted.
2025-11-24 02:21:25.576 +02:00 [DBG] Connection id "0HNHATTJOH6T2" started.
2025-11-24 02:21:25.583 +02:00 [DBG] Connection id "0HNHATTJOH6T3" accepted.
2025-11-24 02:21:25.584 +02:00 [DBG] Connection id "0HNHATTJOH6T3" started.
2025-11-24 02:21:25.597 +02:00 [DBG] Connection id "0HNHATTJOH6T2" received FIN.
2025-11-24 02:21:25.597 +02:00 [DBG] Connection id "0HNHATTJOH6T3" received FIN.
2025-11-24 02:21:25.607 +02:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-11-24 02:21:25.607 +02:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-11-24 02:21:25.632 +02:00 [DBG] Connection id "0HNHATTJOH6T3" stopped.
2025-11-24 02:21:25.632 +02:00 [DBG] Connection id "0HNHATTJOH6T2" stopped.
2025-11-24 02:21:25.634 +02:00 [DBG] Connection id "0HNHATTJOH6T2" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-11-24 02:21:25.634 +02:00 [DBG] Connection id "0HNHATTJOH6T3" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-11-24 02:21:25.666 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-24 02:21:25.667 +02:00 [INF] Hosting environment: Development
2025-11-24 02:21:25.668 +02:00 [INF] Content root path: D:\Walaa\GP\Hospital\Hospital
2025-11-24 02:21:25.668 +02:00 [DBG] Hosting started
2025-11-24 02:21:25.790 +02:00 [DBG] Connection id "0HNHATTJOH6T4" accepted.
2025-11-24 02:21:25.793 +02:00 [DBG] Connection id "0HNHATTJOH6T4" started.
2025-11-24 02:21:25.830 +02:00 [DBG] Connection 0HNHATTJOH6T4 established using the following protocol: "Tls12"
2025-11-24 02:21:25.882 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/swagger/index.html - null null
2025-11-24 02:21:25.950 +02:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-11-24 02:21:25.974 +02:00 [DBG] No candidates found for the request path '/swagger/index.html'
2025-11-24 02:21:25.975 +02:00 [DBG] Request did not match any endpoints
2025-11-24 02:21:26.013 +02:00 [DBG] Response markup is scheduled to include Browser Link script injection.
2025-11-24 02:21:26.014 +02:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2025-11-24 02:21:26.026 +02:00 [DBG] Response markup was updated to include Browser Link script injection.
2025-11-24 02:21:26.027 +02:00 [DBG] Response markup was updated to include browser refresh script injection.
2025-11-24 02:21:26.029 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/swagger/index.html - 200 null text/html;charset=utf-8 153.5039ms
2025-11-24 02:21:26.038 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/_vs/browserLink - null null
2025-11-24 02:21:26.038 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/_framework/aspnetcore-browser-refresh.js - null null
2025-11-24 02:21:26.047 +02:00 [DBG] Script injected: /_framework/aspnetcore-browser-refresh.js
2025-11-24 02:21:26.055 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/_framework/aspnetcore-browser-refresh.js - 200 16501 application/javascript; charset=utf-8 16.8192ms
2025-11-24 02:21:26.071 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/_vs/browserLink - 200 null text/javascript; charset=UTF-8 32.7889ms
2025-11-24 02:21:26.109 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/swagger/v1/swagger.json - null null
2025-11-24 02:21:26.111 +02:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2025-11-24 02:21:26.111 +02:00 [DBG] Request did not match any endpoints
2025-11-24 02:21:26.142 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 33.9373ms
2025-11-24 02:21:29.413 +02:00 [DBG] Connection id "0HNHATTJOH6T5" received FIN.
2025-11-24 02:21:29.413 +02:00 [DBG] Connection id "0HNHATTJOH6T5" accepted.
2025-11-24 02:21:29.415 +02:00 [DBG] Connection id "0HNHATTJOH6T5" started.
2025-11-24 02:21:29.416 +02:00 [DBG] Connection id "0HNHATTJOH6T6" accepted.
2025-11-24 02:21:29.417 +02:00 [DBG] Connection id "0HNHATTJOH6T6" started.
2025-11-24 02:21:29.417 +02:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-11-24 02:21:29.420 +02:00 [DBG] Connection id "0HNHATTJOH6T5" stopped.
2025-11-24 02:21:29.421 +02:00 [DBG] Connection id "0HNHATTJOH6T5" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-11-24 02:21:29.421 +02:00 [DBG] Connection 0HNHATTJOH6T6 established using the following protocol: "Tls12"
2025-11-24 02:21:29.425 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Doctor/branch/7 - null null
2025-11-24 02:21:29.428 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/branch/7'
2025-11-24 02:21:29.430 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.GetByBranch (Hospital)' with route pattern 'api/Doctor/branch/{branchId}' is valid for the request path '/api/Doctor/branch/7'
2025-11-24 02:21:29.431 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.GetByBranch (Hospital)'
2025-11-24 02:21:29.433 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:21:29.457 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:21:29.459 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.GetByBranch (Hospital)'
2025-11-24 02:21:29.479 +02:00 [INF] Route matched with {action = "GetByBranch", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetByBranch(Int32) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 02:21:29.483 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:21:29.484 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:21:29.484 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:21:29.485 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:21:29.486 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:21:29.487 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 02:21:29.715 +02:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-11-24 02:21:29.736 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 02:21:29.748 +02:00 [DBG] Attempting to bind parameter 'branchId' of type 'System.Int32' ...
2025-11-24 02:21:29.750 +02:00 [DBG] Attempting to bind parameter 'branchId' of type 'System.Int32' using the name 'branchId' in request data ...
2025-11-24 02:21:29.752 +02:00 [DBG] Done attempting to bind parameter 'branchId' of type 'System.Int32'.
2025-11-24 02:21:29.752 +02:00 [DBG] Done attempting to bind parameter 'branchId' of type 'System.Int32'.
2025-11-24 02:21:29.753 +02:00 [DBG] Attempting to validate the bound parameter 'branchId' of type 'System.Int32' ...
2025-11-24 02:21:29.755 +02:00 [DBG] Done attempting to validate the bound parameter 'branchId' of type 'System.Int32'.
2025-11-24 02:21:29.758 +02:00 [INF] get doctor by Branch called at "2025-11-24T02:21:29.7584046+02:00"
2025-11-24 02:21:29.760 +02:00 [INF] Fetching all doctors for branch ID 7
2025-11-24 02:21:30.165 +02:00 [DBG] The index {'BranchesBranchId'} was not created on entity type 'BranchDoctor (Dictionary<string, object>)' as the properties are already covered by the index {'BranchesBranchId', 'DoctorsDoctorId'}.
2025-11-24 02:21:30.166 +02:00 [DBG] The index {'BranchId'} was not created on entity type 'BranchService (Dictionary<string, object>)' as the properties are already covered by the index {'BranchId', 'ServiceId'}.
2025-11-24 02:21:30.167 +02:00 [DBG] The index {'BranchId'} was not created on entity type 'BranchSpecialization (Dictionary<string, object>)' as the properties are already covered by the index {'BranchId', 'SpecializationId'}.
2025-11-24 02:21:30.168 +02:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserRole<string>' as the properties are already covered by the index {'UserId', 'RoleId'}.
2025-11-24 02:21:30.168 +02:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserToken<string>' as the properties are already covered by the index {'UserId', 'LoginProvider', 'Name'}.
2025-11-24 02:21:30.259 +02:00 [DBG] The property 'BranchDoctor (Dictionary<string, object>).BranchesBranchId' was created in shadow state because there are no eligible CLR members with a matching name.
2025-11-24 02:21:30.261 +02:00 [DBG] The property 'BranchDoctor (Dictionary<string, object>).DoctorsDoctorId' was created in shadow state because there are no eligible CLR members with a matching name.
2025-11-24 02:21:30.398 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:21:30.452 +02:00 [DBG] Compiling query expression: 
'DbSet<Branch>()
    .FirstOrDefault(e => e.BranchId == __id_0)'
2025-11-24 02:21:30.578 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Branch>(
    asyncEnumerable: new SingleQueryingEnumerable<Branch>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Branch.Address (string) MaxLength(250), 1], [Property: Branch.BranchName (string) Required MaxLength(150), 2], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 3], [Property: Branch.Description (string), 4], [Property: Branch.Email (string) MaxLength(200), 5], [Property: Branch.ImageURL (string) MaxLength(300), 6], [Property: Branch.Phone (string) MaxLength(25), 7], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 8] }
            SELECT TOP(1) b.BranchId, b.Address, b.BranchName, b.CreatedAt, b.Description, b.Email, b.ImageURL, b.Phone, b.UpdatedAt
            FROM Branches AS b
            WHERE b.BranchId == @__id_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Branch>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 02:21:30.607 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:21:30.623 +02:00 [DBG] Created DbConnection. (13ms).
2025-11-24 02:21:30.626 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:21:30.793 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:21:30.796 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:21:30.802 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (4ms).
2025-11-24 02:21:30.809 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (13ms).
2025-11-24 02:21:30.815 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 02:21:30.852 +02:00 [INF] Executed DbCommand (39ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 02:21:30.863 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:21:30.867 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 9ms reading results.
2025-11-24 02:21:30.870 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:21:30.876 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (5ms).
2025-11-24 02:21:30.877 +02:00 [WRN] Branch with ID 7 not found
2025-11-24 02:21:30.931 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.GetByBranch (Hospital) in 1442.1568ms
2025-11-24 02:21:30.932 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.GetByBranch (Hospital)'
2025-11-24 02:21:30.978 +02:00 [ERR]  Exception caught: Branch not found.
System.Collections.Generic.KeyNotFoundException: Branch not found.
   at Hospital.Infrastructure.Services.DoctorService.GetAllAsync(Int32 branchId) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\DoctorService.cs:line 257
   at Hospital.Controllers.DoctorController.GetByBranch(Int32 branchId) in D:\Walaa\GP\Hospital\Hospital\Controllers\DoctorController.cs:line 168
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
2025-11-24 02:21:31.005 +02:00 [DBG] Connection id "0HNHATTJOH6T6" completed keep alive response.
2025-11-24 02:21:31.008 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:21:31.012 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:21:31.014 +02:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-11-24 02:21:31.014 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Doctor/branch/7 - 404 null application/json 1589.713ms
2025-11-24 02:21:37.713 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Doctor/branch/2 - null null
2025-11-24 02:21:37.717 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/branch/2'
2025-11-24 02:21:37.717 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.GetByBranch (Hospital)' with route pattern 'api/Doctor/branch/{branchId}' is valid for the request path '/api/Doctor/branch/2'
2025-11-24 02:21:37.718 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.GetByBranch (Hospital)'
2025-11-24 02:21:37.719 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:21:37.721 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:21:37.721 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.GetByBranch (Hospital)'
2025-11-24 02:21:37.722 +02:00 [INF] Route matched with {action = "GetByBranch", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetByBranch(Int32) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 02:21:37.724 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:21:37.724 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:21:37.725 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:21:37.726 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:21:37.727 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:21:37.728 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 02:21:37.731 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 02:21:37.732 +02:00 [DBG] Attempting to bind parameter 'branchId' of type 'System.Int32' ...
2025-11-24 02:21:37.733 +02:00 [DBG] Attempting to bind parameter 'branchId' of type 'System.Int32' using the name 'branchId' in request data ...
2025-11-24 02:21:37.733 +02:00 [DBG] Done attempting to bind parameter 'branchId' of type 'System.Int32'.
2025-11-24 02:21:37.734 +02:00 [DBG] Done attempting to bind parameter 'branchId' of type 'System.Int32'.
2025-11-24 02:21:37.734 +02:00 [DBG] Attempting to validate the bound parameter 'branchId' of type 'System.Int32' ...
2025-11-24 02:21:37.735 +02:00 [DBG] Done attempting to validate the bound parameter 'branchId' of type 'System.Int32'.
2025-11-24 02:21:37.736 +02:00 [INF] get doctor by Branch called at "2025-11-24T02:21:37.7364981+02:00"
2025-11-24 02:21:37.737 +02:00 [INF] Fetching all doctors for branch ID 2
2025-11-24 02:21:37.772 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:21:37.776 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:21:37.776 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:21:37.777 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:21:37.779 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:21:37.779 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:21:37.780 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:21:37.781 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:21:37.782 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 02:21:37.791 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 02:21:37.829 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:21:37.845 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:21:37.845 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 52ms reading results.
2025-11-24 02:21:37.846 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:21:37.847 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:21:37.855 +02:00 [DBG] Compiling query expression: 
'DbSet<Doctor>()
    .Include(d => d.User)
    .Include(d => d.Specialization)
    .Include(d => d.Branches)
    .Include(d => d.Schedules)
    .Where(d => d.Branches
        .Any(b => b.BranchId == __branchId_0))'
2025-11-24 02:21:37.873 +02:00 [DBG] Including navigation: 'Doctor.User'.
2025-11-24 02:21:37.875 +02:00 [DBG] Including navigation: 'Doctor.Specialization'.
2025-11-24 02:21:37.876 +02:00 [DBG] Including navigation: 'Doctor.Branches'.
2025-11-24 02:21:37.877 +02:00 [DBG] Including navigation: 'Doctor.Schedules'.
2025-11-24 02:21:37.951 +02:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-11-24 02:21:37.962 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Doctor>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Doctor.DoctorId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Doctor.Available (bool?), 1], [Property: Doctor.Biography (string), 2], [Property: Doctor.ConsultationFees (decimal) Required, 3], [Property: Doctor.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: Doctor.ExperienceYears (int?), 5], [Property: Doctor.ImageURL (string) MaxLength(300), 6], [Property: Doctor.SpecializationId (int) Required FK Index, 7], [Property: Doctor.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 8], [Property: Doctor.UserId (string) Required FK Index, 9] }
            1 -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 10], [Property: User.AccessFailedCount (int) Required, 11], [Property: User.ConcurrencyStamp (string) Concurrency, 12], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 13], [Property: User.DateOfBirth (DateOnly?), 14], [Property: User.Email (string) Index MaxLength(256), 15], [Property: User.EmailConfirmed (bool) Required, 16], [Property: User.FullName (string) Required MaxLength(150), 17], [Property: User.Gender (GenderType?) MaxLength(10), 18], [Property: User.LockoutEnabled (bool) Required, 19], [Property: User.LockoutEnd (DateTimeOffset?), 20], [Property: User.NormalizedEmail (string) Index MaxLength(256), 21], [Property: User.NormalizedUserName (string) Index MaxLength(256), 22], [Property: User.PasswordHash (string), 23], [Property: User.PhoneNumber (string), 24], [Property: User.PhoneNumberConfirmed (bool) Required, 25], [Property: User.RefreshToken (string), 26], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 27], [Property: User.Role (string) Required MaxLength(50), 28], [Property: User.SecurityStamp (string), 29], [Property: User.TwoFactorEnabled (bool) Required, 30], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 31], [Property: User.UserName (string) MaxLength(256), 32] }
            2 -> Dictionary<IProperty, int> { [Property: Specialization.SpecializationId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 33], [Property: Specialization.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 34], [Property: Specialization.Description (string), 35], [Property: Specialization.Name (string) Required MaxLength(120), 36], [Property: Specialization.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 37] }
            3 -> 0
            4 -> 10
            5 -> 33
            6 -> Dictionary<IProperty, int> { [Property: BranchDoctor (Dictionary<string, object>).BranchesBranchId (no field, int) Indexer Required PK FK AfterSave:Throw, 38], [Property: BranchDoctor (Dictionary<string, object>).DoctorsDoctorId (no field, int) Indexer Required PK FK Index AfterSave:Throw, 39] }
            7 -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 40], [Property: Branch.Address (string) MaxLength(250), 41], [Property: Branch.BranchName (string) Required MaxLength(150), 42], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 43], [Property: Branch.Description (string), 44], [Property: Branch.Email (string) MaxLength(200), 45], [Property: Branch.ImageURL (string) MaxLength(300), 46], [Property: Branch.Phone (string) MaxLength(25), 47], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 48] }
            8 -> 38
            9 -> 39
            10 -> 40
            11 -> Dictionary<IProperty, int> { [Property: Schedule.ScheduleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 49], [Property: Schedule.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 50], [Property: Schedule.DayOfWeek (string) Required MaxLength(20), 51], [Property: Schedule.DoctorId (int) Required FK Index, 52], [Property: Schedule.EndTime (DateTime) Required, 53], [Property: Schedule.Shift (AppointmentShift) Required, 54], [Property: Schedule.StartTime (DateTime) Required, 55], [Property: Schedule.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 56] }
            12 -> 49
        SELECT d.DoctorId, d.Available, d.Biography, d.ConsultationFees, d.CreatedAt, d.ExperienceYears, d.ImageURL, d.SpecializationId, d.UpdatedAt, d.UserId, u.Id, u.AccessFailedCount, u.ConcurrencyStamp, u.CreatedAt, u.DateOfBirth, u.Email, u.EmailConfirmed, u.FullName, u.Gender, u.LockoutEnabled, u.LockoutEnd, u.NormalizedEmail, u.NormalizedUserName, u.PasswordHash, u.PhoneNumber, u.PhoneNumberConfirmed, u.RefreshToken, u.RefreshTokenExpiryTime, u.Role, u.SecurityStamp, u.TwoFactorEnabled, u.UpdatedAt, u.UserName, s.SpecializationId, s.CreatedAt, s.Description, s.Name, s.UpdatedAt, t.BranchesBranchId, t.DoctorsDoctorId, t.BranchId, t.Address, t.BranchName, t.CreatedAt, t.Description, t.Email, t.ImageURL, t.Phone, t.UpdatedAt, s0.ScheduleId, s0.CreatedAt, s0.DayOfWeek, s0.DoctorId, s0.EndTime, s0.Shift, s0.StartTime, s0.UpdatedAt
        FROM Doctors AS d
        INNER JOIN Users AS u ON d.UserId == u.Id
        INNER JOIN Specializations AS s ON d.SpecializationId == s.SpecializationId
        LEFT JOIN 
        (
            SELECT d1.BranchesBranchId, d1.DoctorsDoctorId, b0.BranchId, b0.Address, b0.BranchName, b0.CreatedAt, b0.Description, b0.Email, b0.ImageURL, b0.Phone, b0.UpdatedAt
            FROM DoctorBranches AS d1
            INNER JOIN Branches AS b0 ON d1.BranchesBranchId == b0.BranchId
        ) AS t ON d.DoctorId == t.DoctorsDoctorId
        LEFT JOIN Schedules AS s0 ON d.DoctorId == s0.DoctorId
        WHERE EXISTS (
            SELECT 1
            FROM DoctorBranches AS d0
            INNER JOIN Branches AS b ON d0.BranchesBranchId == b.BranchId
            WHERE ((d.DoctorId != NULL) && (d.DoctorId == d0.DoctorsDoctorId)) && (b.BranchId == @__branchId_0))
        ORDER BY d.DoctorId ASC, u.Id ASC, s.SpecializationId ASC, t.BranchesBranchId ASC, t.DoctorsDoctorId ASC, t.BranchId ASC), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Doctor>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 02:21:37.974 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:21:37.975 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:21:37.975 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:21:37.976 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:21:37.976 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:21:37.977 +02:00 [DBG] Executing DbCommand [Parameters=[@__branchId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt], [t].[BranchesBranchId], [t].[DoctorsDoctorId], [t].[BranchId], [t].[Address], [t].[BranchName], [t].[CreatedAt], [t].[Description], [t].[Email], [t].[ImageURL], [t].[Phone], [t].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM [Doctors] AS [d]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
LEFT JOIN (
    SELECT [d1].[BranchesBranchId], [d1].[DoctorsDoctorId], [b0].[BranchId], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [DoctorBranches] AS [d1]
    INNER JOIN [Branches] AS [b0] ON [d1].[BranchesBranchId] = [b0].[BranchId]
) AS [t] ON [d].[DoctorId] = [t].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [d].[DoctorId] = [s0].[DoctorId]
WHERE EXISTS (
    SELECT 1
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
    WHERE [d].[DoctorId] = [d0].[DoctorsDoctorId] AND [b].[BranchId] = @__branchId_0)
ORDER BY [d].[DoctorId], [u].[Id], [s].[SpecializationId], [t].[BranchesBranchId], [t].[DoctorsDoctorId], [t].[BranchId]
2025-11-24 02:21:38.000 +02:00 [INF] Executed DbCommand (23ms) [Parameters=[@__branchId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt], [t].[BranchesBranchId], [t].[DoctorsDoctorId], [t].[BranchId], [t].[Address], [t].[BranchName], [t].[CreatedAt], [t].[Description], [t].[Email], [t].[ImageURL], [t].[Phone], [t].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM [Doctors] AS [d]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
LEFT JOIN (
    SELECT [d1].[BranchesBranchId], [d1].[DoctorsDoctorId], [b0].[BranchId], [b0].[Address], [b0].[BranchName], [b0].[CreatedAt], [b0].[Description], [b0].[Email], [b0].[ImageURL], [b0].[Phone], [b0].[UpdatedAt]
    FROM [DoctorBranches] AS [d1]
    INNER JOIN [Branches] AS [b0] ON [d1].[BranchesBranchId] = [b0].[BranchId]
) AS [t] ON [d].[DoctorId] = [t].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [d].[DoctorId] = [s0].[DoctorId]
WHERE EXISTS (
    SELECT 1
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
    WHERE [d].[DoctorId] = [d0].[DoctorsDoctorId] AND [b].[BranchId] = @__branchId_0)
ORDER BY [d].[DoctorId], [u].[Id], [s].[SpecializationId], [t].[BranchesBranchId], [t].[DoctorsDoctorId], [t].[BranchId]
2025-11-24 02:21:38.011 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:21:38.050 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:21:38.052 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:21:38.080 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:21:38.083 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:21:38.101 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:21:38.104 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:21:38.105 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:21:38.106 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:21:38.107 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:21:38.110 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:21:38.117 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:21:38.117 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 114ms reading results.
2025-11-24 02:21:38.118 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:21:38.118 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:21:38.138 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:21:38.142 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:21:38.143 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:21:38.144 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:21:38.145 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:21:38.146 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Doctor.DoctorDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 02:21:38.160 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.GetByBranch (Hospital) in 432.0529ms
2025-11-24 02:21:38.162 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.GetByBranch (Hospital)'
2025-11-24 02:21:38.163 +02:00 [DBG] Connection id "0HNHATTJOH6T6" completed keep alive response.
2025-11-24 02:21:38.164 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:21:38.165 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:21:38.166 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:21:38.166 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Doctor/branch/2 - 200 null application/json; charset=utf-8 453.4745ms
2025-11-24 02:21:50.624 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Doctor/all - null null
2025-11-24 02:21:50.625 +02:00 [DBG] 2 candidate(s) found for the request path '/api/Doctor/all'
2025-11-24 02:21:50.626 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.GetAll (Hospital)' with route pattern 'api/Doctor/all' is valid for the request path '/api/Doctor/all'
2025-11-24 02:21:50.627 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.GetDoctor (Hospital)' with route pattern 'api/Doctor/{doctorId}' is valid for the request path '/api/Doctor/all'
2025-11-24 02:21:50.628 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.GetAll (Hospital)'
2025-11-24 02:21:50.628 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:21:50.631 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:21:50.632 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.GetAll (Hospital)'
2025-11-24 02:21:50.635 +02:00 [INF] Route matched with {action = "GetAll", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll() on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 02:21:50.636 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:21:50.637 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:21:50.637 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:21:50.638 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:21:50.639 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:21:50.639 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 02:21:50.649 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 02:21:50.650 +02:00 [INF] get all doctor in system called at "2025-11-24T02:21:50.6503121+02:00"
2025-11-24 02:21:50.651 +02:00 [INF] Fetching all doctors in the system
2025-11-24 02:21:50.659 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:21:50.662 +02:00 [DBG] Compiling query expression: 
'DbSet<Doctor>()
    .Include(d => d.User)
    .Include(d => d.Specialization)
    .Include(d => d.Branches)
    .Include(d => d.Schedules)'
2025-11-24 02:21:50.663 +02:00 [DBG] Including navigation: 'Doctor.User'.
2025-11-24 02:21:50.664 +02:00 [DBG] Including navigation: 'Doctor.Specialization'.
2025-11-24 02:21:50.665 +02:00 [DBG] Including navigation: 'Doctor.Branches'.
2025-11-24 02:21:50.666 +02:00 [DBG] Including navigation: 'Doctor.Schedules'.
2025-11-24 02:21:50.676 +02:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-11-24 02:21:50.682 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Doctor>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Doctor.DoctorId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Doctor.Available (bool?), 1], [Property: Doctor.Biography (string), 2], [Property: Doctor.ConsultationFees (decimal) Required, 3], [Property: Doctor.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: Doctor.ExperienceYears (int?), 5], [Property: Doctor.ImageURL (string) MaxLength(300), 6], [Property: Doctor.SpecializationId (int) Required FK Index, 7], [Property: Doctor.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 8], [Property: Doctor.UserId (string) Required FK Index, 9] }
            1 -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 10], [Property: User.AccessFailedCount (int) Required, 11], [Property: User.ConcurrencyStamp (string) Concurrency, 12], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 13], [Property: User.DateOfBirth (DateOnly?), 14], [Property: User.Email (string) Index MaxLength(256), 15], [Property: User.EmailConfirmed (bool) Required, 16], [Property: User.FullName (string) Required MaxLength(150), 17], [Property: User.Gender (GenderType?) MaxLength(10), 18], [Property: User.LockoutEnabled (bool) Required, 19], [Property: User.LockoutEnd (DateTimeOffset?), 20], [Property: User.NormalizedEmail (string) Index MaxLength(256), 21], [Property: User.NormalizedUserName (string) Index MaxLength(256), 22], [Property: User.PasswordHash (string), 23], [Property: User.PhoneNumber (string), 24], [Property: User.PhoneNumberConfirmed (bool) Required, 25], [Property: User.RefreshToken (string), 26], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 27], [Property: User.Role (string) Required MaxLength(50), 28], [Property: User.SecurityStamp (string), 29], [Property: User.TwoFactorEnabled (bool) Required, 30], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 31], [Property: User.UserName (string) MaxLength(256), 32] }
            2 -> Dictionary<IProperty, int> { [Property: Specialization.SpecializationId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 33], [Property: Specialization.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 34], [Property: Specialization.Description (string), 35], [Property: Specialization.Name (string) Required MaxLength(120), 36], [Property: Specialization.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 37] }
            3 -> 0
            4 -> 10
            5 -> 33
            6 -> Dictionary<IProperty, int> { [Property: BranchDoctor (Dictionary<string, object>).BranchesBranchId (no field, int) Indexer Required PK FK AfterSave:Throw, 38], [Property: BranchDoctor (Dictionary<string, object>).DoctorsDoctorId (no field, int) Indexer Required PK FK Index AfterSave:Throw, 39] }
            7 -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 40], [Property: Branch.Address (string) MaxLength(250), 41], [Property: Branch.BranchName (string) Required MaxLength(150), 42], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 43], [Property: Branch.Description (string), 44], [Property: Branch.Email (string) MaxLength(200), 45], [Property: Branch.ImageURL (string) MaxLength(300), 46], [Property: Branch.Phone (string) MaxLength(25), 47], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 48] }
            8 -> 38
            9 -> 39
            10 -> 40
            11 -> Dictionary<IProperty, int> { [Property: Schedule.ScheduleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 49], [Property: Schedule.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 50], [Property: Schedule.DayOfWeek (string) Required MaxLength(20), 51], [Property: Schedule.DoctorId (int) Required FK Index, 52], [Property: Schedule.EndTime (DateTime) Required, 53], [Property: Schedule.Shift (AppointmentShift) Required, 54], [Property: Schedule.StartTime (DateTime) Required, 55], [Property: Schedule.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 56] }
            12 -> 49
        SELECT d.DoctorId, d.Available, d.Biography, d.ConsultationFees, d.CreatedAt, d.ExperienceYears, d.ImageURL, d.SpecializationId, d.UpdatedAt, d.UserId, u.Id, u.AccessFailedCount, u.ConcurrencyStamp, u.CreatedAt, u.DateOfBirth, u.Email, u.EmailConfirmed, u.FullName, u.Gender, u.LockoutEnabled, u.LockoutEnd, u.NormalizedEmail, u.NormalizedUserName, u.PasswordHash, u.PhoneNumber, u.PhoneNumberConfirmed, u.RefreshToken, u.RefreshTokenExpiryTime, u.Role, u.SecurityStamp, u.TwoFactorEnabled, u.UpdatedAt, u.UserName, s.SpecializationId, s.CreatedAt, s.Description, s.Name, s.UpdatedAt, t.BranchesBranchId, t.DoctorsDoctorId, t.BranchId, t.Address, t.BranchName, t.CreatedAt, t.Description, t.Email, t.ImageURL, t.Phone, t.UpdatedAt, s0.ScheduleId, s0.CreatedAt, s0.DayOfWeek, s0.DoctorId, s0.EndTime, s0.Shift, s0.StartTime, s0.UpdatedAt
        FROM Doctors AS d
        INNER JOIN Users AS u ON d.UserId == u.Id
        INNER JOIN Specializations AS s ON d.SpecializationId == s.SpecializationId
        LEFT JOIN 
        (
            SELECT d0.BranchesBranchId, d0.DoctorsDoctorId, b.BranchId, b.Address, b.BranchName, b.CreatedAt, b.Description, b.Email, b.ImageURL, b.Phone, b.UpdatedAt
            FROM DoctorBranches AS d0
            INNER JOIN Branches AS b ON d0.BranchesBranchId == b.BranchId
        ) AS t ON d.DoctorId == t.DoctorsDoctorId
        LEFT JOIN Schedules AS s0 ON d.DoctorId == s0.DoctorId
        ORDER BY d.DoctorId ASC, u.Id ASC, s.SpecializationId ASC, t.BranchesBranchId ASC, t.DoctorsDoctorId ASC, t.BranchId ASC), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Doctor>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 02:21:50.685 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:21:50.685 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:21:50.687 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:21:50.688 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:21:50.689 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:21:50.689 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:21:50.690 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:21:50.691 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt], [t].[BranchesBranchId], [t].[DoctorsDoctorId], [t].[BranchId], [t].[Address], [t].[BranchName], [t].[CreatedAt], [t].[Description], [t].[Email], [t].[ImageURL], [t].[Phone], [t].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM [Doctors] AS [d]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t] ON [d].[DoctorId] = [t].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [d].[DoctorId] = [s0].[DoctorId]
ORDER BY [d].[DoctorId], [u].[Id], [s].[SpecializationId], [t].[BranchesBranchId], [t].[DoctorsDoctorId], [t].[BranchId]
2025-11-24 02:21:50.701 +02:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt], [t].[BranchesBranchId], [t].[DoctorsDoctorId], [t].[BranchId], [t].[Address], [t].[BranchName], [t].[CreatedAt], [t].[Description], [t].[Email], [t].[ImageURL], [t].[Phone], [t].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM [Doctors] AS [d]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t] ON [d].[DoctorId] = [t].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [d].[DoctorId] = [s0].[DoctorId]
ORDER BY [d].[DoctorId], [u].[Id], [s].[SpecializationId], [t].[BranchesBranchId], [t].[DoctorsDoctorId], [t].[BranchId]
2025-11-24 02:21:50.704 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:21:50.705 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:21:50.706 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:21:50.707 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:21:50.708 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:21:50.709 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:21:50.709 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:21:50.710 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:21:50.711 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:21:50.711 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:21:50.713 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:21:50.713 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:21:50.715 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:21:50.716 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 11ms reading results.
2025-11-24 02:21:50.716 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:21:50.717 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:21:50.718 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:21:50.719 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:21:50.720 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:21:50.720 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:21:50.721 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:21:50.722 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Doctor.DoctorDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 02:21:50.722 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.GetAll (Hospital) in 83.0868ms
2025-11-24 02:21:50.723 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.GetAll (Hospital)'
2025-11-24 02:21:50.724 +02:00 [DBG] Connection id "0HNHATTJOH6T6" completed keep alive response.
2025-11-24 02:21:50.724 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:21:50.724 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:21:50.725 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:21:50.726 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Doctor/all - 200 null application/json; charset=utf-8 101.8043ms
2025-11-24 02:22:05.222 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Doctor/BySpecialization/1 - null null
2025-11-24 02:22:05.223 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/BySpecialization/1'
2025-11-24 02:22:05.224 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.GetDoctorsBySpecialization (Hospital)' with route pattern 'api/Doctor/BySpecialization/{specializationId}' is valid for the request path '/api/Doctor/BySpecialization/1'
2025-11-24 02:22:05.224 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.GetDoctorsBySpecialization (Hospital)'
2025-11-24 02:22:05.225 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:22:05.225 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:22:05.226 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.GetDoctorsBySpecialization (Hospital)'
2025-11-24 02:22:05.229 +02:00 [INF] Route matched with {action = "GetDoctorsBySpecialization", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetDoctorsBySpecialization(Int32) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 02:22:05.230 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:22:05.231 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:22:05.231 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:22:05.232 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:22:05.233 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:22:05.234 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 02:22:05.235 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 02:22:05.235 +02:00 [DBG] Attempting to bind parameter 'specializationId' of type 'System.Int32' ...
2025-11-24 02:22:05.236 +02:00 [DBG] Attempting to bind parameter 'specializationId' of type 'System.Int32' using the name 'specializationId' in request data ...
2025-11-24 02:22:05.236 +02:00 [DBG] Done attempting to bind parameter 'specializationId' of type 'System.Int32'.
2025-11-24 02:22:05.237 +02:00 [DBG] Done attempting to bind parameter 'specializationId' of type 'System.Int32'.
2025-11-24 02:22:05.237 +02:00 [DBG] Attempting to validate the bound parameter 'specializationId' of type 'System.Int32' ...
2025-11-24 02:22:05.238 +02:00 [DBG] Done attempting to validate the bound parameter 'specializationId' of type 'System.Int32'.
2025-11-24 02:22:05.239 +02:00 [INF] get doctor by Specialization  called at "2025-11-24T02:22:05.2398121+02:00"
2025-11-24 02:22:05.241 +02:00 [INF] Fetching doctors for specialization ID 1
2025-11-24 02:22:05.243 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:22:05.250 +02:00 [DBG] Compiling query expression: 
'DbSet<Specialization>()
    .FirstOrDefault(e => EF.Property<int>(e, "SpecializationId") == __p_0)'
2025-11-24 02:22:05.253 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Specialization>(
    asyncEnumerable: new SingleQueryingEnumerable<Specialization>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Specialization.SpecializationId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Specialization.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: Specialization.Description (string), 2], [Property: Specialization.Name (string) Required MaxLength(120), 3], [Property: Specialization.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 4] }
            SELECT TOP(1) s.SpecializationId, s.CreatedAt, s.Description, s.Name, s.UpdatedAt
            FROM Specializations AS s
            WHERE s.SpecializationId == @__p_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Specialization>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 02:22:05.255 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:22:05.255 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:22:05.255 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:22:05.256 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:22:05.256 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:22:05.257 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:22:05.257 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:22:05.258 +02:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt]
FROM [Specializations] AS [s]
WHERE [s].[SpecializationId] = @__p_0
2025-11-24 02:22:05.261 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt]
FROM [Specializations] AS [s]
WHERE [s].[SpecializationId] = @__p_0
2025-11-24 02:22:05.265 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:22:05.266 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:22:05.267 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 2ms reading results.
2025-11-24 02:22:05.268 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:22:05.269 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 02:22:05.272 +02:00 [DBG] Compiling query expression: 
'DbSet<Doctor>()
    .Include(d => d.User)
    .Include(d => d.Branches)
    .ThenInclude(b => b.Specializations)
    .Where(d => d.Branches
        .Any(b => b.Specializations
            .Any(s => s.SpecializationId == __specializationId_0)))'
2025-11-24 02:22:05.275 +02:00 [DBG] Including navigation: 'Doctor.User'.
2025-11-24 02:22:05.276 +02:00 [DBG] Including navigation: 'Doctor.Branches'.
2025-11-24 02:22:05.277 +02:00 [DBG] Including navigation: 'Branch.Specializations'.
2025-11-24 02:22:05.289 +02:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-11-24 02:22:05.293 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Doctor>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Doctor.DoctorId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Doctor.Available (bool?), 1], [Property: Doctor.Biography (string), 2], [Property: Doctor.ConsultationFees (decimal) Required, 3], [Property: Doctor.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: Doctor.ExperienceYears (int?), 5], [Property: Doctor.ImageURL (string) MaxLength(300), 6], [Property: Doctor.SpecializationId (int) Required FK Index, 7], [Property: Doctor.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 8], [Property: Doctor.UserId (string) Required FK Index, 9] }
            1 -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 10], [Property: User.AccessFailedCount (int) Required, 11], [Property: User.ConcurrencyStamp (string) Concurrency, 12], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 13], [Property: User.DateOfBirth (DateOnly?), 14], [Property: User.Email (string) Index MaxLength(256), 15], [Property: User.EmailConfirmed (bool) Required, 16], [Property: User.FullName (string) Required MaxLength(150), 17], [Property: User.Gender (GenderType?) MaxLength(10), 18], [Property: User.LockoutEnabled (bool) Required, 19], [Property: User.LockoutEnd (DateTimeOffset?), 20], [Property: User.NormalizedEmail (string) Index MaxLength(256), 21], [Property: User.NormalizedUserName (string) Index MaxLength(256), 22], [Property: User.PasswordHash (string), 23], [Property: User.PhoneNumber (string), 24], [Property: User.PhoneNumberConfirmed (bool) Required, 25], [Property: User.RefreshToken (string), 26], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 27], [Property: User.Role (string) Required MaxLength(50), 28], [Property: User.SecurityStamp (string), 29], [Property: User.TwoFactorEnabled (bool) Required, 30], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 31], [Property: User.UserName (string) MaxLength(256), 32] }
            2 -> 0
            3 -> 10
            4 -> Dictionary<IProperty, int> { [Property: BranchDoctor (Dictionary<string, object>).BranchesBranchId (no field, int) Indexer Required PK FK AfterSave:Throw, 33], [Property: BranchDoctor (Dictionary<string, object>).DoctorsDoctorId (no field, int) Indexer Required PK FK Index AfterSave:Throw, 34] }
            5 -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 35], [Property: Branch.Address (string) MaxLength(250), 36], [Property: Branch.BranchName (string) Required MaxLength(150), 37], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 38], [Property: Branch.Description (string), 39], [Property: Branch.Email (string) MaxLength(200), 40], [Property: Branch.ImageURL (string) MaxLength(300), 41], [Property: Branch.Phone (string) MaxLength(25), 42], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 43] }
            6 -> 33
            7 -> 34
            8 -> 35
            9 -> Dictionary<IProperty, int> { [Property: BranchSpecialization (Dictionary<string, object>).BranchId (no field, int) Indexer Required PK FK AfterSave:Throw, 44], [Property: BranchSpecialization (Dictionary<string, object>).SpecializationId (no field, int) Indexer Required PK FK Index AfterSave:Throw, 45] }
            10 -> Dictionary<IProperty, int> { [Property: Specialization.SpecializationId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 46], [Property: Specialization.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 47], [Property: Specialization.Description (string), 48], [Property: Specialization.Name (string) Required MaxLength(120), 49], [Property: Specialization.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 50] }
            11 -> 44
            12 -> 45
            13 -> 46
        SELECT d.DoctorId, d.Available, d.Biography, d.ConsultationFees, d.CreatedAt, d.ExperienceYears, d.ImageURL, d.SpecializationId, d.UpdatedAt, d.UserId, u.Id, u.AccessFailedCount, u.ConcurrencyStamp, u.CreatedAt, u.DateOfBirth, u.Email, u.EmailConfirmed, u.FullName, u.Gender, u.LockoutEnabled, u.LockoutEnd, u.NormalizedEmail, u.NormalizedUserName, u.PasswordHash, u.PhoneNumber, u.PhoneNumberConfirmed, u.RefreshToken, u.RefreshTokenExpiryTime, u.Role, u.SecurityStamp, u.TwoFactorEnabled, u.UpdatedAt, u.UserName, t0.BranchesBranchId, t0.DoctorsDoctorId, t0.BranchId, t0.Address, t0.BranchName, t0.CreatedAt, t0.Description, t0.Email, t0.ImageURL, t0.Phone, t0.UpdatedAt, t0.BranchId0, t0.SpecializationId, t0.SpecializationId0, t0.CreatedAt0, t0.Description0, t0.Name, t0.UpdatedAt0
        FROM Doctors AS d
        INNER JOIN Users AS u ON d.UserId == u.Id
        LEFT JOIN 
        (
            SELECT d1.BranchesBranchId, d1.DoctorsDoctorId, b1.BranchId, b1.Address, b1.BranchName, b1.CreatedAt, b1.Description, b1.Email, b1.ImageURL, b1.Phone, b1.UpdatedAt, t.BranchId AS BranchId0, t.SpecializationId, t.SpecializationId0, t.CreatedAt AS CreatedAt0, t.Description AS Description0, t.Name, t.UpdatedAt AS UpdatedAt0
            FROM DoctorBranches AS d1
            INNER JOIN Branches AS b1 ON d1.BranchesBranchId == b1.BranchId
            LEFT JOIN 
            (
                SELECT b2.BranchId, b2.SpecializationId, s0.SpecializationId AS SpecializationId0, s0.CreatedAt, s0.Description, s0.Name, s0.UpdatedAt
                FROM BranchSpecializations AS b2
                INNER JOIN Specializations AS s0 ON b2.SpecializationId == s0.SpecializationId
            ) AS t ON b1.BranchId == t.BranchId
        ) AS t0 ON d.DoctorId == t0.DoctorsDoctorId
        WHERE EXISTS (
            SELECT 1
            FROM DoctorBranches AS d0
            INNER JOIN Branches AS b ON d0.BranchesBranchId == b.BranchId
            WHERE ((d.DoctorId != NULL) && (d.DoctorId == d0.DoctorsDoctorId)) && EXISTS (
                SELECT 1
                FROM BranchSpecializations AS b0
                INNER JOIN Specializations AS s ON b0.SpecializationId == s.SpecializationId
                WHERE ((b.BranchId != NULL) && (b.BranchId == b0.BranchId)) && (s.SpecializationId == @__specializationId_0)))
        ORDER BY d.DoctorId ASC, u.Id ASC, t0.BranchesBranchId ASC, t0.DoctorsDoctorId ASC, t0.BranchId ASC, t0.BranchId0 ASC, t0.SpecializationId ASC), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Doctor>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 02:22:05.299 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:22:05.299 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:22:05.300 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:22:05.302 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:22:05.303 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 02:22:05.304 +02:00 [DBG] Executing DbCommand [Parameters=[@__specializationId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [t0].[BranchId0], [t0].[SpecializationId], [t0].[SpecializationId0], [t0].[CreatedAt0], [t0].[Description0], [t0].[Name], [t0].[UpdatedAt0]
FROM [Doctors] AS [d]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [d1].[BranchesBranchId], [d1].[DoctorsDoctorId], [b1].[BranchId], [b1].[Address], [b1].[BranchName], [b1].[CreatedAt], [b1].[Description], [b1].[Email], [b1].[ImageURL], [b1].[Phone], [b1].[UpdatedAt], [t].[BranchId] AS [BranchId0], [t].[SpecializationId], [t].[SpecializationId0], [t].[CreatedAt] AS [CreatedAt0], [t].[Description] AS [Description0], [t].[Name], [t].[UpdatedAt] AS [UpdatedAt0]
    FROM [DoctorBranches] AS [d1]
    INNER JOIN [Branches] AS [b1] ON [d1].[BranchesBranchId] = [b1].[BranchId]
    LEFT JOIN (
        SELECT [b2].[BranchId], [b2].[SpecializationId], [s0].[SpecializationId] AS [SpecializationId0], [s0].[CreatedAt], [s0].[Description], [s0].[Name], [s0].[UpdatedAt]
        FROM [BranchSpecializations] AS [b2]
        INNER JOIN [Specializations] AS [s0] ON [b2].[SpecializationId] = [s0].[SpecializationId]
    ) AS [t] ON [b1].[BranchId] = [t].[BranchId]
) AS [t0] ON [d].[DoctorId] = [t0].[DoctorsDoctorId]
WHERE EXISTS (
    SELECT 1
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
    WHERE [d].[DoctorId] = [d0].[DoctorsDoctorId] AND EXISTS (
        SELECT 1
        FROM [BranchSpecializations] AS [b0]
        INNER JOIN [Specializations] AS [s] ON [b0].[SpecializationId] = [s].[SpecializationId]
        WHERE [b].[BranchId] = [b0].[BranchId] AND [s].[SpecializationId] = @__specializationId_0))
ORDER BY [d].[DoctorId], [u].[Id], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[BranchId0], [t0].[SpecializationId]
2025-11-24 02:22:05.329 +02:00 [INF] Executed DbCommand (24ms) [Parameters=[@__specializationId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [t0].[BranchId0], [t0].[SpecializationId], [t0].[SpecializationId0], [t0].[CreatedAt0], [t0].[Description0], [t0].[Name], [t0].[UpdatedAt0]
FROM [Doctors] AS [d]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
LEFT JOIN (
    SELECT [d1].[BranchesBranchId], [d1].[DoctorsDoctorId], [b1].[BranchId], [b1].[Address], [b1].[BranchName], [b1].[CreatedAt], [b1].[Description], [b1].[Email], [b1].[ImageURL], [b1].[Phone], [b1].[UpdatedAt], [t].[BranchId] AS [BranchId0], [t].[SpecializationId], [t].[SpecializationId0], [t].[CreatedAt] AS [CreatedAt0], [t].[Description] AS [Description0], [t].[Name], [t].[UpdatedAt] AS [UpdatedAt0]
    FROM [DoctorBranches] AS [d1]
    INNER JOIN [Branches] AS [b1] ON [d1].[BranchesBranchId] = [b1].[BranchId]
    LEFT JOIN (
        SELECT [b2].[BranchId], [b2].[SpecializationId], [s0].[SpecializationId] AS [SpecializationId0], [s0].[CreatedAt], [s0].[Description], [s0].[Name], [s0].[UpdatedAt]
        FROM [BranchSpecializations] AS [b2]
        INNER JOIN [Specializations] AS [s0] ON [b2].[SpecializationId] = [s0].[SpecializationId]
    ) AS [t] ON [b1].[BranchId] = [t].[BranchId]
) AS [t0] ON [d].[DoctorId] = [t0].[DoctorsDoctorId]
WHERE EXISTS (
    SELECT 1
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
    WHERE [d].[DoctorId] = [d0].[DoctorsDoctorId] AND EXISTS (
        SELECT 1
        FROM [BranchSpecializations] AS [b0]
        INNER JOIN [Specializations] AS [s] ON [b0].[SpecializationId] = [s].[SpecializationId]
        WHERE [b].[BranchId] = [b0].[BranchId] AND [s].[SpecializationId] = @__specializationId_0))
ORDER BY [d].[DoctorId], [u].[Id], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[BranchId0], [t0].[SpecializationId]
2025-11-24 02:22:05.331 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:22:05.331 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:22:05.332 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:22:05.333 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:22:05.333 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:22:05.336 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchSpecialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:22:05.338 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchSpecialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:22:05.338 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:22:05.339 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchSpecialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:22:05.339 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:22:05.340 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:22:05.340 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:22:05.341 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:22:05.342 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:22:05.346 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:22:05.347 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 16ms reading results.
2025-11-24 02:22:05.347 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:22:05.348 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:22:05.350 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:22:05.352 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:22:05.353 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:22:05.353 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:22:05.354 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:22:05.354 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Doctor.DoctorDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 02:22:05.355 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.GetDoctorsBySpecialization (Hospital) in 121.3996ms
2025-11-24 02:22:05.356 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.GetDoctorsBySpecialization (Hospital)'
2025-11-24 02:22:05.356 +02:00 [DBG] Connection id "0HNHATTJOH6T6" completed keep alive response.
2025-11-24 02:22:05.357 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:22:05.357 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:22:05.359 +02:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-11-24 02:22:05.359 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Doctor/BySpecialization/1 - 200 null application/json; charset=utf-8 137.5124ms
2025-11-24 02:22:10.407 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Doctor/BySpecialization/17 - null null
2025-11-24 02:22:10.409 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/BySpecialization/17'
2025-11-24 02:22:10.409 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.GetDoctorsBySpecialization (Hospital)' with route pattern 'api/Doctor/BySpecialization/{specializationId}' is valid for the request path '/api/Doctor/BySpecialization/17'
2025-11-24 02:22:10.411 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.GetDoctorsBySpecialization (Hospital)'
2025-11-24 02:22:10.412 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:22:10.413 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:22:10.414 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.GetDoctorsBySpecialization (Hospital)'
2025-11-24 02:22:10.415 +02:00 [INF] Route matched with {action = "GetDoctorsBySpecialization", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetDoctorsBySpecialization(Int32) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 02:22:10.416 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:22:10.416 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:22:10.417 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:22:10.419 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:22:10.420 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:22:10.421 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 02:22:10.422 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 02:22:10.423 +02:00 [DBG] Attempting to bind parameter 'specializationId' of type 'System.Int32' ...
2025-11-24 02:22:10.424 +02:00 [DBG] Attempting to bind parameter 'specializationId' of type 'System.Int32' using the name 'specializationId' in request data ...
2025-11-24 02:22:10.425 +02:00 [DBG] Done attempting to bind parameter 'specializationId' of type 'System.Int32'.
2025-11-24 02:22:10.425 +02:00 [DBG] Done attempting to bind parameter 'specializationId' of type 'System.Int32'.
2025-11-24 02:22:10.426 +02:00 [DBG] Attempting to validate the bound parameter 'specializationId' of type 'System.Int32' ...
2025-11-24 02:22:10.426 +02:00 [DBG] Done attempting to validate the bound parameter 'specializationId' of type 'System.Int32'.
2025-11-24 02:22:10.427 +02:00 [INF] get doctor by Specialization  called at "2025-11-24T02:22:10.4271760+02:00"
2025-11-24 02:22:10.427 +02:00 [INF] Fetching doctors for specialization ID 17
2025-11-24 02:22:10.428 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:22:10.430 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:22:10.431 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:22:10.431 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:22:10.432 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:22:10.433 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:22:10.434 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:22:10.435 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:22:10.435 +02:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt]
FROM [Specializations] AS [s]
WHERE [s].[SpecializationId] = @__p_0
2025-11-24 02:22:10.437 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt]
FROM [Specializations] AS [s]
WHERE [s].[SpecializationId] = @__p_0
2025-11-24 02:22:10.439 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:22:10.439 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:22:10.440 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:22:10.440 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:22:10.441 +02:00 [WRN] Specialization with ID 17 not found
2025-11-24 02:22:10.475 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.GetDoctorsBySpecialization (Hospital) in 53.6039ms
2025-11-24 02:22:10.476 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.GetDoctorsBySpecialization (Hospital)'
2025-11-24 02:22:10.504 +02:00 [ERR]  Exception caught: Specialization with ID 17 does not exist.
System.Collections.Generic.KeyNotFoundException: Specialization with ID 17 does not exist.
   at Hospital.Infrastructure.Services.DoctorService.GetDoctorsBySpecializationIdAsync(Int32 specializationId) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\DoctorService.cs:line 284
   at Hospital.Controllers.DoctorController.GetDoctorsBySpecialization(Int32 specializationId) in D:\Walaa\GP\Hospital\Hospital\Controllers\DoctorController.cs:line 188
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
2025-11-24 02:22:10.512 +02:00 [DBG] Connection id "0HNHATTJOH6T6" completed keep alive response.
2025-11-24 02:22:10.513 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:22:10.514 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:22:10.515 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:22:10.515 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Doctor/BySpecialization/17 - 404 null application/json 108.2526ms
2025-11-24 02:22:29.145 +02:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7217/api/Doctor/doctor/self-update - application/json 237
2025-11-24 02:22:29.148 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/doctor/self-update'
2025-11-24 02:22:29.149 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.SelfUpdate (Hospital)' with route pattern 'api/Doctor/doctor/self-update' is valid for the request path '/api/Doctor/doctor/self-update'
2025-11-24 02:22:29.151 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.SelfUpdate (Hospital)'
2025-11-24 02:22:29.152 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:22:29.153 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:22:29.155 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.SelfUpdate (Hospital)'
2025-11-24 02:22:29.162 +02:00 [INF] Route matched with {action = "SelfUpdate", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SelfUpdate(Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 02:22:29.164 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:22:29.166 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:22:29.167 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:22:29.168 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:22:29.168 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:22:29.169 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 02:22:29.170 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 02:22:29.170 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto' ...
2025-11-24 02:22:29.172 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto' using the name '' in request data ...
2025-11-24 02:22:29.173 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:22:29.179 +02:00 [DBG] Connection id "0HNHATTJOH6T6", Request id "0HNHATTJOH6T6:00000006": started reading request body.
2025-11-24 02:22:29.180 +02:00 [DBG] Connection id "0HNHATTJOH6T6", Request id "0HNHATTJOH6T6:00000006": done reading request body.
2025-11-24 02:22:29.198 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto'
2025-11-24 02:22:29.199 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto'.
2025-11-24 02:22:29.200 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto'.
2025-11-24 02:22:29.201 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto' ...
2025-11-24 02:22:29.208 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto'.
2025-11-24 02:22:29.209 +02:00 [INF] SelfUpdate doctor called at "2025-11-24T02:22:29.2091825+02:00"
2025-11-24 02:22:29.210 +02:00 [INF] Updating personal info for doctor ID 2
2025-11-24 02:22:29.211 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:22:29.214 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:22:29.214 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:22:29.215 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:22:29.215 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:22:29.216 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:22:29.216 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:22:29.217 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:22:29.218 +02:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt]
FROM [Specializations] AS [s]
WHERE [s].[SpecializationId] = @__p_0
2025-11-24 02:22:29.222 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt]
FROM [Specializations] AS [s]
WHERE [s].[SpecializationId] = @__p_0
2025-11-24 02:22:29.223 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:22:29.224 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:22:29.224 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:22:29.225 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:22:29.225 +02:00 [WRN] Specialization with ID 5 not found
2025-11-24 02:22:29.255 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:22:29.256 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:22:29.257 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:22:29.258 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:22:29.259 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:22:29.259 +02:00 [INF] Executing NotFoundObjectResult, writing value of type '<>f__AnonymousType4`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-11-24 02:22:29.263 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.SelfUpdate (Hospital) in 93.7403ms
2025-11-24 02:22:29.263 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.SelfUpdate (Hospital)'
2025-11-24 02:22:29.264 +02:00 [DBG] Connection id "0HNHATTJOH6T6" completed keep alive response.
2025-11-24 02:22:29.264 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:22:29.265 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:22:29.265 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:22:29.266 +02:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7217/api/Doctor/doctor/self-update - 404 null application/json; charset=utf-8 121.0915ms
2025-11-24 02:23:16.613 +02:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7217/api/Doctor/doctor/self-update - application/json 239
2025-11-24 02:23:16.619 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/doctor/self-update'
2025-11-24 02:23:16.620 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.SelfUpdate (Hospital)' with route pattern 'api/Doctor/doctor/self-update' is valid for the request path '/api/Doctor/doctor/self-update'
2025-11-24 02:23:16.621 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.SelfUpdate (Hospital)'
2025-11-24 02:23:16.621 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:23:16.622 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:23:16.622 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.SelfUpdate (Hospital)'
2025-11-24 02:23:16.623 +02:00 [INF] Route matched with {action = "SelfUpdate", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SelfUpdate(Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 02:23:16.623 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:23:16.624 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:23:16.625 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:23:16.626 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:23:16.627 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:23:16.628 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 02:23:16.629 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 02:23:16.629 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto' ...
2025-11-24 02:23:16.630 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto' using the name '' in request data ...
2025-11-24 02:23:16.631 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:23:16.632 +02:00 [DBG] Connection id "0HNHATTJOH6T6", Request id "0HNHATTJOH6T6:00000007": started reading request body.
2025-11-24 02:23:16.632 +02:00 [DBG] Connection id "0HNHATTJOH6T6", Request id "0HNHATTJOH6T6:00000007": done reading request body.
2025-11-24 02:23:16.634 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto'
2025-11-24 02:23:16.635 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto'.
2025-11-24 02:23:16.635 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto'.
2025-11-24 02:23:16.636 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto' ...
2025-11-24 02:23:16.637 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto'.
2025-11-24 02:23:16.637 +02:00 [INF] SelfUpdate doctor called at "2025-11-24T02:23:16.6378445+02:00"
2025-11-24 02:23:16.638 +02:00 [INF] Updating personal info for doctor ID 2
2025-11-24 02:23:16.639 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:23:16.640 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:23:16.640 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:23:16.641 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:23:16.642 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:23:16.643 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:23:16.643 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:23:16.644 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:23:16.644 +02:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt]
FROM [Specializations] AS [s]
WHERE [s].[SpecializationId] = @__p_0
2025-11-24 02:23:16.646 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt]
FROM [Specializations] AS [s]
WHERE [s].[SpecializationId] = @__p_0
2025-11-24 02:23:16.649 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:23:16.650 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:23:16.651 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 02:23:16.652 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:23:16.652 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:23:16.654 +02:00 [DBG] Compiling query expression: 
'DbSet<Doctor>()
    .Include(d => d.User)
    .Include(d => d.Specialization)
    .Include(d => d.Branches)
    .Include(d => d.Schedules)
    .FirstOrDefault(d => d.DoctorId == __doctorId_0)'
2025-11-24 02:23:16.655 +02:00 [DBG] Including navigation: 'Doctor.User'.
2025-11-24 02:23:16.655 +02:00 [DBG] Including navigation: 'Doctor.Specialization'.
2025-11-24 02:23:16.656 +02:00 [DBG] Including navigation: 'Doctor.Branches'.
2025-11-24 02:23:16.656 +02:00 [DBG] Including navigation: 'Doctor.Schedules'.
2025-11-24 02:23:16.666 +02:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-11-24 02:23:16.672 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Doctor>(
    asyncEnumerable: new SingleQueryingEnumerable<Doctor>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Doctor.DoctorId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Doctor.Available (bool?), 1], [Property: Doctor.Biography (string), 2], [Property: Doctor.ConsultationFees (decimal) Required, 3], [Property: Doctor.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: Doctor.ExperienceYears (int?), 5], [Property: Doctor.ImageURL (string) MaxLength(300), 6], [Property: Doctor.SpecializationId (int) Required FK Index, 7], [Property: Doctor.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 8], [Property: Doctor.UserId (string) Required FK Index, 9] }
                1 -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 10], [Property: User.AccessFailedCount (int) Required, 11], [Property: User.ConcurrencyStamp (string) Concurrency, 12], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 13], [Property: User.DateOfBirth (DateOnly?), 14], [Property: User.Email (string) Index MaxLength(256), 15], [Property: User.EmailConfirmed (bool) Required, 16], [Property: User.FullName (string) Required MaxLength(150), 17], [Property: User.Gender (GenderType?) MaxLength(10), 18], [Property: User.LockoutEnabled (bool) Required, 19], [Property: User.LockoutEnd (DateTimeOffset?), 20], [Property: User.NormalizedEmail (string) Index MaxLength(256), 21], [Property: User.NormalizedUserName (string) Index MaxLength(256), 22], [Property: User.PasswordHash (string), 23], [Property: User.PhoneNumber (string), 24], [Property: User.PhoneNumberConfirmed (bool) Required, 25], [Property: User.RefreshToken (string), 26], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 27], [Property: User.Role (string) Required MaxLength(50), 28], [Property: User.SecurityStamp (string), 29], [Property: User.TwoFactorEnabled (bool) Required, 30], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 31], [Property: User.UserName (string) MaxLength(256), 32] }
                2 -> Dictionary<IProperty, int> { [Property: Specialization.SpecializationId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 33], [Property: Specialization.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 34], [Property: Specialization.Description (string), 35], [Property: Specialization.Name (string) Required MaxLength(120), 36], [Property: Specialization.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 37] }
                3 -> 0
                4 -> 10
                5 -> 33
                6 -> Dictionary<IProperty, int> { [Property: BranchDoctor (Dictionary<string, object>).BranchesBranchId (no field, int) Indexer Required PK FK AfterSave:Throw, 38], [Property: BranchDoctor (Dictionary<string, object>).DoctorsDoctorId (no field, int) Indexer Required PK FK Index AfterSave:Throw, 39] }
                7 -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 40], [Property: Branch.Address (string) MaxLength(250), 41], [Property: Branch.BranchName (string) Required MaxLength(150), 42], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 43], [Property: Branch.Description (string), 44], [Property: Branch.Email (string) MaxLength(200), 45], [Property: Branch.ImageURL (string) MaxLength(300), 46], [Property: Branch.Phone (string) MaxLength(25), 47], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 48] }
                8 -> 38
                9 -> 39
                10 -> 40
                11 -> Dictionary<IProperty, int> { [Property: Schedule.ScheduleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 49], [Property: Schedule.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 50], [Property: Schedule.DayOfWeek (string) Required MaxLength(20), 51], [Property: Schedule.DoctorId (int) Required FK Index, 52], [Property: Schedule.EndTime (DateTime) Required, 53], [Property: Schedule.Shift (AppointmentShift) Required, 54], [Property: Schedule.StartTime (DateTime) Required, 55], [Property: Schedule.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 56] }
                12 -> 49
            SELECT t.DoctorId, t.Available, t.Biography, t.ConsultationFees, t.CreatedAt, t.ExperienceYears, t.ImageURL, t.SpecializationId, t.UpdatedAt, t.UserId, t.Id, t.AccessFailedCount, t.ConcurrencyStamp, t.CreatedAt0, t.DateOfBirth, t.Email, t.EmailConfirmed, t.FullName, t.Gender, t.LockoutEnabled, t.LockoutEnd, t.NormalizedEmail, t.NormalizedUserName, t.PasswordHash, t.PhoneNumber, t.PhoneNumberConfirmed, t.RefreshToken, t.RefreshTokenExpiryTime, t.Role, t.SecurityStamp, t.TwoFactorEnabled, t.UpdatedAt0, t.UserName, t.SpecializationId0, t.CreatedAt1, t.Description, t.Name, t.UpdatedAt1, t0.BranchesBranchId, t0.DoctorsDoctorId, t0.BranchId, t0.Address, t0.BranchName, t0.CreatedAt, t0.Description, t0.Email, t0.ImageURL, t0.Phone, t0.UpdatedAt, s0.ScheduleId, s0.CreatedAt, s0.DayOfWeek, s0.DoctorId, s0.EndTime, s0.Shift, s0.StartTime, s0.UpdatedAt
            FROM 
            (
                SELECT TOP(1) d.DoctorId, d.Available, d.Biography, d.ConsultationFees, d.CreatedAt, d.ExperienceYears, d.ImageURL, d.SpecializationId, d.UpdatedAt, d.UserId, u.Id, u.AccessFailedCount, u.ConcurrencyStamp, u.CreatedAt AS CreatedAt0, u.DateOfBirth, u.Email, u.EmailConfirmed, u.FullName, u.Gender, u.LockoutEnabled, u.LockoutEnd, u.NormalizedEmail, u.NormalizedUserName, u.PasswordHash, u.PhoneNumber, u.PhoneNumberConfirmed, u.RefreshToken, u.RefreshTokenExpiryTime, u.Role, u.SecurityStamp, u.TwoFactorEnabled, u.UpdatedAt AS UpdatedAt0, u.UserName, s.SpecializationId AS SpecializationId0, s.CreatedAt AS CreatedAt1, s.Description, s.Name, s.UpdatedAt AS UpdatedAt1
                FROM Doctors AS d
                INNER JOIN Users AS u ON d.UserId == u.Id
                INNER JOIN Specializations AS s ON d.SpecializationId == s.SpecializationId
                WHERE d.DoctorId == @__doctorId_0
            ) AS t
            LEFT JOIN 
            (
                SELECT d0.BranchesBranchId, d0.DoctorsDoctorId, b.BranchId, b.Address, b.BranchName, b.CreatedAt, b.Description, b.Email, b.ImageURL, b.Phone, b.UpdatedAt
                FROM DoctorBranches AS d0
                INNER JOIN Branches AS b ON d0.BranchesBranchId == b.BranchId
            ) AS t0 ON t.DoctorId == t0.DoctorsDoctorId
            LEFT JOIN Schedules AS s0 ON t.DoctorId == s0.DoctorId
            ORDER BY t.DoctorId ASC, t.Id ASC, t.SpecializationId0 ASC, t0.BranchesBranchId ASC, t0.DoctorsDoctorId ASC, t0.BranchId ASC), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Doctor>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 02:23:16.675 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:23:16.675 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:23:16.676 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:23:16.677 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:23:16.677 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:23:16.678 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:23:16.686 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:23:16.688 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:23:16.689 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:23:16.689 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:23:16.690 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:23:16.691 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:23:16.692 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:23:16.693 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:23:16.693 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 5ms reading results.
2025-11-24 02:23:16.694 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:23:16.695 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:23:16.699 +02:00 [DBG] Compiling query expression: 
'DbSet<Branch>()
    .Where(b => __ids_0
        .Contains(b.BranchId))'
2025-11-24 02:23:16.716 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Branch>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Branch.Address (string) MaxLength(250), 1], [Property: Branch.BranchName (string) Required MaxLength(150), 2], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 3], [Property: Branch.Description (string), 4], [Property: Branch.Email (string) MaxLength(200), 5], [Property: Branch.ImageURL (string) MaxLength(300), 6], [Property: Branch.Phone (string) MaxLength(25), 7], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 8] }
        SELECT b.BranchId, b.Address, b.BranchName, b.CreatedAt, b.Description, b.Email, b.ImageURL, b.Phone, b.UpdatedAt
        FROM Branches AS b
        WHERE b.BranchId IN (
            SELECT i.value
            FROM OPENJSON(@__ids_0) WITH (value int '') AS i)), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Branch>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 02:23:16.725 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:23:16.727 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:23:16.728 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:23:16.729 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:23:16.734 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (5ms).
2025-11-24 02:23:16.735 +02:00 [DBG] Executing DbCommand [Parameters=[@__ids_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__ids_0) WITH ([value] int '$') AS [i]
)
2025-11-24 02:23:16.739 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__ids_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__ids_0) WITH ([value] int '$') AS [i]
)
2025-11-24 02:23:16.741 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:23:16.741 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:23:16.742 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:23:16.743 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:23:16.752 +02:00 [DBG] An entity of type 'Doctor' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:23:16.756 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:23:16.772 +02:00 [DBG] The unchanged property 'User.FullName' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 02:23:16.776 +02:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:23:16.783 +02:00 [DBG] The unchanged property 'User.PhoneNumber' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 02:23:16.796 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:23:16.804 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 02:23:16.806 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:23:16.807 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:23:16.857 +02:00 [DBG] Executing 2 update commands as a batch.
2025-11-24 02:23:16.859 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:23:16.860 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:23:16.861 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 02:23:16.867 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 02:23:16.870 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:23:16.871 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:23:16.873 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-11-24 02:23:16.874 +02:00 [DBG] Executing DbCommand [Parameters=[@p9='?' (DbType = Int32), @p0='?' (DbType = Boolean), @p1='?' (Size = 4000), @p2='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (Size = 300), @p6='?' (DbType = Int32), @p7='?' (DbType = DateTime2), @p8='?' (Size = 450), @p13='?' (Size = 450), @p14='?' (Size = 4000), @p10='?' (Size = 150), @p11='?' (Size = 4000), @p12='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Doctors] SET [Available] = @p0, [Biography] = @p1, [ConsultationFees] = @p2, [CreatedAt] = @p3, [ExperienceYears] = @p4, [ImageURL] = @p5, [SpecializationId] = @p6, [UpdatedAt] = @p7, [UserId] = @p8
OUTPUT 1
WHERE [DoctorId] = @p9;
UPDATE [Users] SET [FullName] = @p10, [PhoneNumber] = @p11, [UpdatedAt] = @p12
OUTPUT 1
WHERE [Id] = @p13 AND [ConcurrencyStamp] = @p14;
2025-11-24 02:23:16.883 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[@p9='?' (DbType = Int32), @p0='?' (DbType = Boolean), @p1='?' (Size = 4000), @p2='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (Size = 300), @p6='?' (DbType = Int32), @p7='?' (DbType = DateTime2), @p8='?' (Size = 450), @p13='?' (Size = 450), @p14='?' (Size = 4000), @p10='?' (Size = 150), @p11='?' (Size = 4000), @p12='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Doctors] SET [Available] = @p0, [Biography] = @p1, [ConsultationFees] = @p2, [CreatedAt] = @p3, [ExperienceYears] = @p4, [ImageURL] = @p5, [SpecializationId] = @p6, [UpdatedAt] = @p7, [UserId] = @p8
OUTPUT 1
WHERE [DoctorId] = @p9;
UPDATE [Users] SET [FullName] = @p10, [PhoneNumber] = @p11, [UpdatedAt] = @p12
OUTPUT 1
WHERE [Id] = @p13 AND [ConcurrencyStamp] = @p14;
2025-11-24 02:23:16.888 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:23:16.889 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 3ms reading results.
2025-11-24 02:23:16.891 +02:00 [DBG] Committing transaction.
2025-11-24 02:23:16.894 +02:00 [DBG] Committed transaction.
2025-11-24 02:23:16.896 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:23:16.896 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:23:16.899 +02:00 [DBG] Disposing transaction.
2025-11-24 02:23:16.904 +02:00 [DBG] An entity of type 'Doctor' tracked by 'AppDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:23:16.906 +02:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:23:16.908 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 2 entities written to the database.
2025-11-24 02:23:16.909 +02:00 [INF] Personal info updated successfully for doctor ID 2
2025-11-24 02:23:16.909 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:23:16.910 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:23:16.910 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:23:16.912 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:23:16.913 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:23:16.915 +02:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType4`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-11-24 02:23:16.915 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.SelfUpdate (Hospital) in 287.5457ms
2025-11-24 02:23:16.916 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.SelfUpdate (Hospital)'
2025-11-24 02:23:16.917 +02:00 [DBG] Connection id "0HNHATTJOH6T6" completed keep alive response.
2025-11-24 02:23:16.917 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:23:16.917 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:23:16.918 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:23:16.919 +02:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7217/api/Doctor/doctor/self-update - 200 null application/json; charset=utf-8 306.0811ms
2025-11-24 02:23:26.837 +02:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7217/api/Doctor/doctor/self-update - application/json 239
2025-11-24 02:23:26.838 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/doctor/self-update'
2025-11-24 02:23:26.838 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.SelfUpdate (Hospital)' with route pattern 'api/Doctor/doctor/self-update' is valid for the request path '/api/Doctor/doctor/self-update'
2025-11-24 02:23:26.839 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.SelfUpdate (Hospital)'
2025-11-24 02:23:26.840 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:23:26.841 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:23:26.842 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.SelfUpdate (Hospital)'
2025-11-24 02:23:26.843 +02:00 [INF] Route matched with {action = "SelfUpdate", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SelfUpdate(Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 02:23:26.844 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:23:26.844 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:23:26.845 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:23:26.846 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:23:26.846 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:23:26.847 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 02:23:26.849 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 02:23:26.849 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto' ...
2025-11-24 02:23:26.850 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto' using the name '' in request data ...
2025-11-24 02:23:26.851 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:23:26.853 +02:00 [DBG] Connection id "0HNHATTJOH6T6", Request id "0HNHATTJOH6T6:00000008": started reading request body.
2025-11-24 02:23:26.854 +02:00 [DBG] Connection id "0HNHATTJOH6T6", Request id "0HNHATTJOH6T6:00000008": done reading request body.
2025-11-24 02:23:26.856 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto'
2025-11-24 02:23:26.856 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto'.
2025-11-24 02:23:26.857 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto'.
2025-11-24 02:23:26.858 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto' ...
2025-11-24 02:23:26.859 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto'.
2025-11-24 02:23:26.860 +02:00 [INF] SelfUpdate doctor called at "2025-11-24T02:23:26.8604415+02:00"
2025-11-24 02:23:26.860 +02:00 [INF] Updating personal info for doctor ID 2
2025-11-24 02:23:26.861 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:23:26.863 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:23:26.864 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:23:26.865 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:23:26.866 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:23:26.866 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:23:26.867 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:23:26.867 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:23:26.868 +02:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt]
FROM [Specializations] AS [s]
WHERE [s].[SpecializationId] = @__p_0
2025-11-24 02:23:26.871 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt]
FROM [Specializations] AS [s]
WHERE [s].[SpecializationId] = @__p_0
2025-11-24 02:23:26.876 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:23:26.877 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:23:26.877 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 02:23:26.878 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:23:26.878 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:23:26.879 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:23:26.880 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:23:26.881 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:23:26.881 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:23:26.882 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:23:26.882 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:23:26.885 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:23:26.888 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:23:26.888 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:23:26.889 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:23:26.890 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:23:26.891 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:23:26.892 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:23:26.893 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:23:26.894 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 6ms reading results.
2025-11-24 02:23:26.894 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:23:26.895 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:23:26.896 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:23:26.896 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:23:26.897 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:23:26.897 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:23:26.898 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:23:26.898 +02:00 [DBG] Executing DbCommand [Parameters=[@__ids_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__ids_0) WITH ([value] int '$') AS [i]
)
2025-11-24 02:23:26.900 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__ids_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__ids_0) WITH ([value] int '$') AS [i]
)
2025-11-24 02:23:26.902 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:23:26.903 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 02:23:26.904 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:23:26.904 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:23:26.905 +02:00 [DBG] An entity of type 'Doctor' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:23:26.906 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:23:26.906 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:23:26.907 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 02:23:26.907 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:23:26.908 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:23:26.909 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:23:26.909 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:23:26.910 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:23:26.910 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:23:26.911 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:23:26.911 +02:00 [DBG] Executing DbCommand [Parameters=[@p9='?' (DbType = Int32), @p0='?' (DbType = Boolean), @p1='?' (Size = 4000), @p2='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (Size = 300), @p6='?' (DbType = Int32), @p7='?' (DbType = DateTime2), @p8='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Doctors] SET [Available] = @p0, [Biography] = @p1, [ConsultationFees] = @p2, [CreatedAt] = @p3, [ExperienceYears] = @p4, [ImageURL] = @p5, [SpecializationId] = @p6, [UpdatedAt] = @p7, [UserId] = @p8
OUTPUT 1
WHERE [DoctorId] = @p9;
2025-11-24 02:23:26.922 +02:00 [INF] Executed DbCommand (11ms) [Parameters=[@p9='?' (DbType = Int32), @p0='?' (DbType = Boolean), @p1='?' (Size = 4000), @p2='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (Size = 300), @p6='?' (DbType = Int32), @p7='?' (DbType = DateTime2), @p8='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Doctors] SET [Available] = @p0, [Biography] = @p1, [ConsultationFees] = @p2, [CreatedAt] = @p3, [ExperienceYears] = @p4, [ImageURL] = @p5, [SpecializationId] = @p6, [UpdatedAt] = @p7, [UserId] = @p8
OUTPUT 1
WHERE [DoctorId] = @p9;
2025-11-24 02:23:26.923 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:23:26.924 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:23:26.924 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:23:26.925 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:23:26.926 +02:00 [DBG] An entity of type 'Doctor' tracked by 'AppDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:23:26.926 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 02:23:26.927 +02:00 [INF] Personal info updated successfully for doctor ID 2
2025-11-24 02:23:26.927 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:23:26.929 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:23:26.929 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:23:26.929 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:23:26.930 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:23:26.930 +02:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType4`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-11-24 02:23:26.931 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.SelfUpdate (Hospital) in 83.9194ms
2025-11-24 02:23:26.932 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.SelfUpdate (Hospital)'
2025-11-24 02:23:26.933 +02:00 [DBG] Connection id "0HNHATTJOH6T6" completed keep alive response.
2025-11-24 02:23:26.933 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:23:26.934 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:23:26.934 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:23:26.935 +02:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7217/api/Doctor/doctor/self-update - 200 null application/json; charset=utf-8 98.7352ms
2025-11-24 02:24:48.734 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/swagger/index.html - null null
2025-11-24 02:24:48.742 +02:00 [DBG] No candidates found for the request path '/swagger/index.html'
2025-11-24 02:24:48.743 +02:00 [DBG] Request did not match any endpoints
2025-11-24 02:24:48.744 +02:00 [DBG] Response markup is scheduled to include Browser Link script injection.
2025-11-24 02:24:48.744 +02:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2025-11-24 02:24:48.748 +02:00 [DBG] Response markup was updated to include Browser Link script injection.
2025-11-24 02:24:48.748 +02:00 [DBG] Response markup was updated to include browser refresh script injection.
2025-11-24 02:24:48.749 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/swagger/index.html - 200 null text/html;charset=utf-8 14.7788ms
2025-11-24 02:24:48.767 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/_framework/aspnetcore-browser-refresh.js - null null
2025-11-24 02:24:48.769 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/_vs/browserLink - null null
2025-11-24 02:24:48.770 +02:00 [DBG] Script injected: /_framework/aspnetcore-browser-refresh.js
2025-11-24 02:24:48.772 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/_framework/aspnetcore-browser-refresh.js - 200 16501 application/javascript; charset=utf-8 4.831ms
2025-11-24 02:24:48.784 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/_vs/browserLink - 200 null text/javascript; charset=UTF-8 15.186ms
2025-11-24 02:24:48.840 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/swagger/v1/swagger.json - null null
2025-11-24 02:24:48.842 +02:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2025-11-24 02:24:48.843 +02:00 [DBG] Request did not match any endpoints
2025-11-24 02:24:48.879 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 38.4201ms
2025-11-24 02:24:59.736 +02:00 [DBG] Connection id "0HNHATTJOH6T7" accepted.
2025-11-24 02:24:59.736 +02:00 [DBG] Connection id "0HNHATTJOH6T7" received FIN.
2025-11-24 02:24:59.737 +02:00 [DBG] Connection id "0HNHATTJOH6T7" started.
2025-11-24 02:24:59.745 +02:00 [DBG] Connection id "0HNHATTJOH6T8" accepted.
2025-11-24 02:24:59.746 +02:00 [DBG] Connection id "0HNHATTJOH6T8" started.
2025-11-24 02:24:59.746 +02:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-11-24 02:24:59.748 +02:00 [DBG] Connection id "0HNHATTJOH6T7" stopped.
2025-11-24 02:24:59.749 +02:00 [DBG] Connection id "0HNHATTJOH6T7" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-11-24 02:24:59.751 +02:00 [DBG] Connection 0HNHATTJOH6T8 established using the following protocol: "Tls12"
2025-11-24 02:24:59.752 +02:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7217/api/Doctor/doctor/self-update - application/json 189
2025-11-24 02:24:59.754 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/doctor/self-update'
2025-11-24 02:24:59.754 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.SelfUpdate (Hospital)' with route pattern 'api/Doctor/doctor/self-update' is valid for the request path '/api/Doctor/doctor/self-update'
2025-11-24 02:24:59.755 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.SelfUpdate (Hospital)'
2025-11-24 02:24:59.756 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:24:59.757 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:24:59.758 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.SelfUpdate (Hospital)'
2025-11-24 02:24:59.761 +02:00 [INF] Route matched with {action = "SelfUpdate", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SelfUpdate(Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 02:24:59.762 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:24:59.763 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:24:59.764 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:24:59.764 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:24:59.765 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:24:59.766 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 02:24:59.766 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 02:24:59.767 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto' ...
2025-11-24 02:24:59.767 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto' using the name '' in request data ...
2025-11-24 02:24:59.768 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:24:59.770 +02:00 [DBG] Connection id "0HNHATTJOH6T8", Request id "0HNHATTJOH6T8:00000001": started reading request body.
2025-11-24 02:24:59.770 +02:00 [DBG] Connection id "0HNHATTJOH6T8", Request id "0HNHATTJOH6T8:00000001": done reading request body.
2025-11-24 02:24:59.772 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto'
2025-11-24 02:24:59.772 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto'.
2025-11-24 02:24:59.773 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto'.
2025-11-24 02:24:59.773 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto' ...
2025-11-24 02:32:02.700 +02:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-11-24 02:32:02.794 +02:00 [DBG] Hosting starting
2025-11-24 02:32:02.813 +02:00 [INF] User profile is available. Using 'C:\Users\E-Mad\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-24 02:32:02.821 +02:00 [DBG] Reading data from file 'C:\Users\E-Mad\AppData\Local\ASP.NET\DataProtection-Keys\key-b85f0939-0825-4b2b-b21a-67409aec9db0.xml'.
2025-11-24 02:32:02.828 +02:00 [DBG] Found key {b85f0939-0825-4b2b-b21a-67409aec9db0}.
2025-11-24 02:32:02.835 +02:00 [DBG] Considering key {b85f0939-0825-4b2b-b21a-67409aec9db0} with expiration date 2026-02-09 12:52:20Z as default key.
2025-11-24 02:32:02.838 +02:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-11-24 02:32:02.840 +02:00 [DBG] Decrypting secret element using Windows DPAPI.
2025-11-24 02:32:02.841 +02:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-11-24 02:32:02.845 +02:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-11-24 02:32:02.846 +02:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-11-24 02:32:02.847 +02:00 [DBG] Using key {b85f0939-0825-4b2b-b21a-67409aec9db0} as the default key.
2025-11-24 02:32:02.848 +02:00 [DBG] Key ring with default key {b85f0939-0825-4b2b-b21a-67409aec9db0} was loaded during application startup.
2025-11-24 02:32:02.853 +02:00 [DBG] Middleware loaded
2025-11-24 02:32:02.855 +02:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16501 B).
2025-11-24 02:32:02.857 +02:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-11-24 02:32:02.914 +02:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-11-24 02:32:02.973 +02:00 [INF] Now listening on: https://localhost:7217
2025-11-24 02:32:02.974 +02:00 [INF] Now listening on: http://localhost:5163
2025-11-24 02:32:02.974 +02:00 [DBG] Loaded hosting startup assembly Hospital
2025-11-24 02:32:02.975 +02:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-11-24 02:32:02.975 +02:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-11-24 02:32:02.976 +02:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-11-24 02:32:03.034 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-24 02:32:03.035 +02:00 [INF] Hosting environment: Development
2025-11-24 02:32:03.036 +02:00 [INF] Content root path: D:\Walaa\GP\Hospital\Hospital
2025-11-24 02:32:03.036 +02:00 [DBG] Hosting started
2025-11-24 02:32:03.279 +02:00 [DBG] Connection id "0HNHAU3HQ5A67" accepted.
2025-11-24 02:32:03.279 +02:00 [DBG] Connection id "0HNHAU3HQ5A66" accepted.
2025-11-24 02:32:03.281 +02:00 [DBG] Connection id "0HNHAU3HQ5A67" started.
2025-11-24 02:32:03.281 +02:00 [DBG] Connection id "0HNHAU3HQ5A66" started.
2025-11-24 02:32:03.292 +02:00 [DBG] Connection id "0HNHAU3HQ5A66" received FIN.
2025-11-24 02:32:03.292 +02:00 [DBG] Connection id "0HNHAU3HQ5A67" received FIN.
2025-11-24 02:32:03.300 +02:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-11-24 02:32:03.301 +02:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-11-24 02:32:03.324 +02:00 [DBG] Connection id "0HNHAU3HQ5A66" stopped.
2025-11-24 02:32:03.324 +02:00 [DBG] Connection id "0HNHAU3HQ5A67" stopped.
2025-11-24 02:32:03.327 +02:00 [DBG] Connection id "0HNHAU3HQ5A67" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-11-24 02:32:03.327 +02:00 [DBG] Connection id "0HNHAU3HQ5A66" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-11-24 02:32:03.408 +02:00 [DBG] Connection id "0HNHAU3HQ5A68" accepted.
2025-11-24 02:32:03.409 +02:00 [DBG] Connection id "0HNHAU3HQ5A68" started.
2025-11-24 02:32:03.443 +02:00 [DBG] Connection 0HNHAU3HQ5A68 established using the following protocol: "Tls12"
2025-11-24 02:32:03.494 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/swagger/index.html - null null
2025-11-24 02:32:03.565 +02:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-11-24 02:32:03.590 +02:00 [DBG] No candidates found for the request path '/swagger/index.html'
2025-11-24 02:32:03.591 +02:00 [DBG] Request did not match any endpoints
2025-11-24 02:32:03.631 +02:00 [DBG] Response markup is scheduled to include Browser Link script injection.
2025-11-24 02:32:03.633 +02:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2025-11-24 02:32:03.645 +02:00 [DBG] Response markup was updated to include Browser Link script injection.
2025-11-24 02:32:03.646 +02:00 [DBG] Response markup was updated to include browser refresh script injection.
2025-11-24 02:32:03.651 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/swagger/index.html - 200 null text/html;charset=utf-8 164.7001ms
2025-11-24 02:32:03.661 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/_framework/aspnetcore-browser-refresh.js - null null
2025-11-24 02:32:03.661 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/_vs/browserLink - null null
2025-11-24 02:32:03.666 +02:00 [DBG] Script injected: /_framework/aspnetcore-browser-refresh.js
2025-11-24 02:32:03.667 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/_framework/aspnetcore-browser-refresh.js - 200 16501 application/javascript; charset=utf-8 6.2729ms
2025-11-24 02:32:03.693 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/_vs/browserLink - 200 null text/javascript; charset=UTF-8 31.7116ms
2025-11-24 02:32:03.733 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/swagger/v1/swagger.json - null null
2025-11-24 02:32:03.734 +02:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2025-11-24 02:32:03.735 +02:00 [DBG] Request did not match any endpoints
2025-11-24 02:32:03.768 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 35.511ms
2025-11-24 02:32:11.943 +02:00 [DBG] Connection id "0HNHAU3HQ5A69" received FIN.
2025-11-24 02:32:11.943 +02:00 [DBG] Connection id "0HNHAU3HQ5A69" accepted.
2025-11-24 02:32:11.945 +02:00 [DBG] Connection id "0HNHAU3HQ5A69" started.
2025-11-24 02:32:11.945 +02:00 [DBG] Connection id "0HNHAU3HQ5A6A" accepted.
2025-11-24 02:32:11.946 +02:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-11-24 02:32:11.947 +02:00 [DBG] Connection id "0HNHAU3HQ5A6A" started.
2025-11-24 02:32:11.950 +02:00 [DBG] Connection id "0HNHAU3HQ5A69" stopped.
2025-11-24 02:32:11.951 +02:00 [DBG] Connection id "0HNHAU3HQ5A69" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-11-24 02:32:11.955 +02:00 [DBG] Connection 0HNHAU3HQ5A6A established using the following protocol: "Tls12"
2025-11-24 02:32:11.958 +02:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7217/api/Doctor/doctor/self-update - application/json 189
2025-11-24 02:32:11.961 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/doctor/self-update'
2025-11-24 02:32:11.965 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.SelfUpdate (Hospital)' with route pattern 'api/Doctor/doctor/self-update' is valid for the request path '/api/Doctor/doctor/self-update'
2025-11-24 02:32:11.966 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.SelfUpdate (Hospital)'
2025-11-24 02:32:11.968 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:32:11.993 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:32:11.994 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.SelfUpdate (Hospital)'
2025-11-24 02:32:12.017 +02:00 [INF] Route matched with {action = "SelfUpdate", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SelfUpdate(Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 02:32:12.020 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:32:12.021 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:32:12.022 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:32:12.023 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:32:12.024 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:32:12.026 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 02:32:12.284 +02:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-11-24 02:32:12.308 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 02:32:12.321 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto' ...
2025-11-24 02:32:12.323 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto' using the name '' in request data ...
2025-11-24 02:32:12.325 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:32:12.335 +02:00 [DBG] Connection id "0HNHAU3HQ5A6A", Request id "0HNHAU3HQ5A6A:00000001": started reading request body.
2025-11-24 02:32:12.336 +02:00 [DBG] Connection id "0HNHAU3HQ5A6A", Request id "0HNHAU3HQ5A6A:00000001": done reading request body.
2025-11-24 02:32:12.350 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto'
2025-11-24 02:32:12.353 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto'.
2025-11-24 02:32:12.354 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto'.
2025-11-24 02:32:12.355 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto' ...
2025-11-24 02:32:12.361 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto'.
2025-11-24 02:32:12.363 +02:00 [INF] SelfUpdate doctor called at "2025-11-24T02:32:12.3637196+02:00"
2025-11-24 02:32:12.366 +02:00 [INF] Updating personal info for doctor ID 2
2025-11-24 02:32:12.833 +02:00 [DBG] The index {'BranchesBranchId'} was not created on entity type 'BranchDoctor (Dictionary<string, object>)' as the properties are already covered by the index {'BranchesBranchId', 'DoctorsDoctorId'}.
2025-11-24 02:32:12.834 +02:00 [DBG] The index {'BranchId'} was not created on entity type 'BranchService (Dictionary<string, object>)' as the properties are already covered by the index {'BranchId', 'ServiceId'}.
2025-11-24 02:32:12.834 +02:00 [DBG] The index {'BranchId'} was not created on entity type 'BranchSpecialization (Dictionary<string, object>)' as the properties are already covered by the index {'BranchId', 'SpecializationId'}.
2025-11-24 02:32:12.835 +02:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserRole<string>' as the properties are already covered by the index {'UserId', 'RoleId'}.
2025-11-24 02:32:12.837 +02:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserToken<string>' as the properties are already covered by the index {'UserId', 'LoginProvider', 'Name'}.
2025-11-24 02:32:12.938 +02:00 [DBG] The property 'BranchDoctor (Dictionary<string, object>).BranchesBranchId' was created in shadow state because there are no eligible CLR members with a matching name.
2025-11-24 02:32:12.939 +02:00 [DBG] The property 'BranchDoctor (Dictionary<string, object>).DoctorsDoctorId' was created in shadow state because there are no eligible CLR members with a matching name.
2025-11-24 02:32:13.101 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:32:13.170 +02:00 [DBG] Compiling query expression: 
'DbSet<Doctor>()
    .Include(d => d.User)
    .Include(d => d.Specialization)
    .Include(d => d.Branches)
    .Include(d => d.Schedules)
    .FirstOrDefault(d => d.DoctorId == __doctorId_0)'
2025-11-24 02:32:13.225 +02:00 [DBG] Including navigation: 'Doctor.User'.
2025-11-24 02:32:13.226 +02:00 [DBG] Including navigation: 'Doctor.Specialization'.
2025-11-24 02:32:13.229 +02:00 [DBG] Including navigation: 'Doctor.Branches'.
2025-11-24 02:32:13.231 +02:00 [DBG] Including navigation: 'Doctor.Schedules'.
2025-11-24 02:32:13.436 +02:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-11-24 02:32:13.453 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Doctor>(
    asyncEnumerable: new SingleQueryingEnumerable<Doctor>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Doctor.DoctorId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Doctor.Available (bool?), 1], [Property: Doctor.Biography (string), 2], [Property: Doctor.ConsultationFees (decimal) Required, 3], [Property: Doctor.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: Doctor.ExperienceYears (int?), 5], [Property: Doctor.ImageURL (string) MaxLength(300), 6], [Property: Doctor.SpecializationId (int) Required FK Index, 7], [Property: Doctor.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 8], [Property: Doctor.UserId (string) Required FK Index, 9] }
                1 -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 10], [Property: User.AccessFailedCount (int) Required, 11], [Property: User.ConcurrencyStamp (string) Concurrency, 12], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 13], [Property: User.DateOfBirth (DateOnly?), 14], [Property: User.Email (string) Index MaxLength(256), 15], [Property: User.EmailConfirmed (bool) Required, 16], [Property: User.FullName (string) Required MaxLength(150), 17], [Property: User.Gender (GenderType?) MaxLength(10), 18], [Property: User.LockoutEnabled (bool) Required, 19], [Property: User.LockoutEnd (DateTimeOffset?), 20], [Property: User.NormalizedEmail (string) Index MaxLength(256), 21], [Property: User.NormalizedUserName (string) Index MaxLength(256), 22], [Property: User.PasswordHash (string), 23], [Property: User.PhoneNumber (string), 24], [Property: User.PhoneNumberConfirmed (bool) Required, 25], [Property: User.RefreshToken (string), 26], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 27], [Property: User.Role (string) Required MaxLength(50), 28], [Property: User.SecurityStamp (string), 29], [Property: User.TwoFactorEnabled (bool) Required, 30], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 31], [Property: User.UserName (string) MaxLength(256), 32] }
                2 -> Dictionary<IProperty, int> { [Property: Specialization.SpecializationId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 33], [Property: Specialization.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 34], [Property: Specialization.Description (string), 35], [Property: Specialization.Name (string) Required MaxLength(120), 36], [Property: Specialization.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 37] }
                3 -> 0
                4 -> 10
                5 -> 33
                6 -> Dictionary<IProperty, int> { [Property: BranchDoctor (Dictionary<string, object>).BranchesBranchId (no field, int) Indexer Required PK FK AfterSave:Throw, 38], [Property: BranchDoctor (Dictionary<string, object>).DoctorsDoctorId (no field, int) Indexer Required PK FK Index AfterSave:Throw, 39] }
                7 -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 40], [Property: Branch.Address (string) MaxLength(250), 41], [Property: Branch.BranchName (string) Required MaxLength(150), 42], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 43], [Property: Branch.Description (string), 44], [Property: Branch.Email (string) MaxLength(200), 45], [Property: Branch.ImageURL (string) MaxLength(300), 46], [Property: Branch.Phone (string) MaxLength(25), 47], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 48] }
                8 -> 38
                9 -> 39
                10 -> 40
                11 -> Dictionary<IProperty, int> { [Property: Schedule.ScheduleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 49], [Property: Schedule.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 50], [Property: Schedule.DayOfWeek (string) Required MaxLength(20), 51], [Property: Schedule.DoctorId (int) Required FK Index, 52], [Property: Schedule.EndTime (DateTime) Required, 53], [Property: Schedule.Shift (AppointmentShift) Required, 54], [Property: Schedule.StartTime (DateTime) Required, 55], [Property: Schedule.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 56] }
                12 -> 49
            SELECT t.DoctorId, t.Available, t.Biography, t.ConsultationFees, t.CreatedAt, t.ExperienceYears, t.ImageURL, t.SpecializationId, t.UpdatedAt, t.UserId, t.Id, t.AccessFailedCount, t.ConcurrencyStamp, t.CreatedAt0, t.DateOfBirth, t.Email, t.EmailConfirmed, t.FullName, t.Gender, t.LockoutEnabled, t.LockoutEnd, t.NormalizedEmail, t.NormalizedUserName, t.PasswordHash, t.PhoneNumber, t.PhoneNumberConfirmed, t.RefreshToken, t.RefreshTokenExpiryTime, t.Role, t.SecurityStamp, t.TwoFactorEnabled, t.UpdatedAt0, t.UserName, t.SpecializationId0, t.CreatedAt1, t.Description, t.Name, t.UpdatedAt1, t0.BranchesBranchId, t0.DoctorsDoctorId, t0.BranchId, t0.Address, t0.BranchName, t0.CreatedAt, t0.Description, t0.Email, t0.ImageURL, t0.Phone, t0.UpdatedAt, s0.ScheduleId, s0.CreatedAt, s0.DayOfWeek, s0.DoctorId, s0.EndTime, s0.Shift, s0.StartTime, s0.UpdatedAt
            FROM 
            (
                SELECT TOP(1) d.DoctorId, d.Available, d.Biography, d.ConsultationFees, d.CreatedAt, d.ExperienceYears, d.ImageURL, d.SpecializationId, d.UpdatedAt, d.UserId, u.Id, u.AccessFailedCount, u.ConcurrencyStamp, u.CreatedAt AS CreatedAt0, u.DateOfBirth, u.Email, u.EmailConfirmed, u.FullName, u.Gender, u.LockoutEnabled, u.LockoutEnd, u.NormalizedEmail, u.NormalizedUserName, u.PasswordHash, u.PhoneNumber, u.PhoneNumberConfirmed, u.RefreshToken, u.RefreshTokenExpiryTime, u.Role, u.SecurityStamp, u.TwoFactorEnabled, u.UpdatedAt AS UpdatedAt0, u.UserName, s.SpecializationId AS SpecializationId0, s.CreatedAt AS CreatedAt1, s.Description, s.Name, s.UpdatedAt AS UpdatedAt1
                FROM Doctors AS d
                INNER JOIN Users AS u ON d.UserId == u.Id
                INNER JOIN Specializations AS s ON d.SpecializationId == s.SpecializationId
                WHERE d.DoctorId == @__doctorId_0
            ) AS t
            LEFT JOIN 
            (
                SELECT d0.BranchesBranchId, d0.DoctorsDoctorId, b.BranchId, b.Address, b.BranchName, b.CreatedAt, b.Description, b.Email, b.ImageURL, b.Phone, b.UpdatedAt
                FROM DoctorBranches AS d0
                INNER JOIN Branches AS b ON d0.BranchesBranchId == b.BranchId
            ) AS t0 ON t.DoctorId == t0.DoctorsDoctorId
            LEFT JOIN Schedules AS s0 ON t.DoctorId == s0.DoctorId
            ORDER BY t.DoctorId ASC, t.Id ASC, t.SpecializationId0 ASC, t0.BranchesBranchId ASC, t0.DoctorsDoctorId ASC, t0.BranchId ASC), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Doctor>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 02:32:13.491 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:32:13.506 +02:00 [DBG] Created DbConnection. (11ms).
2025-11-24 02:32:13.509 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:32:13.674 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:32:13.678 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:32:13.682 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-11-24 02:32:13.689 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (10ms).
2025-11-24 02:32:13.696 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:32:13.754 +02:00 [INF] Executed DbCommand (57ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:32:13.790 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:32:13.837 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:32:13.839 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:32:13.871 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:32:13.875 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:32:13.890 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:32:13.902 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:32:13.917 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:32:13.928 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:32:13.933 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 172ms reading results.
2025-11-24 02:32:13.936 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:32:13.942 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (5ms).
2025-11-24 02:32:13.956 +02:00 [DBG] An entity of type 'Doctor' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:32:13.960 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:32:13.994 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:32:14.002 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 02:32:14.004 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:32:14.006 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:32:14.077 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:32:14.079 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:32:14.083 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:32:14.084 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:32:14.088 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2025-11-24 02:32:14.089 +02:00 [DBG] Executing DbCommand [Parameters=[@p9='?' (DbType = Int32), @p0='?' (DbType = Boolean), @p1='?' (Size = 4000), @p2='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (Size = 300), @p6='?' (DbType = Int32), @p7='?' (DbType = DateTime2), @p8='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Doctors] SET [Available] = @p0, [Biography] = @p1, [ConsultationFees] = @p2, [CreatedAt] = @p3, [ExperienceYears] = @p4, [ImageURL] = @p5, [SpecializationId] = @p6, [UpdatedAt] = @p7, [UserId] = @p8
OUTPUT 1
WHERE [DoctorId] = @p9;
2025-11-24 02:32:14.104 +02:00 [INF] Executed DbCommand (15ms) [Parameters=[@p9='?' (DbType = Int32), @p0='?' (DbType = Boolean), @p1='?' (Size = 4000), @p2='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (Size = 300), @p6='?' (DbType = Int32), @p7='?' (DbType = DateTime2), @p8='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Doctors] SET [Available] = @p0, [Biography] = @p1, [ConsultationFees] = @p2, [CreatedAt] = @p3, [ExperienceYears] = @p4, [ImageURL] = @p5, [SpecializationId] = @p6, [UpdatedAt] = @p7, [UserId] = @p8
OUTPUT 1
WHERE [DoctorId] = @p9;
2025-11-24 02:32:14.110 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:32:14.111 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 5ms reading results.
2025-11-24 02:32:14.113 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:32:14.114 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:32:14.120 +02:00 [DBG] An entity of type 'Doctor' tracked by 'AppDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:32:14.124 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 02:32:14.126 +02:00 [INF] Personal info updated successfully for doctor ID 2
2025-11-24 02:32:14.130 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:32:14.133 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:32:14.134 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:32:14.135 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:32:14.137 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:32:14.138 +02:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType4`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-11-24 02:32:14.149 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.SelfUpdate (Hospital) in 2121.6425ms
2025-11-24 02:32:14.150 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.SelfUpdate (Hospital)'
2025-11-24 02:32:14.153 +02:00 [DBG] Connection id "0HNHAU3HQ5A6A" completed keep alive response.
2025-11-24 02:32:14.157 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:32:14.160 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:32:14.162 +02:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-11-24 02:32:14.163 +02:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7217/api/Doctor/doctor/self-update - 200 null application/json; charset=utf-8 2205.4125ms
2025-11-24 02:32:48.611 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Doctor/add-from-excel - multipart/form-data; boundary=--------------------------312230609236841306078471 9737
2025-11-24 02:32:48.622 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/add-from-excel'
2025-11-24 02:32:48.623 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.AddDoctorsFromExcel (Hospital)' with route pattern 'api/Doctor/add-from-excel' is valid for the request path '/api/Doctor/add-from-excel'
2025-11-24 02:32:48.624 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.AddDoctorsFromExcel (Hospital)'
2025-11-24 02:32:48.625 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:32:48.627 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:32:48.628 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.AddDoctorsFromExcel (Hospital)'
2025-11-24 02:32:48.637 +02:00 [INF] Route matched with {action = "AddDoctorsFromExcel", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddDoctorsFromExcel(Microsoft.AspNetCore.Http.IFormFile) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 02:32:48.640 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:32:48.641 +02:00 [DBG] Execution plan of resource filters (in the following order): ["Microsoft.AspNetCore.Mvc.ConsumesAttribute"]
2025-11-24 02:32:48.643 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:32:48.644 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:32:48.645 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:32:48.646 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 02:32:48.649 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 02:32:48.653 +02:00 [DBG] Connection id "0HNHAU3HQ5A6A", Request id "0HNHAU3HQ5A6A:00000002": started reading request body.
2025-11-24 02:32:48.658 +02:00 [DBG] Connection id "0HNHAU3HQ5A6A", Request id "0HNHAU3HQ5A6A:00000002": done reading request body.
2025-11-24 02:32:48.659 +02:00 [DBG] Attempting to bind parameter 'file' of type 'Microsoft.AspNetCore.Http.IFormFile' ...
2025-11-24 02:32:48.661 +02:00 [DBG] Attempting to bind parameter 'file' of type 'Microsoft.AspNetCore.Http.IFormFile' using the name 'file' in request data ...
2025-11-24 02:32:48.664 +02:00 [DBG] Done attempting to bind parameter 'file' of type 'Microsoft.AspNetCore.Http.IFormFile'.
2025-11-24 02:32:48.664 +02:00 [DBG] Done attempting to bind parameter 'file' of type 'Microsoft.AspNetCore.Http.IFormFile'.
2025-11-24 02:32:48.665 +02:00 [DBG] Attempting to validate the bound parameter 'file' of type 'Microsoft.AspNetCore.Http.IFormFile' ...
2025-11-24 02:32:48.667 +02:00 [DBG] Done attempting to validate the bound parameter 'file' of type 'Microsoft.AspNetCore.Http.IFormFile'.
2025-11-24 02:32:48.679 +02:00 [INF] add doctor using excel called at "2025-11-24T02:32:48.6792093+02:00"
2025-11-24 02:32:49.363 +02:00 [INF] Adding new doctor: Dr Ahmed Ali, Email: walaa.elbishlawy@gmail.com
2025-11-24 02:32:49.402 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:32:49.409 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:32:49.410 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:32:49.411 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:32:49.412 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:32:49.414 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 02:32:49.419 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 02:32:49.430 +02:00 [DBG] Compiling query expression: 
'DbSet<Specialization>()
    .FirstOrDefault(e => EF.Property<int>(e, "SpecializationId") == __p_0)'
2025-11-24 02:32:49.436 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Specialization>(
    asyncEnumerable: new SingleQueryingEnumerable<Specialization>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Specialization.SpecializationId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Specialization.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: Specialization.Description (string), 2], [Property: Specialization.Name (string) Required MaxLength(120), 3], [Property: Specialization.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 4] }
            SELECT TOP(1) s.SpecializationId, s.CreatedAt, s.Description, s.Name, s.UpdatedAt
            FROM Specializations AS s
            WHERE s.SpecializationId == @__p_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Specialization>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 02:32:49.438 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:32:49.438 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:32:49.439 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:32:49.440 +02:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt]
FROM [Specializations] AS [s]
WHERE [s].[SpecializationId] = @__p_0
2025-11-24 02:32:49.444 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt]
FROM [Specializations] AS [s]
WHERE [s].[SpecializationId] = @__p_0
2025-11-24 02:32:49.447 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:32:49.447 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:32:49.448 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 02:32:49.453 +02:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(u => u.NormalizedEmail == __normalizedEmail_0)'
2025-11-24 02:32:49.458 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: new SingleQueryingEnumerable<User>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 0], [Property: User.AccessFailedCount (int) Required, 1], [Property: User.ConcurrencyStamp (string) Concurrency, 2], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 3], [Property: User.DateOfBirth (DateOnly?), 4], [Property: User.Email (string) Index MaxLength(256), 5], [Property: User.EmailConfirmed (bool) Required, 6], [Property: User.FullName (string) Required MaxLength(150), 7], [Property: User.Gender (GenderType?) MaxLength(10), 8], [Property: User.LockoutEnabled (bool) Required, 9], [Property: User.LockoutEnd (DateTimeOffset?), 10], [Property: User.NormalizedEmail (string) Index MaxLength(256), 11], [Property: User.NormalizedUserName (string) Index MaxLength(256), 12], [Property: User.PasswordHash (string), 13], [Property: User.PhoneNumber (string), 14], [Property: User.PhoneNumberConfirmed (bool) Required, 15], [Property: User.RefreshToken (string), 16], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 17], [Property: User.Role (string) Required MaxLength(50), 18], [Property: User.SecurityStamp (string), 19], [Property: User.TwoFactorEnabled (bool) Required, 20], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 21], [Property: User.UserName (string) MaxLength(256), 22] }
            SELECT TOP(2) u.Id, u.AccessFailedCount, u.ConcurrencyStamp, u.CreatedAt, u.DateOfBirth, u.Email, u.EmailConfirmed, u.FullName, u.Gender, u.LockoutEnabled, u.LockoutEnd, u.NormalizedEmail, u.NormalizedUserName, u.PasswordHash, u.PhoneNumber, u.PhoneNumberConfirmed, u.RefreshToken, u.RefreshTokenExpiryTime, u.Role, u.SecurityStamp, u.TwoFactorEnabled, u.UpdatedAt, u.UserName
            FROM Users AS u
            WHERE u.NormalizedEmail == @__normalizedEmail_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 02:32:49.465 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:32:49.465 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:32:49.466 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:32:49.467 +02:00 [DBG] Executing DbCommand [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedEmail] = @__normalizedEmail_0
2025-11-24 02:32:49.472 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedEmail] = @__normalizedEmail_0
2025-11-24 02:32:49.474 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:32:49.475 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:32:49.475 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 02:32:49.477 +02:00 [ERR] Failed to register user for doctor Dr Ahmed Ali: Email already exists!
2025-11-24 02:32:49.512 +02:00 [DBG] Rolling back transaction.
2025-11-24 02:32:49.515 +02:00 [DBG] Rolled back transaction.
2025-11-24 02:32:49.517 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:32:49.518 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:32:49.519 +02:00 [ERR] Transaction rolled back while adding doctor Dr Ahmed Ali
2025-11-24 02:32:49.538 +02:00 [DBG] Disposing transaction.
2025-11-24 02:32:49.560 +02:00 [INF] Adding new doctor: Dr Sara Nabil, Email: sara@example.com
2025-11-24 02:32:49.562 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:32:49.563 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:32:49.563 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 02:32:49.565 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 02:32:49.569 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:32:49.569 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:32:49.570 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:32:49.571 +02:00 [DBG] Executing DbCommand [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedEmail] = @__normalizedEmail_0
2025-11-24 02:32:49.574 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedEmail] = @__normalizedEmail_0
2025-11-24 02:32:49.575 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:32:49.576 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:32:49.578 +02:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(u => u.NormalizedUserName == __normalizedUserName_0)'
2025-11-24 02:32:49.582 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: new SingleQueryingEnumerable<User>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 0], [Property: User.AccessFailedCount (int) Required, 1], [Property: User.ConcurrencyStamp (string) Concurrency, 2], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 3], [Property: User.DateOfBirth (DateOnly?), 4], [Property: User.Email (string) Index MaxLength(256), 5], [Property: User.EmailConfirmed (bool) Required, 6], [Property: User.FullName (string) Required MaxLength(150), 7], [Property: User.Gender (GenderType?) MaxLength(10), 8], [Property: User.LockoutEnabled (bool) Required, 9], [Property: User.LockoutEnd (DateTimeOffset?), 10], [Property: User.NormalizedEmail (string) Index MaxLength(256), 11], [Property: User.NormalizedUserName (string) Index MaxLength(256), 12], [Property: User.PasswordHash (string), 13], [Property: User.PhoneNumber (string), 14], [Property: User.PhoneNumberConfirmed (bool) Required, 15], [Property: User.RefreshToken (string), 16], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 17], [Property: User.Role (string) Required MaxLength(50), 18], [Property: User.SecurityStamp (string), 19], [Property: User.TwoFactorEnabled (bool) Required, 20], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 21], [Property: User.UserName (string) MaxLength(256), 22] }
            SELECT TOP(1) u.Id, u.AccessFailedCount, u.ConcurrencyStamp, u.CreatedAt, u.DateOfBirth, u.Email, u.EmailConfirmed, u.FullName, u.Gender, u.LockoutEnabled, u.LockoutEnd, u.NormalizedEmail, u.NormalizedUserName, u.PasswordHash, u.PhoneNumber, u.PhoneNumberConfirmed, u.RefreshToken, u.RefreshTokenExpiryTime, u.Role, u.SecurityStamp, u.TwoFactorEnabled, u.UpdatedAt, u.UserName
            FROM Users AS u
            WHERE u.NormalizedUserName == @__normalizedUserName_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 02:32:49.585 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:32:49.585 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:32:49.586 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:32:49.586 +02:00 [DBG] Executing DbCommand [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0
2025-11-24 02:32:49.590 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0
2025-11-24 02:32:49.592 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:32:49.592 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:32:49.597 +02:00 [DBG] Compiling query expression: 
'DbSet<IdentityRole>()
    .FirstOrDefault(r => r.NormalizedName == __normalizedName_0)'
2025-11-24 02:32:49.602 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<IdentityRole>(
    asyncEnumerable: new SingleQueryingEnumerable<IdentityRole>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: IdentityRole.Id (string) Required PK AfterSave:Throw, 0], [Property: IdentityRole.ConcurrencyStamp (string) Concurrency, 1], [Property: IdentityRole.Name (string) MaxLength(256), 2], [Property: IdentityRole.NormalizedName (string) Index MaxLength(256), 3] }
            SELECT TOP(1) a.Id, a.ConcurrencyStamp, a.Name, a.NormalizedName
            FROM AspNetRoles AS a
            WHERE a.NormalizedName == @__normalizedName_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, IdentityRole>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 02:32:49.604 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:32:49.605 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:32:49.605 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:32:49.606 +02:00 [DBG] Executing DbCommand [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-11-24 02:32:49.613 +02:00 [INF] Executed DbCommand (8ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-11-24 02:32:49.617 +02:00 [DBG] Context 'AppDbContext' started tracking 'IdentityRole' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:32:49.622 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:32:49.623 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 8ms reading results.
2025-11-24 02:32:49.698 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:32:49.699 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:32:49.701 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-11-24 02:32:49.703 +02:00 [DBG] Executing DbCommand [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0
2025-11-24 02:32:49.706 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0
2025-11-24 02:32:49.708 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:32:49.709 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:32:49.718 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:32:49.720 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:32:49.722 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:32:49.723 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 02:32:49.724 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:32:49.724 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:32:49.730 +02:00 [DBG] Creating transaction savepoint.
2025-11-24 02:32:49.740 +02:00 [DBG] Created transaction savepoint.
2025-11-24 02:32:49.741 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:32:49.742 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:32:49.745 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-11-24 02:32:49.746 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (Size = 450), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (DbType = DateTime2), @p5='?' (Size = 256), @p6='?' (DbType = Boolean), @p7='?' (Size = 150), @p8='?' (Size = 10), @p9='?' (DbType = Boolean), @p10='?' (DbType = DateTimeOffset), @p11='?' (Size = 256), @p12='?' (Size = 256), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Boolean), @p16='?' (Size = 4000), @p17='?' (DbType = DateTime2), @p18='?' (Size = 50), @p19='?' (Size = 4000), @p20='?' (DbType = Boolean), @p21='?' (DbType = DateTime2), @p22='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([Id], [AccessFailedCount], [ConcurrencyStamp], [CreatedAt], [DateOfBirth], [Email], [EmailConfirmed], [FullName], [Gender], [LockoutEnabled], [LockoutEnd], [NormalizedEmail], [NormalizedUserName], [PasswordHash], [PhoneNumber], [PhoneNumberConfirmed], [RefreshToken], [RefreshTokenExpiryTime], [Role], [SecurityStamp], [TwoFactorEnabled], [UpdatedAt], [UserName])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22);
2025-11-24 02:32:49.751 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Size = 450), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (DbType = DateTime2), @p5='?' (Size = 256), @p6='?' (DbType = Boolean), @p7='?' (Size = 150), @p8='?' (Size = 10), @p9='?' (DbType = Boolean), @p10='?' (DbType = DateTimeOffset), @p11='?' (Size = 256), @p12='?' (Size = 256), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Boolean), @p16='?' (Size = 4000), @p17='?' (DbType = DateTime2), @p18='?' (Size = 50), @p19='?' (Size = 4000), @p20='?' (DbType = Boolean), @p21='?' (DbType = DateTime2), @p22='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([Id], [AccessFailedCount], [ConcurrencyStamp], [CreatedAt], [DateOfBirth], [Email], [EmailConfirmed], [FullName], [Gender], [LockoutEnabled], [LockoutEnd], [NormalizedEmail], [NormalizedUserName], [PasswordHash], [PhoneNumber], [PhoneNumberConfirmed], [RefreshToken], [RefreshTokenExpiryTime], [Role], [SecurityStamp], [TwoFactorEnabled], [UpdatedAt], [UserName])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22);
2025-11-24 02:32:49.755 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:32:49.756 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:32:49.757 +02:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:32:49.757 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 02:32:49.762 +02:00 [DBG] Compiling query expression: 
'DbSet<IdentityRole>()
    .SingleOrDefault(r => r.NormalizedName == __normalizedRoleName_0)'
2025-11-24 02:32:49.765 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<IdentityRole>(
    asyncEnumerable: new SingleQueryingEnumerable<IdentityRole>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: IdentityRole.Id (string) Required PK AfterSave:Throw, 0], [Property: IdentityRole.ConcurrencyStamp (string) Concurrency, 1], [Property: IdentityRole.Name (string) MaxLength(256), 2], [Property: IdentityRole.NormalizedName (string) Index MaxLength(256), 3] }
            SELECT TOP(2) a.Id, a.ConcurrencyStamp, a.Name, a.NormalizedName
            FROM AspNetRoles AS a
            WHERE a.NormalizedName == @__normalizedRoleName_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, IdentityRole>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 02:32:49.768 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:32:49.769 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:32:49.770 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:32:49.771 +02:00 [DBG] Executing DbCommand [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedRoleName_0
2025-11-24 02:32:49.775 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedRoleName_0
2025-11-24 02:32:49.777 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:32:49.777 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:32:49.780 +02:00 [DBG] Compiling query expression: 
'DbSet<IdentityUserRole<string>>()
    .FirstOrDefault(e => EF.Property<string>(e, "UserId") == __p_0 && EF.Property<string>(e, "RoleId") == __p_1)'
2025-11-24 02:32:49.784 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<IdentityUserRole<string>>(
    asyncEnumerable: new SingleQueryingEnumerable<IdentityUserRole<string>>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: IdentityUserRole<string>.UserId (string) Required PK FK AfterSave:Throw, 0], [Property: IdentityUserRole<string>.RoleId (string) Required PK FK Index AfterSave:Throw, 1] }
            SELECT TOP(1) a.UserId, a.RoleId
            FROM AspNetUserRoles AS a
            WHERE (a.UserId == @__p_0) && (a.RoleId == @__p_1)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, IdentityUserRole<string>>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 02:32:49.790 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:32:49.791 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:32:49.793 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-11-24 02:32:49.794 +02:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (Size = 450), @__p_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[UserId], [a].[RoleId]
FROM [AspNetUserRoles] AS [a]
WHERE [a].[UserId] = @__p_0 AND [a].[RoleId] = @__p_1
2025-11-24 02:32:49.799 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (Size = 450), @__p_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[UserId], [a].[RoleId]
FROM [AspNetUserRoles] AS [a]
WHERE [a].[UserId] = @__p_0 AND [a].[RoleId] = @__p_1
2025-11-24 02:32:49.800 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:32:49.801 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:32:49.804 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:32:49.805 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:32:49.806 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:32:49.807 +02:00 [DBG] Executing DbCommand [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedRoleName_0
2025-11-24 02:32:49.809 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedRoleName_0
2025-11-24 02:32:49.811 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:32:49.812 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:32:49.819 +02:00 [DBG] Context 'AppDbContext' started tracking 'IdentityUserRole' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:32:49.822 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:32:49.822 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:32:49.823 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:32:49.824 +02:00 [DBG] Executing DbCommand [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0
2025-11-24 02:32:49.827 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0
2025-11-24 02:32:49.828 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:32:49.829 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:32:49.832 +02:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:32:49.832 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:32:49.833 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:32:49.834 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 02:32:49.835 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:32:49.835 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:32:49.842 +02:00 [DBG] Executing 2 update commands as a batch.
2025-11-24 02:32:49.843 +02:00 [DBG] Creating transaction savepoint.
2025-11-24 02:32:49.844 +02:00 [DBG] Created transaction savepoint.
2025-11-24 02:32:49.844 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:32:49.845 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:32:49.846 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:32:49.846 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (Size = 450), @p1='?' (Size = 450), @p24='?' (Size = 450), @p2='?' (DbType = Int32), @p3='?' (Size = 4000), @p25='?' (Size = 4000), @p4='?' (DbType = DateTime2), @p5='?' (DbType = DateTime2), @p6='?' (Size = 256), @p7='?' (DbType = Boolean), @p8='?' (Size = 150), @p9='?' (Size = 10), @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTimeOffset), @p12='?' (Size = 256), @p13='?' (Size = 256), @p14='?' (Size = 4000), @p15='?' (Size = 4000), @p16='?' (DbType = Boolean), @p17='?' (Size = 4000), @p18='?' (DbType = DateTime2), @p19='?' (Size = 50), @p20='?' (Size = 4000), @p21='?' (DbType = Boolean), @p22='?' (DbType = DateTime2), @p23='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [AspNetUserRoles] ([RoleId], [UserId])
VALUES (@p0, @p1);
UPDATE [Users] SET [AccessFailedCount] = @p2, [ConcurrencyStamp] = @p3, [CreatedAt] = @p4, [DateOfBirth] = @p5, [Email] = @p6, [EmailConfirmed] = @p7, [FullName] = @p8, [Gender] = @p9, [LockoutEnabled] = @p10, [LockoutEnd] = @p11, [NormalizedEmail] = @p12, [NormalizedUserName] = @p13, [PasswordHash] = @p14, [PhoneNumber] = @p15, [PhoneNumberConfirmed] = @p16, [RefreshToken] = @p17, [RefreshTokenExpiryTime] = @p18, [Role] = @p19, [SecurityStamp] = @p20, [TwoFactorEnabled] = @p21, [UpdatedAt] = @p22, [UserName] = @p23
OUTPUT 1
WHERE [Id] = @p24 AND [ConcurrencyStamp] = @p25;
2025-11-24 02:32:49.854 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[@p0='?' (Size = 450), @p1='?' (Size = 450), @p24='?' (Size = 450), @p2='?' (DbType = Int32), @p3='?' (Size = 4000), @p25='?' (Size = 4000), @p4='?' (DbType = DateTime2), @p5='?' (DbType = DateTime2), @p6='?' (Size = 256), @p7='?' (DbType = Boolean), @p8='?' (Size = 150), @p9='?' (Size = 10), @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTimeOffset), @p12='?' (Size = 256), @p13='?' (Size = 256), @p14='?' (Size = 4000), @p15='?' (Size = 4000), @p16='?' (DbType = Boolean), @p17='?' (Size = 4000), @p18='?' (DbType = DateTime2), @p19='?' (Size = 50), @p20='?' (Size = 4000), @p21='?' (DbType = Boolean), @p22='?' (DbType = DateTime2), @p23='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [AspNetUserRoles] ([RoleId], [UserId])
VALUES (@p0, @p1);
UPDATE [Users] SET [AccessFailedCount] = @p2, [ConcurrencyStamp] = @p3, [CreatedAt] = @p4, [DateOfBirth] = @p5, [Email] = @p6, [EmailConfirmed] = @p7, [FullName] = @p8, [Gender] = @p9, [LockoutEnabled] = @p10, [LockoutEnd] = @p11, [NormalizedEmail] = @p12, [NormalizedUserName] = @p13, [PasswordHash] = @p14, [PhoneNumber] = @p15, [PhoneNumberConfirmed] = @p16, [RefreshToken] = @p17, [RefreshTokenExpiryTime] = @p18, [Role] = @p19, [SecurityStamp] = @p20, [TwoFactorEnabled] = @p21, [UpdatedAt] = @p22, [UserName] = @p23
OUTPUT 1
WHERE [Id] = @p24 AND [ConcurrencyStamp] = @p25;
2025-11-24 02:32:49.855 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:32:49.856 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:32:49.857 +02:00 [DBG] An entity of type 'IdentityUserRole' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:32:49.858 +02:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:32:49.858 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 2 entities written to the database.
2025-11-24 02:32:49.865 +02:00 [DBG] Compiling query expression: 
'DbSet<Branch>()
    .Where(b => __ids_0
        .Contains(b.BranchId))'
2025-11-24 02:32:49.889 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Branch>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Branch.Address (string) MaxLength(250), 1], [Property: Branch.BranchName (string) Required MaxLength(150), 2], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 3], [Property: Branch.Description (string), 4], [Property: Branch.Email (string) MaxLength(200), 5], [Property: Branch.ImageURL (string) MaxLength(300), 6], [Property: Branch.Phone (string) MaxLength(25), 7], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 8] }
        SELECT b.BranchId, b.Address, b.BranchName, b.CreatedAt, b.Description, b.Email, b.ImageURL, b.Phone, b.UpdatedAt
        FROM Branches AS b
        WHERE b.BranchId IN (
            SELECT i.value
            FROM OPENJSON(@__ids_0) WITH (value int '') AS i)), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Branch>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 02:32:49.897 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:32:49.899 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:32:49.902 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2025-11-24 02:32:49.903 +02:00 [DBG] Executing DbCommand [Parameters=[@__ids_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__ids_0) WITH ([value] int '$') AS [i]
)
2025-11-24 02:32:49.909 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__ids_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] IN (
    SELECT [i].[value]
    FROM OPENJSON(@__ids_0) WITH ([value] int '$') AS [i]
)
2025-11-24 02:32:49.910 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:32:49.912 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:32:49.912 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:32:49.913 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 2ms reading results.
2025-11-24 02:32:49.926 +02:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Doctor.DoctorId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:32:49.929 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:32:49.931 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:32:49.933 +02:00 [DBG] The navigation 'User.DoctorProfile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:32:49.936 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:32:49.944 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:32:49.946 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:32:49.946 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:32:49.949 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:32:49.951 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 02:32:49.952 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:32:49.953 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:32:49.958 +02:00 [DBG] Creating transaction savepoint.
2025-11-24 02:32:49.959 +02:00 [DBG] Created transaction savepoint.
2025-11-24 02:32:49.960 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:32:49.961 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:32:49.962 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:32:49.963 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Boolean), @p1='?' (Size = 4000), @p2='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (Size = 300), @p6='?' (DbType = Int32), @p7='?' (DbType = DateTime2), @p8='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Doctors] ([Available], [Biography], [ConsultationFees], [CreatedAt], [ExperienceYears], [ImageURL], [SpecializationId], [UpdatedAt], [UserId])
OUTPUT INSERTED.[DoctorId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
2025-11-24 02:32:49.969 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (DbType = Boolean), @p1='?' (Size = 4000), @p2='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (Size = 300), @p6='?' (DbType = Int32), @p7='?' (DbType = DateTime2), @p8='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Doctors] ([Available], [Biography], [ConsultationFees], [CreatedAt], [ExperienceYears], [ImageURL], [SpecializationId], [UpdatedAt], [UserId])
OUTPUT INSERTED.[DoctorId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
2025-11-24 02:32:49.978 +02:00 [DBG] The foreign key property 'Doctor.DoctorId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 02:32:49.983 +02:00 [DBG] The foreign key property 'BranchDoctor.DoctorsDoctorId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 02:32:49.986 +02:00 [DBG] The foreign key property 'BranchDoctor.DoctorsDoctorId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 02:32:49.987 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:32:49.988 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 17ms reading results.
2025-11-24 02:32:49.990 +02:00 [DBG] Executing 2 update commands as a batch.
2025-11-24 02:32:49.992 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:32:49.992 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:32:49.993 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:32:49.993 +02:00 [DBG] Executing DbCommand [Parameters=[@p9='?' (DbType = Int32), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [DoctorBranches] ([BranchesBranchId], [DoctorsDoctorId])
VALUES (@p9, @p10),
(@p11, @p12);
2025-11-24 02:32:49.997 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@p9='?' (DbType = Int32), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [DoctorBranches] ([BranchesBranchId], [DoctorsDoctorId])
VALUES (@p9, @p10),
(@p11, @p12);
2025-11-24 02:32:49.998 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:32:49.999 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:32:50.001 +02:00 [DBG] An entity of type 'Doctor' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:32:50.002 +02:00 [DBG] An entity of type 'BranchDoctor' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:32:50.004 +02:00 [DBG] An entity of type 'BranchDoctor' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:32:50.005 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 3 entities written to the database.
2025-11-24 02:32:50.008 +02:00 [DBG] Committing transaction.
2025-11-24 02:32:50.011 +02:00 [DBG] Committed transaction.
2025-11-24 02:32:50.012 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:32:50.012 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:32:53.794 +02:00 [INF] Sent registration email to sara@example.com
2025-11-24 02:32:53.813 +02:00 [DBG] Disposing transaction.
2025-11-24 02:32:53.814 +02:00 [INF] Adding new doctor: , Email: walaa.elbishl8awy1@gmail
2025-11-24 02:32:53.814 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:32:53.815 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:32:53.817 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 02:32:53.818 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 02:32:53.820 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:32:53.822 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-11-24 02:32:53.824 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2025-11-24 02:32:53.825 +02:00 [DBG] Executing DbCommand [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedEmail] = @__normalizedEmail_0
2025-11-24 02:32:53.827 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedEmail] = @__normalizedEmail_0
2025-11-24 02:32:53.829 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:32:53.830 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:32:53.831 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:32:53.832 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:32:53.833 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:32:53.834 +02:00 [DBG] Executing DbCommand [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0
2025-11-24 02:32:53.845 +02:00 [INF] Executed DbCommand (11ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0
2025-11-24 02:32:53.847 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:32:53.847 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:32:53.848 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:32:53.848 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:32:53.849 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:32:53.849 +02:00 [DBG] Executing DbCommand [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-11-24 02:32:53.852 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-11-24 02:32:53.853 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:32:53.854 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:32:53.925 +02:00 [DBG] User validation failed: InvalidUserName.
2025-11-24 02:32:53.927 +02:00 [ERR] Failed to register user for doctor : Username ' 11' is invalid, can only contain letters or digits.
2025-11-24 02:32:53.951 +02:00 [DBG] Rolling back transaction.
2025-11-24 02:32:53.952 +02:00 [DBG] Rolled back transaction.
2025-11-24 02:32:53.953 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:32:53.953 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:32:53.955 +02:00 [ERR] Transaction rolled back while adding doctor 
2025-11-24 02:32:53.970 +02:00 [DBG] Disposing transaction.
2025-11-24 02:32:53.987 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:32:53.989 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:32:53.989 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:32:53.990 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:32:53.990 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:32:53.991 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-11-24 02:32:53.996 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.AddDoctorsFromExcel (Hospital) in 5350.1156ms
2025-11-24 02:32:53.996 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.AddDoctorsFromExcel (Hospital)'
2025-11-24 02:32:53.996 +02:00 [DBG] Connection id "0HNHAU3HQ5A6A" completed keep alive response.
2025-11-24 02:32:53.997 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:32:53.998 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:32:53.998 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:32:53.999 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Doctor/add-from-excel - 200 null application/json; charset=utf-8 5387.619ms
2025-11-24 02:33:10.648 +02:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7217/api/Doctor/doctor/self-update - application/json 189
2025-11-24 02:33:10.649 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/doctor/self-update'
2025-11-24 02:33:10.650 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.SelfUpdate (Hospital)' with route pattern 'api/Doctor/doctor/self-update' is valid for the request path '/api/Doctor/doctor/self-update'
2025-11-24 02:33:10.651 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.SelfUpdate (Hospital)'
2025-11-24 02:33:10.652 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:33:10.653 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:33:10.654 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.SelfUpdate (Hospital)'
2025-11-24 02:33:10.655 +02:00 [INF] Route matched with {action = "SelfUpdate", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SelfUpdate(Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 02:33:10.656 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:33:10.657 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:33:10.658 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:33:10.659 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:33:10.659 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:33:10.660 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 02:33:10.671 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 02:33:10.672 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto' ...
2025-11-24 02:33:10.673 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto' using the name '' in request data ...
2025-11-24 02:33:10.674 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:33:10.676 +02:00 [DBG] Connection id "0HNHAU3HQ5A6A", Request id "0HNHAU3HQ5A6A:00000003": started reading request body.
2025-11-24 02:33:10.676 +02:00 [DBG] Connection id "0HNHAU3HQ5A6A", Request id "0HNHAU3HQ5A6A:00000003": done reading request body.
2025-11-24 02:33:10.677 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto'
2025-11-24 02:33:10.678 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto'.
2025-11-24 02:33:10.678 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto'.
2025-11-24 02:33:10.678 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto' ...
2025-11-24 02:33:10.680 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto'.
2025-11-24 02:33:10.680 +02:00 [INF] SelfUpdate doctor called at "2025-11-24T02:33:10.6809184+02:00"
2025-11-24 02:33:10.681 +02:00 [INF] Updating personal info for doctor ID 2
2025-11-24 02:33:10.688 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:33:10.691 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:33:10.691 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:33:10.691 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:33:10.692 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:33:10.693 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:33:10.693 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:33:10.694 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:33:10.695 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:33:10.704 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:33:10.709 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:33:10.710 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:33:10.710 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:33:10.712 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:33:10.713 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:33:10.714 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:33:10.715 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:33:10.717 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:33:10.718 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:33:10.718 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 9ms reading results.
2025-11-24 02:33:10.719 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:33:10.719 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:33:10.720 +02:00 [DBG] An entity of type 'Doctor' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:33:10.721 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:33:10.722 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:33:10.723 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 02:33:10.723 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:33:10.723 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:33:10.724 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:33:10.725 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:33:10.725 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:33:10.726 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:33:10.727 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:33:10.727 +02:00 [DBG] Executing DbCommand [Parameters=[@p9='?' (DbType = Int32), @p0='?' (DbType = Boolean), @p1='?' (Size = 4000), @p2='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (Size = 300), @p6='?' (DbType = Int32), @p7='?' (DbType = DateTime2), @p8='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Doctors] SET [Available] = @p0, [Biography] = @p1, [ConsultationFees] = @p2, [CreatedAt] = @p3, [ExperienceYears] = @p4, [ImageURL] = @p5, [SpecializationId] = @p6, [UpdatedAt] = @p7, [UserId] = @p8
OUTPUT 1
WHERE [DoctorId] = @p9;
2025-11-24 02:33:10.737 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[@p9='?' (DbType = Int32), @p0='?' (DbType = Boolean), @p1='?' (Size = 4000), @p2='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (Size = 300), @p6='?' (DbType = Int32), @p7='?' (DbType = DateTime2), @p8='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Doctors] SET [Available] = @p0, [Biography] = @p1, [ConsultationFees] = @p2, [CreatedAt] = @p3, [ExperienceYears] = @p4, [ImageURL] = @p5, [SpecializationId] = @p6, [UpdatedAt] = @p7, [UserId] = @p8
OUTPUT 1
WHERE [DoctorId] = @p9;
2025-11-24 02:33:10.739 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:33:10.739 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:33:10.740 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:33:10.741 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:33:10.742 +02:00 [DBG] An entity of type 'Doctor' tracked by 'AppDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:33:10.743 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 02:33:10.744 +02:00 [INF] Personal info updated successfully for doctor ID 2
2025-11-24 02:33:10.744 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:33:10.745 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:33:10.746 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:33:10.746 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:33:10.746 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:33:10.747 +02:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType4`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-11-24 02:33:10.748 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.SelfUpdate (Hospital) in 88.026ms
2025-11-24 02:33:10.749 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.SelfUpdate (Hospital)'
2025-11-24 02:33:10.750 +02:00 [DBG] Connection id "0HNHAU3HQ5A6A" completed keep alive response.
2025-11-24 02:33:10.750 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:33:10.751 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:33:10.751 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:33:10.752 +02:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7217/api/Doctor/doctor/self-update - 200 null application/json; charset=utf-8 104.4094ms
2025-11-24 02:36:32.517 +02:00 [DBG] Connection id "0HNHAU3HQ5A6B" received FIN.
2025-11-24 02:36:32.523 +02:00 [DBG] Connection id "0HNHAU3HQ5A6B" accepted.
2025-11-24 02:36:32.523 +02:00 [DBG] Connection id "0HNHAU3HQ5A6B" started.
2025-11-24 02:36:32.527 +02:00 [DBG] Connection id "0HNHAU3HQ5A6C" accepted.
2025-11-24 02:36:32.528 +02:00 [DBG] Connection id "0HNHAU3HQ5A6C" started.
2025-11-24 02:36:32.528 +02:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-11-24 02:36:32.530 +02:00 [DBG] Connection id "0HNHAU3HQ5A6B" stopped.
2025-11-24 02:36:32.531 +02:00 [DBG] Connection id "0HNHAU3HQ5A6B" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-11-24 02:36:32.533 +02:00 [DBG] Connection 0HNHAU3HQ5A6C established using the following protocol: "Tls12"
2025-11-24 02:36:32.533 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Auth/register - application/json 164
2025-11-24 02:36:32.535 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/register'
2025-11-24 02:36:32.536 +02:00 [DBG] Endpoint 'Hospital.Controllers.AuthController.RegisterAsync (Hospital)' with route pattern 'api/Auth/register' is valid for the request path '/api/Auth/register'
2025-11-24 02:36:32.537 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.AuthController.RegisterAsync (Hospital)'
2025-11-24 02:36:32.537 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:36:32.538 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:36:32.539 +02:00 [INF] Executing endpoint 'Hospital.Controllers.AuthController.RegisterAsync (Hospital)'
2025-11-24 02:36:32.542 +02:00 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RegisterAsync(Hospital.Domain.Models.RegisterModel) on controller Hospital.Controllers.AuthController (Hospital).
2025-11-24 02:36:32.544 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:36:32.545 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:36:32.545 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:36:32.546 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:36:32.546 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:36:32.547 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.AuthController (Hospital)
2025-11-24 02:36:32.548 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.AuthController (Hospital)
2025-11-24 02:36:32.549 +02:00 [DBG] Attempting to bind parameter 'model' of type 'Hospital.Domain.Models.RegisterModel' ...
2025-11-24 02:36:32.550 +02:00 [DBG] Attempting to bind parameter 'model' of type 'Hospital.Domain.Models.RegisterModel' using the name '' in request data ...
2025-11-24 02:36:32.550 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:36:32.552 +02:00 [DBG] Connection id "0HNHAU3HQ5A6C", Request id "0HNHAU3HQ5A6C:00000001": started reading request body.
2025-11-24 02:36:32.553 +02:00 [DBG] Connection id "0HNHAU3HQ5A6C", Request id "0HNHAU3HQ5A6C:00000001": done reading request body.
2025-11-24 02:36:32.554 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Domain.Models.RegisterModel'
2025-11-24 02:36:32.555 +02:00 [DBG] Done attempting to bind parameter 'model' of type 'Hospital.Domain.Models.RegisterModel'.
2025-11-24 02:36:32.555 +02:00 [DBG] Done attempting to bind parameter 'model' of type 'Hospital.Domain.Models.RegisterModel'.
2025-11-24 02:36:32.556 +02:00 [DBG] Attempting to validate the bound parameter 'model' of type 'Hospital.Domain.Models.RegisterModel' ...
2025-11-24 02:36:32.558 +02:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'Hospital.Domain.Models.RegisterModel'.
2025-11-24 02:36:32.561 +02:00 [INF] Register called at "2025-11-24T02:36:32.5609467+02:00"
2025-11-24 02:36:32.563 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:36:32.564 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:36:32.564 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:36:32.564 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:32.565 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:32.566 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:36:32.566 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:36:32.567 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:36:32.568 +02:00 [DBG] Executing DbCommand [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedEmail] = @__normalizedEmail_0
2025-11-24 02:36:32.573 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedEmail] = @__normalizedEmail_0
2025-11-24 02:36:32.574 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:36:32.575 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:36:32.576 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:32.576 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:36:32.577 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:32.578 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:32.578 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:36:32.578 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:36:32.579 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:36:32.580 +02:00 [DBG] Executing DbCommand [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0
2025-11-24 02:36:32.583 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0
2025-11-24 02:36:32.585 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:36:32.585 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:36:32.586 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:32.586 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:36:32.587 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:32.587 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:32.588 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:36:32.589 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:36:32.590 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:36:32.591 +02:00 [DBG] Executing DbCommand [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-11-24 02:36:32.594 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-11-24 02:36:32.595 +02:00 [DBG] Context 'AppDbContext' started tracking 'IdentityRole' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:36:32.596 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:36:32.596 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 02:36:32.597 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:32.598 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:36:32.657 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:32.658 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:32.659 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:36:32.660 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:36:32.661 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 02:36:32.663 +02:00 [DBG] Executing DbCommand [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0
2025-11-24 02:36:32.666 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0
2025-11-24 02:36:32.667 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:36:32.669 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 02:36:32.670 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:32.671 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 02:36:32.672 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:36:32.673 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:36:32.674 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:36:32.674 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 02:36:32.674 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:36:32.675 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:36:32.676 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:32.677 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:32.677 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:36:32.678 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:36:32.678 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:36:32.679 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (Size = 450), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (DbType = DateTime2), @p5='?' (Size = 256), @p6='?' (DbType = Boolean), @p7='?' (Size = 150), @p8='?' (Size = 10), @p9='?' (DbType = Boolean), @p10='?' (DbType = DateTimeOffset), @p11='?' (Size = 256), @p12='?' (Size = 256), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Boolean), @p16='?' (Size = 4000), @p17='?' (DbType = DateTime2), @p18='?' (Size = 50), @p19='?' (Size = 4000), @p20='?' (DbType = Boolean), @p21='?' (DbType = DateTime2), @p22='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([Id], [AccessFailedCount], [ConcurrencyStamp], [CreatedAt], [DateOfBirth], [Email], [EmailConfirmed], [FullName], [Gender], [LockoutEnabled], [LockoutEnd], [NormalizedEmail], [NormalizedUserName], [PasswordHash], [PhoneNumber], [PhoneNumberConfirmed], [RefreshToken], [RefreshTokenExpiryTime], [Role], [SecurityStamp], [TwoFactorEnabled], [UpdatedAt], [UserName])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22);
2025-11-24 02:36:32.687 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[@p0='?' (Size = 450), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (DbType = DateTime2), @p5='?' (Size = 256), @p6='?' (DbType = Boolean), @p7='?' (Size = 150), @p8='?' (Size = 10), @p9='?' (DbType = Boolean), @p10='?' (DbType = DateTimeOffset), @p11='?' (Size = 256), @p12='?' (Size = 256), @p13='?' (Size = 4000), @p14='?' (Size = 4000), @p15='?' (DbType = Boolean), @p16='?' (Size = 4000), @p17='?' (DbType = DateTime2), @p18='?' (Size = 50), @p19='?' (Size = 4000), @p20='?' (DbType = Boolean), @p21='?' (DbType = DateTime2), @p22='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([Id], [AccessFailedCount], [ConcurrencyStamp], [CreatedAt], [DateOfBirth], [Email], [EmailConfirmed], [FullName], [Gender], [LockoutEnabled], [LockoutEnd], [NormalizedEmail], [NormalizedUserName], [PasswordHash], [PhoneNumber], [PhoneNumberConfirmed], [RefreshToken], [RefreshTokenExpiryTime], [Role], [SecurityStamp], [TwoFactorEnabled], [UpdatedAt], [UserName])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22);
2025-11-24 02:36:32.689 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:36:32.689 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:36:32.690 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:32.690 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:36:32.692 +02:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:36:32.693 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 02:36:32.693 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:32.694 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:32.694 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:36:32.695 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:36:32.695 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:36:32.696 +02:00 [DBG] Executing DbCommand [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedRoleName_0
2025-11-24 02:36:32.698 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedRoleName_0
2025-11-24 02:36:32.699 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:36:32.699 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:36:32.700 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:32.701 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:36:32.702 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:32.703 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:32.703 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:36:32.704 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:36:32.704 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:36:32.705 +02:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (Size = 450), @__p_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[UserId], [a].[RoleId]
FROM [AspNetUserRoles] AS [a]
WHERE [a].[UserId] = @__p_0 AND [a].[RoleId] = @__p_1
2025-11-24 02:36:32.709 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (Size = 450), @__p_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[UserId], [a].[RoleId]
FROM [AspNetUserRoles] AS [a]
WHERE [a].[UserId] = @__p_0 AND [a].[RoleId] = @__p_1
2025-11-24 02:36:32.710 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:36:32.711 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:36:32.712 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:32.712 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:36:32.713 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:32.714 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:32.714 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:36:32.715 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:36:32.715 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:36:32.716 +02:00 [DBG] Executing DbCommand [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedRoleName_0
2025-11-24 02:36:32.717 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedRoleName_0
2025-11-24 02:36:32.719 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:36:32.719 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:36:32.720 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:32.721 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:36:32.722 +02:00 [DBG] Context 'AppDbContext' started tracking 'IdentityUserRole' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:36:32.723 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:32.724 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:32.724 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:36:32.724 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:36:32.725 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:36:32.725 +02:00 [DBG] Executing DbCommand [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0
2025-11-24 02:36:32.727 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0
2025-11-24 02:36:32.730 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:36:32.730 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:36:32.731 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:32.731 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:36:32.733 +02:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:36:32.734 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:36:32.734 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:36:32.735 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 02:36:32.735 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:36:32.736 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:36:32.737 +02:00 [DBG] Executing 2 update commands as a batch.
2025-11-24 02:36:32.738 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:32.740 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:32.740 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 02:36:32.741 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 02:36:32.741 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:36:32.742 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:36:32.742 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:36:32.743 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (Size = 450), @p1='?' (Size = 450), @p24='?' (Size = 450), @p2='?' (DbType = Int32), @p3='?' (Size = 4000), @p25='?' (Size = 4000), @p4='?' (DbType = DateTime2), @p5='?' (DbType = DateTime2), @p6='?' (Size = 256), @p7='?' (DbType = Boolean), @p8='?' (Size = 150), @p9='?' (Size = 10), @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTimeOffset), @p12='?' (Size = 256), @p13='?' (Size = 256), @p14='?' (Size = 4000), @p15='?' (Size = 4000), @p16='?' (DbType = Boolean), @p17='?' (Size = 4000), @p18='?' (DbType = DateTime2), @p19='?' (Size = 50), @p20='?' (Size = 4000), @p21='?' (DbType = Boolean), @p22='?' (DbType = DateTime2), @p23='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [AspNetUserRoles] ([RoleId], [UserId])
VALUES (@p0, @p1);
UPDATE [Users] SET [AccessFailedCount] = @p2, [ConcurrencyStamp] = @p3, [CreatedAt] = @p4, [DateOfBirth] = @p5, [Email] = @p6, [EmailConfirmed] = @p7, [FullName] = @p8, [Gender] = @p9, [LockoutEnabled] = @p10, [LockoutEnd] = @p11, [NormalizedEmail] = @p12, [NormalizedUserName] = @p13, [PasswordHash] = @p14, [PhoneNumber] = @p15, [PhoneNumberConfirmed] = @p16, [RefreshToken] = @p17, [RefreshTokenExpiryTime] = @p18, [Role] = @p19, [SecurityStamp] = @p20, [TwoFactorEnabled] = @p21, [UpdatedAt] = @p22, [UserName] = @p23
OUTPUT 1
WHERE [Id] = @p24 AND [ConcurrencyStamp] = @p25;
2025-11-24 02:36:32.751 +02:00 [INF] Executed DbCommand (8ms) [Parameters=[@p0='?' (Size = 450), @p1='?' (Size = 450), @p24='?' (Size = 450), @p2='?' (DbType = Int32), @p3='?' (Size = 4000), @p25='?' (Size = 4000), @p4='?' (DbType = DateTime2), @p5='?' (DbType = DateTime2), @p6='?' (Size = 256), @p7='?' (DbType = Boolean), @p8='?' (Size = 150), @p9='?' (Size = 10), @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTimeOffset), @p12='?' (Size = 256), @p13='?' (Size = 256), @p14='?' (Size = 4000), @p15='?' (Size = 4000), @p16='?' (DbType = Boolean), @p17='?' (Size = 4000), @p18='?' (DbType = DateTime2), @p19='?' (Size = 50), @p20='?' (Size = 4000), @p21='?' (DbType = Boolean), @p22='?' (DbType = DateTime2), @p23='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [AspNetUserRoles] ([RoleId], [UserId])
VALUES (@p0, @p1);
UPDATE [Users] SET [AccessFailedCount] = @p2, [ConcurrencyStamp] = @p3, [CreatedAt] = @p4, [DateOfBirth] = @p5, [Email] = @p6, [EmailConfirmed] = @p7, [FullName] = @p8, [Gender] = @p9, [LockoutEnabled] = @p10, [LockoutEnd] = @p11, [NormalizedEmail] = @p12, [NormalizedUserName] = @p13, [PasswordHash] = @p14, [PhoneNumber] = @p15, [PhoneNumberConfirmed] = @p16, [RefreshToken] = @p17, [RefreshTokenExpiryTime] = @p18, [Role] = @p19, [SecurityStamp] = @p20, [TwoFactorEnabled] = @p21, [UpdatedAt] = @p22, [UserName] = @p23
OUTPUT 1
WHERE [Id] = @p24 AND [ConcurrencyStamp] = @p25;
2025-11-24 02:36:32.753 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:36:32.754 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:36:32.755 +02:00 [DBG] Committing transaction.
2025-11-24 02:36:32.756 +02:00 [DBG] Committed transaction.
2025-11-24 02:36:32.756 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:32.757 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:36:32.758 +02:00 [DBG] Disposing transaction.
2025-11-24 02:36:32.758 +02:00 [DBG] An entity of type 'IdentityUserRole' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:36:32.759 +02:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:36:32.760 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 2 entities written to the database.
2025-11-24 02:36:32.763 +02:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Patient.PatientId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:36:32.772 +02:00 [DBG] The navigation 'User.PatientProfile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:36:32.773 +02:00 [DBG] Context 'AppDbContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:36:32.774 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:36:32.778 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:36:32.779 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 02:36:32.780 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:36:32.781 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:36:32.782 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:32.783 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:32.784 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:36:32.784 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:36:32.785 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:36:32.785 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 150), @p2='?' (DbType = DateTime2), @p3='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Patients] ([CreatedAt], [EmergencyContact], [UpdatedAt], [UserId])
OUTPUT INSERTED.[PatientId]
VALUES (@p0, @p1, @p2, @p3);
2025-11-24 02:36:32.790 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 150), @p2='?' (DbType = DateTime2), @p3='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Patients] ([CreatedAt], [EmergencyContact], [UpdatedAt], [UserId])
OUTPUT INSERTED.[PatientId]
VALUES (@p0, @p1, @p2, @p3);
2025-11-24 02:36:32.791 +02:00 [DBG] The foreign key property 'Patient.PatientId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 02:36:32.792 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:36:32.793 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 2ms reading results.
2025-11-24 02:36:32.793 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:32.794 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:36:32.794 +02:00 [DBG] An entity of type 'Patient' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:36:32.795 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 02:36:32.796 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:36:32.796 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:36:32.797 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:36:32.797 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:36:32.797 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:36:32.798 +02:00 [INF] Executing OkObjectResult, writing value of type 'Hospital.Application.DTO.Auth.RegisterDto'.
2025-11-24 02:36:32.799 +02:00 [INF] Executed action Hospital.Controllers.AuthController.RegisterAsync (Hospital) in 252.228ms
2025-11-24 02:36:32.801 +02:00 [INF] Executed endpoint 'Hospital.Controllers.AuthController.RegisterAsync (Hospital)'
2025-11-24 02:36:32.801 +02:00 [DBG] Connection id "0HNHAU3HQ5A6C" completed keep alive response.
2025-11-24 02:36:32.802 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:36:32.802 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:32.803 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:36:32.804 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Auth/register - 200 null application/json; charset=utf-8 270.3473ms
2025-11-24 02:36:46.186 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Auth/login - application/json 64
2025-11-24 02:36:46.189 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/login'
2025-11-24 02:36:46.189 +02:00 [DBG] Endpoint 'Hospital.Controllers.AuthController.LoginAsync (Hospital)' with route pattern 'api/Auth/login' is valid for the request path '/api/Auth/login'
2025-11-24 02:36:46.190 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.AuthController.LoginAsync (Hospital)'
2025-11-24 02:36:46.192 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:36:46.192 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:36:46.193 +02:00 [INF] Executing endpoint 'Hospital.Controllers.AuthController.LoginAsync (Hospital)'
2025-11-24 02:36:46.196 +02:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] LoginAsync(Hospital.Domain.Models.LoginModel) on controller Hospital.Controllers.AuthController (Hospital).
2025-11-24 02:36:46.197 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:36:46.198 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:36:46.199 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:36:46.200 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:36:46.200 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:36:46.201 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.AuthController (Hospital)
2025-11-24 02:36:46.202 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.AuthController (Hospital)
2025-11-24 02:36:46.202 +02:00 [DBG] Attempting to bind parameter 'model' of type 'Hospital.Domain.Models.LoginModel' ...
2025-11-24 02:36:46.203 +02:00 [DBG] Attempting to bind parameter 'model' of type 'Hospital.Domain.Models.LoginModel' using the name '' in request data ...
2025-11-24 02:36:46.204 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:36:46.205 +02:00 [DBG] Connection id "0HNHAU3HQ5A6C", Request id "0HNHAU3HQ5A6C:00000002": started reading request body.
2025-11-24 02:36:46.206 +02:00 [DBG] Connection id "0HNHAU3HQ5A6C", Request id "0HNHAU3HQ5A6C:00000002": done reading request body.
2025-11-24 02:36:46.207 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Domain.Models.LoginModel'
2025-11-24 02:36:46.208 +02:00 [DBG] Done attempting to bind parameter 'model' of type 'Hospital.Domain.Models.LoginModel'.
2025-11-24 02:36:46.209 +02:00 [DBG] Done attempting to bind parameter 'model' of type 'Hospital.Domain.Models.LoginModel'.
2025-11-24 02:36:46.210 +02:00 [DBG] Attempting to validate the bound parameter 'model' of type 'Hospital.Domain.Models.LoginModel' ...
2025-11-24 02:36:46.211 +02:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'Hospital.Domain.Models.LoginModel'.
2025-11-24 02:36:46.213 +02:00 [INF] Login called at "2025-11-24T02:36:46.2132966+02:00"
2025-11-24 02:36:46.215 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:36:46.216 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:36:46.217 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:36:46.218 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:46.218 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:46.219 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:36:46.220 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:36:46.221 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 02:36:46.222 +02:00 [DBG] Executing DbCommand [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedEmail] = @__normalizedEmail_0
2025-11-24 02:36:46.226 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedEmail] = @__normalizedEmail_0
2025-11-24 02:36:46.227 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:36:46.228 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:36:46.228 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 02:36:46.229 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:46.230 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:36:46.300 +02:00 [DBG] Compiling query expression: 
'DbSet<IdentityUserClaim<string>>()
    .Where(uc => uc.UserId.Equals(__user_Id_0))
    .Select(c => c.ToClaim())'
2025-11-24 02:36:46.306 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Claim>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: IdentityUserClaim<string>.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: IdentityUserClaim<string>.ClaimType (string), 1], [Property: IdentityUserClaim<string>.ClaimValue (string), 2], [Property: IdentityUserClaim<string>.UserId (string) Required FK Index, 3] }
        SELECT a.Id, a.ClaimType, a.ClaimValue, a.UserId
        FROM AspNetUserClaims AS a
        WHERE a.UserId == @__user_Id_0), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Claim>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 02:36:46.308 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:46.309 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:46.311 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:36:46.311 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:36:46.313 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:36:46.313 +02:00 [DBG] Executing DbCommand [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2025-11-24 02:36:46.317 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2025-11-24 02:36:46.318 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:36:46.319 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:36:46.320 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:46.321 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:36:46.326 +02:00 [DBG] Compiling query expression: 
'DbSet<IdentityUserRole<string>>()
    .Join(
        inner: DbSet<IdentityRole>(), 
        outerKeySelector: userRole => userRole.RoleId, 
        innerKeySelector: role => role.Id, 
        resultSelector: (userRole, role) => new { 
            userRole = userRole, 
            role = role
         })
    .Where(<>h__TransparentIdentifier0 => <>h__TransparentIdentifier0.userRole.UserId.Equals(__userId_0))
    .Select(<>h__TransparentIdentifier0 => <>h__TransparentIdentifier0.role.Name)'
2025-11-24 02:36:46.329 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<string>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT a0.Name
        FROM AspNetUserRoles AS a
        INNER JOIN AspNetRoles AS a0 ON a.RoleId == a0.Id
        WHERE a.UserId == @__userId_0), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, string>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 02:36:46.331 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:46.332 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:46.333 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:36:46.333 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:36:46.334 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:36:46.334 +02:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2025-11-24 02:36:46.339 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2025-11-24 02:36:46.341 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:36:46.342 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:36:46.342 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:46.343 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:36:46.350 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:46.351 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:46.351 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:36:46.352 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:36:46.352 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:36:46.353 +02:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2025-11-24 02:36:46.355 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2025-11-24 02:36:46.356 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:36:46.357 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:36:46.357 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:46.358 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:36:46.359 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:46.360 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:46.360 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:36:46.360 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:36:46.361 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:36:46.361 +02:00 [DBG] Executing DbCommand [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0
2025-11-24 02:36:46.364 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0
2025-11-24 02:36:46.365 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:36:46.366 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 02:36:46.368 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:46.368 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:36:46.369 +02:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:36:46.370 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:36:46.370 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:36:46.371 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 02:36:46.372 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:36:46.373 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:36:46.373 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:46.374 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:46.375 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:36:46.375 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:36:46.376 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:36:46.376 +02:00 [DBG] Executing DbCommand [Parameters=[@p22='?' (Size = 450), @p0='?' (DbType = Int32), @p1='?' (Size = 4000), @p23='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (DbType = DateTime2), @p4='?' (Size = 256), @p5='?' (DbType = Boolean), @p6='?' (Size = 150), @p7='?' (Size = 10), @p8='?' (DbType = Boolean), @p9='?' (DbType = DateTimeOffset), @p10='?' (Size = 256), @p11='?' (Size = 256), @p12='?' (Size = 4000), @p13='?' (Size = 4000), @p14='?' (DbType = Boolean), @p15='?' (Size = 4000), @p16='?' (DbType = DateTime2), @p17='?' (Size = 50), @p18='?' (Size = 4000), @p19='?' (DbType = Boolean), @p20='?' (DbType = DateTime2), @p21='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Users] SET [AccessFailedCount] = @p0, [ConcurrencyStamp] = @p1, [CreatedAt] = @p2, [DateOfBirth] = @p3, [Email] = @p4, [EmailConfirmed] = @p5, [FullName] = @p6, [Gender] = @p7, [LockoutEnabled] = @p8, [LockoutEnd] = @p9, [NormalizedEmail] = @p10, [NormalizedUserName] = @p11, [PasswordHash] = @p12, [PhoneNumber] = @p13, [PhoneNumberConfirmed] = @p14, [RefreshToken] = @p15, [RefreshTokenExpiryTime] = @p16, [Role] = @p17, [SecurityStamp] = @p18, [TwoFactorEnabled] = @p19, [UpdatedAt] = @p20, [UserName] = @p21
OUTPUT 1
WHERE [Id] = @p22 AND [ConcurrencyStamp] = @p23;
2025-11-24 02:36:46.382 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p22='?' (Size = 450), @p0='?' (DbType = Int32), @p1='?' (Size = 4000), @p23='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (DbType = DateTime2), @p4='?' (Size = 256), @p5='?' (DbType = Boolean), @p6='?' (Size = 150), @p7='?' (Size = 10), @p8='?' (DbType = Boolean), @p9='?' (DbType = DateTimeOffset), @p10='?' (Size = 256), @p11='?' (Size = 256), @p12='?' (Size = 4000), @p13='?' (Size = 4000), @p14='?' (DbType = Boolean), @p15='?' (Size = 4000), @p16='?' (DbType = DateTime2), @p17='?' (Size = 50), @p18='?' (Size = 4000), @p19='?' (DbType = Boolean), @p20='?' (DbType = DateTime2), @p21='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Users] SET [AccessFailedCount] = @p0, [ConcurrencyStamp] = @p1, [CreatedAt] = @p2, [DateOfBirth] = @p3, [Email] = @p4, [EmailConfirmed] = @p5, [FullName] = @p6, [Gender] = @p7, [LockoutEnabled] = @p8, [LockoutEnd] = @p9, [NormalizedEmail] = @p10, [NormalizedUserName] = @p11, [PasswordHash] = @p12, [PhoneNumber] = @p13, [PhoneNumberConfirmed] = @p14, [RefreshToken] = @p15, [RefreshTokenExpiryTime] = @p16, [Role] = @p17, [SecurityStamp] = @p18, [TwoFactorEnabled] = @p19, [UpdatedAt] = @p20, [UserName] = @p21
OUTPUT 1
WHERE [Id] = @p22 AND [ConcurrencyStamp] = @p23;
2025-11-24 02:36:46.383 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:36:46.384 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:36:46.384 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:46.385 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:36:46.385 +02:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:36:46.386 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 02:36:46.404 +02:00 [DBG] Compiling query expression: 
'DbSet<Patient>()
    .FirstOrDefault(p => p.UserId == __user_Id_0)'
2025-11-24 02:36:46.407 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Patient>(
    asyncEnumerable: new SingleQueryingEnumerable<Patient>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Patient.PatientId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Patient.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: Patient.EmergencyContact (string) MaxLength(150), 2], [Property: Patient.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 3], [Property: Patient.UserId (string) Required FK Index, 4] }
            SELECT TOP(1) p.PatientId, p.CreatedAt, p.EmergencyContact, p.UpdatedAt, p.UserId
            FROM Patients AS p
            WHERE p.UserId == @__user_Id_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Patient>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 02:36:46.408 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:46.409 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:46.410 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:36:46.410 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:36:46.411 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:36:46.412 +02:00 [DBG] Executing DbCommand [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId]
FROM [Patients] AS [p]
WHERE [p].[UserId] = @__user_Id_0
2025-11-24 02:36:46.417 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId]
FROM [Patients] AS [p]
WHERE [p].[UserId] = @__user_Id_0
2025-11-24 02:36:46.419 +02:00 [DBG] The navigation 'User.PatientProfile' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:36:46.420 +02:00 [DBG] Context 'AppDbContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:36:46.421 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:36:46.422 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 3ms reading results.
2025-11-24 02:36:46.423 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:46.423 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:36:46.424 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:36:46.426 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:36:46.427 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:36:46.428 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:36:46.428 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:36:46.428 +02:00 [INF] Executing OkObjectResult, writing value of type 'Hospital.Domain.Models.AuthModel'.
2025-11-24 02:36:46.436 +02:00 [INF] Executed action Hospital.Controllers.AuthController.LoginAsync (Hospital) in 235.1968ms
2025-11-24 02:36:46.437 +02:00 [INF] Executed endpoint 'Hospital.Controllers.AuthController.LoginAsync (Hospital)'
2025-11-24 02:36:46.438 +02:00 [DBG] Connection id "0HNHAU3HQ5A6C" completed keep alive response.
2025-11-24 02:36:46.438 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:36:46.439 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:36:46.439 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:36:46.440 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Auth/login - 200 null application/json; charset=utf-8 254.0505ms
2025-11-24 02:37:30.080 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Auth/forgot-password - application/json 36
2025-11-24 02:37:30.086 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/forgot-password'
2025-11-24 02:37:30.087 +02:00 [DBG] Endpoint 'Hospital.Controllers.AuthController.ForgotPassword (Hospital)' with route pattern 'api/Auth/forgot-password' is valid for the request path '/api/Auth/forgot-password'
2025-11-24 02:37:30.088 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.AuthController.ForgotPassword (Hospital)'
2025-11-24 02:37:30.089 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:37:30.089 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:37:30.090 +02:00 [INF] Executing endpoint 'Hospital.Controllers.AuthController.ForgotPassword (Hospital)'
2025-11-24 02:37:30.093 +02:00 [INF] Route matched with {action = "ForgotPassword", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ForgotPassword(Hospital.Application.DTO.Auth.ForgotPasswordDto) on controller Hospital.Controllers.AuthController (Hospital).
2025-11-24 02:37:30.095 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:37:30.095 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:37:30.096 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:37:30.097 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:37:30.097 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:37:30.098 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.AuthController (Hospital)
2025-11-24 02:37:30.098 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.AuthController (Hospital)
2025-11-24 02:37:30.099 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Auth.ForgotPasswordDto' ...
2025-11-24 02:37:30.099 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Auth.ForgotPasswordDto' using the name '' in request data ...
2025-11-24 02:37:30.100 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:37:30.102 +02:00 [DBG] Connection id "0HNHAU3HQ5A6C", Request id "0HNHAU3HQ5A6C:00000003": started reading request body.
2025-11-24 02:37:30.103 +02:00 [DBG] Connection id "0HNHAU3HQ5A6C", Request id "0HNHAU3HQ5A6C:00000003": done reading request body.
2025-11-24 02:37:30.105 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Auth.ForgotPasswordDto'
2025-11-24 02:37:30.105 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Auth.ForgotPasswordDto'.
2025-11-24 02:37:30.106 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Auth.ForgotPasswordDto'.
2025-11-24 02:37:30.107 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Auth.ForgotPasswordDto' ...
2025-11-24 02:37:30.108 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Auth.ForgotPasswordDto'.
2025-11-24 02:37:30.109 +02:00 [INF] ForgotPassword called at "2025-11-24T02:37:30.1096303+02:00"
2025-11-24 02:37:30.111 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:37:30.112 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:37:30.113 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:37:30.113 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:37:30.114 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:37:30.114 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:37:30.115 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:37:30.115 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:37:30.115 +02:00 [DBG] Executing DbCommand [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedEmail] = @__normalizedEmail_0
2025-11-24 02:37:30.117 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedEmail] = @__normalizedEmail_0
2025-11-24 02:37:30.123 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:37:30.124 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:37:30.125 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 02:37:30.125 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:37:30.125 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:37:30.127 +02:00 [DBG] 'AppDbContext' generated a temporary value for the property 'PasswordResetCode.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:37:30.133 +02:00 [DBG] The navigation 'PasswordResetCode.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:37:30.134 +02:00 [DBG] Context 'AppDbContext' started tracking 'PasswordResetCode' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:37:30.135 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:37:30.137 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:37:30.137 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 02:37:30.138 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:37:30.138 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:37:30.139 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:37:30.140 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:37:30.140 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:37:30.141 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:37:30.141 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:37:30.142 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [PasswordResetCodes] ([Code], [ExpireAt], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2);
2025-11-24 02:37:30.146 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [PasswordResetCodes] ([Code], [ExpireAt], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2);
2025-11-24 02:37:30.148 +02:00 [DBG] The foreign key property 'PasswordResetCode.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 02:37:30.149 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:37:30.150 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 2ms reading results.
2025-11-24 02:37:30.150 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:37:30.151 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:37:30.152 +02:00 [DBG] An entity of type 'PasswordResetCode' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:37:30.153 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 02:37:32.796 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:37:32.798 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:37:32.798 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:37:32.800 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:37:32.801 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter' and content type 'text/plain' to write the response.
2025-11-24 02:37:32.802 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.String'.
2025-11-24 02:37:32.804 +02:00 [INF] Executed action Hospital.Controllers.AuthController.ForgotPassword (Hospital) in 2706.5446ms
2025-11-24 02:37:32.805 +02:00 [INF] Executed endpoint 'Hospital.Controllers.AuthController.ForgotPassword (Hospital)'
2025-11-24 02:37:32.806 +02:00 [DBG] Connection id "0HNHAU3HQ5A6C" completed keep alive response.
2025-11-24 02:37:32.807 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:37:32.808 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:37:32.809 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:37:32.810 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Auth/forgot-password - 200 null text/plain; charset=utf-8 2731.2792ms
2025-11-24 02:39:44.491 +02:00 [DBG] Connection id "0HNHAU3HQ5A6D" received FIN.
2025-11-24 02:39:44.498 +02:00 [DBG] Connection id "0HNHAU3HQ5A6D" accepted.
2025-11-24 02:39:44.499 +02:00 [DBG] Connection id "0HNHAU3HQ5A6D" started.
2025-11-24 02:39:44.504 +02:00 [DBG] Connection id "0HNHAU3HQ5A6E" accepted.
2025-11-24 02:39:44.504 +02:00 [DBG] Connection id "0HNHAU3HQ5A6E" started.
2025-11-24 02:39:44.505 +02:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-11-24 02:39:44.508 +02:00 [DBG] Connection id "0HNHAU3HQ5A6D" stopped.
2025-11-24 02:39:44.508 +02:00 [DBG] Connection id "0HNHAU3HQ5A6D" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-11-24 02:39:44.509 +02:00 [DBG] Connection 0HNHAU3HQ5A6E established using the following protocol: "Tls12"
2025-11-24 02:39:44.510 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Auth/forgot-password - application/json 39
2025-11-24 02:39:44.512 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/forgot-password'
2025-11-24 02:39:44.513 +02:00 [DBG] Endpoint 'Hospital.Controllers.AuthController.ForgotPassword (Hospital)' with route pattern 'api/Auth/forgot-password' is valid for the request path '/api/Auth/forgot-password'
2025-11-24 02:39:44.513 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.AuthController.ForgotPassword (Hospital)'
2025-11-24 02:39:44.514 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:39:44.514 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:39:44.515 +02:00 [INF] Executing endpoint 'Hospital.Controllers.AuthController.ForgotPassword (Hospital)'
2025-11-24 02:39:44.515 +02:00 [INF] Route matched with {action = "ForgotPassword", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ForgotPassword(Hospital.Application.DTO.Auth.ForgotPasswordDto) on controller Hospital.Controllers.AuthController (Hospital).
2025-11-24 02:39:44.516 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:39:44.517 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:39:44.517 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:39:44.518 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:39:44.519 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:39:44.519 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.AuthController (Hospital)
2025-11-24 02:39:44.520 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.AuthController (Hospital)
2025-11-24 02:39:44.521 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Auth.ForgotPasswordDto' ...
2025-11-24 02:39:44.522 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Auth.ForgotPasswordDto' using the name '' in request data ...
2025-11-24 02:39:44.523 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:39:44.523 +02:00 [DBG] Connection id "0HNHAU3HQ5A6E", Request id "0HNHAU3HQ5A6E:00000001": started reading request body.
2025-11-24 02:39:44.524 +02:00 [DBG] Connection id "0HNHAU3HQ5A6E", Request id "0HNHAU3HQ5A6E:00000001": done reading request body.
2025-11-24 02:39:44.524 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Auth.ForgotPasswordDto'
2025-11-24 02:39:44.524 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Auth.ForgotPasswordDto'.
2025-11-24 02:39:44.525 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Auth.ForgotPasswordDto'.
2025-11-24 02:39:44.525 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Auth.ForgotPasswordDto' ...
2025-11-24 02:39:44.526 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Auth.ForgotPasswordDto'.
2025-11-24 02:39:44.527 +02:00 [INF] ForgotPassword called at "2025-11-24T02:39:44.5269930+02:00"
2025-11-24 02:39:44.528 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:39:44.529 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:39:44.530 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:39:44.530 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:39:44.532 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:39:44.532 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:39:44.533 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:39:44.534 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:39:44.535 +02:00 [DBG] Executing DbCommand [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedEmail] = @__normalizedEmail_0
2025-11-24 02:39:44.539 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedEmail] = @__normalizedEmail_0
2025-11-24 02:39:44.540 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:39:44.541 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:39:44.542 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:39:44.543 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:39:44.544 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:39:44.545 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:39:44.545 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:39:44.545 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:39:44.546 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter' and content type 'text/plain' to write the response.
2025-11-24 02:39:44.546 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.String'.
2025-11-24 02:39:44.547 +02:00 [INF] Executed action Hospital.Controllers.AuthController.ForgotPassword (Hospital) in 27.341ms
2025-11-24 02:39:44.547 +02:00 [INF] Executed endpoint 'Hospital.Controllers.AuthController.ForgotPassword (Hospital)'
2025-11-24 02:39:44.548 +02:00 [DBG] Connection id "0HNHAU3HQ5A6E" completed keep alive response.
2025-11-24 02:39:44.549 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:39:44.549 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:39:44.550 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:39:44.551 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Auth/forgot-password - 200 null text/plain; charset=utf-8 40.6917ms
2025-11-24 02:40:42.107 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/SupportTicket/create - application/json 83
2025-11-24 02:40:42.112 +02:00 [DBG] 1 candidate(s) found for the request path '/api/SupportTicket/create'
2025-11-24 02:40:42.113 +02:00 [DBG] Endpoint 'Hospital.Controllers.SupportTicketController.Create (Hospital)' with route pattern 'api/SupportTicket/create' is valid for the request path '/api/SupportTicket/create'
2025-11-24 02:40:42.114 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.SupportTicketController.Create (Hospital)'
2025-11-24 02:40:42.114 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:40:42.115 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:40:42.116 +02:00 [INF] Executing endpoint 'Hospital.Controllers.SupportTicketController.Create (Hospital)'
2025-11-24 02:40:42.119 +02:00 [INF] Route matched with {action = "Create", controller = "SupportTicket"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Create(Hospital.Application.DTO.SupportTicket.CreateSupportTicketDto) on controller Hospital.Controllers.SupportTicketController (Hospital).
2025-11-24 02:40:42.121 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:40:42.122 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:40:42.123 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:40:42.124 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:40:42.125 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:40:42.126 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.SupportTicketController (Hospital)
2025-11-24 02:40:42.127 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.SupportTicketController (Hospital)
2025-11-24 02:40:42.128 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.SupportTicket.CreateSupportTicketDto' ...
2025-11-24 02:40:42.129 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.SupportTicket.CreateSupportTicketDto' using the name '' in request data ...
2025-11-24 02:40:42.130 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:40:42.131 +02:00 [DBG] Connection id "0HNHAU3HQ5A6E", Request id "0HNHAU3HQ5A6E:00000002": started reading request body.
2025-11-24 02:40:42.132 +02:00 [DBG] Connection id "0HNHAU3HQ5A6E", Request id "0HNHAU3HQ5A6E:00000002": done reading request body.
2025-11-24 02:40:42.134 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.SupportTicket.CreateSupportTicketDto'
2025-11-24 02:40:42.134 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.SupportTicket.CreateSupportTicketDto'.
2025-11-24 02:40:42.135 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.SupportTicket.CreateSupportTicketDto'.
2025-11-24 02:40:42.135 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.SupportTicket.CreateSupportTicketDto' ...
2025-11-24 02:40:42.138 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.SupportTicket.CreateSupportTicketDto'.
2025-11-24 02:40:42.139 +02:00 [INF] create Support Ticket called at "2025-11-24T02:40:42.1391661+02:00"
2025-11-24 02:40:42.140 +02:00 [INF] Creating a new support ticket for PatientId 1
2025-11-24 02:40:42.142 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:40:42.144 +02:00 [DBG] Compiling query expression: 
'DbSet<Patient>()
    .Include(p => p.User)
    .Include(p => p.MedicalRecords)
    .ThenInclude(m => m.Doctor)
    .ThenInclude(d => d.User)
    .FirstOrDefault(p => p.PatientId == __id_0)'
2025-11-24 02:40:42.146 +02:00 [DBG] Including navigation: 'Patient.User'.
2025-11-24 02:40:42.146 +02:00 [DBG] Including navigation: 'Patient.MedicalRecords'.
2025-11-24 02:40:42.147 +02:00 [DBG] Including navigation: 'MedicalRecord.Doctor'.
2025-11-24 02:40:42.148 +02:00 [DBG] Including navigation: 'Doctor.User'.
2025-11-24 02:40:42.164 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Patient>(
    asyncEnumerable: new SingleQueryingEnumerable<Patient>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Patient.PatientId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Patient.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: Patient.EmergencyContact (string) MaxLength(150), 2], [Property: Patient.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 3], [Property: Patient.UserId (string) Required FK Index, 4] }
                1 -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 5], [Property: User.AccessFailedCount (int) Required, 6], [Property: User.ConcurrencyStamp (string) Concurrency, 7], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 8], [Property: User.DateOfBirth (DateOnly?), 9], [Property: User.Email (string) Index MaxLength(256), 10], [Property: User.EmailConfirmed (bool) Required, 11], [Property: User.FullName (string) Required MaxLength(150), 12], [Property: User.Gender (GenderType?) MaxLength(10), 13], [Property: User.LockoutEnabled (bool) Required, 14], [Property: User.LockoutEnd (DateTimeOffset?), 15], [Property: User.NormalizedEmail (string) Index MaxLength(256), 16], [Property: User.NormalizedUserName (string) Index MaxLength(256), 17], [Property: User.PasswordHash (string), 18], [Property: User.PhoneNumber (string), 19], [Property: User.PhoneNumberConfirmed (bool) Required, 20], [Property: User.RefreshToken (string), 21], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 22], [Property: User.Role (string) Required MaxLength(50), 23], [Property: User.SecurityStamp (string), 24], [Property: User.TwoFactorEnabled (bool) Required, 25], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 26], [Property: User.UserName (string) MaxLength(256), 27] }
                2 -> 0
                3 -> 5
                4 -> Dictionary<IProperty, int> { [Property: MedicalRecord.RecordId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 28], [Property: MedicalRecord.AppointmentId (int) Required FK Index, 29], [Property: MedicalRecord.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 30], [Property: MedicalRecord.Diagnosis (string), 31], [Property: MedicalRecord.DoctorId (int) Required FK Index, 32], [Property: MedicalRecord.Notes (string), 33], [Property: MedicalRecord.PatientId (int) Required FK Index, 34], [Property: MedicalRecord.TreatmentPlan (string), 35], [Property: MedicalRecord.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 36] }
                5 -> Dictionary<IProperty, int> { [Property: Doctor.DoctorId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 37], [Property: Doctor.Available (bool?), 38], [Property: Doctor.Biography (string), 39], [Property: Doctor.ConsultationFees (decimal) Required, 40], [Property: Doctor.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 41], [Property: Doctor.ExperienceYears (int?), 42], [Property: Doctor.ImageURL (string) MaxLength(300), 43], [Property: Doctor.SpecializationId (int) Required FK Index, 44], [Property: Doctor.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 45], [Property: Doctor.UserId (string) Required FK Index, 46] }
                6 -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 47], [Property: User.AccessFailedCount (int) Required, 48], [Property: User.ConcurrencyStamp (string) Concurrency, 49], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 50], [Property: User.DateOfBirth (DateOnly?), 51], [Property: User.Email (string) Index MaxLength(256), 52], [Property: User.EmailConfirmed (bool) Required, 53], [Property: User.FullName (string) Required MaxLength(150), 54], [Property: User.Gender (GenderType?) MaxLength(10), 55], [Property: User.LockoutEnabled (bool) Required, 56], [Property: User.LockoutEnd (DateTimeOffset?), 57], [Property: User.NormalizedEmail (string) Index MaxLength(256), 58], [Property: User.NormalizedUserName (string) Index MaxLength(256), 59], [Property: User.PasswordHash (string), 60], [Property: User.PhoneNumber (string), 61], [Property: User.PhoneNumberConfirmed (bool) Required, 62], [Property: User.RefreshToken (string), 63], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 64], [Property: User.Role (string) Required MaxLength(50), 65], [Property: User.SecurityStamp (string), 66], [Property: User.TwoFactorEnabled (bool) Required, 67], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 68], [Property: User.UserName (string) MaxLength(256), 69] }
                7 -> 28
                8 -> 37
                9 -> 47
            SELECT t.PatientId, t.CreatedAt, t.EmergencyContact, t.UpdatedAt, t.UserId, t.Id, t.AccessFailedCount, t.ConcurrencyStamp, t.CreatedAt0, t.DateOfBirth, t.Email, t.EmailConfirmed, t.FullName, t.Gender, t.LockoutEnabled, t.LockoutEnd, t.NormalizedEmail, t.NormalizedUserName, t.PasswordHash, t.PhoneNumber, t.PhoneNumberConfirmed, t.RefreshToken, t.RefreshTokenExpiryTime, t.Role, t.SecurityStamp, t.TwoFactorEnabled, t.UpdatedAt0, t.UserName, t0.RecordId, t0.AppointmentId, t0.CreatedAt, t0.Diagnosis, t0.DoctorId, t0.Notes, t0.PatientId, t0.TreatmentPlan, t0.UpdatedAt, t0.DoctorId0, t0.Available, t0.Biography, t0.ConsultationFees, t0.CreatedAt0, t0.ExperienceYears, t0.ImageURL, t0.SpecializationId, t0.UpdatedAt0, t0.UserId, t0.Id, t0.AccessFailedCount, t0.ConcurrencyStamp, t0.CreatedAt1, t0.DateOfBirth, t0.Email, t0.EmailConfirmed, t0.FullName, t0.Gender, t0.LockoutEnabled, t0.LockoutEnd, t0.NormalizedEmail, t0.NormalizedUserName, t0.PasswordHash, t0.PhoneNumber, t0.PhoneNumberConfirmed, t0.RefreshToken, t0.RefreshTokenExpiryTime, t0.Role, t0.SecurityStamp, t0.TwoFactorEnabled, t0.UpdatedAt1, t0.UserName
            FROM 
            (
                SELECT TOP(1) p.PatientId, p.CreatedAt, p.EmergencyContact, p.UpdatedAt, p.UserId, u.Id, u.AccessFailedCount, u.ConcurrencyStamp, u.CreatedAt AS CreatedAt0, u.DateOfBirth, u.Email, u.EmailConfirmed, u.FullName, u.Gender, u.LockoutEnabled, u.LockoutEnd, u.NormalizedEmail, u.NormalizedUserName, u.PasswordHash, u.PhoneNumber, u.PhoneNumberConfirmed, u.RefreshToken, u.RefreshTokenExpiryTime, u.Role, u.SecurityStamp, u.TwoFactorEnabled, u.UpdatedAt AS UpdatedAt0, u.UserName
                FROM Patients AS p
                INNER JOIN Users AS u ON p.UserId == u.Id
                WHERE p.PatientId == @__id_0
            ) AS t
            LEFT JOIN 
            (
                SELECT m.RecordId, m.AppointmentId, m.CreatedAt, m.Diagnosis, m.DoctorId, m.Notes, m.PatientId, m.TreatmentPlan, m.UpdatedAt, d.DoctorId AS DoctorId0, d.Available, d.Biography, d.ConsultationFees, d.CreatedAt AS CreatedAt0, d.ExperienceYears, d.ImageURL, d.SpecializationId, d.UpdatedAt AS UpdatedAt0, d.UserId, u0.Id, u0.AccessFailedCount, u0.ConcurrencyStamp, u0.CreatedAt AS CreatedAt1, u0.DateOfBirth, u0.Email, u0.EmailConfirmed, u0.FullName, u0.Gender, u0.LockoutEnabled, u0.LockoutEnd, u0.NormalizedEmail, u0.NormalizedUserName, u0.PasswordHash, u0.PhoneNumber, u0.PhoneNumberConfirmed, u0.RefreshToken, u0.RefreshTokenExpiryTime, u0.Role, u0.SecurityStamp, u0.TwoFactorEnabled, u0.UpdatedAt AS UpdatedAt1, u0.UserName
                FROM MedicalRecords AS m
                INNER JOIN Doctors AS d ON m.DoctorId == d.DoctorId
                INNER JOIN Users AS u0 ON d.UserId == u0.Id
            ) AS t0 ON t.PatientId == t0.PatientId
            ORDER BY t.PatientId ASC, t.Id ASC, t0.RecordId ASC, t0.DoctorId0 ASC), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Patient>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 02:40:42.171 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:40:42.172 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:40:42.172 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:40:42.173 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:40:42.173 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:40:42.173 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:40:42.175 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:40:42.176 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 02:40:42.198 +02:00 [INF] Executed DbCommand (23ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 02:40:42.204 +02:00 [DBG] Context 'AppDbContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:40:42.204 +02:00 [DBG] The navigation 'Patient.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:40:42.205 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:40:42.206 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:40:42.208 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 4ms reading results.
2025-11-24 02:40:42.209 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:40:42.210 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:40:42.214 +02:00 [DBG] 'AppDbContext' generated a temporary value for the property 'SupportTicket.TicketId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:40:42.223 +02:00 [DBG] The navigation 'SupportTicket.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:40:42.224 +02:00 [DBG] Context 'AppDbContext' started tracking 'SupportTicket' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:40:42.225 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:40:42.229 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:40:42.230 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 02:40:42.231 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:40:42.233 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:40:42.234 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:40:42.235 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:40:42.235 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:40:42.237 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:40:42.238 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 02:40:42.238 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (Size = 20), @p4='?' (Size = 200), @p5='?' (DbType = DateTime2), @p6='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [SupportTickets] ([CreatedAt], [Message], [Response], [Status], [Subject], [UpdatedAt], [UserId])
OUTPUT INSERTED.[TicketId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-11-24 02:40:42.244 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (Size = 20), @p4='?' (Size = 200), @p5='?' (DbType = DateTime2), @p6='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [SupportTickets] ([CreatedAt], [Message], [Response], [Status], [Subject], [UpdatedAt], [UserId])
OUTPUT INSERTED.[TicketId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-11-24 02:40:42.247 +02:00 [DBG] The foreign key property 'SupportTicket.TicketId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 02:40:42.249 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:40:42.249 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 2ms reading results.
2025-11-24 02:40:42.250 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:40:42.251 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 02:40:42.254 +02:00 [DBG] An entity of type 'SupportTicket' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:40:42.255 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 02:40:42.256 +02:00 [INF] Support ticket 1 created successfully for PatientId 1
2025-11-24 02:40:42.258 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:40:42.260 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:40:42.261 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:40:42.261 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:40:42.262 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:40:42.262 +02:00 [INF] Executing OkObjectResult, writing value of type 'Hospital.Application.DTO.SupportTicket.SupportTicketDto'.
2025-11-24 02:40:42.268 +02:00 [INF] Executed action Hospital.Controllers.SupportTicketController.Create (Hospital) in 141.5658ms
2025-11-24 02:40:42.269 +02:00 [INF] Executed endpoint 'Hospital.Controllers.SupportTicketController.Create (Hospital)'
2025-11-24 02:40:42.270 +02:00 [DBG] Connection id "0HNHAU3HQ5A6E" completed keep alive response.
2025-11-24 02:40:42.270 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:40:42.271 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:40:42.271 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:40:42.272 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/SupportTicket/create - 200 null application/json; charset=utf-8 167.8741ms
2025-11-24 02:40:48.814 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/SupportTicket/create - application/json 83
2025-11-24 02:40:48.816 +02:00 [DBG] 1 candidate(s) found for the request path '/api/SupportTicket/create'
2025-11-24 02:40:48.818 +02:00 [DBG] Endpoint 'Hospital.Controllers.SupportTicketController.Create (Hospital)' with route pattern 'api/SupportTicket/create' is valid for the request path '/api/SupportTicket/create'
2025-11-24 02:40:48.818 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.SupportTicketController.Create (Hospital)'
2025-11-24 02:40:48.819 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:40:48.820 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:40:48.821 +02:00 [INF] Executing endpoint 'Hospital.Controllers.SupportTicketController.Create (Hospital)'
2025-11-24 02:40:48.823 +02:00 [INF] Route matched with {action = "Create", controller = "SupportTicket"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Create(Hospital.Application.DTO.SupportTicket.CreateSupportTicketDto) on controller Hospital.Controllers.SupportTicketController (Hospital).
2025-11-24 02:40:48.825 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:40:48.825 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:40:48.826 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:40:48.827 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:40:48.827 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:40:48.828 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.SupportTicketController (Hospital)
2025-11-24 02:40:48.829 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.SupportTicketController (Hospital)
2025-11-24 02:40:48.830 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.SupportTicket.CreateSupportTicketDto' ...
2025-11-24 02:40:48.832 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.SupportTicket.CreateSupportTicketDto' using the name '' in request data ...
2025-11-24 02:40:48.833 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:40:48.833 +02:00 [DBG] Connection id "0HNHAU3HQ5A6E", Request id "0HNHAU3HQ5A6E:00000003": started reading request body.
2025-11-24 02:40:48.834 +02:00 [DBG] Connection id "0HNHAU3HQ5A6E", Request id "0HNHAU3HQ5A6E:00000003": done reading request body.
2025-11-24 02:40:48.835 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.SupportTicket.CreateSupportTicketDto'
2025-11-24 02:40:48.836 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.SupportTicket.CreateSupportTicketDto'.
2025-11-24 02:40:48.837 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.SupportTicket.CreateSupportTicketDto'.
2025-11-24 02:40:48.837 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.SupportTicket.CreateSupportTicketDto' ...
2025-11-24 02:40:48.838 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.SupportTicket.CreateSupportTicketDto'.
2025-11-24 02:40:48.839 +02:00 [INF] create Support Ticket called at "2025-11-24T02:40:48.8390204+02:00"
2025-11-24 02:40:48.839 +02:00 [INF] Creating a new support ticket for PatientId 1
2025-11-24 02:40:48.840 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:40:48.841 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:40:48.842 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:40:48.842 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:40:48.843 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:40:48.843 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:40:48.844 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:40:48.844 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:40:48.845 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 02:40:48.850 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 02:40:48.856 +02:00 [DBG] Context 'AppDbContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:40:48.857 +02:00 [DBG] The navigation 'Patient.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:40:48.858 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:40:48.859 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:40:48.859 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 3ms reading results.
2025-11-24 02:40:48.860 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:40:48.861 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:40:48.863 +02:00 [DBG] 'AppDbContext' generated a temporary value for the property 'SupportTicket.TicketId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:40:48.863 +02:00 [DBG] The navigation 'SupportTicket.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:40:48.864 +02:00 [DBG] Context 'AppDbContext' started tracking 'SupportTicket' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:40:48.865 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:40:48.865 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:40:48.866 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 02:40:48.866 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:40:48.866 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:40:48.867 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:40:48.867 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:40:48.868 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:40:48.868 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:40:48.869 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:40:48.869 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (Size = 20), @p4='?' (Size = 200), @p5='?' (DbType = DateTime2), @p6='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [SupportTickets] ([CreatedAt], [Message], [Response], [Status], [Subject], [UpdatedAt], [UserId])
OUTPUT INSERTED.[TicketId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-11-24 02:40:48.872 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (Size = 20), @p4='?' (Size = 200), @p5='?' (DbType = DateTime2), @p6='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [SupportTickets] ([CreatedAt], [Message], [Response], [Status], [Subject], [UpdatedAt], [UserId])
OUTPUT INSERTED.[TicketId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-11-24 02:40:48.873 +02:00 [DBG] The foreign key property 'SupportTicket.TicketId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 02:40:48.873 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:40:48.874 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 02:40:48.875 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:40:48.875 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:40:48.875 +02:00 [DBG] An entity of type 'SupportTicket' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:40:48.876 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 02:40:48.877 +02:00 [INF] Support ticket 2 created successfully for PatientId 1
2025-11-24 02:40:48.877 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:40:48.880 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:40:48.881 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:40:48.881 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:40:48.881 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:40:48.883 +02:00 [INF] Executing OkObjectResult, writing value of type 'Hospital.Application.DTO.SupportTicket.SupportTicketDto'.
2025-11-24 02:40:48.884 +02:00 [INF] Executed action Hospital.Controllers.SupportTicketController.Create (Hospital) in 56.2984ms
2025-11-24 02:40:48.885 +02:00 [INF] Executed endpoint 'Hospital.Controllers.SupportTicketController.Create (Hospital)'
2025-11-24 02:40:48.885 +02:00 [DBG] Connection id "0HNHAU3HQ5A6E" completed keep alive response.
2025-11-24 02:40:48.885 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:40:48.886 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:40:48.886 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:40:48.887 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/SupportTicket/create - 200 null application/json; charset=utf-8 72.5146ms
2025-11-24 02:40:56.786 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/SupportTicket/create - application/json 83
2025-11-24 02:40:56.787 +02:00 [DBG] 1 candidate(s) found for the request path '/api/SupportTicket/create'
2025-11-24 02:40:56.787 +02:00 [DBG] Endpoint 'Hospital.Controllers.SupportTicketController.Create (Hospital)' with route pattern 'api/SupportTicket/create' is valid for the request path '/api/SupportTicket/create'
2025-11-24 02:40:56.789 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.SupportTicketController.Create (Hospital)'
2025-11-24 02:40:56.790 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:40:56.791 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:40:56.792 +02:00 [INF] Executing endpoint 'Hospital.Controllers.SupportTicketController.Create (Hospital)'
2025-11-24 02:40:56.793 +02:00 [INF] Route matched with {action = "Create", controller = "SupportTicket"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Create(Hospital.Application.DTO.SupportTicket.CreateSupportTicketDto) on controller Hospital.Controllers.SupportTicketController (Hospital).
2025-11-24 02:40:56.794 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:40:56.795 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:40:56.796 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:40:56.798 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:40:56.799 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:40:56.800 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.SupportTicketController (Hospital)
2025-11-24 02:40:56.802 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.SupportTicketController (Hospital)
2025-11-24 02:40:56.803 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.SupportTicket.CreateSupportTicketDto' ...
2025-11-24 02:40:56.804 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.SupportTicket.CreateSupportTicketDto' using the name '' in request data ...
2025-11-24 02:40:56.805 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:40:56.806 +02:00 [DBG] Connection id "0HNHAU3HQ5A6E", Request id "0HNHAU3HQ5A6E:00000004": started reading request body.
2025-11-24 02:40:56.807 +02:00 [DBG] Connection id "0HNHAU3HQ5A6E", Request id "0HNHAU3HQ5A6E:00000004": done reading request body.
2025-11-24 02:40:56.808 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.SupportTicket.CreateSupportTicketDto'
2025-11-24 02:40:56.808 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.SupportTicket.CreateSupportTicketDto'.
2025-11-24 02:40:56.809 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.SupportTicket.CreateSupportTicketDto'.
2025-11-24 02:40:56.809 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.SupportTicket.CreateSupportTicketDto' ...
2025-11-24 02:40:56.811 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.SupportTicket.CreateSupportTicketDto'.
2025-11-24 02:40:56.812 +02:00 [INF] create Support Ticket called at "2025-11-24T02:40:56.8125728+02:00"
2025-11-24 02:40:56.813 +02:00 [INF] Creating a new support ticket for PatientId 1
2025-11-24 02:40:56.814 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:40:56.815 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:40:56.815 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:40:56.816 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:40:56.817 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:40:56.818 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:40:56.819 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:40:56.820 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:40:56.820 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 02:40:56.823 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 02:40:56.826 +02:00 [DBG] Context 'AppDbContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:40:56.827 +02:00 [DBG] The navigation 'Patient.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:40:56.828 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:40:56.828 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:40:56.829 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 2ms reading results.
2025-11-24 02:40:56.829 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:40:56.830 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:40:56.831 +02:00 [DBG] 'AppDbContext' generated a temporary value for the property 'SupportTicket.TicketId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:40:56.833 +02:00 [DBG] The navigation 'SupportTicket.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:40:56.833 +02:00 [DBG] Context 'AppDbContext' started tracking 'SupportTicket' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:40:56.835 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:40:56.835 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:40:56.836 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 02:40:56.837 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:40:56.838 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:40:56.839 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:40:56.839 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:40:56.840 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:40:56.841 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:40:56.841 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:40:56.842 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (Size = 20), @p4='?' (Size = 200), @p5='?' (DbType = DateTime2), @p6='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [SupportTickets] ([CreatedAt], [Message], [Response], [Status], [Subject], [UpdatedAt], [UserId])
OUTPUT INSERTED.[TicketId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-11-24 02:40:56.849 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (Size = 20), @p4='?' (Size = 200), @p5='?' (DbType = DateTime2), @p6='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [SupportTickets] ([CreatedAt], [Message], [Response], [Status], [Subject], [UpdatedAt], [UserId])
OUTPUT INSERTED.[TicketId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-11-24 02:40:56.852 +02:00 [DBG] The foreign key property 'SupportTicket.TicketId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 02:40:56.853 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:40:56.853 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 02:40:56.854 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:40:56.854 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:40:56.855 +02:00 [DBG] An entity of type 'SupportTicket' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:40:56.856 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 02:40:56.856 +02:00 [INF] Support ticket 3 created successfully for PatientId 1
2025-11-24 02:40:56.857 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:40:56.858 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:40:56.858 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:40:56.858 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:40:56.859 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:40:56.859 +02:00 [INF] Executing OkObjectResult, writing value of type 'Hospital.Application.DTO.SupportTicket.SupportTicketDto'.
2025-11-24 02:40:56.860 +02:00 [INF] Executed action Hospital.Controllers.SupportTicketController.Create (Hospital) in 60.5162ms
2025-11-24 02:40:56.861 +02:00 [INF] Executed endpoint 'Hospital.Controllers.SupportTicketController.Create (Hospital)'
2025-11-24 02:40:56.862 +02:00 [DBG] Connection id "0HNHAU3HQ5A6E" completed keep alive response.
2025-11-24 02:40:56.862 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:40:56.863 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:40:56.863 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:40:56.864 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/SupportTicket/create - 200 null application/json; charset=utf-8 78.3336ms
2025-11-24 02:41:07.904 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/SupportTicket - null null
2025-11-24 02:41:07.905 +02:00 [DBG] 1 candidate(s) found for the request path '/api/SupportTicket'
2025-11-24 02:41:07.906 +02:00 [DBG] Endpoint 'Hospital.Controllers.SupportTicketController.GetAll (Hospital)' with route pattern 'api/SupportTicket' is valid for the request path '/api/SupportTicket'
2025-11-24 02:41:07.908 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.SupportTicketController.GetAll (Hospital)'
2025-11-24 02:41:07.908 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:41:07.909 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:41:07.909 +02:00 [INF] Executing endpoint 'Hospital.Controllers.SupportTicketController.GetAll (Hospital)'
2025-11-24 02:41:07.913 +02:00 [INF] Route matched with {action = "GetAll", controller = "SupportTicket"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll() on controller Hospital.Controllers.SupportTicketController (Hospital).
2025-11-24 02:41:07.914 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:41:07.914 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:41:07.916 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:41:07.917 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:41:07.918 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:41:07.919 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.SupportTicketController (Hospital)
2025-11-24 02:41:07.920 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.SupportTicketController (Hospital)
2025-11-24 02:41:07.921 +02:00 [INF] get all Support Ticket called at "2025-11-24T02:41:07.9218111+02:00"
2025-11-24 02:41:07.923 +02:00 [INF] Fetching all support tickets in the system
2025-11-24 02:41:07.924 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:41:07.925 +02:00 [DBG] Compiling query expression: 
'DbSet<SupportTicket>()
    .Include(t => t.User)
    .OrderByDescending(t => t.CreatedAt)'
2025-11-24 02:41:07.927 +02:00 [DBG] Including navigation: 'SupportTicket.User'.
2025-11-24 02:41:07.933 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<SupportTicket>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: SupportTicket.TicketId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: SupportTicket.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: SupportTicket.Message (string) Required, 2], [Property: SupportTicket.Response (string), 3], [Property: SupportTicket.Status (TicketStatus) Required MaxLength(20), 4], [Property: SupportTicket.Subject (string) Required MaxLength(200), 5], [Property: SupportTicket.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 6], [Property: SupportTicket.UserId (string) Required FK Index, 7] }
            1 -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 8], [Property: User.AccessFailedCount (int) Required, 9], [Property: User.ConcurrencyStamp (string) Concurrency, 10], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 11], [Property: User.DateOfBirth (DateOnly?), 12], [Property: User.Email (string) Index MaxLength(256), 13], [Property: User.EmailConfirmed (bool) Required, 14], [Property: User.FullName (string) Required MaxLength(150), 15], [Property: User.Gender (GenderType?) MaxLength(10), 16], [Property: User.LockoutEnabled (bool) Required, 17], [Property: User.LockoutEnd (DateTimeOffset?), 18], [Property: User.NormalizedEmail (string) Index MaxLength(256), 19], [Property: User.NormalizedUserName (string) Index MaxLength(256), 20], [Property: User.PasswordHash (string), 21], [Property: User.PhoneNumber (string), 22], [Property: User.PhoneNumberConfirmed (bool) Required, 23], [Property: User.RefreshToken (string), 24], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 25], [Property: User.Role (string) Required MaxLength(50), 26], [Property: User.SecurityStamp (string), 27], [Property: User.TwoFactorEnabled (bool) Required, 28], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 29], [Property: User.UserName (string) MaxLength(256), 30] }
        SELECT s.TicketId, s.CreatedAt, s.Message, s.Response, s.Status, s.Subject, s.UpdatedAt, s.UserId, u.Id, u.AccessFailedCount, u.ConcurrencyStamp, u.CreatedAt, u.DateOfBirth, u.Email, u.EmailConfirmed, u.FullName, u.Gender, u.LockoutEnabled, u.LockoutEnd, u.NormalizedEmail, u.NormalizedUserName, u.PasswordHash, u.PhoneNumber, u.PhoneNumberConfirmed, u.RefreshToken, u.RefreshTokenExpiryTime, u.Role, u.SecurityStamp, u.TwoFactorEnabled, u.UpdatedAt, u.UserName
        FROM SupportTickets AS s
        INNER JOIN Users AS u ON s.UserId == u.Id
        ORDER BY s.CreatedAt DESC), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, SupportTicket>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 02:41:07.937 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:41:07.938 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:41:07.938 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:41:07.939 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:41:07.939 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:41:07.941 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:41:07.941 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:41:07.942 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[TicketId], [s].[CreatedAt], [s].[Message], [s].[Response], [s].[Status], [s].[Subject], [s].[UpdatedAt], [s].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [SupportTickets] AS [s]
INNER JOIN [Users] AS [u] ON [s].[UserId] = [u].[Id]
ORDER BY [s].[CreatedAt] DESC
2025-11-24 02:41:07.955 +02:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[TicketId], [s].[CreatedAt], [s].[Message], [s].[Response], [s].[Status], [s].[Subject], [s].[UpdatedAt], [s].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [SupportTickets] AS [s]
INNER JOIN [Users] AS [u] ON [s].[UserId] = [u].[Id]
ORDER BY [s].[CreatedAt] DESC
2025-11-24 02:41:07.958 +02:00 [DBG] Context 'AppDbContext' started tracking 'SupportTicket' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:41:07.959 +02:00 [DBG] The navigation 'SupportTicket.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:41:07.961 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:41:07.962 +02:00 [DBG] Context 'AppDbContext' started tracking 'SupportTicket' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:41:07.963 +02:00 [DBG] Context 'AppDbContext' started tracking 'SupportTicket' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:41:07.963 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:41:07.965 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 8ms reading results.
2025-11-24 02:41:07.965 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:41:07.966 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:41:07.971 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:41:07.974 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:41:07.974 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:41:07.975 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:41:07.976 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:41:07.978 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.SupportTicket.SupportTicketDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 02:41:07.979 +02:00 [INF] Executed action Hospital.Controllers.SupportTicketController.GetAll (Hospital) in 60.2725ms
2025-11-24 02:41:07.981 +02:00 [INF] Executed endpoint 'Hospital.Controllers.SupportTicketController.GetAll (Hospital)'
2025-11-24 02:41:07.982 +02:00 [DBG] Connection id "0HNHAU3HQ5A6E" completed keep alive response.
2025-11-24 02:41:07.983 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:41:07.983 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:41:07.984 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:41:07.984 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/SupportTicket - 200 null application/json; charset=utf-8 80.4136ms
2025-11-24 02:41:25.801 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/SupportTicket/patient/1 - null null
2025-11-24 02:41:25.802 +02:00 [DBG] 1 candidate(s) found for the request path '/api/SupportTicket/patient/1'
2025-11-24 02:41:25.803 +02:00 [DBG] Endpoint 'Hospital.Controllers.SupportTicketController.GetAllByPatientId (Hospital)' with route pattern 'api/SupportTicket/patient/{patientId}' is valid for the request path '/api/SupportTicket/patient/1'
2025-11-24 02:41:25.804 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.SupportTicketController.GetAllByPatientId (Hospital)'
2025-11-24 02:41:25.805 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:41:25.806 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:41:25.807 +02:00 [INF] Executing endpoint 'Hospital.Controllers.SupportTicketController.GetAllByPatientId (Hospital)'
2025-11-24 02:41:25.810 +02:00 [INF] Route matched with {action = "GetAllByPatientId", controller = "SupportTicket"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IEnumerable`1[Hospital.Application.DTO.SupportTicket.SupportTicketDto]]] GetAllByPatientId(Int32) on controller Hospital.Controllers.SupportTicketController (Hospital).
2025-11-24 02:41:25.813 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:41:25.814 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:41:25.815 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:41:25.816 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:41:25.816 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:41:25.817 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.SupportTicketController (Hospital)
2025-11-24 02:41:25.817 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.SupportTicketController (Hospital)
2025-11-24 02:41:25.818 +02:00 [DBG] Attempting to bind parameter 'patientId' of type 'System.Int32' ...
2025-11-24 02:41:25.819 +02:00 [DBG] Attempting to bind parameter 'patientId' of type 'System.Int32' using the name 'patientId' in request data ...
2025-11-24 02:41:25.821 +02:00 [DBG] Done attempting to bind parameter 'patientId' of type 'System.Int32'.
2025-11-24 02:41:25.821 +02:00 [DBG] Done attempting to bind parameter 'patientId' of type 'System.Int32'.
2025-11-24 02:41:25.822 +02:00 [DBG] Attempting to validate the bound parameter 'patientId' of type 'System.Int32' ...
2025-11-24 02:41:25.823 +02:00 [DBG] Done attempting to validate the bound parameter 'patientId' of type 'System.Int32'.
2025-11-24 02:41:25.825 +02:00 [INF] get all Support Ticket  by patient id called at "2025-11-24T02:41:25.8255619+02:00"
2025-11-24 02:41:25.827 +02:00 [INF] Fetching patient with ID: 1
2025-11-24 02:41:25.828 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:41:25.830 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:41:25.831 +02:00 [DBG] Created DbConnection. (1ms).
2025-11-24 02:41:25.832 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:41:25.832 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:41:25.833 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:41:25.834 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:41:25.835 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 02:41:25.836 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 02:41:25.847 +02:00 [INF] Executed DbCommand (11ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 02:41:25.849 +02:00 [DBG] Context 'AppDbContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:41:25.850 +02:00 [DBG] The navigation 'Patient.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:41:25.851 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:41:25.853 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:41:25.853 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 4ms reading results.
2025-11-24 02:41:25.854 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:41:25.854 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:41:25.855 +02:00 [INF] Patient with ID 1 retrieved successfully
2025-11-24 02:41:25.859 +02:00 [INF] Fetching all tickets for Patient UserId de866516-28cb-4edd-a517-be658e2dc89c
2025-11-24 02:41:25.861 +02:00 [DBG] Compiling query expression: 
'DbSet<SupportTicket>()
    .Where(t => t.UserId == __patientId_0)
    .Include(t => t.User)
    .OrderByDescending(t => t.CreatedAt)'
2025-11-24 02:41:25.862 +02:00 [DBG] Including navigation: 'SupportTicket.User'.
2025-11-24 02:41:25.866 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<SupportTicket>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: SupportTicket.TicketId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: SupportTicket.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: SupportTicket.Message (string) Required, 2], [Property: SupportTicket.Response (string), 3], [Property: SupportTicket.Status (TicketStatus) Required MaxLength(20), 4], [Property: SupportTicket.Subject (string) Required MaxLength(200), 5], [Property: SupportTicket.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 6], [Property: SupportTicket.UserId (string) Required FK Index, 7] }
            1 -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 8], [Property: User.AccessFailedCount (int) Required, 9], [Property: User.ConcurrencyStamp (string) Concurrency, 10], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 11], [Property: User.DateOfBirth (DateOnly?), 12], [Property: User.Email (string) Index MaxLength(256), 13], [Property: User.EmailConfirmed (bool) Required, 14], [Property: User.FullName (string) Required MaxLength(150), 15], [Property: User.Gender (GenderType?) MaxLength(10), 16], [Property: User.LockoutEnabled (bool) Required, 17], [Property: User.LockoutEnd (DateTimeOffset?), 18], [Property: User.NormalizedEmail (string) Index MaxLength(256), 19], [Property: User.NormalizedUserName (string) Index MaxLength(256), 20], [Property: User.PasswordHash (string), 21], [Property: User.PhoneNumber (string), 22], [Property: User.PhoneNumberConfirmed (bool) Required, 23], [Property: User.RefreshToken (string), 24], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 25], [Property: User.Role (string) Required MaxLength(50), 26], [Property: User.SecurityStamp (string), 27], [Property: User.TwoFactorEnabled (bool) Required, 28], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 29], [Property: User.UserName (string) MaxLength(256), 30] }
        SELECT s.TicketId, s.CreatedAt, s.Message, s.Response, s.Status, s.Subject, s.UpdatedAt, s.UserId, u.Id, u.AccessFailedCount, u.ConcurrencyStamp, u.CreatedAt, u.DateOfBirth, u.Email, u.EmailConfirmed, u.FullName, u.Gender, u.LockoutEnabled, u.LockoutEnd, u.NormalizedEmail, u.NormalizedUserName, u.PasswordHash, u.PhoneNumber, u.PhoneNumberConfirmed, u.RefreshToken, u.RefreshTokenExpiryTime, u.Role, u.SecurityStamp, u.TwoFactorEnabled, u.UpdatedAt, u.UserName
        FROM SupportTickets AS s
        INNER JOIN Users AS u ON s.UserId == u.Id
        WHERE s.UserId == @__patientId_0
        ORDER BY s.CreatedAt DESC), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, SupportTicket>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 02:41:25.867 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:41:25.868 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:41:25.868 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:41:25.869 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:41:25.870 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:41:25.872 +02:00 [DBG] Executing DbCommand [Parameters=[@__patientId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[TicketId], [s].[CreatedAt], [s].[Message], [s].[Response], [s].[Status], [s].[Subject], [s].[UpdatedAt], [s].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [SupportTickets] AS [s]
INNER JOIN [Users] AS [u] ON [s].[UserId] = [u].[Id]
WHERE [s].[UserId] = @__patientId_0
ORDER BY [s].[CreatedAt] DESC
2025-11-24 02:41:25.877 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__patientId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[TicketId], [s].[CreatedAt], [s].[Message], [s].[Response], [s].[Status], [s].[Subject], [s].[UpdatedAt], [s].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [SupportTickets] AS [s]
INNER JOIN [Users] AS [u] ON [s].[UserId] = [u].[Id]
WHERE [s].[UserId] = @__patientId_0
ORDER BY [s].[CreatedAt] DESC
2025-11-24 02:41:25.881 +02:00 [DBG] Context 'AppDbContext' started tracking 'SupportTicket' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:41:25.882 +02:00 [DBG] Context 'AppDbContext' started tracking 'SupportTicket' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:41:25.884 +02:00 [DBG] Context 'AppDbContext' started tracking 'SupportTicket' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:41:25.885 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:41:25.886 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 5ms reading results.
2025-11-24 02:41:25.887 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:41:25.888 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:41:25.891 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:41:25.892 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:41:25.892 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:41:25.893 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:41:25.893 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:41:25.894 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.SupportTicket.SupportTicketDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 02:41:25.895 +02:00 [INF] Executed action Hospital.Controllers.SupportTicketController.GetAllByPatientId (Hospital) in 78.4326ms
2025-11-24 02:41:25.896 +02:00 [INF] Executed endpoint 'Hospital.Controllers.SupportTicketController.GetAllByPatientId (Hospital)'
2025-11-24 02:41:25.896 +02:00 [DBG] Connection id "0HNHAU3HQ5A6E" completed keep alive response.
2025-11-24 02:41:25.897 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:41:25.897 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:41:25.898 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:41:25.898 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/SupportTicket/patient/1 - 200 null application/json; charset=utf-8 97.3067ms
2025-11-24 02:41:33.669 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/SupportTicket/patient/10 - null null
2025-11-24 02:41:33.671 +02:00 [DBG] 1 candidate(s) found for the request path '/api/SupportTicket/patient/10'
2025-11-24 02:41:33.672 +02:00 [DBG] Endpoint 'Hospital.Controllers.SupportTicketController.GetAllByPatientId (Hospital)' with route pattern 'api/SupportTicket/patient/{patientId}' is valid for the request path '/api/SupportTicket/patient/10'
2025-11-24 02:41:33.673 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.SupportTicketController.GetAllByPatientId (Hospital)'
2025-11-24 02:41:33.673 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:41:33.674 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:41:33.674 +02:00 [INF] Executing endpoint 'Hospital.Controllers.SupportTicketController.GetAllByPatientId (Hospital)'
2025-11-24 02:41:33.675 +02:00 [INF] Route matched with {action = "GetAllByPatientId", controller = "SupportTicket"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IEnumerable`1[Hospital.Application.DTO.SupportTicket.SupportTicketDto]]] GetAllByPatientId(Int32) on controller Hospital.Controllers.SupportTicketController (Hospital).
2025-11-24 02:41:33.677 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:41:33.678 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:41:33.679 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:41:33.681 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:41:33.682 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:41:33.683 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.SupportTicketController (Hospital)
2025-11-24 02:41:33.685 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.SupportTicketController (Hospital)
2025-11-24 02:41:33.685 +02:00 [DBG] Attempting to bind parameter 'patientId' of type 'System.Int32' ...
2025-11-24 02:41:33.686 +02:00 [DBG] Attempting to bind parameter 'patientId' of type 'System.Int32' using the name 'patientId' in request data ...
2025-11-24 02:41:33.687 +02:00 [DBG] Done attempting to bind parameter 'patientId' of type 'System.Int32'.
2025-11-24 02:41:33.687 +02:00 [DBG] Done attempting to bind parameter 'patientId' of type 'System.Int32'.
2025-11-24 02:41:33.688 +02:00 [DBG] Attempting to validate the bound parameter 'patientId' of type 'System.Int32' ...
2025-11-24 02:41:33.690 +02:00 [DBG] Done attempting to validate the bound parameter 'patientId' of type 'System.Int32'.
2025-11-24 02:41:33.691 +02:00 [INF] get all Support Ticket  by patient id called at "2025-11-24T02:41:33.6911146+02:00"
2025-11-24 02:41:33.692 +02:00 [INF] Fetching patient with ID: 10
2025-11-24 02:41:33.693 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:41:33.695 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:41:33.695 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:41:33.696 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:41:33.697 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:41:33.697 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:41:33.698 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:41:33.698 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:41:33.699 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 02:41:33.702 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 02:41:33.706 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:41:33.706 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:41:33.708 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:41:33.709 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:41:33.710 +02:00 [WRN] Patient with ID 10 not found
2025-11-24 02:41:33.731 +02:00 [ERR] Error while fetching patient with ID: 10
System.Collections.Generic.KeyNotFoundException: Patient with ID 10 not found
   at Hospital.Infrastructure.Services.PatientService.GetPatientByIdAsync(Int32 id) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\PatientService.cs:line 34
2025-11-24 02:41:33.777 +02:00 [INF] Executed action Hospital.Controllers.SupportTicketController.GetAllByPatientId (Hospital) in 93.0878ms
2025-11-24 02:41:33.778 +02:00 [INF] Executed endpoint 'Hospital.Controllers.SupportTicketController.GetAllByPatientId (Hospital)'
2025-11-24 02:41:33.827 +02:00 [ERR]  Exception caught: Patient with ID 10 not found
System.Collections.Generic.KeyNotFoundException: Patient with ID 10 not found
   at Hospital.Infrastructure.Services.PatientService.GetPatientByIdAsync(Int32 id) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\PatientService.cs:line 34
   at Hospital.Controllers.SupportTicketController.GetAllByPatientId(Int32 patientId) in D:\Walaa\GP\Hospital\Hospital\Controllers\SupportTicketController.cs:line 96
   at lambda_method1178(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
2025-11-24 02:41:33.853 +02:00 [DBG] Connection id "0HNHAU3HQ5A6E" completed keep alive response.
2025-11-24 02:41:33.853 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:41:33.854 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:41:33.854 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:41:33.855 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/SupportTicket/patient/10 - 404 null application/json 185.9189ms
2025-11-24 02:41:58.179 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/SupportTicket/20 - null null
2025-11-24 02:41:58.182 +02:00 [DBG] 1 candidate(s) found for the request path '/api/SupportTicket/20'
2025-11-24 02:41:58.182 +02:00 [DBG] Endpoint 'Hospital.Controllers.SupportTicketController.GetById (Hospital)' with route pattern 'api/SupportTicket/{ticketId}' is valid for the request path '/api/SupportTicket/20'
2025-11-24 02:41:58.183 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.SupportTicketController.GetById (Hospital)'
2025-11-24 02:41:58.184 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:41:58.184 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:41:58.184 +02:00 [INF] Executing endpoint 'Hospital.Controllers.SupportTicketController.GetById (Hospital)'
2025-11-24 02:41:58.187 +02:00 [INF] Route matched with {action = "GetById", controller = "SupportTicket"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetById(Int32) on controller Hospital.Controllers.SupportTicketController (Hospital).
2025-11-24 02:41:58.189 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:41:58.190 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:41:58.191 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:41:58.192 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:41:58.194 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:41:58.194 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.SupportTicketController (Hospital)
2025-11-24 02:41:58.195 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.SupportTicketController (Hospital)
2025-11-24 02:41:58.197 +02:00 [DBG] Attempting to bind parameter 'ticketId' of type 'System.Int32' ...
2025-11-24 02:41:58.198 +02:00 [DBG] Attempting to bind parameter 'ticketId' of type 'System.Int32' using the name 'ticketId' in request data ...
2025-11-24 02:41:58.198 +02:00 [DBG] Done attempting to bind parameter 'ticketId' of type 'System.Int32'.
2025-11-24 02:41:58.199 +02:00 [DBG] Done attempting to bind parameter 'ticketId' of type 'System.Int32'.
2025-11-24 02:41:58.199 +02:00 [DBG] Attempting to validate the bound parameter 'ticketId' of type 'System.Int32' ...
2025-11-24 02:41:58.200 +02:00 [DBG] Done attempting to validate the bound parameter 'ticketId' of type 'System.Int32'.
2025-11-24 02:41:58.202 +02:00 [INF] get  Support by id Ticket called at "2025-11-24T02:41:58.2019870+02:00"
2025-11-24 02:41:58.203 +02:00 [INF] Fetching ticket 20
2025-11-24 02:41:58.205 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:41:58.207 +02:00 [DBG] Compiling query expression: 
'DbSet<SupportTicket>()
    .Include(t => t.User)
    .FirstOrDefault(t => t.TicketId == __ticketId_0)'
2025-11-24 02:41:58.208 +02:00 [DBG] Including navigation: 'SupportTicket.User'.
2025-11-24 02:41:58.213 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<SupportTicket>(
    asyncEnumerable: new SingleQueryingEnumerable<SupportTicket>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: SupportTicket.TicketId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: SupportTicket.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: SupportTicket.Message (string) Required, 2], [Property: SupportTicket.Response (string), 3], [Property: SupportTicket.Status (TicketStatus) Required MaxLength(20), 4], [Property: SupportTicket.Subject (string) Required MaxLength(200), 5], [Property: SupportTicket.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 6], [Property: SupportTicket.UserId (string) Required FK Index, 7] }
                1 -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 8], [Property: User.AccessFailedCount (int) Required, 9], [Property: User.ConcurrencyStamp (string) Concurrency, 10], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 11], [Property: User.DateOfBirth (DateOnly?), 12], [Property: User.Email (string) Index MaxLength(256), 13], [Property: User.EmailConfirmed (bool) Required, 14], [Property: User.FullName (string) Required MaxLength(150), 15], [Property: User.Gender (GenderType?) MaxLength(10), 16], [Property: User.LockoutEnabled (bool) Required, 17], [Property: User.LockoutEnd (DateTimeOffset?), 18], [Property: User.NormalizedEmail (string) Index MaxLength(256), 19], [Property: User.NormalizedUserName (string) Index MaxLength(256), 20], [Property: User.PasswordHash (string), 21], [Property: User.PhoneNumber (string), 22], [Property: User.PhoneNumberConfirmed (bool) Required, 23], [Property: User.RefreshToken (string), 24], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 25], [Property: User.Role (string) Required MaxLength(50), 26], [Property: User.SecurityStamp (string), 27], [Property: User.TwoFactorEnabled (bool) Required, 28], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 29], [Property: User.UserName (string) MaxLength(256), 30] }
            SELECT TOP(1) s.TicketId, s.CreatedAt, s.Message, s.Response, s.Status, s.Subject, s.UpdatedAt, s.UserId, u.Id, u.AccessFailedCount, u.ConcurrencyStamp, u.CreatedAt, u.DateOfBirth, u.Email, u.EmailConfirmed, u.FullName, u.Gender, u.LockoutEnabled, u.LockoutEnd, u.NormalizedEmail, u.NormalizedUserName, u.PasswordHash, u.PhoneNumber, u.PhoneNumberConfirmed, u.RefreshToken, u.RefreshTokenExpiryTime, u.Role, u.SecurityStamp, u.TwoFactorEnabled, u.UpdatedAt, u.UserName
            FROM SupportTickets AS s
            INNER JOIN Users AS u ON s.UserId == u.Id
            WHERE s.TicketId == @__ticketId_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, SupportTicket>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 02:41:58.215 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:41:58.216 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:41:58.216 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:41:58.217 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:41:58.217 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:41:58.218 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:41:58.218 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:41:58.220 +02:00 [DBG] Executing DbCommand [Parameters=[@__ticketId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[TicketId], [s].[CreatedAt], [s].[Message], [s].[Response], [s].[Status], [s].[Subject], [s].[UpdatedAt], [s].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [SupportTickets] AS [s]
INNER JOIN [Users] AS [u] ON [s].[UserId] = [u].[Id]
WHERE [s].[TicketId] = @__ticketId_0
2025-11-24 02:41:58.234 +02:00 [INF] Executed DbCommand (14ms) [Parameters=[@__ticketId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[TicketId], [s].[CreatedAt], [s].[Message], [s].[Response], [s].[Status], [s].[Subject], [s].[UpdatedAt], [s].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [SupportTickets] AS [s]
INNER JOIN [Users] AS [u] ON [s].[UserId] = [u].[Id]
WHERE [s].[TicketId] = @__ticketId_0
2025-11-24 02:41:58.237 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:41:58.238 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 02:41:58.239 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:41:58.240 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:41:58.241 +02:00 [WRN] Ticket 20 not found
2025-11-24 02:41:58.243 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:41:58.245 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:41:58.247 +02:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2025-11-24 02:41:58.248 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2025-11-24 02:41:58.249 +02:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-11-24 02:41:58.260 +02:00 [INF] Executed action Hospital.Controllers.SupportTicketController.GetById (Hospital) in 66.0453ms
2025-11-24 02:41:58.261 +02:00 [INF] Executed endpoint 'Hospital.Controllers.SupportTicketController.GetById (Hospital)'
2025-11-24 02:41:58.262 +02:00 [DBG] Connection id "0HNHAU3HQ5A6E" completed keep alive response.
2025-11-24 02:41:58.262 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:41:58.263 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:41:58.263 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:41:58.264 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/SupportTicket/20 - 404 null application/problem+json; charset=utf-8 84.5472ms
2025-11-24 02:42:02.914 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/SupportTicket/2 - null null
2025-11-24 02:42:02.917 +02:00 [DBG] 1 candidate(s) found for the request path '/api/SupportTicket/2'
2025-11-24 02:42:02.918 +02:00 [DBG] Endpoint 'Hospital.Controllers.SupportTicketController.GetById (Hospital)' with route pattern 'api/SupportTicket/{ticketId}' is valid for the request path '/api/SupportTicket/2'
2025-11-24 02:42:02.919 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.SupportTicketController.GetById (Hospital)'
2025-11-24 02:42:02.921 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:42:02.924 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:42:02.925 +02:00 [INF] Executing endpoint 'Hospital.Controllers.SupportTicketController.GetById (Hospital)'
2025-11-24 02:42:02.925 +02:00 [INF] Route matched with {action = "GetById", controller = "SupportTicket"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetById(Int32) on controller Hospital.Controllers.SupportTicketController (Hospital).
2025-11-24 02:42:02.926 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:42:02.927 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:42:02.927 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:42:02.928 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:42:02.929 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:42:02.929 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.SupportTicketController (Hospital)
2025-11-24 02:42:02.930 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.SupportTicketController (Hospital)
2025-11-24 02:42:02.931 +02:00 [DBG] Attempting to bind parameter 'ticketId' of type 'System.Int32' ...
2025-11-24 02:42:02.932 +02:00 [DBG] Attempting to bind parameter 'ticketId' of type 'System.Int32' using the name 'ticketId' in request data ...
2025-11-24 02:42:02.933 +02:00 [DBG] Done attempting to bind parameter 'ticketId' of type 'System.Int32'.
2025-11-24 02:42:02.933 +02:00 [DBG] Done attempting to bind parameter 'ticketId' of type 'System.Int32'.
2025-11-24 02:42:02.934 +02:00 [DBG] Attempting to validate the bound parameter 'ticketId' of type 'System.Int32' ...
2025-11-24 02:42:02.934 +02:00 [DBG] Done attempting to validate the bound parameter 'ticketId' of type 'System.Int32'.
2025-11-24 02:42:02.935 +02:00 [INF] get  Support by id Ticket called at "2025-11-24T02:42:02.9349962+02:00"
2025-11-24 02:42:02.935 +02:00 [INF] Fetching ticket 2
2025-11-24 02:42:02.936 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:42:02.937 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:42:02.937 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:42:02.938 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:42:02.939 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:42:02.939 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:42:02.940 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:42:02.940 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:42:02.941 +02:00 [DBG] Executing DbCommand [Parameters=[@__ticketId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[TicketId], [s].[CreatedAt], [s].[Message], [s].[Response], [s].[Status], [s].[Subject], [s].[UpdatedAt], [s].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [SupportTickets] AS [s]
INNER JOIN [Users] AS [u] ON [s].[UserId] = [u].[Id]
WHERE [s].[TicketId] = @__ticketId_0
2025-11-24 02:42:02.944 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__ticketId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[TicketId], [s].[CreatedAt], [s].[Message], [s].[Response], [s].[Status], [s].[Subject], [s].[UpdatedAt], [s].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [SupportTickets] AS [s]
INNER JOIN [Users] AS [u] ON [s].[UserId] = [u].[Id]
WHERE [s].[TicketId] = @__ticketId_0
2025-11-24 02:42:02.945 +02:00 [DBG] Context 'AppDbContext' started tracking 'SupportTicket' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:42:02.946 +02:00 [DBG] The navigation 'SupportTicket.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:42:02.947 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:42:02.948 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:42:02.949 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 3ms reading results.
2025-11-24 02:42:02.950 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:42:02.951 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:42:02.952 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:42:02.955 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:42:02.955 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:42:02.956 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:42:02.956 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:42:02.957 +02:00 [INF] Executing OkObjectResult, writing value of type 'Hospital.Application.DTO.SupportTicket.SupportTicketDto'.
2025-11-24 02:42:02.958 +02:00 [INF] Executed action Hospital.Controllers.SupportTicketController.GetById (Hospital) in 28.928ms
2025-11-24 02:42:02.959 +02:00 [INF] Executed endpoint 'Hospital.Controllers.SupportTicketController.GetById (Hospital)'
2025-11-24 02:42:02.960 +02:00 [DBG] Connection id "0HNHAU3HQ5A6E" completed keep alive response.
2025-11-24 02:42:02.960 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:42:02.961 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:42:02.962 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:42:02.962 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/SupportTicket/2 - 200 null application/json; charset=utf-8 48.3663ms
2025-11-24 02:44:25.255 +02:00 [DBG] Connection id "0HNHAU3HQ5A6F" received FIN.
2025-11-24 02:44:25.262 +02:00 [DBG] Connection id "0HNHAU3HQ5A6F" accepted.
2025-11-24 02:44:25.262 +02:00 [DBG] Connection id "0HNHAU3HQ5A6F" started.
2025-11-24 02:44:25.266 +02:00 [DBG] Connection id "0HNHAU3HQ5A6G" accepted.
2025-11-24 02:44:25.268 +02:00 [DBG] Connection id "0HNHAU3HQ5A6G" started.
2025-11-24 02:44:25.268 +02:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-11-24 02:44:25.274 +02:00 [DBG] Connection id "0HNHAU3HQ5A6F" stopped.
2025-11-24 02:44:25.275 +02:00 [DBG] Connection id "0HNHAU3HQ5A6F" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-11-24 02:44:25.275 +02:00 [DBG] Connection 0HNHAU3HQ5A6G established using the following protocol: "Tls12"
2025-11-24 02:44:25.281 +02:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7217/api/SupportTicket - application/json 64
2025-11-24 02:44:25.283 +02:00 [DBG] 1 candidate(s) found for the request path '/api/SupportTicket'
2025-11-24 02:44:25.284 +02:00 [DBG] Endpoint 'Hospital.Controllers.SupportTicketController.Update (Hospital)' with route pattern 'api/SupportTicket' is valid for the request path '/api/SupportTicket'
2025-11-24 02:44:25.285 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.SupportTicketController.Update (Hospital)'
2025-11-24 02:44:25.285 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:44:25.286 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:44:25.287 +02:00 [INF] Executing endpoint 'Hospital.Controllers.SupportTicketController.Update (Hospital)'
2025-11-24 02:44:25.291 +02:00 [INF] Route matched with {action = "Update", controller = "SupportTicket"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Update(Hospital.Application.DTO.SupportTicket.UpdateSupportTicketDto) on controller Hospital.Controllers.SupportTicketController (Hospital).
2025-11-24 02:44:25.292 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:44:25.293 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:44:25.294 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:44:25.295 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:44:25.297 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:44:25.299 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.SupportTicketController (Hospital)
2025-11-24 02:44:25.300 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.SupportTicketController (Hospital)
2025-11-24 02:44:25.301 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.SupportTicket.UpdateSupportTicketDto' ...
2025-11-24 02:44:25.302 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.SupportTicket.UpdateSupportTicketDto' using the name '' in request data ...
2025-11-24 02:44:25.304 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:44:25.309 +02:00 [DBG] Connection id "0HNHAU3HQ5A6G", Request id "0HNHAU3HQ5A6G:00000001": started reading request body.
2025-11-24 02:44:25.310 +02:00 [DBG] Connection id "0HNHAU3HQ5A6G", Request id "0HNHAU3HQ5A6G:00000001": done reading request body.
2025-11-24 02:44:25.313 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.SupportTicket.UpdateSupportTicketDto'
2025-11-24 02:44:25.314 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.SupportTicket.UpdateSupportTicketDto'.
2025-11-24 02:44:25.315 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.SupportTicket.UpdateSupportTicketDto'.
2025-11-24 02:44:25.317 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.SupportTicket.UpdateSupportTicketDto' ...
2025-11-24 02:44:25.321 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.SupportTicket.UpdateSupportTicketDto'.
2025-11-24 02:44:25.322 +02:00 [INF] update Support Ticket called at "2025-11-24T02:44:25.3228742+02:00"
2025-11-24 02:44:25.324 +02:00 [INF] Updating support ticket 3
2025-11-24 02:44:25.325 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:44:25.326 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:44:25.327 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:44:25.327 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:44:25.328 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:44:25.329 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:44:25.330 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:44:25.331 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 02:44:25.332 +02:00 [DBG] Executing DbCommand [Parameters=[@__ticketId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[TicketId], [s].[CreatedAt], [s].[Message], [s].[Response], [s].[Status], [s].[Subject], [s].[UpdatedAt], [s].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [SupportTickets] AS [s]
INNER JOIN [Users] AS [u] ON [s].[UserId] = [u].[Id]
WHERE [s].[TicketId] = @__ticketId_0
2025-11-24 02:44:25.339 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[@__ticketId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[TicketId], [s].[CreatedAt], [s].[Message], [s].[Response], [s].[Status], [s].[Subject], [s].[UpdatedAt], [s].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [SupportTickets] AS [s]
INNER JOIN [Users] AS [u] ON [s].[UserId] = [u].[Id]
WHERE [s].[TicketId] = @__ticketId_0
2025-11-24 02:44:25.341 +02:00 [DBG] Context 'AppDbContext' started tracking 'SupportTicket' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:44:25.342 +02:00 [DBG] The navigation 'SupportTicket.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:44:25.343 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:44:25.344 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:44:25.345 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 4ms reading results.
2025-11-24 02:44:25.346 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:44:25.346 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:44:25.350 +02:00 [DBG] An entity of type 'SupportTicket' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:44:25.351 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:44:25.352 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:44:25.353 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 02:44:25.353 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:44:25.354 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:44:25.355 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:44:25.356 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:44:25.357 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:44:25.357 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:44:25.358 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:44:25.359 +02:00 [DBG] Executing DbCommand [Parameters=[@p7='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (Size = 20), @p4='?' (Size = 200), @p5='?' (DbType = DateTime2), @p6='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [SupportTickets] SET [CreatedAt] = @p0, [Message] = @p1, [Response] = @p2, [Status] = @p3, [Subject] = @p4, [UpdatedAt] = @p5, [UserId] = @p6
OUTPUT 1
WHERE [TicketId] = @p7;
2025-11-24 02:44:25.364 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p7='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (Size = 20), @p4='?' (Size = 200), @p5='?' (DbType = DateTime2), @p6='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [SupportTickets] SET [CreatedAt] = @p0, [Message] = @p1, [Response] = @p2, [Status] = @p3, [Subject] = @p4, [UpdatedAt] = @p5, [UserId] = @p6
OUTPUT 1
WHERE [TicketId] = @p7;
2025-11-24 02:44:25.366 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:44:25.367 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 02:44:25.368 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:44:25.369 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:44:25.370 +02:00 [DBG] An entity of type 'SupportTicket' tracked by 'AppDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:44:25.372 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 02:44:25.373 +02:00 [INF] Ticket 3 updated successfully
2025-11-24 02:44:25.374 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:44:25.375 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:44:25.377 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:44:25.379 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:44:25.380 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:44:25.381 +02:00 [INF] Executing OkObjectResult, writing value of type 'Hospital.Application.DTO.SupportTicket.SupportTicketDto'.
2025-11-24 02:44:25.382 +02:00 [INF] Executed action Hospital.Controllers.SupportTicketController.Update (Hospital) in 82.4043ms
2025-11-24 02:44:25.382 +02:00 [INF] Executed endpoint 'Hospital.Controllers.SupportTicketController.Update (Hospital)'
2025-11-24 02:44:25.383 +02:00 [DBG] Connection id "0HNHAU3HQ5A6G" completed keep alive response.
2025-11-24 02:44:25.384 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:44:25.385 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:44:25.386 +02:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-11-24 02:44:25.387 +02:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7217/api/SupportTicket - 200 null application/json; charset=utf-8 105.311ms
2025-11-24 02:44:34.404 +02:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7217/api/SupportTicket - application/json 64
2025-11-24 02:44:34.405 +02:00 [DBG] 1 candidate(s) found for the request path '/api/SupportTicket'
2025-11-24 02:44:34.406 +02:00 [DBG] Endpoint 'Hospital.Controllers.SupportTicketController.Update (Hospital)' with route pattern 'api/SupportTicket' is valid for the request path '/api/SupportTicket'
2025-11-24 02:44:34.407 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.SupportTicketController.Update (Hospital)'
2025-11-24 02:44:34.407 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:44:34.408 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:44:34.408 +02:00 [INF] Executing endpoint 'Hospital.Controllers.SupportTicketController.Update (Hospital)'
2025-11-24 02:44:34.409 +02:00 [INF] Route matched with {action = "Update", controller = "SupportTicket"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Update(Hospital.Application.DTO.SupportTicket.UpdateSupportTicketDto) on controller Hospital.Controllers.SupportTicketController (Hospital).
2025-11-24 02:44:34.410 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:44:34.411 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:44:34.412 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:44:34.413 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:44:34.414 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:44:34.414 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.SupportTicketController (Hospital)
2025-11-24 02:44:34.415 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.SupportTicketController (Hospital)
2025-11-24 02:44:34.416 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.SupportTicket.UpdateSupportTicketDto' ...
2025-11-24 02:44:34.417 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.SupportTicket.UpdateSupportTicketDto' using the name '' in request data ...
2025-11-24 02:44:34.418 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:44:34.420 +02:00 [DBG] Connection id "0HNHAU3HQ5A6G", Request id "0HNHAU3HQ5A6G:00000002": started reading request body.
2025-11-24 02:44:34.421 +02:00 [DBG] Connection id "0HNHAU3HQ5A6G", Request id "0HNHAU3HQ5A6G:00000002": done reading request body.
2025-11-24 02:44:34.421 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.SupportTicket.UpdateSupportTicketDto'
2025-11-24 02:44:34.422 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.SupportTicket.UpdateSupportTicketDto'.
2025-11-24 02:44:34.422 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.SupportTicket.UpdateSupportTicketDto'.
2025-11-24 02:44:34.423 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.SupportTicket.UpdateSupportTicketDto' ...
2025-11-24 02:44:34.423 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.SupportTicket.UpdateSupportTicketDto'.
2025-11-24 02:44:34.424 +02:00 [INF] update Support Ticket called at "2025-11-24T02:44:34.4244245+02:00"
2025-11-24 02:44:34.425 +02:00 [INF] Updating support ticket 3
2025-11-24 02:44:34.426 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:44:34.427 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:44:34.428 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:44:34.429 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:44:34.430 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:44:34.431 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:44:34.431 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:44:34.431 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:44:34.432 +02:00 [DBG] Executing DbCommand [Parameters=[@__ticketId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[TicketId], [s].[CreatedAt], [s].[Message], [s].[Response], [s].[Status], [s].[Subject], [s].[UpdatedAt], [s].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [SupportTickets] AS [s]
INNER JOIN [Users] AS [u] ON [s].[UserId] = [u].[Id]
WHERE [s].[TicketId] = @__ticketId_0
2025-11-24 02:44:34.434 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__ticketId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[TicketId], [s].[CreatedAt], [s].[Message], [s].[Response], [s].[Status], [s].[Subject], [s].[UpdatedAt], [s].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [SupportTickets] AS [s]
INNER JOIN [Users] AS [u] ON [s].[UserId] = [u].[Id]
WHERE [s].[TicketId] = @__ticketId_0
2025-11-24 02:44:34.436 +02:00 [DBG] Context 'AppDbContext' started tracking 'SupportTicket' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:44:34.436 +02:00 [DBG] The navigation 'SupportTicket.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:44:34.437 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:44:34.438 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:44:34.438 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 2ms reading results.
2025-11-24 02:44:34.439 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:44:34.439 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:44:34.441 +02:00 [DBG] An entity of type 'SupportTicket' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:44:34.442 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:44:34.442 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:44:34.443 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 02:44:34.444 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:44:34.445 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:44:34.446 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:44:34.447 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:44:34.447 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:44:34.448 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:44:34.448 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:44:34.449 +02:00 [DBG] Executing DbCommand [Parameters=[@p7='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (Size = 20), @p4='?' (Size = 200), @p5='?' (DbType = DateTime2), @p6='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [SupportTickets] SET [CreatedAt] = @p0, [Message] = @p1, [Response] = @p2, [Status] = @p3, [Subject] = @p4, [UpdatedAt] = @p5, [UserId] = @p6
OUTPUT 1
WHERE [TicketId] = @p7;
2025-11-24 02:44:34.455 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@p7='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (Size = 20), @p4='?' (Size = 200), @p5='?' (DbType = DateTime2), @p6='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [SupportTickets] SET [CreatedAt] = @p0, [Message] = @p1, [Response] = @p2, [Status] = @p3, [Subject] = @p4, [UpdatedAt] = @p5, [UserId] = @p6
OUTPUT 1
WHERE [TicketId] = @p7;
2025-11-24 02:44:34.456 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:44:34.457 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:44:34.457 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:44:34.458 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:44:34.459 +02:00 [DBG] An entity of type 'SupportTicket' tracked by 'AppDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:44:34.460 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 02:44:34.460 +02:00 [INF] Ticket 3 updated successfully
2025-11-24 02:44:34.461 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:44:34.463 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:44:34.464 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:44:34.464 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:44:34.464 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:44:34.465 +02:00 [INF] Executing OkObjectResult, writing value of type 'Hospital.Application.DTO.SupportTicket.SupportTicketDto'.
2025-11-24 02:44:34.467 +02:00 [INF] Executed action Hospital.Controllers.SupportTicketController.Update (Hospital) in 52.3994ms
2025-11-24 02:44:34.467 +02:00 [INF] Executed endpoint 'Hospital.Controllers.SupportTicketController.Update (Hospital)'
2025-11-24 02:44:34.468 +02:00 [DBG] Connection id "0HNHAU3HQ5A6G" completed keep alive response.
2025-11-24 02:44:34.469 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:44:34.469 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:44:34.470 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:44:34.471 +02:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7217/api/SupportTicket - 200 null application/json; charset=utf-8 66.8192ms
2025-11-24 02:44:43.490 +02:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7217/api/SupportTicket - application/json 64
2025-11-24 02:44:43.493 +02:00 [DBG] 1 candidate(s) found for the request path '/api/SupportTicket'
2025-11-24 02:44:43.494 +02:00 [DBG] Endpoint 'Hospital.Controllers.SupportTicketController.Update (Hospital)' with route pattern 'api/SupportTicket' is valid for the request path '/api/SupportTicket'
2025-11-24 02:44:43.495 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.SupportTicketController.Update (Hospital)'
2025-11-24 02:44:43.495 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:44:43.496 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:44:43.496 +02:00 [INF] Executing endpoint 'Hospital.Controllers.SupportTicketController.Update (Hospital)'
2025-11-24 02:44:43.497 +02:00 [INF] Route matched with {action = "Update", controller = "SupportTicket"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Update(Hospital.Application.DTO.SupportTicket.UpdateSupportTicketDto) on controller Hospital.Controllers.SupportTicketController (Hospital).
2025-11-24 02:44:43.497 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:44:43.499 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:44:43.500 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:44:43.502 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:44:43.503 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:44:43.503 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.SupportTicketController (Hospital)
2025-11-24 02:44:43.504 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.SupportTicketController (Hospital)
2025-11-24 02:44:43.504 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.SupportTicket.UpdateSupportTicketDto' ...
2025-11-24 02:44:43.505 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.SupportTicket.UpdateSupportTicketDto' using the name '' in request data ...
2025-11-24 02:44:43.505 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:44:43.507 +02:00 [DBG] Connection id "0HNHAU3HQ5A6G", Request id "0HNHAU3HQ5A6G:00000003": started reading request body.
2025-11-24 02:44:43.507 +02:00 [DBG] Connection id "0HNHAU3HQ5A6G", Request id "0HNHAU3HQ5A6G:00000003": done reading request body.
2025-11-24 02:44:43.508 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.SupportTicket.UpdateSupportTicketDto'
2025-11-24 02:44:43.509 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.SupportTicket.UpdateSupportTicketDto'.
2025-11-24 02:44:43.510 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.SupportTicket.UpdateSupportTicketDto'.
2025-11-24 02:44:43.510 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.SupportTicket.UpdateSupportTicketDto' ...
2025-11-24 02:44:43.511 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.SupportTicket.UpdateSupportTicketDto'.
2025-11-24 02:44:43.512 +02:00 [INF] update Support Ticket called at "2025-11-24T02:44:43.5124357+02:00"
2025-11-24 02:44:43.513 +02:00 [INF] Updating support ticket 3
2025-11-24 02:44:43.514 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:44:43.515 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:44:43.515 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:44:43.515 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:44:43.516 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:44:43.517 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:44:43.517 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:44:43.518 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:44:43.519 +02:00 [DBG] Executing DbCommand [Parameters=[@__ticketId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[TicketId], [s].[CreatedAt], [s].[Message], [s].[Response], [s].[Status], [s].[Subject], [s].[UpdatedAt], [s].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [SupportTickets] AS [s]
INNER JOIN [Users] AS [u] ON [s].[UserId] = [u].[Id]
WHERE [s].[TicketId] = @__ticketId_0
2025-11-24 02:44:43.522 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__ticketId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[TicketId], [s].[CreatedAt], [s].[Message], [s].[Response], [s].[Status], [s].[Subject], [s].[UpdatedAt], [s].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [SupportTickets] AS [s]
INNER JOIN [Users] AS [u] ON [s].[UserId] = [u].[Id]
WHERE [s].[TicketId] = @__ticketId_0
2025-11-24 02:44:43.524 +02:00 [DBG] Context 'AppDbContext' started tracking 'SupportTicket' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:44:43.524 +02:00 [DBG] The navigation 'SupportTicket.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:44:43.525 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:44:43.526 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:44:43.526 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 2ms reading results.
2025-11-24 02:44:43.528 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:44:43.528 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:44:43.529 +02:00 [WRN] Invalid ticket status "9" for TicketId 3
2025-11-24 02:44:43.558 +02:00 [INF] Executed action Hospital.Controllers.SupportTicketController.Update (Hospital) in 54.9479ms
2025-11-24 02:44:43.559 +02:00 [INF] Executed endpoint 'Hospital.Controllers.SupportTicketController.Update (Hospital)'
2025-11-24 02:44:43.595 +02:00 [ERR]  Exception caught: Invalid ticket status. Allowed values: Open, InProgress, Resolved, Closed.
System.ArgumentException: Invalid ticket status. Allowed values: Open, InProgress, Resolved, Closed.
   at Hospital.Infrastructure.Services.SupportTicketService.UpdateAsync(UpdateSupportTicketDto dto) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\SupportTicketService.cs:line 85
   at Hospital.Controllers.SupportTicketController.Update(UpdateSupportTicketDto dto) in D:\Walaa\GP\Hospital\Hospital\Controllers\SupportTicketController.cs:line 113
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
2025-11-24 02:44:43.606 +02:00 [DBG] Connection id "0HNHAU3HQ5A6G" completed keep alive response.
2025-11-24 02:44:43.607 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:44:43.608 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:44:43.608 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:44:43.609 +02:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7217/api/SupportTicket - 400 null application/json 119.014ms
2025-11-24 02:44:56.964 +02:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7217/api/SupportTicket - application/json 64
2025-11-24 02:44:56.965 +02:00 [DBG] 1 candidate(s) found for the request path '/api/SupportTicket'
2025-11-24 02:44:56.966 +02:00 [DBG] Endpoint 'Hospital.Controllers.SupportTicketController.Update (Hospital)' with route pattern 'api/SupportTicket' is valid for the request path '/api/SupportTicket'
2025-11-24 02:44:56.967 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.SupportTicketController.Update (Hospital)'
2025-11-24 02:44:56.967 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:44:56.968 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:44:56.969 +02:00 [INF] Executing endpoint 'Hospital.Controllers.SupportTicketController.Update (Hospital)'
2025-11-24 02:44:56.970 +02:00 [INF] Route matched with {action = "Update", controller = "SupportTicket"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Update(Hospital.Application.DTO.SupportTicket.UpdateSupportTicketDto) on controller Hospital.Controllers.SupportTicketController (Hospital).
2025-11-24 02:44:56.971 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:44:56.971 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:44:56.972 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:44:56.973 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:44:56.973 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:44:56.974 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.SupportTicketController (Hospital)
2025-11-24 02:44:56.975 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.SupportTicketController (Hospital)
2025-11-24 02:44:56.975 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.SupportTicket.UpdateSupportTicketDto' ...
2025-11-24 02:44:56.976 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.SupportTicket.UpdateSupportTicketDto' using the name '' in request data ...
2025-11-24 02:44:56.976 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:44:56.977 +02:00 [DBG] Connection id "0HNHAU3HQ5A6G", Request id "0HNHAU3HQ5A6G:00000004": started reading request body.
2025-11-24 02:44:56.977 +02:00 [DBG] Connection id "0HNHAU3HQ5A6G", Request id "0HNHAU3HQ5A6G:00000004": done reading request body.
2025-11-24 02:44:56.978 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.SupportTicket.UpdateSupportTicketDto'
2025-11-24 02:44:56.978 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.SupportTicket.UpdateSupportTicketDto'.
2025-11-24 02:44:56.979 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.SupportTicket.UpdateSupportTicketDto'.
2025-11-24 02:44:56.980 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.SupportTicket.UpdateSupportTicketDto' ...
2025-11-24 02:44:56.981 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.SupportTicket.UpdateSupportTicketDto'.
2025-11-24 02:44:56.981 +02:00 [INF] update Support Ticket called at "2025-11-24T02:44:56.9816201+02:00"
2025-11-24 02:44:56.982 +02:00 [INF] Updating support ticket 3
2025-11-24 02:44:56.982 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:44:56.984 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:44:56.985 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:44:56.985 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:44:56.986 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:44:56.986 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:44:56.987 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:44:56.987 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:44:56.987 +02:00 [DBG] Executing DbCommand [Parameters=[@__ticketId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[TicketId], [s].[CreatedAt], [s].[Message], [s].[Response], [s].[Status], [s].[Subject], [s].[UpdatedAt], [s].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [SupportTickets] AS [s]
INNER JOIN [Users] AS [u] ON [s].[UserId] = [u].[Id]
WHERE [s].[TicketId] = @__ticketId_0
2025-11-24 02:44:56.991 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__ticketId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[TicketId], [s].[CreatedAt], [s].[Message], [s].[Response], [s].[Status], [s].[Subject], [s].[UpdatedAt], [s].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [SupportTickets] AS [s]
INNER JOIN [Users] AS [u] ON [s].[UserId] = [u].[Id]
WHERE [s].[TicketId] = @__ticketId_0
2025-11-24 02:44:56.994 +02:00 [DBG] Context 'AppDbContext' started tracking 'SupportTicket' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:44:56.995 +02:00 [DBG] The navigation 'SupportTicket.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:44:56.996 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:44:56.997 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:44:56.997 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 3ms reading results.
2025-11-24 02:44:56.998 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:44:56.999 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 02:44:57.000 +02:00 [DBG] An entity of type 'SupportTicket' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:44:57.001 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:44:57.001 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:44:57.002 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 02:44:57.002 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:44:57.002 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:44:57.003 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:44:57.003 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:44:57.004 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:44:57.005 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:44:57.006 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:44:57.006 +02:00 [DBG] Executing DbCommand [Parameters=[@p7='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (Size = 20), @p4='?' (Size = 200), @p5='?' (DbType = DateTime2), @p6='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [SupportTickets] SET [CreatedAt] = @p0, [Message] = @p1, [Response] = @p2, [Status] = @p3, [Subject] = @p4, [UpdatedAt] = @p5, [UserId] = @p6
OUTPUT 1
WHERE [TicketId] = @p7;
2025-11-24 02:44:57.008 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@p7='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (Size = 20), @p4='?' (Size = 200), @p5='?' (DbType = DateTime2), @p6='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [SupportTickets] SET [CreatedAt] = @p0, [Message] = @p1, [Response] = @p2, [Status] = @p3, [Subject] = @p4, [UpdatedAt] = @p5, [UserId] = @p6
OUTPUT 1
WHERE [TicketId] = @p7;
2025-11-24 02:44:57.010 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:44:57.011 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:44:57.012 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:44:57.012 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:44:57.013 +02:00 [DBG] An entity of type 'SupportTicket' tracked by 'AppDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:44:57.014 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 02:44:57.015 +02:00 [INF] Ticket 3 updated successfully
2025-11-24 02:44:57.016 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:44:57.017 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:44:57.017 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:44:57.018 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:44:57.018 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:44:57.018 +02:00 [INF] Executing OkObjectResult, writing value of type 'Hospital.Application.DTO.SupportTicket.SupportTicketDto'.
2025-11-24 02:44:57.019 +02:00 [INF] Executed action Hospital.Controllers.SupportTicketController.Update (Hospital) in 45.1519ms
2025-11-24 02:44:57.020 +02:00 [INF] Executed endpoint 'Hospital.Controllers.SupportTicketController.Update (Hospital)'
2025-11-24 02:44:57.021 +02:00 [DBG] Connection id "0HNHAU3HQ5A6G" completed keep alive response.
2025-11-24 02:44:57.021 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:44:57.022 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:44:57.022 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:44:57.023 +02:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7217/api/SupportTicket - 200 null application/json; charset=utf-8 58.7247ms
2025-11-24 02:45:45.487 +02:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7217/api/SupportTicket/2 - null null
2025-11-24 02:45:45.490 +02:00 [DBG] 1 candidate(s) found for the request path '/api/SupportTicket/2'
2025-11-24 02:45:45.492 +02:00 [DBG] Endpoint 'Hospital.Controllers.SupportTicketController.Delete (Hospital)' with route pattern 'api/SupportTicket/{ticketId}' is valid for the request path '/api/SupportTicket/2'
2025-11-24 02:45:45.493 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.SupportTicketController.Delete (Hospital)'
2025-11-24 02:45:45.494 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:45:45.495 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:45:45.496 +02:00 [INF] Executing endpoint 'Hospital.Controllers.SupportTicketController.Delete (Hospital)'
2025-11-24 02:45:45.499 +02:00 [INF] Route matched with {action = "Delete", controller = "SupportTicket"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Delete(Int32) on controller Hospital.Controllers.SupportTicketController (Hospital).
2025-11-24 02:45:45.500 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:45:45.501 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:45:45.501 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:45:45.502 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:45:45.503 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:45:45.503 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.SupportTicketController (Hospital)
2025-11-24 02:45:45.504 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.SupportTicketController (Hospital)
2025-11-24 02:45:45.504 +02:00 [DBG] Attempting to bind parameter 'ticketId' of type 'System.Int32' ...
2025-11-24 02:45:45.505 +02:00 [DBG] Attempting to bind parameter 'ticketId' of type 'System.Int32' using the name 'ticketId' in request data ...
2025-11-24 02:45:45.505 +02:00 [DBG] Done attempting to bind parameter 'ticketId' of type 'System.Int32'.
2025-11-24 02:45:45.506 +02:00 [DBG] Done attempting to bind parameter 'ticketId' of type 'System.Int32'.
2025-11-24 02:45:45.506 +02:00 [DBG] Attempting to validate the bound parameter 'ticketId' of type 'System.Int32' ...
2025-11-24 02:45:45.507 +02:00 [DBG] Done attempting to validate the bound parameter 'ticketId' of type 'System.Int32'.
2025-11-24 02:45:45.508 +02:00 [INF] delete Support Ticket called at "2025-11-24T02:45:45.5082343+02:00"
2025-11-24 02:45:45.510 +02:00 [INF] Deleting ticket 2
2025-11-24 02:45:45.511 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:45:45.513 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:45:45.513 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:45:45.513 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:45:45.514 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:45:45.515 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:45:45.515 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:45:45.516 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:45:45.516 +02:00 [DBG] Executing DbCommand [Parameters=[@__ticketId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[TicketId], [s].[CreatedAt], [s].[Message], [s].[Response], [s].[Status], [s].[Subject], [s].[UpdatedAt], [s].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [SupportTickets] AS [s]
INNER JOIN [Users] AS [u] ON [s].[UserId] = [u].[Id]
WHERE [s].[TicketId] = @__ticketId_0
2025-11-24 02:45:45.524 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[@__ticketId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[TicketId], [s].[CreatedAt], [s].[Message], [s].[Response], [s].[Status], [s].[Subject], [s].[UpdatedAt], [s].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [SupportTickets] AS [s]
INNER JOIN [Users] AS [u] ON [s].[UserId] = [u].[Id]
WHERE [s].[TicketId] = @__ticketId_0
2025-11-24 02:45:45.526 +02:00 [DBG] Context 'AppDbContext' started tracking 'SupportTicket' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:45:45.527 +02:00 [DBG] The navigation 'SupportTicket.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:45:45.527 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:45:45.528 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:45:45.529 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 3ms reading results.
2025-11-24 02:45:45.530 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:45:45.530 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:45:45.532 +02:00 [DBG] An entity of type 'SupportTicket' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Deleted"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:45:45.534 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:45:45.535 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:45:45.535 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 02:45:45.536 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:45:45.536 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:45:45.538 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:45:45.539 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:45:45.540 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:45:45.541 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:45:45.542 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 02:45:45.543 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [SupportTickets]
OUTPUT 1
WHERE [TicketId] = @p0;
2025-11-24 02:45:45.554 +02:00 [INF] Executed DbCommand (12ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [SupportTickets]
OUTPUT 1
WHERE [TicketId] = @p0;
2025-11-24 02:45:45.555 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:45:45.556 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:45:45.557 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:45:45.557 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:45:45.561 +02:00 [DBG] An entity of type 'SupportTicket' tracked by 'AppDbContext' changed state from '"Deleted"' to '"Detached"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:45:45.562 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 02:45:45.562 +02:00 [INF] Ticket 2 deleted successfully
2025-11-24 02:45:45.563 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:45:45.564 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:45:45.564 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:45:45.564 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:45:45.565 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter' and content type 'text/plain' to write the response.
2025-11-24 02:45:45.565 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.String'.
2025-11-24 02:45:45.566 +02:00 [INF] Executed action Hospital.Controllers.SupportTicketController.Delete (Hospital) in 62.4865ms
2025-11-24 02:45:45.566 +02:00 [INF] Executed endpoint 'Hospital.Controllers.SupportTicketController.Delete (Hospital)'
2025-11-24 02:45:45.567 +02:00 [DBG] Connection id "0HNHAU3HQ5A6G" completed keep alive response.
2025-11-24 02:45:45.567 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:45:45.567 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:45:45.568 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:45:45.569 +02:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7217/api/SupportTicket/2 - 200 null text/plain; charset=utf-8 81.2606ms
2025-11-24 02:45:54.953 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/SupportTicket - null null
2025-11-24 02:45:54.955 +02:00 [DBG] 1 candidate(s) found for the request path '/api/SupportTicket'
2025-11-24 02:45:54.955 +02:00 [DBG] Endpoint 'Hospital.Controllers.SupportTicketController.GetAll (Hospital)' with route pattern 'api/SupportTicket' is valid for the request path '/api/SupportTicket'
2025-11-24 02:45:54.956 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.SupportTicketController.GetAll (Hospital)'
2025-11-24 02:45:54.956 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:45:54.957 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:45:54.957 +02:00 [INF] Executing endpoint 'Hospital.Controllers.SupportTicketController.GetAll (Hospital)'
2025-11-24 02:45:54.958 +02:00 [INF] Route matched with {action = "GetAll", controller = "SupportTicket"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll() on controller Hospital.Controllers.SupportTicketController (Hospital).
2025-11-24 02:45:54.958 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:45:54.959 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:45:54.960 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:45:54.961 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:45:54.961 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:45:54.962 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.SupportTicketController (Hospital)
2025-11-24 02:45:54.963 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.SupportTicketController (Hospital)
2025-11-24 02:45:54.963 +02:00 [INF] get all Support Ticket called at "2025-11-24T02:45:54.9637883+02:00"
2025-11-24 02:45:54.964 +02:00 [INF] Fetching all support tickets in the system
2025-11-24 02:45:54.964 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:45:54.965 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:45:54.966 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:45:54.966 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:45:54.967 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:45:54.968 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:45:54.968 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:45:54.969 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:45:54.970 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[TicketId], [s].[CreatedAt], [s].[Message], [s].[Response], [s].[Status], [s].[Subject], [s].[UpdatedAt], [s].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [SupportTickets] AS [s]
INNER JOIN [Users] AS [u] ON [s].[UserId] = [u].[Id]
ORDER BY [s].[CreatedAt] DESC
2025-11-24 02:45:54.974 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[TicketId], [s].[CreatedAt], [s].[Message], [s].[Response], [s].[Status], [s].[Subject], [s].[UpdatedAt], [s].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [SupportTickets] AS [s]
INNER JOIN [Users] AS [u] ON [s].[UserId] = [u].[Id]
ORDER BY [s].[CreatedAt] DESC
2025-11-24 02:45:54.975 +02:00 [DBG] Context 'AppDbContext' started tracking 'SupportTicket' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:45:54.976 +02:00 [DBG] The navigation 'SupportTicket.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:45:54.977 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:45:54.977 +02:00 [DBG] Context 'AppDbContext' started tracking 'SupportTicket' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:45:54.978 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:45:54.979 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 3ms reading results.
2025-11-24 02:45:54.979 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:45:54.980 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:45:54.981 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:45:54.983 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:45:54.983 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:45:54.984 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:45:54.985 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:45:54.986 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.SupportTicket.SupportTicketDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 02:45:54.987 +02:00 [INF] Executed action Hospital.Controllers.SupportTicketController.GetAll (Hospital) in 24.4841ms
2025-11-24 02:45:54.987 +02:00 [INF] Executed endpoint 'Hospital.Controllers.SupportTicketController.GetAll (Hospital)'
2025-11-24 02:45:54.988 +02:00 [DBG] Connection id "0HNHAU3HQ5A6G" completed keep alive response.
2025-11-24 02:45:54.988 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:45:54.989 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:45:54.990 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:45:54.991 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/SupportTicket - 200 null application/json; charset=utf-8 37.9543ms
2025-11-24 02:46:15.863 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Patient/1 - null null
2025-11-24 02:46:15.864 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Patient/1'
2025-11-24 02:46:15.865 +02:00 [DBG] Endpoint 'Hospital.Controllers.PatientController.GetPatientById (Hospital)' with route pattern 'api/Patient/{id}' is valid for the request path '/api/Patient/1'
2025-11-24 02:46:15.866 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.PatientController.GetPatientById (Hospital)'
2025-11-24 02:46:15.867 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:46:15.867 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:46:15.868 +02:00 [INF] Executing endpoint 'Hospital.Controllers.PatientController.GetPatientById (Hospital)'
2025-11-24 02:46:15.870 +02:00 [INF] Route matched with {action = "GetPatientById", controller = "Patient"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPatientById(Int32) on controller Hospital.Controllers.PatientController (Hospital).
2025-11-24 02:46:15.871 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:46:15.872 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:46:15.873 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:46:15.875 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:46:15.876 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:46:15.876 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.PatientController (Hospital)
2025-11-24 02:46:15.877 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.PatientController (Hospital)
2025-11-24 02:46:15.878 +02:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-11-24 02:46:15.878 +02:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-11-24 02:46:15.880 +02:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-11-24 02:46:15.881 +02:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-11-24 02:46:15.881 +02:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-11-24 02:46:15.882 +02:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-11-24 02:46:15.883 +02:00 [INF] get patient by id called at "2025-11-24T02:46:15.8836365+02:00"
2025-11-24 02:46:15.884 +02:00 [INF] Fetching patient with ID: 1
2025-11-24 02:46:15.884 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:46:15.886 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:46:15.887 +02:00 [DBG] Created DbConnection. (1ms).
2025-11-24 02:46:15.887 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:46:15.888 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:46:15.888 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:46:15.889 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:46:15.890 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:46:15.891 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 02:46:15.902 +02:00 [INF] Executed DbCommand (11ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 02:46:15.904 +02:00 [DBG] Context 'AppDbContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:46:15.905 +02:00 [DBG] The navigation 'Patient.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:46:15.905 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:46:15.906 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:46:15.906 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 2ms reading results.
2025-11-24 02:46:15.907 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:46:15.908 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:46:15.908 +02:00 [INF] Patient with ID 1 retrieved successfully
2025-11-24 02:46:15.909 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:46:15.910 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:46:15.911 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:46:15.911 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:46:15.912 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:46:15.912 +02:00 [INF] Executing OkObjectResult, writing value of type 'Hospital.Application.DTO.Patient.PatientDto'.
2025-11-24 02:46:15.915 +02:00 [INF] Executed action Hospital.Controllers.PatientController.GetPatientById (Hospital) in 38.3688ms
2025-11-24 02:46:15.915 +02:00 [INF] Executed endpoint 'Hospital.Controllers.PatientController.GetPatientById (Hospital)'
2025-11-24 02:46:15.916 +02:00 [DBG] Connection id "0HNHAU3HQ5A6G" completed keep alive response.
2025-11-24 02:46:15.917 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:46:15.918 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:46:15.918 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:46:15.919 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Patient/1 - 200 null application/json; charset=utf-8 56.372ms
2025-11-24 02:46:31.871 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/MedicalRecord - application/json 147
2025-11-24 02:46:31.872 +02:00 [DBG] 1 candidate(s) found for the request path '/api/MedicalRecord'
2025-11-24 02:46:31.873 +02:00 [DBG] Endpoint 'Hospital.Controllers.MedicalRecordController.Add (Hospital)' with route pattern 'api/MedicalRecord' is valid for the request path '/api/MedicalRecord'
2025-11-24 02:46:31.874 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.MedicalRecordController.Add (Hospital)'
2025-11-24 02:46:31.874 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:46:31.875 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:46:31.875 +02:00 [INF] Executing endpoint 'Hospital.Controllers.MedicalRecordController.Add (Hospital)'
2025-11-24 02:46:31.878 +02:00 [INF] Route matched with {action = "Add", controller = "MedicalRecord"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Hospital.Application.DTO.MedicalRecord.PatientMedicalRecordDto]] Add(Hospital.Application.DTO.MedicalRecord.AddMedicalRecordDto) on controller Hospital.Controllers.MedicalRecordController (Hospital).
2025-11-24 02:46:31.879 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:46:31.880 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:46:31.881 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:46:31.882 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:46:31.883 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:46:31.883 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.MedicalRecordController (Hospital)
2025-11-24 02:46:31.885 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.MedicalRecordController (Hospital)
2025-11-24 02:46:31.885 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.MedicalRecord.AddMedicalRecordDto' ...
2025-11-24 02:46:31.886 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.MedicalRecord.AddMedicalRecordDto' using the name '' in request data ...
2025-11-24 02:46:31.886 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:46:31.887 +02:00 [DBG] Connection id "0HNHAU3HQ5A6G", Request id "0HNHAU3HQ5A6G:00000008": started reading request body.
2025-11-24 02:46:31.888 +02:00 [DBG] Connection id "0HNHAU3HQ5A6G", Request id "0HNHAU3HQ5A6G:00000008": done reading request body.
2025-11-24 02:46:31.889 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.MedicalRecord.AddMedicalRecordDto'
2025-11-24 02:46:31.890 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.MedicalRecord.AddMedicalRecordDto'.
2025-11-24 02:46:31.891 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.MedicalRecord.AddMedicalRecordDto'.
2025-11-24 02:46:31.891 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.MedicalRecord.AddMedicalRecordDto' ...
2025-11-24 02:46:31.893 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.MedicalRecord.AddMedicalRecordDto'.
2025-11-24 02:46:31.894 +02:00 [INF] add medical record  called at "2025-11-24T02:46:31.8948114+02:00"
2025-11-24 02:46:31.896 +02:00 [INF] Adding medical record for DoctorId 1, PatientId 1, AppointmentId 1
2025-11-24 02:46:31.898 +02:00 [INF] Fetching doctor with ID 1
2025-11-24 02:46:31.899 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:46:31.900 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:46:31.901 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:46:31.901 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:46:31.902 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:46:31.903 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:46:31.903 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:46:31.904 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:46:31.904 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:46:31.914 +02:00 [INF] Executed DbCommand (10ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:46:31.916 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:46:31.917 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:46:31.917 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:46:31.918 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:46:31.918 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:46:31.920 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:46:31.920 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:46:31.921 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:46:31.922 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 5ms reading results.
2025-11-24 02:46:31.922 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:46:31.923 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:46:31.923 +02:00 [INF] Fetching patient with ID: 1
2025-11-24 02:46:31.924 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:46:31.925 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:46:31.925 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:46:31.926 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:46:31.927 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:46:31.927 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 02:46:31.940 +02:00 [INF] Executed DbCommand (13ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 02:46:31.943 +02:00 [DBG] Context 'AppDbContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:46:31.943 +02:00 [DBG] The navigation 'Patient.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:46:31.944 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:46:31.944 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:46:31.945 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 2ms reading results.
2025-11-24 02:46:31.945 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:46:31.946 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:46:31.946 +02:00 [INF] Patient with ID 1 retrieved successfully
2025-11-24 02:46:31.948 +02:00 [INF] Fetching appointment by ID: 1
2025-11-24 02:46:31.950 +02:00 [DBG] Compiling query expression: 
'DbSet<Appointment>()
    .Include(a => a.Patient)
    .Include(a => a.Doctor)
    .Include(a => a.Branch)
    .FirstOrDefault(a => a.AppointmentId == __id_0)'
2025-11-24 02:46:31.951 +02:00 [DBG] Including navigation: 'Appointment.Patient'.
2025-11-24 02:46:31.952 +02:00 [DBG] Including navigation: 'Appointment.Doctor'.
2025-11-24 02:46:31.953 +02:00 [DBG] Including navigation: 'Appointment.Branch'.
2025-11-24 02:46:31.961 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Appointment>(
    asyncEnumerable: new SingleQueryingEnumerable<Appointment>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Appointment.AppointmentId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Appointment.BranchId (int) Required FK Index, 1], [Property: Appointment.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 2], [Property: Appointment.CreatedBy (string) FK Index, 3], [Property: Appointment.Date (DateOnly) Required, 4], [Property: Appointment.DoctorId (int) Required FK Index, 5], [Property: Appointment.Notes (string), 6], [Property: Appointment.PatientId (int) Required FK Index, 7], [Property: Appointment.PaymentMethod (PaymentMethod) Required, 8], [Property: Appointment.Status (AppointmentStatus) Required MaxLength(20), 9], [Property: Appointment.Time (DateTime) Required, 10], [Property: Appointment.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 11] }
                1 -> Dictionary<IProperty, int> { [Property: Patient.PatientId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 12], [Property: Patient.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 13], [Property: Patient.EmergencyContact (string) MaxLength(150), 14], [Property: Patient.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 15], [Property: Patient.UserId (string) Required FK Index, 16] }
                2 -> Dictionary<IProperty, int> { [Property: Doctor.DoctorId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 17], [Property: Doctor.Available (bool?), 18], [Property: Doctor.Biography (string), 19], [Property: Doctor.ConsultationFees (decimal) Required, 20], [Property: Doctor.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 21], [Property: Doctor.ExperienceYears (int?), 22], [Property: Doctor.ImageURL (string) MaxLength(300), 23], [Property: Doctor.SpecializationId (int) Required FK Index, 24], [Property: Doctor.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 25], [Property: Doctor.UserId (string) Required FK Index, 26] }
                3 -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 27], [Property: Branch.Address (string) MaxLength(250), 28], [Property: Branch.BranchName (string) Required MaxLength(150), 29], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 30], [Property: Branch.Description (string), 31], [Property: Branch.Email (string) MaxLength(200), 32], [Property: Branch.ImageURL (string) MaxLength(300), 33], [Property: Branch.Phone (string) MaxLength(25), 34], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 35] }
            SELECT TOP(1) a.AppointmentId, a.BranchId, a.CreatedAt, a.CreatedBy, a.Date, a.DoctorId, a.Notes, a.PatientId, a.PaymentMethod, a.Status, a.Time, a.UpdatedAt, p.PatientId, p.CreatedAt, p.EmergencyContact, p.UpdatedAt, p.UserId, d.DoctorId, d.Available, d.Biography, d.ConsultationFees, d.CreatedAt, d.ExperienceYears, d.ImageURL, d.SpecializationId, d.UpdatedAt, d.UserId, b.BranchId, b.Address, b.BranchName, b.CreatedAt, b.Description, b.Email, b.ImageURL, b.Phone, b.UpdatedAt
            FROM Appointments AS a
            INNER JOIN Patients AS p ON a.PatientId == p.PatientId
            INNER JOIN Doctors AS d ON a.DoctorId == d.DoctorId
            INNER JOIN Branches AS b ON a.BranchId == b.BranchId
            WHERE a.AppointmentId == @__id_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Appointment>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 02:46:31.963 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:46:31.964 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:46:31.964 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:46:31.964 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:46:31.965 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:46:31.965 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Doctors] AS [d] ON [a].[DoctorId] = [d].[DoctorId]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[AppointmentId] = @__id_0
2025-11-24 02:46:31.971 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Doctors] AS [d] ON [a].[DoctorId] = [d].[DoctorId]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[AppointmentId] = @__id_0
2025-11-24 02:46:31.974 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:46:31.974 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 02:46:31.975 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:46:31.976 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:46:31.976 +02:00 [WRN] Appointment with ID 1 not found
2025-11-24 02:46:31.977 +02:00 [WRN] Appointment with Id 1 not found
2025-11-24 02:46:32.009 +02:00 [INF] Executed action Hospital.Controllers.MedicalRecordController.Add (Hospital) in 125.7732ms
2025-11-24 02:46:32.010 +02:00 [INF] Executed endpoint 'Hospital.Controllers.MedicalRecordController.Add (Hospital)'
2025-11-24 02:46:32.038 +02:00 [ERR]  Exception caught: Appointment with Id 1 not found
System.Exception: Appointment with Id 1 not found
   at Hospital.Infrastructure.Services.MedicalRecordService.AddAsync(AddMedicalRecordDto dto) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\MedicalRecordService.cs:line 68
   at Hospital.Controllers.MedicalRecordController.Add(AddMedicalRecordDto dto) in D:\Walaa\GP\Hospital\Hospital\Controllers\MedicalRecordController.cs:line 26
   at lambda_method1226(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
2025-11-24 02:46:32.047 +02:00 [DBG] Connection id "0HNHAU3HQ5A6G" completed keep alive response.
2025-11-24 02:46:32.048 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:46:32.049 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:46:32.051 +02:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-11-24 02:46:32.052 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/MedicalRecord - 500 null application/json 181.6301ms
2025-11-24 02:46:42.125 +02:00 [DBG] Connection id "0HNHAU3HQ5A6C" received FIN.
2025-11-24 02:46:42.125 +02:00 [DBG] Connection id "0HNHAU3HQ5A6A" received FIN.
2025-11-24 02:46:42.132 +02:00 [DBG] Connection id "0HNHAU3HQ5A6G" received FIN.
2025-11-24 02:46:42.138 +02:00 [DBG] Connection id "0HNHAU3HQ5A6A" disconnecting.
2025-11-24 02:46:42.146 +02:00 [DBG] Connection id "0HNHAU3HQ5A6G" disconnecting.
2025-11-24 02:46:42.125 +02:00 [DBG] Connection id "0HNHAU3HQ5A6E" received FIN.
2025-11-24 02:46:42.136 +02:00 [DBG] Connection id "0HNHAU3HQ5A6C" disconnecting.
2025-11-24 02:46:42.154 +02:00 [DBG] Connection id "0HNHAU3HQ5A6A" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-11-24 02:46:42.171 +02:00 [DBG] Connection id "0HNHAU3HQ5A6C" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-11-24 02:46:42.169 +02:00 [DBG] Connection id "0HNHAU3HQ5A6G" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-11-24 02:46:42.170 +02:00 [DBG] Connection id "0HNHAU3HQ5A6E" disconnecting.
2025-11-24 02:46:42.190 +02:00 [DBG] Connection id "0HNHAU3HQ5A6E" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-11-24 02:46:42.198 +02:00 [DBG] Connection id "0HNHAU3HQ5A6C" stopped.
2025-11-24 02:46:42.198 +02:00 [DBG] Connection id "0HNHAU3HQ5A6A" stopped.
2025-11-24 02:46:42.198 +02:00 [DBG] Connection id "0HNHAU3HQ5A6E" stopped.
2025-11-24 02:46:42.198 +02:00 [DBG] Connection id "0HNHAU3HQ5A6G" stopped.
2025-11-24 02:46:53.303 +02:00 [DBG] Connection id "0HNHAU3HQ5A6H" accepted.
2025-11-24 02:46:53.304 +02:00 [DBG] Connection id "0HNHAU3HQ5A6H" started.
2025-11-24 02:46:53.304 +02:00 [DBG] Connection id "0HNHAU3HQ5A6H" received FIN.
2025-11-24 02:46:53.304 +02:00 [DBG] Connection id "0HNHAU3HQ5A6I" accepted.
2025-11-24 02:46:53.306 +02:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-11-24 02:46:53.306 +02:00 [DBG] Connection id "0HNHAU3HQ5A6I" started.
2025-11-24 02:46:53.308 +02:00 [DBG] Connection id "0HNHAU3HQ5A6H" stopped.
2025-11-24 02:46:53.309 +02:00 [DBG] Connection id "0HNHAU3HQ5A6H" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-11-24 02:46:53.313 +02:00 [DBG] Connection 0HNHAU3HQ5A6I established using the following protocol: "Tls12"
2025-11-24 02:46:53.314 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/MedicalRecord - application/json 147
2025-11-24 02:46:53.315 +02:00 [DBG] 1 candidate(s) found for the request path '/api/MedicalRecord'
2025-11-24 02:46:53.316 +02:00 [DBG] Endpoint 'Hospital.Controllers.MedicalRecordController.Add (Hospital)' with route pattern 'api/MedicalRecord' is valid for the request path '/api/MedicalRecord'
2025-11-24 02:46:53.317 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.MedicalRecordController.Add (Hospital)'
2025-11-24 02:46:53.317 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:46:53.318 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:46:53.319 +02:00 [INF] Executing endpoint 'Hospital.Controllers.MedicalRecordController.Add (Hospital)'
2025-11-24 02:46:53.320 +02:00 [INF] Route matched with {action = "Add", controller = "MedicalRecord"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Hospital.Application.DTO.MedicalRecord.PatientMedicalRecordDto]] Add(Hospital.Application.DTO.MedicalRecord.AddMedicalRecordDto) on controller Hospital.Controllers.MedicalRecordController (Hospital).
2025-11-24 02:46:53.322 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:46:53.323 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:46:53.324 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:46:53.325 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:46:53.325 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:46:53.326 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.MedicalRecordController (Hospital)
2025-11-24 02:46:53.327 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.MedicalRecordController (Hospital)
2025-11-24 02:46:53.328 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.MedicalRecord.AddMedicalRecordDto' ...
2025-11-24 02:46:53.329 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.MedicalRecord.AddMedicalRecordDto' using the name '' in request data ...
2025-11-24 02:46:53.331 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:46:53.331 +02:00 [DBG] Connection id "0HNHAU3HQ5A6I", Request id "0HNHAU3HQ5A6I:00000001": started reading request body.
2025-11-24 02:46:53.332 +02:00 [DBG] Connection id "0HNHAU3HQ5A6I", Request id "0HNHAU3HQ5A6I:00000001": done reading request body.
2025-11-24 02:46:53.333 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.MedicalRecord.AddMedicalRecordDto'
2025-11-24 02:46:53.333 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.MedicalRecord.AddMedicalRecordDto'.
2025-11-24 02:46:53.334 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.MedicalRecord.AddMedicalRecordDto'.
2025-11-24 02:46:53.334 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.MedicalRecord.AddMedicalRecordDto' ...
2025-11-24 02:46:53.335 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.MedicalRecord.AddMedicalRecordDto'.
2025-11-24 02:46:53.335 +02:00 [INF] add medical record  called at "2025-11-24T02:46:53.3355986+02:00"
2025-11-24 02:46:53.336 +02:00 [INF] Adding medical record for DoctorId 1, PatientId 1, AppointmentId 1
2025-11-24 02:46:53.336 +02:00 [INF] Fetching doctor with ID 1
2025-11-24 02:46:53.337 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:46:53.338 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:46:53.338 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:46:53.339 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:46:53.339 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:46:53.340 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:46:53.340 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:46:53.341 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:46:53.341 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:46:53.350 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:46:53.353 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:46:53.354 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:46:53.355 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:46:53.356 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:46:53.357 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:46:53.358 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:46:53.358 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:46:53.359 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:46:53.360 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 6ms reading results.
2025-11-24 02:46:53.360 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:46:53.361 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:46:53.362 +02:00 [INF] Fetching patient with ID: 1
2025-11-24 02:46:53.363 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:46:53.363 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:46:53.364 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:46:53.364 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:46:53.364 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:46:53.365 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 02:46:53.373 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 02:46:53.376 +02:00 [DBG] Context 'AppDbContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:46:53.377 +02:00 [DBG] The navigation 'Patient.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:46:53.378 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:46:53.379 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:46:53.379 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 3ms reading results.
2025-11-24 02:46:53.381 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:46:53.381 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:46:53.382 +02:00 [INF] Patient with ID 1 retrieved successfully
2025-11-24 02:46:53.382 +02:00 [INF] Fetching appointment by ID: 1
2025-11-24 02:46:53.383 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:46:53.384 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:46:53.384 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:46:53.384 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:46:53.385 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:46:53.385 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Doctors] AS [d] ON [a].[DoctorId] = [d].[DoctorId]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[AppointmentId] = @__id_0
2025-11-24 02:46:53.390 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Doctors] AS [d] ON [a].[DoctorId] = [d].[DoctorId]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[AppointmentId] = @__id_0
2025-11-24 02:46:53.392 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:46:53.393 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 02:46:53.395 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:46:53.397 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 02:46:53.398 +02:00 [WRN] Appointment with ID 1 not found
2025-11-24 02:46:53.399 +02:00 [WRN] Appointment with Id 1 not found
2025-11-24 02:46:53.424 +02:00 [INF] Executed action Hospital.Controllers.MedicalRecordController.Add (Hospital) in 98.7117ms
2025-11-24 02:46:53.425 +02:00 [INF] Executed endpoint 'Hospital.Controllers.MedicalRecordController.Add (Hospital)'
2025-11-24 02:46:53.455 +02:00 [ERR]  Exception caught: Appointment with Id 1 not found
System.Exception: Appointment with Id 1 not found
   at Hospital.Infrastructure.Services.MedicalRecordService.AddAsync(AddMedicalRecordDto dto) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\MedicalRecordService.cs:line 68
   at Hospital.Controllers.MedicalRecordController.Add(AddMedicalRecordDto dto) in D:\Walaa\GP\Hospital\Hospital\Controllers\MedicalRecordController.cs:line 26
   at lambda_method1226(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
2025-11-24 02:46:53.463 +02:00 [DBG] Connection id "0HNHAU3HQ5A6I" completed keep alive response.
2025-11-24 02:46:53.464 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:46:53.465 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:46:53.465 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:46:53.465 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/MedicalRecord - 500 null application/json 151.4548ms
2025-11-24 02:47:27.816 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Appointment - application/json 181
2025-11-24 02:47:27.822 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Appointment'
2025-11-24 02:47:27.823 +02:00 [DBG] Endpoint 'Hospital.API.Controllers.AppointmentController.Add (Hospital)' with route pattern 'api/Appointment' is valid for the request path '/api/Appointment'
2025-11-24 02:47:27.824 +02:00 [DBG] Request matched endpoint 'Hospital.API.Controllers.AppointmentController.Add (Hospital)'
2025-11-24 02:47:27.825 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:47:27.825 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:47:27.826 +02:00 [INF] Executing endpoint 'Hospital.API.Controllers.AppointmentController.Add (Hospital)'
2025-11-24 02:47:27.828 +02:00 [INF] Route matched with {action = "Add", controller = "Appointment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Add(Hospital.Application.DTO.Appointment.AddAppointmentDto) on controller Hospital.API.Controllers.AppointmentController (Hospital).
2025-11-24 02:47:27.829 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:47:27.830 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:47:27.831 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:47:27.832 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:47:27.832 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:47:27.833 +02:00 [DBG] Executing controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 02:47:27.834 +02:00 [DBG] Executed controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 02:47:27.835 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto' ...
2025-11-24 02:47:27.835 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto' using the name '' in request data ...
2025-11-24 02:47:27.836 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:47:27.844 +02:00 [DBG] Connection id "0HNHAU3HQ5A6I", Request id "0HNHAU3HQ5A6I:00000002": started reading request body.
2025-11-24 02:47:27.845 +02:00 [DBG] Connection id "0HNHAU3HQ5A6I", Request id "0HNHAU3HQ5A6I:00000002": done reading request body.
2025-11-24 02:47:27.851 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Appointment.AddAppointmentDto'
2025-11-24 02:47:27.852 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto'.
2025-11-24 02:47:27.852 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto'.
2025-11-24 02:47:27.853 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto' ...
2025-11-24 02:47:27.856 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto'.
2025-11-24 02:47:27.858 +02:00 [INF] Add Appointment called at "2025-11-24T02:47:27.8584280+02:00"
2025-11-24 02:47:27.860 +02:00 [INF] Creating appointment for PatientId: 2, DoctorId: 2, Date: "2025-11-23", Time: "2025-11-23T15:33:47.5410000Z"
2025-11-24 02:47:27.865 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:47:27.867 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:47:27.867 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:47:27.871 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:47:27.873 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:47:27.874 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 02:47:27.874 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 02:47:27.875 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:47:27.875 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:47:27.876 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:47:27.876 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 02:47:27.879 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 02:47:27.882 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:47:27.883 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:47:27.883 +02:00 [WRN] Patient with ID 2 not found
2025-11-24 02:47:27.898 +02:00 [DBG] Rolling back transaction.
2025-11-24 02:47:27.899 +02:00 [DBG] Rolled back transaction.
2025-11-24 02:47:27.899 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:47:27.900 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 02:47:27.901 +02:00 [ERR] Failed to create appointment for PatientId: 2, DoctorId: 2
System.ArgumentException: Patient does not exist.
   at Hospital.Infrastructure.Services.AppointmentService.AddAsync(AddAppointmentDto dto) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\AppointmentService.cs:line 61
2025-11-24 02:47:27.914 +02:00 [DBG] Disposing transaction.
2025-11-24 02:47:27.943 +02:00 [INF] Executed action Hospital.API.Controllers.AppointmentController.Add (Hospital) in 109.6962ms
2025-11-24 02:47:27.944 +02:00 [INF] Executed endpoint 'Hospital.API.Controllers.AppointmentController.Add (Hospital)'
2025-11-24 02:47:27.975 +02:00 [ERR]  Exception caught: Patient does not exist.
System.ArgumentException: Patient does not exist.
   at Hospital.Infrastructure.Services.AppointmentService.AddAsync(AddAppointmentDto dto) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\AppointmentService.cs:line 61
   at Hospital.Infrastructure.Services.AppointmentService.AddAsync(AddAppointmentDto dto) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\AppointmentService.cs:line 128
   at Hospital.Infrastructure.Services.AppointmentService.AddAsync(AddAppointmentDto dto) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\AppointmentService.cs:line 129
   at Hospital.API.Controllers.AppointmentController.Add(AddAppointmentDto dto) in D:\Walaa\GP\Hospital\Hospital\Controllers\AppointmentController.cs:line 27
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
2025-11-24 02:47:27.985 +02:00 [DBG] Connection id "0HNHAU3HQ5A6I" completed keep alive response.
2025-11-24 02:47:27.985 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:47:27.986 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:47:27.987 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:47:27.988 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Appointment - 400 null application/json 172.0701ms
2025-11-24 02:47:34.279 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Appointment - application/json 181
2025-11-24 02:47:34.281 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Appointment'
2025-11-24 02:47:34.282 +02:00 [DBG] Endpoint 'Hospital.API.Controllers.AppointmentController.Add (Hospital)' with route pattern 'api/Appointment' is valid for the request path '/api/Appointment'
2025-11-24 02:47:34.282 +02:00 [DBG] Request matched endpoint 'Hospital.API.Controllers.AppointmentController.Add (Hospital)'
2025-11-24 02:47:34.283 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:47:34.283 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:47:34.284 +02:00 [INF] Executing endpoint 'Hospital.API.Controllers.AppointmentController.Add (Hospital)'
2025-11-24 02:47:34.285 +02:00 [INF] Route matched with {action = "Add", controller = "Appointment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Add(Hospital.Application.DTO.Appointment.AddAppointmentDto) on controller Hospital.API.Controllers.AppointmentController (Hospital).
2025-11-24 02:47:34.286 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:47:34.286 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:47:34.287 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:47:34.288 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:47:34.289 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:47:34.289 +02:00 [DBG] Executing controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 02:47:34.290 +02:00 [DBG] Executed controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 02:47:34.291 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto' ...
2025-11-24 02:47:34.292 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto' using the name '' in request data ...
2025-11-24 02:47:34.294 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:47:34.294 +02:00 [DBG] Connection id "0HNHAU3HQ5A6I", Request id "0HNHAU3HQ5A6I:00000003": started reading request body.
2025-11-24 02:47:34.295 +02:00 [DBG] Connection id "0HNHAU3HQ5A6I", Request id "0HNHAU3HQ5A6I:00000003": done reading request body.
2025-11-24 02:47:34.295 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Appointment.AddAppointmentDto'
2025-11-24 02:47:34.296 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto'.
2025-11-24 02:47:34.296 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto'.
2025-11-24 02:47:34.297 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto' ...
2025-11-24 02:47:34.297 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto'.
2025-11-24 02:47:34.300 +02:00 [INF] Add Appointment called at "2025-11-24T02:47:34.3000896+02:00"
2025-11-24 02:47:34.301 +02:00 [INF] Creating appointment for PatientId: 1, DoctorId: 2, Date: "2025-11-23", Time: "2025-11-23T15:33:47.5410000Z"
2025-11-24 02:47:34.303 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:47:34.308 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:47:34.309 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:47:34.309 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:47:34.310 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:47:34.311 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 02:47:34.311 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 02:47:34.312 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:47:34.313 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:47:34.313 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:47:34.314 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 02:47:34.318 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 02:47:34.326 +02:00 [DBG] Context 'AppDbContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:34.327 +02:00 [DBG] The navigation 'Patient.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:34.328 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:34.330 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:47:34.331 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 4ms reading results.
2025-11-24 02:47:34.332 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:47:34.332 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:47:34.333 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:47:34.334 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:47:34.339 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:47:34.341 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:34.342 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:34.342 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:34.343 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:34.344 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:34.345 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:34.346 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:34.347 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:34.347 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:47:34.348 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 7ms reading results.
2025-11-24 02:47:34.351 +02:00 [DBG] Compiling query expression: 
'DbSet<Branch>()
    .FirstOrDefault(e => e.BranchId == __id_0)'
2025-11-24 02:47:34.354 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Branch>(
    asyncEnumerable: new SingleQueryingEnumerable<Branch>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Branch.Address (string) MaxLength(250), 1], [Property: Branch.BranchName (string) Required MaxLength(150), 2], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 3], [Property: Branch.Description (string), 4], [Property: Branch.Email (string) MaxLength(200), 5], [Property: Branch.ImageURL (string) MaxLength(300), 6], [Property: Branch.Phone (string) MaxLength(25), 7], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 8] }
            SELECT TOP(1) b.BranchId, b.Address, b.BranchName, b.CreatedAt, b.Description, b.Email, b.ImageURL, b.Phone, b.UpdatedAt
            FROM Branches AS b
            WHERE b.BranchId == @__id_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Branch>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 02:47:34.355 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:47:34.356 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:47:34.357 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:47:34.357 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 02:47:34.360 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 02:47:34.362 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:47:34.363 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 02:47:34.364 +02:00 [WRN] Branch with ID 1 not found
2025-11-24 02:47:34.378 +02:00 [DBG] Rolling back transaction.
2025-11-24 02:47:34.378 +02:00 [DBG] Rolled back transaction.
2025-11-24 02:47:34.379 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:47:34.379 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:47:34.380 +02:00 [ERR] Failed to create appointment for PatientId: 1, DoctorId: 2
System.ArgumentException: Branch does not exist.
   at Hospital.Infrastructure.Services.AppointmentService.AddAsync(AddAppointmentDto dto) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\AppointmentService.cs:line 75
2025-11-24 02:47:34.394 +02:00 [DBG] Disposing transaction.
2025-11-24 02:47:34.420 +02:00 [INF] Executed action Hospital.API.Controllers.AppointmentController.Add (Hospital) in 130.4972ms
2025-11-24 02:47:34.421 +02:00 [INF] Executed endpoint 'Hospital.API.Controllers.AppointmentController.Add (Hospital)'
2025-11-24 02:47:34.449 +02:00 [ERR]  Exception caught: Branch does not exist.
System.ArgumentException: Branch does not exist.
   at Hospital.Infrastructure.Services.AppointmentService.AddAsync(AddAppointmentDto dto) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\AppointmentService.cs:line 75
   at Hospital.Infrastructure.Services.AppointmentService.AddAsync(AddAppointmentDto dto) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\AppointmentService.cs:line 128
   at Hospital.Infrastructure.Services.AppointmentService.AddAsync(AddAppointmentDto dto) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\AppointmentService.cs:line 129
   at Hospital.API.Controllers.AppointmentController.Add(AddAppointmentDto dto) in D:\Walaa\GP\Hospital\Hospital\Controllers\AppointmentController.cs:line 27
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
2025-11-24 02:47:34.455 +02:00 [DBG] Connection id "0HNHAU3HQ5A6I" completed keep alive response.
2025-11-24 02:47:34.455 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:47:34.456 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:47:34.456 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:47:34.457 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Appointment - 400 null application/json 178.1751ms
2025-11-24 02:47:40.281 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Appointment - application/json 181
2025-11-24 02:47:40.282 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Appointment'
2025-11-24 02:47:40.283 +02:00 [DBG] Endpoint 'Hospital.API.Controllers.AppointmentController.Add (Hospital)' with route pattern 'api/Appointment' is valid for the request path '/api/Appointment'
2025-11-24 02:47:40.284 +02:00 [DBG] Request matched endpoint 'Hospital.API.Controllers.AppointmentController.Add (Hospital)'
2025-11-24 02:47:40.284 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:47:40.285 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:47:40.285 +02:00 [INF] Executing endpoint 'Hospital.API.Controllers.AppointmentController.Add (Hospital)'
2025-11-24 02:47:40.286 +02:00 [INF] Route matched with {action = "Add", controller = "Appointment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Add(Hospital.Application.DTO.Appointment.AddAppointmentDto) on controller Hospital.API.Controllers.AppointmentController (Hospital).
2025-11-24 02:47:40.287 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:47:40.287 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:47:40.290 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:47:40.291 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:47:40.292 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:47:40.293 +02:00 [DBG] Executing controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 02:47:40.295 +02:00 [DBG] Executed controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 02:47:40.296 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto' ...
2025-11-24 02:47:40.297 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto' using the name '' in request data ...
2025-11-24 02:47:40.298 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:47:40.299 +02:00 [DBG] Connection id "0HNHAU3HQ5A6I", Request id "0HNHAU3HQ5A6I:00000004": started reading request body.
2025-11-24 02:47:40.300 +02:00 [DBG] Connection id "0HNHAU3HQ5A6I", Request id "0HNHAU3HQ5A6I:00000004": done reading request body.
2025-11-24 02:47:40.301 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Appointment.AddAppointmentDto'
2025-11-24 02:47:40.302 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto'.
2025-11-24 02:47:40.304 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto'.
2025-11-24 02:47:40.307 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto' ...
2025-11-24 02:47:40.310 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto'.
2025-11-24 02:47:40.311 +02:00 [INF] Add Appointment called at "2025-11-24T02:47:40.3111213+02:00"
2025-11-24 02:47:40.312 +02:00 [INF] Creating appointment for PatientId: 1, DoctorId: 2, Date: "2025-11-23", Time: "2025-11-23T15:33:47.5410000Z"
2025-11-24 02:47:40.314 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:47:40.316 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:47:40.317 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:47:40.318 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:47:40.320 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:47:40.321 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 02:47:40.323 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 02:47:40.324 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:47:40.324 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:47:40.325 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:47:40.326 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 02:47:40.344 +02:00 [INF] Executed DbCommand (18ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 02:47:40.350 +02:00 [DBG] Context 'AppDbContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:40.352 +02:00 [DBG] The navigation 'Patient.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:40.354 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:40.355 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:47:40.356 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 5ms reading results.
2025-11-24 02:47:40.357 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:47:40.358 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:47:40.359 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:47:40.360 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:47:40.374 +02:00 [INF] Executed DbCommand (13ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:47:40.378 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:40.379 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:40.381 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:40.383 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:40.384 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:40.386 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:40.387 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:40.389 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:40.390 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:47:40.391 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 13ms reading results.
2025-11-24 02:47:40.393 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:47:40.394 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:47:40.395 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:47:40.396 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 02:47:40.400 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 02:47:40.402 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:47:40.403 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 02:47:40.417 +02:00 [DBG] Rolling back transaction.
2025-11-24 02:47:40.418 +02:00 [DBG] Rolled back transaction.
2025-11-24 02:47:40.420 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:47:40.421 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:47:40.422 +02:00 [ERR] Failed to create appointment for PatientId: 1, DoctorId: 2
System.ArgumentException: Appointment date cannot be in the past.
   at Hospital.Infrastructure.Services.AppointmentService.AddAsync(AddAppointmentDto dto) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\AppointmentService.cs:line 85
2025-11-24 02:47:40.438 +02:00 [DBG] Disposing transaction.
2025-11-24 02:47:40.466 +02:00 [INF] Executed action Hospital.API.Controllers.AppointmentController.Add (Hospital) in 172.7866ms
2025-11-24 02:47:40.467 +02:00 [INF] Executed endpoint 'Hospital.API.Controllers.AppointmentController.Add (Hospital)'
2025-11-24 02:47:40.497 +02:00 [ERR]  Exception caught: Appointment date cannot be in the past.
System.ArgumentException: Appointment date cannot be in the past.
   at Hospital.Infrastructure.Services.AppointmentService.AddAsync(AddAppointmentDto dto) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\AppointmentService.cs:line 85
   at Hospital.Infrastructure.Services.AppointmentService.AddAsync(AddAppointmentDto dto) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\AppointmentService.cs:line 128
   at Hospital.Infrastructure.Services.AppointmentService.AddAsync(AddAppointmentDto dto) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\AppointmentService.cs:line 129
   at Hospital.API.Controllers.AppointmentController.Add(AddAppointmentDto dto) in D:\Walaa\GP\Hospital\Hospital\Controllers\AppointmentController.cs:line 27
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
2025-11-24 02:47:40.505 +02:00 [DBG] Connection id "0HNHAU3HQ5A6I" completed keep alive response.
2025-11-24 02:47:40.506 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:47:40.507 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:47:40.508 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:47:40.509 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Appointment - 400 null application/json 227.9ms
2025-11-24 02:47:47.450 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Appointment - application/json 181
2025-11-24 02:47:47.453 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Appointment'
2025-11-24 02:47:47.455 +02:00 [DBG] Endpoint 'Hospital.API.Controllers.AppointmentController.Add (Hospital)' with route pattern 'api/Appointment' is valid for the request path '/api/Appointment'
2025-11-24 02:47:47.457 +02:00 [DBG] Request matched endpoint 'Hospital.API.Controllers.AppointmentController.Add (Hospital)'
2025-11-24 02:47:47.457 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:47:47.458 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:47:47.458 +02:00 [INF] Executing endpoint 'Hospital.API.Controllers.AppointmentController.Add (Hospital)'
2025-11-24 02:47:47.459 +02:00 [INF] Route matched with {action = "Add", controller = "Appointment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Add(Hospital.Application.DTO.Appointment.AddAppointmentDto) on controller Hospital.API.Controllers.AppointmentController (Hospital).
2025-11-24 02:47:47.460 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:47:47.460 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:47:47.461 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:47:47.462 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:47:47.462 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:47:47.463 +02:00 [DBG] Executing controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 02:47:47.463 +02:00 [DBG] Executed controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 02:47:47.464 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto' ...
2025-11-24 02:47:47.464 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto' using the name '' in request data ...
2025-11-24 02:47:47.465 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:47:47.465 +02:00 [DBG] Connection id "0HNHAU3HQ5A6I", Request id "0HNHAU3HQ5A6I:00000005": started reading request body.
2025-11-24 02:47:47.466 +02:00 [DBG] Connection id "0HNHAU3HQ5A6I", Request id "0HNHAU3HQ5A6I:00000005": done reading request body.
2025-11-24 02:47:47.466 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Appointment.AddAppointmentDto'
2025-11-24 02:47:47.467 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto'.
2025-11-24 02:47:47.467 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto'.
2025-11-24 02:47:47.468 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto' ...
2025-11-24 02:47:47.469 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto'.
2025-11-24 02:47:47.470 +02:00 [INF] Add Appointment called at "2025-11-24T02:47:47.4706989+02:00"
2025-11-24 02:47:47.471 +02:00 [INF] Creating appointment for PatientId: 1, DoctorId: 2, Date: "2025-11-26", Time: "2025-11-23T15:33:47.5410000Z"
2025-11-24 02:47:47.472 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:47:47.473 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:47:47.474 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:47:47.474 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:47:47.475 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:47:47.475 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 02:47:47.476 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 02:47:47.477 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:47:47.478 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:47:47.479 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:47:47.480 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 02:47:47.492 +02:00 [INF] Executed DbCommand (12ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 02:47:47.494 +02:00 [DBG] Context 'AppDbContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:47.495 +02:00 [DBG] The navigation 'Patient.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:47.496 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:47.496 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:47:47.497 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 2ms reading results.
2025-11-24 02:47:47.497 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:47:47.498 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:47:47.498 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:47:47.499 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:47:47.511 +02:00 [INF] Executed DbCommand (12ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:47:47.515 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:47.516 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:47.517 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:47.518 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:47.519 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:47.520 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:47.521 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:47.522 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:47.524 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:47:47.524 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 9ms reading results.
2025-11-24 02:47:47.526 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:47:47.527 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:47:47.528 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 02:47:47.529 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 02:47:47.533 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 02:47:47.535 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:47:47.536 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 02:47:47.539 +02:00 [DBG] Compiling query expression: 
'DbSet<Appointment>()
    .Any(a => a.DoctorId == __doctorId_0 && a.Date == __date_1 && a.Time == __time_2)'
2025-11-24 02:47:47.544 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Appointments AS a
                WHERE ((a.DoctorId == @__doctorId_0) && (a.Date == @__date_1)) && (a.Time == @__time_2))), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 02:47:47.554 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:47:47.555 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:47:47.556 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:47:47.556 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2), @__time_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Appointments] AS [a]
        WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Time] = @__time_2) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-24 02:47:47.560 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2), @__time_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Appointments] AS [a]
        WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Time] = @__time_2) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-24 02:47:47.564 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:47:47.565 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 02:47:47.572 +02:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Appointment.AppointmentId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:47.592 +02:00 [DBG] The navigation 'Appointment.Branch' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:47.594 +02:00 [DBG] The navigation 'Appointment.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:47.596 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:47.597 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:47.598 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:47:47.606 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:47:47.608 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 02:47:47.609 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:47:47.610 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:47:47.611 +02:00 [DBG] Creating transaction savepoint.
2025-11-24 02:47:47.613 +02:00 [DBG] Created transaction savepoint.
2025-11-24 02:47:47.613 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:47:47.614 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:47:47.617 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-11-24 02:47:47.619 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 450), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (Size = 4000), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (Size = 20), @p9='?' (DbType = DateTime2), @p10='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Appointments] ([BranchId], [CreatedAt], [CreatedBy], [Date], [DoctorId], [Notes], [PatientId], [PaymentMethod], [Status], [Time], [UpdatedAt])
OUTPUT INSERTED.[AppointmentId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2025-11-24 02:47:47.624 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 450), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (Size = 4000), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (Size = 20), @p9='?' (DbType = DateTime2), @p10='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Appointments] ([BranchId], [CreatedAt], [CreatedBy], [Date], [DoctorId], [Notes], [PatientId], [PaymentMethod], [Status], [Time], [UpdatedAt])
OUTPUT INSERTED.[AppointmentId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2025-11-24 02:47:47.626 +02:00 [DBG] The foreign key property 'Appointment.AppointmentId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 02:47:47.629 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:47:47.629 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 3ms reading results.
2025-11-24 02:47:47.631 +02:00 [DBG] An entity of type 'Appointment' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:47.632 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 02:47:47.636 +02:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Payment.PaymentId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:47.652 +02:00 [DBG] The navigation 'Payment.Appointment' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:47.654 +02:00 [DBG] The navigation 'Appointment.Payment' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:47.655 +02:00 [DBG] Context 'AppDbContext' started tracking 'Payment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:47.656 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:47:47.663 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:47:47.664 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 02:47:47.664 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:47:47.665 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:47:47.666 +02:00 [DBG] Creating transaction savepoint.
2025-11-24 02:47:47.667 +02:00 [DBG] Created transaction savepoint.
2025-11-24 02:47:47.667 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:47:47.668 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:47:47.671 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-11-24 02:47:47.672 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 3), @p4='?' (Size = 4000), @p5='?' (Size = 100), @p6='?' (DbType = Int64), @p7='?' (DbType = Int64), @p8='?' (Size = 20), @p9='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Payments] ([Amount], [AppointmentId], [CreatedAt], [Currency], [GatewayResponse], [PaymobMerchantOrderId], [PaymobOrderId], [PaymobTransactionId], [Status], [UpdatedAt])
OUTPUT INSERTED.[PaymentId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-24 02:47:47.676 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 3), @p4='?' (Size = 4000), @p5='?' (Size = 100), @p6='?' (DbType = Int64), @p7='?' (DbType = Int64), @p8='?' (Size = 20), @p9='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Payments] ([Amount], [AppointmentId], [CreatedAt], [Currency], [GatewayResponse], [PaymobMerchantOrderId], [PaymobOrderId], [PaymobTransactionId], [Status], [UpdatedAt])
OUTPUT INSERTED.[PaymentId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-24 02:47:47.677 +02:00 [DBG] The foreign key property 'Payment.PaymentId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 02:47:47.678 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:47:47.680 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 2ms reading results.
2025-11-24 02:47:47.681 +02:00 [DBG] An entity of type 'Payment' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:47.682 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 02:47:47.683 +02:00 [DBG] Committing transaction.
2025-11-24 02:47:47.684 +02:00 [DBG] Committed transaction.
2025-11-24 02:47:47.684 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:47:47.685 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:47:47.686 +02:00 [INF] Appointment created successfully with ID: 1
2025-11-24 02:47:47.689 +02:00 [DBG] Disposing transaction.
2025-11-24 02:47:47.690 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:47:47.692 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:47:47.692 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:47:47.692 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:47:47.693 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:47:47.693 +02:00 [INF] Executing CreatedAtActionResult, writing value of type 'Hospital.Application.DTO.Appointment.AppointmentDto'.
2025-11-24 02:47:47.705 +02:00 [DBG] Found the endpoints ["Hospital.API.Controllers.AppointmentController.GetById (Hospital)"] for address (id=[1],action=[GetById],controller=[Appointment])
2025-11-24 02:47:47.708 +02:00 [DBG] Successfully processed template api/Appointment/{id:int} for Hospital.API.Controllers.AppointmentController.GetById (Hospital) resulting in /api/Appointment/1 and 
2025-11-24 02:47:47.710 +02:00 [DBG] Link generation succeeded for endpoints ["Hospital.API.Controllers.AppointmentController.GetById (Hospital)"] with result /api/Appointment/1
2025-11-24 02:47:47.715 +02:00 [INF] Executed action Hospital.API.Controllers.AppointmentController.Add (Hospital) in 252.1886ms
2025-11-24 02:47:47.716 +02:00 [INF] Executed endpoint 'Hospital.API.Controllers.AppointmentController.Add (Hospital)'
2025-11-24 02:47:47.718 +02:00 [DBG] Connection id "0HNHAU3HQ5A6I" completed keep alive response.
2025-11-24 02:47:47.719 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:47:47.720 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:47:47.721 +02:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-11-24 02:47:47.722 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Appointment - 201 null application/json; charset=utf-8 271.8131ms
2025-11-24 02:47:55.908 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/MedicalRecord - application/json 147
2025-11-24 02:47:55.911 +02:00 [DBG] 1 candidate(s) found for the request path '/api/MedicalRecord'
2025-11-24 02:47:55.913 +02:00 [DBG] Endpoint 'Hospital.Controllers.MedicalRecordController.Add (Hospital)' with route pattern 'api/MedicalRecord' is valid for the request path '/api/MedicalRecord'
2025-11-24 02:47:55.914 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.MedicalRecordController.Add (Hospital)'
2025-11-24 02:47:55.915 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:47:55.915 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:47:55.916 +02:00 [INF] Executing endpoint 'Hospital.Controllers.MedicalRecordController.Add (Hospital)'
2025-11-24 02:47:55.916 +02:00 [INF] Route matched with {action = "Add", controller = "MedicalRecord"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Hospital.Application.DTO.MedicalRecord.PatientMedicalRecordDto]] Add(Hospital.Application.DTO.MedicalRecord.AddMedicalRecordDto) on controller Hospital.Controllers.MedicalRecordController (Hospital).
2025-11-24 02:47:55.917 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:47:55.919 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:47:55.920 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:47:55.921 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:47:55.922 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:47:55.922 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.MedicalRecordController (Hospital)
2025-11-24 02:47:55.924 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.MedicalRecordController (Hospital)
2025-11-24 02:47:55.925 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.MedicalRecord.AddMedicalRecordDto' ...
2025-11-24 02:47:55.926 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.MedicalRecord.AddMedicalRecordDto' using the name '' in request data ...
2025-11-24 02:47:55.927 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:47:55.928 +02:00 [DBG] Connection id "0HNHAU3HQ5A6I", Request id "0HNHAU3HQ5A6I:00000006": started reading request body.
2025-11-24 02:47:55.928 +02:00 [DBG] Connection id "0HNHAU3HQ5A6I", Request id "0HNHAU3HQ5A6I:00000006": done reading request body.
2025-11-24 02:47:55.928 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.MedicalRecord.AddMedicalRecordDto'
2025-11-24 02:47:55.929 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.MedicalRecord.AddMedicalRecordDto'.
2025-11-24 02:47:55.929 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.MedicalRecord.AddMedicalRecordDto'.
2025-11-24 02:47:55.930 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.MedicalRecord.AddMedicalRecordDto' ...
2025-11-24 02:47:55.931 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.MedicalRecord.AddMedicalRecordDto'.
2025-11-24 02:47:55.932 +02:00 [INF] add medical record  called at "2025-11-24T02:47:55.9321093+02:00"
2025-11-24 02:47:55.932 +02:00 [INF] Adding medical record for DoctorId 1, PatientId 1, AppointmentId 1
2025-11-24 02:47:55.933 +02:00 [INF] Fetching doctor with ID 1
2025-11-24 02:47:55.934 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:47:55.937 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:47:55.937 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:47:55.938 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:47:55.938 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:47:55.939 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:47:55.940 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:47:55.940 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:47:55.941 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:47:55.945 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:47:55.949 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:55.950 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:55.951 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:55.952 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:55.953 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:55.954 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:55.954 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:55.955 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:47:55.956 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 6ms reading results.
2025-11-24 02:47:55.959 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:47:55.959 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:47:55.960 +02:00 [INF] Fetching patient with ID: 1
2025-11-24 02:47:55.963 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:47:55.964 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:47:55.965 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:47:55.966 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:47:55.967 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:47:55.968 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 02:47:55.974 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 02:47:55.978 +02:00 [DBG] Context 'AppDbContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:55.981 +02:00 [DBG] The navigation 'Patient.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:55.982 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:55.982 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:47:55.983 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 5ms reading results.
2025-11-24 02:47:55.985 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:47:55.986 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 02:47:55.987 +02:00 [INF] Patient with ID 1 retrieved successfully
2025-11-24 02:47:55.988 +02:00 [INF] Fetching appointment by ID: 1
2025-11-24 02:47:55.989 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:47:55.990 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:47:55.990 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:47:55.991 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:47:55.992 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:47:55.993 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Doctors] AS [d] ON [a].[DoctorId] = [d].[DoctorId]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[AppointmentId] = @__id_0
2025-11-24 02:47:56.006 +02:00 [INF] Executed DbCommand (13ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Doctors] AS [d] ON [a].[DoctorId] = [d].[DoctorId]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[AppointmentId] = @__id_0
2025-11-24 02:47:56.010 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:56.012 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:56.013 +02:00 [DBG] The navigation 'Appointment.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:56.014 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:56.015 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:47:56.016 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 7ms reading results.
2025-11-24 02:47:56.016 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:47:56.017 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:47:56.024 +02:00 [DBG] 'AppDbContext' generated a temporary value for the property 'MedicalRecord.RecordId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:56.036 +02:00 [DBG] The navigation 'MedicalRecord.Appointment' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:56.040 +02:00 [DBG] The navigation 'MedicalRecord.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:56.043 +02:00 [DBG] The navigation 'MedicalRecord.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:56.044 +02:00 [DBG] Context 'AppDbContext' started tracking 'MedicalRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:56.045 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:47:56.048 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:47:56.049 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 02:47:56.051 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:47:56.052 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:47:56.054 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:47:56.054 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:47:56.055 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:47:56.055 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:47:56.056 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:47:56.056 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (DbType = Int32), @p4='?' (Size = 4000), @p5='?' (DbType = Int32), @p6='?' (Size = 4000), @p7='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [MedicalRecords] ([AppointmentId], [CreatedAt], [Diagnosis], [DoctorId], [Notes], [PatientId], [TreatmentPlan], [UpdatedAt])
OUTPUT INSERTED.[RecordId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-11-24 02:47:56.061 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (DbType = Int32), @p4='?' (Size = 4000), @p5='?' (DbType = Int32), @p6='?' (Size = 4000), @p7='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [MedicalRecords] ([AppointmentId], [CreatedAt], [Diagnosis], [DoctorId], [Notes], [PatientId], [TreatmentPlan], [UpdatedAt])
OUTPUT INSERTED.[RecordId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-11-24 02:47:56.063 +02:00 [DBG] The foreign key property 'MedicalRecord.RecordId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 02:47:56.065 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:47:56.066 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 3ms reading results.
2025-11-24 02:47:56.067 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:47:56.067 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:47:56.068 +02:00 [DBG] An entity of type 'MedicalRecord' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:47:56.069 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 02:47:56.072 +02:00 [DBG] Compiling query expression: 
'DbSet<MedicalRecord>()
    .Include(r => r.Doctor)
    .ThenInclude(d => d.User)
    .Include(r => r.Patient)
    .ThenInclude(p => p.User)
    .Include(r => r.Appointment)
    .ThenInclude(a => a.Branch)
    .FirstOrDefault(r => r.RecordId == __id_0)'
2025-11-24 02:47:56.074 +02:00 [DBG] Including navigation: 'MedicalRecord.Doctor'.
2025-11-24 02:47:56.075 +02:00 [DBG] Including navigation: 'Doctor.User'.
2025-11-24 02:47:56.077 +02:00 [DBG] Including navigation: 'MedicalRecord.Patient'.
2025-11-24 02:47:56.078 +02:00 [DBG] Including navigation: 'Patient.User'.
2025-11-24 02:47:56.078 +02:00 [DBG] Including navigation: 'MedicalRecord.Appointment'.
2025-11-24 02:47:56.079 +02:00 [DBG] Including navigation: 'Appointment.Branch'.
2025-11-24 02:47:56.097 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<MedicalRecord>(
    asyncEnumerable: new SingleQueryingEnumerable<MedicalRecord>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: MedicalRecord.RecordId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: MedicalRecord.AppointmentId (int) Required FK Index, 1], [Property: MedicalRecord.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 2], [Property: MedicalRecord.Diagnosis (string), 3], [Property: MedicalRecord.DoctorId (int) Required FK Index, 4], [Property: MedicalRecord.Notes (string), 5], [Property: MedicalRecord.PatientId (int) Required FK Index, 6], [Property: MedicalRecord.TreatmentPlan (string), 7], [Property: MedicalRecord.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 8] }
                1 -> Dictionary<IProperty, int> { [Property: Doctor.DoctorId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 9], [Property: Doctor.Available (bool?), 10], [Property: Doctor.Biography (string), 11], [Property: Doctor.ConsultationFees (decimal) Required, 12], [Property: Doctor.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 13], [Property: Doctor.ExperienceYears (int?), 14], [Property: Doctor.ImageURL (string) MaxLength(300), 15], [Property: Doctor.SpecializationId (int) Required FK Index, 16], [Property: Doctor.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 17], [Property: Doctor.UserId (string) Required FK Index, 18] }
                2 -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 19], [Property: User.AccessFailedCount (int) Required, 20], [Property: User.ConcurrencyStamp (string) Concurrency, 21], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 22], [Property: User.DateOfBirth (DateOnly?), 23], [Property: User.Email (string) Index MaxLength(256), 24], [Property: User.EmailConfirmed (bool) Required, 25], [Property: User.FullName (string) Required MaxLength(150), 26], [Property: User.Gender (GenderType?) MaxLength(10), 27], [Property: User.LockoutEnabled (bool) Required, 28], [Property: User.LockoutEnd (DateTimeOffset?), 29], [Property: User.NormalizedEmail (string) Index MaxLength(256), 30], [Property: User.NormalizedUserName (string) Index MaxLength(256), 31], [Property: User.PasswordHash (string), 32], [Property: User.PhoneNumber (string), 33], [Property: User.PhoneNumberConfirmed (bool) Required, 34], [Property: User.RefreshToken (string), 35], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 36], [Property: User.Role (string) Required MaxLength(50), 37], [Property: User.SecurityStamp (string), 38], [Property: User.TwoFactorEnabled (bool) Required, 39], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 40], [Property: User.UserName (string) MaxLength(256), 41] }
                3 -> Dictionary<IProperty, int> { [Property: Patient.PatientId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 42], [Property: Patient.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 43], [Property: Patient.EmergencyContact (string) MaxLength(150), 44], [Property: Patient.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 45], [Property: Patient.UserId (string) Required FK Index, 46] }
                4 -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 47], [Property: User.AccessFailedCount (int) Required, 48], [Property: User.ConcurrencyStamp (string) Concurrency, 49], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 50], [Property: User.DateOfBirth (DateOnly?), 51], [Property: User.Email (string) Index MaxLength(256), 52], [Property: User.EmailConfirmed (bool) Required, 53], [Property: User.FullName (string) Required MaxLength(150), 54], [Property: User.Gender (GenderType?) MaxLength(10), 55], [Property: User.LockoutEnabled (bool) Required, 56], [Property: User.LockoutEnd (DateTimeOffset?), 57], [Property: User.NormalizedEmail (string) Index MaxLength(256), 58], [Property: User.NormalizedUserName (string) Index MaxLength(256), 59], [Property: User.PasswordHash (string), 60], [Property: User.PhoneNumber (string), 61], [Property: User.PhoneNumberConfirmed (bool) Required, 62], [Property: User.RefreshToken (string), 63], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 64], [Property: User.Role (string) Required MaxLength(50), 65], [Property: User.SecurityStamp (string), 66], [Property: User.TwoFactorEnabled (bool) Required, 67], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 68], [Property: User.UserName (string) MaxLength(256), 69] }
                5 -> Dictionary<IProperty, int> { [Property: Appointment.AppointmentId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 70], [Property: Appointment.BranchId (int) Required FK Index, 71], [Property: Appointment.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 72], [Property: Appointment.CreatedBy (string) FK Index, 73], [Property: Appointment.Date (DateOnly) Required, 74], [Property: Appointment.DoctorId (int) Required FK Index, 75], [Property: Appointment.Notes (string), 76], [Property: Appointment.PatientId (int) Required FK Index, 77], [Property: Appointment.PaymentMethod (PaymentMethod) Required, 78], [Property: Appointment.Status (AppointmentStatus) Required MaxLength(20), 79], [Property: Appointment.Time (DateTime) Required, 80], [Property: Appointment.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 81] }
                6 -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 82], [Property: Branch.Address (string) MaxLength(250), 83], [Property: Branch.BranchName (string) Required MaxLength(150), 84], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 85], [Property: Branch.Description (string), 86], [Property: Branch.Email (string) MaxLength(200), 87], [Property: Branch.ImageURL (string) MaxLength(300), 88], [Property: Branch.Phone (string) MaxLength(25), 89], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 90] }
            SELECT TOP(1) m.RecordId, m.AppointmentId, m.CreatedAt, m.Diagnosis, m.DoctorId, m.Notes, m.PatientId, m.TreatmentPlan, m.UpdatedAt, d.DoctorId, d.Available, d.Biography, d.ConsultationFees, d.CreatedAt, d.ExperienceYears, d.ImageURL, d.SpecializationId, d.UpdatedAt, d.UserId, u.Id, u.AccessFailedCount, u.ConcurrencyStamp, u.CreatedAt, u.DateOfBirth, u.Email, u.EmailConfirmed, u.FullName, u.Gender, u.LockoutEnabled, u.LockoutEnd, u.NormalizedEmail, u.NormalizedUserName, u.PasswordHash, u.PhoneNumber, u.PhoneNumberConfirmed, u.RefreshToken, u.RefreshTokenExpiryTime, u.Role, u.SecurityStamp, u.TwoFactorEnabled, u.UpdatedAt, u.UserName, p.PatientId, p.CreatedAt, p.EmergencyContact, p.UpdatedAt, p.UserId, u0.Id, u0.AccessFailedCount, u0.ConcurrencyStamp, u0.CreatedAt, u0.DateOfBirth, u0.Email, u0.EmailConfirmed, u0.FullName, u0.Gender, u0.LockoutEnabled, u0.LockoutEnd, u0.NormalizedEmail, u0.NormalizedUserName, u0.PasswordHash, u0.PhoneNumber, u0.PhoneNumberConfirmed, u0.RefreshToken, u0.RefreshTokenExpiryTime, u0.Role, u0.SecurityStamp, u0.TwoFactorEnabled, u0.UpdatedAt, u0.UserName, a.AppointmentId, a.BranchId, a.CreatedAt, a.CreatedBy, a.Date, a.DoctorId, a.Notes, a.PatientId, a.PaymentMethod, a.Status, a.Time, a.UpdatedAt, b.BranchId, b.Address, b.BranchName, b.CreatedAt, b.Description, b.Email, b.ImageURL, b.Phone, b.UpdatedAt
            FROM MedicalRecords AS m
            INNER JOIN Doctors AS d ON m.DoctorId == d.DoctorId
            INNER JOIN Users AS u ON d.UserId == u.Id
            INNER JOIN Patients AS p ON m.PatientId == p.PatientId
            INNER JOIN Users AS u0 ON p.UserId == u0.Id
            INNER JOIN Appointments AS a ON m.AppointmentId == a.AppointmentId
            INNER JOIN Branches AS b ON a.BranchId == b.BranchId
            WHERE m.RecordId == @__id_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, MedicalRecord>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 02:47:56.103 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:47:56.104 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:47:56.105 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:47:56.106 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:47:56.107 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:47:56.107 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt], [u0].[UserName], [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [MedicalRecords] AS [m]
INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
INNER JOIN [Patients] AS [p] ON [m].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u0] ON [p].[UserId] = [u0].[Id]
INNER JOIN [Appointments] AS [a] ON [m].[AppointmentId] = [a].[AppointmentId]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [m].[RecordId] = @__id_0
2025-11-24 02:47:56.124 +02:00 [INF] Executed DbCommand (17ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt], [u0].[UserName], [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [MedicalRecords] AS [m]
INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
INNER JOIN [Patients] AS [p] ON [m].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u0] ON [p].[UserId] = [u0].[Id]
INNER JOIN [Appointments] AS [a] ON [m].[AppointmentId] = [a].[AppointmentId]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [m].[RecordId] = @__id_0
2025-11-24 02:47:56.129 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:47:56.130 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 02:47:56.131 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:47:56.133 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (2ms).
2025-11-24 02:47:56.134 +02:00 [INF] Medical record added successfully with RecordId 1
2025-11-24 02:47:56.141 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:47:56.145 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:47:56.148 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:47:56.149 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:47:56.150 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:47:56.152 +02:00 [INF] Executing OkObjectResult, writing value of type 'Hospital.Application.DTO.MedicalRecord.MedicalRecordDto'.
2025-11-24 02:47:56.164 +02:00 [INF] Executed action Hospital.Controllers.MedicalRecordController.Add (Hospital) in 241.908ms
2025-11-24 02:47:56.165 +02:00 [INF] Executed endpoint 'Hospital.Controllers.MedicalRecordController.Add (Hospital)'
2025-11-24 02:47:56.166 +02:00 [DBG] Connection id "0HNHAU3HQ5A6I" completed keep alive response.
2025-11-24 02:47:56.167 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:47:56.167 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:47:56.168 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:47:56.168 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/MedicalRecord - 200 null application/json; charset=utf-8 260.0299ms
2025-11-24 02:48:33.923 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/MedicalRecord - application/json 157
2025-11-24 02:48:33.925 +02:00 [DBG] 1 candidate(s) found for the request path '/api/MedicalRecord'
2025-11-24 02:48:33.926 +02:00 [DBG] Endpoint 'Hospital.Controllers.MedicalRecordController.Add (Hospital)' with route pattern 'api/MedicalRecord' is valid for the request path '/api/MedicalRecord'
2025-11-24 02:48:33.926 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.MedicalRecordController.Add (Hospital)'
2025-11-24 02:48:33.927 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:48:33.928 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:48:33.928 +02:00 [INF] Executing endpoint 'Hospital.Controllers.MedicalRecordController.Add (Hospital)'
2025-11-24 02:48:33.929 +02:00 [INF] Route matched with {action = "Add", controller = "MedicalRecord"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Hospital.Application.DTO.MedicalRecord.PatientMedicalRecordDto]] Add(Hospital.Application.DTO.MedicalRecord.AddMedicalRecordDto) on controller Hospital.Controllers.MedicalRecordController (Hospital).
2025-11-24 02:48:33.931 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:48:33.931 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:48:33.932 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:48:33.933 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:48:33.934 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:48:33.935 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.MedicalRecordController (Hospital)
2025-11-24 02:48:33.935 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.MedicalRecordController (Hospital)
2025-11-24 02:48:33.936 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.MedicalRecord.AddMedicalRecordDto' ...
2025-11-24 02:48:33.937 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.MedicalRecord.AddMedicalRecordDto' using the name '' in request data ...
2025-11-24 02:48:33.938 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:48:33.939 +02:00 [DBG] Connection id "0HNHAU3HQ5A6I", Request id "0HNHAU3HQ5A6I:00000007": started reading request body.
2025-11-24 02:48:33.940 +02:00 [DBG] Connection id "0HNHAU3HQ5A6I", Request id "0HNHAU3HQ5A6I:00000007": done reading request body.
2025-11-24 02:48:33.941 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.MedicalRecord.AddMedicalRecordDto'
2025-11-24 02:48:33.942 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.MedicalRecord.AddMedicalRecordDto'.
2025-11-24 02:48:33.942 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.MedicalRecord.AddMedicalRecordDto'.
2025-11-24 02:48:33.944 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.MedicalRecord.AddMedicalRecordDto' ...
2025-11-24 02:48:33.945 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.MedicalRecord.AddMedicalRecordDto'.
2025-11-24 02:48:33.945 +02:00 [INF] add medical record  called at "2025-11-24T02:48:33.9457183+02:00"
2025-11-24 02:48:33.946 +02:00 [INF] Adding medical record for DoctorId 1, PatientId 1, AppointmentId 4
2025-11-24 02:48:33.946 +02:00 [INF] Fetching doctor with ID 1
2025-11-24 02:48:33.947 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:48:33.947 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:48:33.948 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:48:33.948 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:48:33.949 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:48:33.950 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:48:33.951 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:48:33.951 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:48:33.952 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:48:33.956 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:48:33.962 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:48:33.963 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:48:33.964 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:48:33.965 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:48:33.966 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:48:33.966 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:48:33.967 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:48:33.968 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:48:33.968 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 6ms reading results.
2025-11-24 02:48:33.969 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:48:33.970 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:48:33.971 +02:00 [INF] Fetching patient with ID: 1
2025-11-24 02:48:33.971 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:48:33.972 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:48:33.973 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:48:33.973 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:48:33.974 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:48:33.974 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 02:48:33.985 +02:00 [INF] Executed DbCommand (11ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 02:48:33.987 +02:00 [DBG] Context 'AppDbContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:48:33.988 +02:00 [DBG] The navigation 'Patient.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:48:33.989 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:48:33.991 +02:00 [DBG] The navigation 'MedicalRecord.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:48:33.992 +02:00 [DBG] Context 'AppDbContext' started tracking 'MedicalRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:48:33.993 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:48:33.993 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 5ms reading results.
2025-11-24 02:48:33.994 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:48:33.994 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:48:33.995 +02:00 [INF] Patient with ID 1 retrieved successfully
2025-11-24 02:48:33.996 +02:00 [INF] Fetching appointment by ID: 4
2025-11-24 02:48:33.996 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:48:33.997 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:48:33.997 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:48:33.997 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:48:33.998 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:48:33.999 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Doctors] AS [d] ON [a].[DoctorId] = [d].[DoctorId]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[AppointmentId] = @__id_0
2025-11-24 02:48:34.001 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Doctors] AS [d] ON [a].[DoctorId] = [d].[DoctorId]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[AppointmentId] = @__id_0
2025-11-24 02:48:34.003 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:48:34.003 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:48:34.004 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:48:34.004 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:48:34.005 +02:00 [WRN] Appointment with ID 4 not found
2025-11-24 02:48:34.005 +02:00 [WRN] Appointment with Id 4 not found
2025-11-24 02:48:34.036 +02:00 [INF] Executed action Hospital.Controllers.MedicalRecordController.Add (Hospital) in 101.4291ms
2025-11-24 02:48:34.037 +02:00 [INF] Executed endpoint 'Hospital.Controllers.MedicalRecordController.Add (Hospital)'
2025-11-24 02:48:34.066 +02:00 [ERR]  Exception caught: Appointment with Id 4 not found
System.Exception: Appointment with Id 4 not found
   at Hospital.Infrastructure.Services.MedicalRecordService.AddAsync(AddMedicalRecordDto dto) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\MedicalRecordService.cs:line 68
   at Hospital.Controllers.MedicalRecordController.Add(AddMedicalRecordDto dto) in D:\Walaa\GP\Hospital\Hospital\Controllers\MedicalRecordController.cs:line 26
   at lambda_method1226(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
2025-11-24 02:48:34.073 +02:00 [DBG] Connection id "0HNHAU3HQ5A6I" completed keep alive response.
2025-11-24 02:48:34.074 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:48:34.074 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:48:34.075 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:48:34.076 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/MedicalRecord - 500 null application/json 152.503ms
2025-11-24 02:48:40.807 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/MedicalRecord - application/json 156
2025-11-24 02:48:40.808 +02:00 [DBG] 1 candidate(s) found for the request path '/api/MedicalRecord'
2025-11-24 02:48:40.809 +02:00 [DBG] Endpoint 'Hospital.Controllers.MedicalRecordController.Add (Hospital)' with route pattern 'api/MedicalRecord' is valid for the request path '/api/MedicalRecord'
2025-11-24 02:48:40.810 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.MedicalRecordController.Add (Hospital)'
2025-11-24 02:48:40.811 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:48:40.812 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:48:40.813 +02:00 [INF] Executing endpoint 'Hospital.Controllers.MedicalRecordController.Add (Hospital)'
2025-11-24 02:48:40.814 +02:00 [INF] Route matched with {action = "Add", controller = "MedicalRecord"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Hospital.Application.DTO.MedicalRecord.PatientMedicalRecordDto]] Add(Hospital.Application.DTO.MedicalRecord.AddMedicalRecordDto) on controller Hospital.Controllers.MedicalRecordController (Hospital).
2025-11-24 02:48:40.815 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:48:40.816 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:48:40.817 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:48:40.817 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:48:40.818 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:48:40.819 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.MedicalRecordController (Hospital)
2025-11-24 02:48:40.820 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.MedicalRecordController (Hospital)
2025-11-24 02:48:40.821 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.MedicalRecord.AddMedicalRecordDto' ...
2025-11-24 02:48:40.822 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.MedicalRecord.AddMedicalRecordDto' using the name '' in request data ...
2025-11-24 02:48:40.822 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:48:40.823 +02:00 [DBG] Connection id "0HNHAU3HQ5A6I", Request id "0HNHAU3HQ5A6I:00000008": started reading request body.
2025-11-24 02:48:40.824 +02:00 [DBG] Connection id "0HNHAU3HQ5A6I", Request id "0HNHAU3HQ5A6I:00000008": done reading request body.
2025-11-24 02:48:40.824 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.MedicalRecord.AddMedicalRecordDto'
2025-11-24 02:48:40.825 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.MedicalRecord.AddMedicalRecordDto'.
2025-11-24 02:48:40.825 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.MedicalRecord.AddMedicalRecordDto'.
2025-11-24 02:48:40.825 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.MedicalRecord.AddMedicalRecordDto' ...
2025-11-24 02:48:40.827 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.MedicalRecord.AddMedicalRecordDto'.
2025-11-24 02:48:40.827 +02:00 [INF] add medical record  called at "2025-11-24T02:48:40.8275688+02:00"
2025-11-24 02:48:40.828 +02:00 [INF] Adding medical record for DoctorId 1, PatientId 1, AppointmentId 4
2025-11-24 02:48:40.829 +02:00 [INF] Fetching doctor with ID 1
2025-11-24 02:48:40.830 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:48:40.831 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:48:40.832 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:48:40.833 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:48:40.833 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:48:40.834 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:48:40.834 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:48:40.835 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:48:40.836 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:48:40.840 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:48:40.846 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:48:40.847 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:48:40.847 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:48:40.848 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:48:40.848 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:48:40.849 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:48:40.850 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:48:40.851 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:48:40.851 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 4ms reading results.
2025-11-24 02:48:40.852 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:48:40.852 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:48:40.853 +02:00 [INF] Fetching patient with ID: 1
2025-11-24 02:48:40.854 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:48:40.855 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:48:40.855 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:48:40.856 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:48:40.856 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:48:40.857 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 02:48:40.859 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 02:48:40.861 +02:00 [DBG] Context 'AppDbContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:48:40.862 +02:00 [DBG] The navigation 'Patient.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:48:40.862 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:48:40.863 +02:00 [DBG] The navigation 'MedicalRecord.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:48:40.864 +02:00 [DBG] Context 'AppDbContext' started tracking 'MedicalRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:48:40.865 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:48:40.865 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 3ms reading results.
2025-11-24 02:48:40.866 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:48:40.867 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 02:48:40.868 +02:00 [INF] Patient with ID 1 retrieved successfully
2025-11-24 02:48:40.869 +02:00 [INF] Fetching appointment by ID: 4
2025-11-24 02:48:40.870 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:48:40.871 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:48:40.871 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:48:40.871 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:48:40.872 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:48:40.872 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Doctors] AS [d] ON [a].[DoctorId] = [d].[DoctorId]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[AppointmentId] = @__id_0
2025-11-24 02:48:40.874 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Doctors] AS [d] ON [a].[DoctorId] = [d].[DoctorId]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[AppointmentId] = @__id_0
2025-11-24 02:48:40.876 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:48:40.877 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:48:40.877 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:48:40.878 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:48:40.878 +02:00 [WRN] Appointment with ID 4 not found
2025-11-24 02:48:40.879 +02:00 [WRN] Appointment with Id 4 not found
2025-11-24 02:48:40.905 +02:00 [INF] Executed action Hospital.Controllers.MedicalRecordController.Add (Hospital) in 86.2969ms
2025-11-24 02:48:40.906 +02:00 [INF] Executed endpoint 'Hospital.Controllers.MedicalRecordController.Add (Hospital)'
2025-11-24 02:48:40.936 +02:00 [ERR]  Exception caught: Appointment with Id 4 not found
System.Exception: Appointment with Id 4 not found
   at Hospital.Infrastructure.Services.MedicalRecordService.AddAsync(AddMedicalRecordDto dto) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\MedicalRecordService.cs:line 68
   at Hospital.Controllers.MedicalRecordController.Add(AddMedicalRecordDto dto) in D:\Walaa\GP\Hospital\Hospital\Controllers\MedicalRecordController.cs:line 26
   at lambda_method1226(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
2025-11-24 02:48:40.943 +02:00 [DBG] Connection id "0HNHAU3HQ5A6I" completed keep alive response.
2025-11-24 02:48:40.944 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:48:40.944 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:48:40.945 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:48:40.946 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/MedicalRecord - 500 null application/json 139.462ms
2025-11-24 02:48:47.459 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/MedicalRecord - application/json 156
2025-11-24 02:48:47.462 +02:00 [DBG] 1 candidate(s) found for the request path '/api/MedicalRecord'
2025-11-24 02:48:47.463 +02:00 [DBG] Endpoint 'Hospital.Controllers.MedicalRecordController.Add (Hospital)' with route pattern 'api/MedicalRecord' is valid for the request path '/api/MedicalRecord'
2025-11-24 02:48:47.464 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.MedicalRecordController.Add (Hospital)'
2025-11-24 02:48:47.465 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:48:47.466 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:48:47.468 +02:00 [INF] Executing endpoint 'Hospital.Controllers.MedicalRecordController.Add (Hospital)'
2025-11-24 02:48:47.469 +02:00 [INF] Route matched with {action = "Add", controller = "MedicalRecord"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Hospital.Application.DTO.MedicalRecord.PatientMedicalRecordDto]] Add(Hospital.Application.DTO.MedicalRecord.AddMedicalRecordDto) on controller Hospital.Controllers.MedicalRecordController (Hospital).
2025-11-24 02:48:47.471 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:48:47.472 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:48:47.473 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:48:47.474 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:48:47.475 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:48:47.477 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.MedicalRecordController (Hospital)
2025-11-24 02:48:47.478 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.MedicalRecordController (Hospital)
2025-11-24 02:48:47.479 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.MedicalRecord.AddMedicalRecordDto' ...
2025-11-24 02:48:47.481 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.MedicalRecord.AddMedicalRecordDto' using the name '' in request data ...
2025-11-24 02:48:47.482 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 02:48:47.484 +02:00 [DBG] Connection id "0HNHAU3HQ5A6I", Request id "0HNHAU3HQ5A6I:00000009": started reading request body.
2025-11-24 02:48:47.485 +02:00 [DBG] Connection id "0HNHAU3HQ5A6I", Request id "0HNHAU3HQ5A6I:00000009": done reading request body.
2025-11-24 02:48:47.485 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.MedicalRecord.AddMedicalRecordDto'
2025-11-24 02:48:47.486 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.MedicalRecord.AddMedicalRecordDto'.
2025-11-24 02:48:47.487 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.MedicalRecord.AddMedicalRecordDto'.
2025-11-24 02:48:47.488 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.MedicalRecord.AddMedicalRecordDto' ...
2025-11-24 02:48:47.490 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.MedicalRecord.AddMedicalRecordDto'.
2025-11-24 02:48:47.491 +02:00 [INF] add medical record  called at "2025-11-24T02:48:47.4910644+02:00"
2025-11-24 02:48:47.491 +02:00 [INF] Adding medical record for DoctorId 1, PatientId 1, AppointmentId 1
2025-11-24 02:48:47.492 +02:00 [INF] Fetching doctor with ID 1
2025-11-24 02:48:47.493 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:48:47.495 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:48:47.496 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:48:47.497 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:48:47.499 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:48:47.500 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:48:47.501 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:48:47.503 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 02:48:47.504 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:48:47.514 +02:00 [INF] Executed DbCommand (11ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:48:47.517 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:48:47.518 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:48:47.519 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:48:47.520 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:48:47.521 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:48:47.522 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:48:47.523 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:48:47.524 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:48:47.525 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 7ms reading results.
2025-11-24 02:48:47.526 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:48:47.527 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:48:47.528 +02:00 [INF] Fetching patient with ID: 1
2025-11-24 02:48:47.529 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:48:47.530 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:48:47.530 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:48:47.531 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:48:47.532 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:48:47.533 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 02:48:47.546 +02:00 [INF] Executed DbCommand (13ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 02:48:47.552 +02:00 [DBG] Context 'AppDbContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:48:47.554 +02:00 [DBG] The navigation 'Patient.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:48:47.555 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:48:47.556 +02:00 [DBG] The navigation 'MedicalRecord.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:48:47.557 +02:00 [DBG] Context 'AppDbContext' started tracking 'MedicalRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:48:47.558 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:48:47.559 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 6ms reading results.
2025-11-24 02:48:47.560 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:48:47.561 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:48:47.562 +02:00 [INF] Patient with ID 1 retrieved successfully
2025-11-24 02:48:47.562 +02:00 [INF] Fetching appointment by ID: 1
2025-11-24 02:48:47.563 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:48:47.563 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:48:47.564 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:48:47.565 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:48:47.565 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:48:47.566 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Doctors] AS [d] ON [a].[DoctorId] = [d].[DoctorId]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[AppointmentId] = @__id_0
2025-11-24 02:48:47.573 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Doctors] AS [d] ON [a].[DoctorId] = [d].[DoctorId]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[AppointmentId] = @__id_0
2025-11-24 02:48:47.576 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:48:47.577 +02:00 [DBG] The navigation 'MedicalRecord.Appointment' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:48:47.578 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:48:47.579 +02:00 [DBG] The navigation 'Appointment.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:48:47.580 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:48:47.581 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:48:47.582 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 5ms reading results.
2025-11-24 02:48:47.583 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:48:47.585 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 02:48:47.586 +02:00 [DBG] 'AppDbContext' generated a temporary value for the property 'MedicalRecord.RecordId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:48:47.587 +02:00 [DBG] The navigation 'MedicalRecord.Appointment' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:48:47.588 +02:00 [DBG] The navigation 'MedicalRecord.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:48:47.589 +02:00 [DBG] The navigation 'MedicalRecord.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:48:47.590 +02:00 [DBG] Context 'AppDbContext' started tracking 'MedicalRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:48:47.591 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:48:47.592 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:48:47.592 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 02:48:47.593 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 02:48:47.594 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 02:48:47.595 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:48:47.595 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:48:47.596 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:48:47.597 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:48:47.598 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:48:47.599 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (DbType = Int32), @p4='?' (Size = 4000), @p5='?' (DbType = Int32), @p6='?' (Size = 4000), @p7='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [MedicalRecords] ([AppointmentId], [CreatedAt], [Diagnosis], [DoctorId], [Notes], [PatientId], [TreatmentPlan], [UpdatedAt])
OUTPUT INSERTED.[RecordId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-11-24 02:48:47.606 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (DbType = Int32), @p4='?' (Size = 4000), @p5='?' (DbType = Int32), @p6='?' (Size = 4000), @p7='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [MedicalRecords] ([AppointmentId], [CreatedAt], [Diagnosis], [DoctorId], [Notes], [PatientId], [TreatmentPlan], [UpdatedAt])
OUTPUT INSERTED.[RecordId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-11-24 02:48:47.608 +02:00 [DBG] The foreign key property 'MedicalRecord.RecordId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 02:48:47.609 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:48:47.610 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 2ms reading results.
2025-11-24 02:48:47.611 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:48:47.612 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:48:47.613 +02:00 [DBG] An entity of type 'MedicalRecord' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:48:47.614 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 02:48:47.615 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:48:47.616 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:48:47.617 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:48:47.617 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:48:47.618 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:48:47.619 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt], [u0].[UserName], [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [MedicalRecords] AS [m]
INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
INNER JOIN [Patients] AS [p] ON [m].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u0] ON [p].[UserId] = [u0].[Id]
INNER JOIN [Appointments] AS [a] ON [m].[AppointmentId] = [a].[AppointmentId]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [m].[RecordId] = @__id_0
2025-11-24 02:48:47.627 +02:00 [INF] Executed DbCommand (8ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt], [u0].[UserName], [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [MedicalRecords] AS [m]
INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
INNER JOIN [Patients] AS [p] ON [m].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u0] ON [p].[UserId] = [u0].[Id]
INNER JOIN [Appointments] AS [a] ON [m].[AppointmentId] = [a].[AppointmentId]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [m].[RecordId] = @__id_0
2025-11-24 02:48:47.628 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:48:47.629 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:48:47.630 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:48:47.631 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:48:47.632 +02:00 [INF] Medical record added successfully with RecordId 2
2025-11-24 02:48:47.632 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:48:47.633 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:48:47.634 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:48:47.634 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:48:47.634 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:48:47.635 +02:00 [INF] Executing OkObjectResult, writing value of type 'Hospital.Application.DTO.MedicalRecord.MedicalRecordDto'.
2025-11-24 02:48:47.636 +02:00 [INF] Executed action Hospital.Controllers.MedicalRecordController.Add (Hospital) in 159.3963ms
2025-11-24 02:48:47.637 +02:00 [INF] Executed endpoint 'Hospital.Controllers.MedicalRecordController.Add (Hospital)'
2025-11-24 02:48:47.638 +02:00 [DBG] Connection id "0HNHAU3HQ5A6I" completed keep alive response.
2025-11-24 02:48:47.639 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:48:47.640 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:48:47.640 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:48:47.642 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/MedicalRecord - 200 null application/json; charset=utf-8 182.2135ms
2025-11-24 02:49:01.776 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/MedicalRecord/11 - null null
2025-11-24 02:49:01.777 +02:00 [DBG] 1 candidate(s) found for the request path '/api/MedicalRecord/11'
2025-11-24 02:49:01.778 +02:00 [DBG] Endpoint 'Hospital.Controllers.MedicalRecordController.GetById (Hospital)' with route pattern 'api/MedicalRecord/{id}' is valid for the request path '/api/MedicalRecord/11'
2025-11-24 02:49:01.781 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.MedicalRecordController.GetById (Hospital)'
2025-11-24 02:49:01.782 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:49:01.783 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:49:01.784 +02:00 [INF] Executing endpoint 'Hospital.Controllers.MedicalRecordController.GetById (Hospital)'
2025-11-24 02:49:01.789 +02:00 [INF] Route matched with {action = "GetById", controller = "MedicalRecord"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Hospital.Application.DTO.MedicalRecord.PatientMedicalRecordDto]] GetById(Int32) on controller Hospital.Controllers.MedicalRecordController (Hospital).
2025-11-24 02:49:01.792 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:49:01.792 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:49:01.793 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:49:01.794 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:49:01.795 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:49:01.795 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.MedicalRecordController (Hospital)
2025-11-24 02:49:01.796 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.MedicalRecordController (Hospital)
2025-11-24 02:49:01.797 +02:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-11-24 02:49:01.798 +02:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-11-24 02:49:01.799 +02:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-11-24 02:49:01.800 +02:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-11-24 02:49:01.800 +02:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-11-24 02:49:01.801 +02:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-11-24 02:49:01.802 +02:00 [INF] get medical  record by id called at "2025-11-24T02:49:01.8025642+02:00"
2025-11-24 02:49:01.804 +02:00 [INF] Fetching medical record with RecordId 11
2025-11-24 02:49:01.807 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:49:01.809 +02:00 [DBG] Compiling query expression: 
'DbSet<MedicalRecord>()
    .Include(m => m.Doctor)
    .Include(m => m.Patient)
    .Include(m => m.Appointment)
    .FirstOrDefault(m => m.RecordId == __id_0)'
2025-11-24 02:49:01.811 +02:00 [DBG] Including navigation: 'MedicalRecord.Doctor'.
2025-11-24 02:49:01.812 +02:00 [DBG] Including navigation: 'MedicalRecord.Patient'.
2025-11-24 02:49:01.813 +02:00 [DBG] Including navigation: 'MedicalRecord.Appointment'.
2025-11-24 02:49:01.822 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<MedicalRecord>(
    asyncEnumerable: new SingleQueryingEnumerable<MedicalRecord>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: MedicalRecord.RecordId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: MedicalRecord.AppointmentId (int) Required FK Index, 1], [Property: MedicalRecord.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 2], [Property: MedicalRecord.Diagnosis (string), 3], [Property: MedicalRecord.DoctorId (int) Required FK Index, 4], [Property: MedicalRecord.Notes (string), 5], [Property: MedicalRecord.PatientId (int) Required FK Index, 6], [Property: MedicalRecord.TreatmentPlan (string), 7], [Property: MedicalRecord.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 8] }
                1 -> Dictionary<IProperty, int> { [Property: Doctor.DoctorId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 9], [Property: Doctor.Available (bool?), 10], [Property: Doctor.Biography (string), 11], [Property: Doctor.ConsultationFees (decimal) Required, 12], [Property: Doctor.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 13], [Property: Doctor.ExperienceYears (int?), 14], [Property: Doctor.ImageURL (string) MaxLength(300), 15], [Property: Doctor.SpecializationId (int) Required FK Index, 16], [Property: Doctor.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 17], [Property: Doctor.UserId (string) Required FK Index, 18] }
                2 -> Dictionary<IProperty, int> { [Property: Patient.PatientId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 19], [Property: Patient.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 20], [Property: Patient.EmergencyContact (string) MaxLength(150), 21], [Property: Patient.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 22], [Property: Patient.UserId (string) Required FK Index, 23] }
                3 -> Dictionary<IProperty, int> { [Property: Appointment.AppointmentId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 24], [Property: Appointment.BranchId (int) Required FK Index, 25], [Property: Appointment.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 26], [Property: Appointment.CreatedBy (string) FK Index, 27], [Property: Appointment.Date (DateOnly) Required, 28], [Property: Appointment.DoctorId (int) Required FK Index, 29], [Property: Appointment.Notes (string), 30], [Property: Appointment.PatientId (int) Required FK Index, 31], [Property: Appointment.PaymentMethod (PaymentMethod) Required, 32], [Property: Appointment.Status (AppointmentStatus) Required MaxLength(20), 33], [Property: Appointment.Time (DateTime) Required, 34], [Property: Appointment.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 35] }
            SELECT TOP(1) m.RecordId, m.AppointmentId, m.CreatedAt, m.Diagnosis, m.DoctorId, m.Notes, m.PatientId, m.TreatmentPlan, m.UpdatedAt, d.DoctorId, d.Available, d.Biography, d.ConsultationFees, d.CreatedAt, d.ExperienceYears, d.ImageURL, d.SpecializationId, d.UpdatedAt, d.UserId, p.PatientId, p.CreatedAt, p.EmergencyContact, p.UpdatedAt, p.UserId, a.AppointmentId, a.BranchId, a.CreatedAt, a.CreatedBy, a.Date, a.DoctorId, a.Notes, a.PatientId, a.PaymentMethod, a.Status, a.Time, a.UpdatedAt
            FROM MedicalRecords AS m
            INNER JOIN Doctors AS d ON m.DoctorId == d.DoctorId
            INNER JOIN Patients AS p ON m.PatientId == p.PatientId
            INNER JOIN Appointments AS a ON m.AppointmentId == a.AppointmentId
            WHERE m.RecordId == @__id_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, MedicalRecord>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 02:49:01.825 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:49:01.826 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:49:01.826 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:49:01.827 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:49:01.827 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:49:01.828 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:49:01.828 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:49:01.829 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt]
FROM [MedicalRecords] AS [m]
INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
INNER JOIN [Patients] AS [p] ON [m].[PatientId] = [p].[PatientId]
INNER JOIN [Appointments] AS [a] ON [m].[AppointmentId] = [a].[AppointmentId]
WHERE [m].[RecordId] = @__id_0
2025-11-24 02:49:01.836 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt]
FROM [MedicalRecords] AS [m]
INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
INNER JOIN [Patients] AS [p] ON [m].[PatientId] = [p].[PatientId]
INNER JOIN [Appointments] AS [a] ON [m].[AppointmentId] = [a].[AppointmentId]
WHERE [m].[RecordId] = @__id_0
2025-11-24 02:49:01.838 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:49:01.839 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:49:01.840 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:49:01.841 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 02:49:01.841 +02:00 [WRN] MedicalRecord with Id 11 not found
2025-11-24 02:49:01.842 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:49:01.843 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:49:01.844 +02:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2025-11-24 02:49:01.845 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2025-11-24 02:49:01.846 +02:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-11-24 02:49:01.847 +02:00 [INF] Executed action Hospital.Controllers.MedicalRecordController.GetById (Hospital) in 51.3206ms
2025-11-24 02:49:01.847 +02:00 [INF] Executed endpoint 'Hospital.Controllers.MedicalRecordController.GetById (Hospital)'
2025-11-24 02:49:01.849 +02:00 [DBG] Connection id "0HNHAU3HQ5A6I" completed keep alive response.
2025-11-24 02:49:01.849 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:49:01.850 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:49:01.851 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:49:01.851 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/MedicalRecord/11 - 404 null application/problem+json; charset=utf-8 75.6989ms
2025-11-24 02:49:06.047 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/MedicalRecord/1 - null null
2025-11-24 02:49:06.051 +02:00 [DBG] 1 candidate(s) found for the request path '/api/MedicalRecord/1'
2025-11-24 02:49:06.052 +02:00 [DBG] Endpoint 'Hospital.Controllers.MedicalRecordController.GetById (Hospital)' with route pattern 'api/MedicalRecord/{id}' is valid for the request path '/api/MedicalRecord/1'
2025-11-24 02:49:06.052 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.MedicalRecordController.GetById (Hospital)'
2025-11-24 02:49:06.053 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:49:06.054 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:49:06.054 +02:00 [INF] Executing endpoint 'Hospital.Controllers.MedicalRecordController.GetById (Hospital)'
2025-11-24 02:49:06.055 +02:00 [INF] Route matched with {action = "GetById", controller = "MedicalRecord"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Hospital.Application.DTO.MedicalRecord.PatientMedicalRecordDto]] GetById(Int32) on controller Hospital.Controllers.MedicalRecordController (Hospital).
2025-11-24 02:49:06.055 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:49:06.056 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:49:06.056 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:49:06.057 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:49:06.058 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:49:06.059 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.MedicalRecordController (Hospital)
2025-11-24 02:49:06.061 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.MedicalRecordController (Hospital)
2025-11-24 02:49:06.062 +02:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-11-24 02:49:06.062 +02:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-11-24 02:49:06.063 +02:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-11-24 02:49:06.063 +02:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-11-24 02:49:06.064 +02:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-11-24 02:49:06.065 +02:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-11-24 02:49:06.065 +02:00 [INF] get medical  record by id called at "2025-11-24T02:49:06.0657429+02:00"
2025-11-24 02:49:06.066 +02:00 [INF] Fetching medical record with RecordId 1
2025-11-24 02:49:06.066 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:49:06.067 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:49:06.067 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:49:06.068 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:49:06.069 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:49:06.070 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:49:06.071 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:49:06.072 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 02:49:06.072 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt]
FROM [MedicalRecords] AS [m]
INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
INNER JOIN [Patients] AS [p] ON [m].[PatientId] = [p].[PatientId]
INNER JOIN [Appointments] AS [a] ON [m].[AppointmentId] = [a].[AppointmentId]
WHERE [m].[RecordId] = @__id_0
2025-11-24 02:49:06.075 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt]
FROM [MedicalRecords] AS [m]
INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
INNER JOIN [Patients] AS [p] ON [m].[PatientId] = [p].[PatientId]
INNER JOIN [Appointments] AS [a] ON [m].[AppointmentId] = [a].[AppointmentId]
WHERE [m].[RecordId] = @__id_0
2025-11-24 02:49:06.077 +02:00 [DBG] Context 'AppDbContext' started tracking 'MedicalRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:06.077 +02:00 [DBG] The navigation 'MedicalRecord.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:06.078 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:06.078 +02:00 [DBG] The navigation 'MedicalRecord.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:06.079 +02:00 [DBG] Context 'AppDbContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:06.081 +02:00 [DBG] The navigation 'MedicalRecord.Appointment' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:06.082 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:06.082 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:49:06.083 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 5ms reading results.
2025-11-24 02:49:06.084 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:49:06.084 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:49:06.085 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:49:06.086 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:49:06.087 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:49:06.087 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:49:06.087 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:49:06.089 +02:00 [INF] Executing OkObjectResult, writing value of type 'Hospital.Application.DTO.MedicalRecord.MedicalRecordDto'.
2025-11-24 02:49:06.091 +02:00 [INF] Executed action Hospital.Controllers.MedicalRecordController.GetById (Hospital) in 31.8115ms
2025-11-24 02:49:06.092 +02:00 [INF] Executed endpoint 'Hospital.Controllers.MedicalRecordController.GetById (Hospital)'
2025-11-24 02:49:06.093 +02:00 [DBG] Connection id "0HNHAU3HQ5A6I" completed keep alive response.
2025-11-24 02:49:06.094 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:49:06.095 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:49:06.095 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:49:06.096 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/MedicalRecord/1 - 200 null application/json; charset=utf-8 48.5665ms
2025-11-24 02:49:16.821 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/MedicalRecord/by-doctor/1 - null null
2025-11-24 02:49:16.822 +02:00 [DBG] 1 candidate(s) found for the request path '/api/MedicalRecord/by-doctor/1'
2025-11-24 02:49:16.823 +02:00 [DBG] Endpoint 'Hospital.Controllers.MedicalRecordController.GetByDoctor (Hospital)' with route pattern 'api/MedicalRecord/by-doctor/{doctorId}' is valid for the request path '/api/MedicalRecord/by-doctor/1'
2025-11-24 02:49:16.823 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.MedicalRecordController.GetByDoctor (Hospital)'
2025-11-24 02:49:16.824 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:49:16.824 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:49:16.825 +02:00 [INF] Executing endpoint 'Hospital.Controllers.MedicalRecordController.GetByDoctor (Hospital)'
2025-11-24 02:49:16.827 +02:00 [INF] Route matched with {action = "GetByDoctor", controller = "MedicalRecord"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[Hospital.Application.DTO.MedicalRecord.PatientMedicalRecordDto]]] GetByDoctor(Int32) on controller Hospital.Controllers.MedicalRecordController (Hospital).
2025-11-24 02:49:16.830 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:49:16.832 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:49:16.832 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:49:16.833 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:49:16.834 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:49:16.834 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.MedicalRecordController (Hospital)
2025-11-24 02:49:16.835 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.MedicalRecordController (Hospital)
2025-11-24 02:49:16.837 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 02:49:16.838 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' using the name 'doctorId' in request data ...
2025-11-24 02:49:16.839 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 02:49:16.840 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 02:49:16.840 +02:00 [DBG] Attempting to validate the bound parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 02:49:16.841 +02:00 [DBG] Done attempting to validate the bound parameter 'doctorId' of type 'System.Int32'.
2025-11-24 02:49:16.842 +02:00 [INF] get medical record by doctor id   called at "2025-11-24T02:49:16.8425035+02:00"
2025-11-24 02:49:16.843 +02:00 [INF] Fetching medical records for DoctorId 1
2025-11-24 02:49:16.844 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:49:16.845 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:49:16.846 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:49:16.846 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:49:16.847 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:49:16.847 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:49:16.848 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:49:16.848 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:49:16.849 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:49:16.853 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:49:16.855 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:16.856 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:16.856 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:16.857 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:16.857 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:16.858 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:16.859 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:16.860 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:49:16.861 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 6ms reading results.
2025-11-24 02:49:16.862 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:49:16.863 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:49:16.865 +02:00 [DBG] Compiling query expression: 
'DbSet<MedicalRecord>()
    .Include(m => m.Patient)
    .Include(m => m.Doctor)
    .Include(m => m.Appointment)
    .Where(m => m.DoctorId == __doctorId_0)'
2025-11-24 02:49:16.866 +02:00 [DBG] Including navigation: 'MedicalRecord.Patient'.
2025-11-24 02:49:16.867 +02:00 [DBG] Including navigation: 'MedicalRecord.Doctor'.
2025-11-24 02:49:16.868 +02:00 [DBG] Including navigation: 'MedicalRecord.Appointment'.
2025-11-24 02:49:16.874 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<MedicalRecord>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: MedicalRecord.RecordId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: MedicalRecord.AppointmentId (int) Required FK Index, 1], [Property: MedicalRecord.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 2], [Property: MedicalRecord.Diagnosis (string), 3], [Property: MedicalRecord.DoctorId (int) Required FK Index, 4], [Property: MedicalRecord.Notes (string), 5], [Property: MedicalRecord.PatientId (int) Required FK Index, 6], [Property: MedicalRecord.TreatmentPlan (string), 7], [Property: MedicalRecord.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 8] }
            1 -> Dictionary<IProperty, int> { [Property: Patient.PatientId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 9], [Property: Patient.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 10], [Property: Patient.EmergencyContact (string) MaxLength(150), 11], [Property: Patient.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 12], [Property: Patient.UserId (string) Required FK Index, 13] }
            2 -> Dictionary<IProperty, int> { [Property: Doctor.DoctorId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 14], [Property: Doctor.Available (bool?), 15], [Property: Doctor.Biography (string), 16], [Property: Doctor.ConsultationFees (decimal) Required, 17], [Property: Doctor.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 18], [Property: Doctor.ExperienceYears (int?), 19], [Property: Doctor.ImageURL (string) MaxLength(300), 20], [Property: Doctor.SpecializationId (int) Required FK Index, 21], [Property: Doctor.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 22], [Property: Doctor.UserId (string) Required FK Index, 23] }
            3 -> Dictionary<IProperty, int> { [Property: Appointment.AppointmentId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 24], [Property: Appointment.BranchId (int) Required FK Index, 25], [Property: Appointment.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 26], [Property: Appointment.CreatedBy (string) FK Index, 27], [Property: Appointment.Date (DateOnly) Required, 28], [Property: Appointment.DoctorId (int) Required FK Index, 29], [Property: Appointment.Notes (string), 30], [Property: Appointment.PatientId (int) Required FK Index, 31], [Property: Appointment.PaymentMethod (PaymentMethod) Required, 32], [Property: Appointment.Status (AppointmentStatus) Required MaxLength(20), 33], [Property: Appointment.Time (DateTime) Required, 34], [Property: Appointment.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 35] }
        SELECT m.RecordId, m.AppointmentId, m.CreatedAt, m.Diagnosis, m.DoctorId, m.Notes, m.PatientId, m.TreatmentPlan, m.UpdatedAt, p.PatientId, p.CreatedAt, p.EmergencyContact, p.UpdatedAt, p.UserId, d.DoctorId, d.Available, d.Biography, d.ConsultationFees, d.CreatedAt, d.ExperienceYears, d.ImageURL, d.SpecializationId, d.UpdatedAt, d.UserId, a.AppointmentId, a.BranchId, a.CreatedAt, a.CreatedBy, a.Date, a.DoctorId, a.Notes, a.PatientId, a.PaymentMethod, a.Status, a.Time, a.UpdatedAt
        FROM MedicalRecords AS m
        INNER JOIN Patients AS p ON m.PatientId == p.PatientId
        INNER JOIN Doctors AS d ON m.DoctorId == d.DoctorId
        INNER JOIN Appointments AS a ON m.AppointmentId == a.AppointmentId
        WHERE m.DoctorId == @__doctorId_0), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, MedicalRecord>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 02:49:16.877 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:49:16.877 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:49:16.878 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:49:16.878 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:49:16.879 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:49:16.879 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt]
FROM [MedicalRecords] AS [m]
INNER JOIN [Patients] AS [p] ON [m].[PatientId] = [p].[PatientId]
INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
INNER JOIN [Appointments] AS [a] ON [m].[AppointmentId] = [a].[AppointmentId]
WHERE [m].[DoctorId] = @__doctorId_0
2025-11-24 02:49:16.885 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt]
FROM [MedicalRecords] AS [m]
INNER JOIN [Patients] AS [p] ON [m].[PatientId] = [p].[PatientId]
INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
INNER JOIN [Appointments] AS [a] ON [m].[AppointmentId] = [a].[AppointmentId]
WHERE [m].[DoctorId] = @__doctorId_0
2025-11-24 02:49:16.886 +02:00 [DBG] Context 'AppDbContext' started tracking 'MedicalRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:16.887 +02:00 [DBG] The navigation 'MedicalRecord.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:16.887 +02:00 [DBG] Context 'AppDbContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:16.888 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:16.888 +02:00 [DBG] The navigation 'MedicalRecord.Appointment' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:16.889 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:16.890 +02:00 [DBG] The navigation 'MedicalRecord.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:16.891 +02:00 [DBG] The navigation 'MedicalRecord.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:16.892 +02:00 [DBG] Context 'AppDbContext' started tracking 'MedicalRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:16.893 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:49:16.893 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 7ms reading results.
2025-11-24 02:49:16.894 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:49:16.894 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:49:16.900 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:49:16.901 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:49:16.902 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:49:16.902 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:49:16.903 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:49:16.903 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.MedicalRecord.MedicalRecordDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 02:49:16.904 +02:00 [INF] Executed action Hospital.Controllers.MedicalRecordController.GetByDoctor (Hospital) in 69.8411ms
2025-11-24 02:49:16.905 +02:00 [INF] Executed endpoint 'Hospital.Controllers.MedicalRecordController.GetByDoctor (Hospital)'
2025-11-24 02:49:16.906 +02:00 [DBG] Connection id "0HNHAU3HQ5A6I" completed keep alive response.
2025-11-24 02:49:16.907 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:49:16.909 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:49:16.910 +02:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-11-24 02:49:16.911 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/MedicalRecord/by-doctor/1 - 200 null application/json; charset=utf-8 90.7025ms
2025-11-24 02:49:28.006 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/MedicalRecord/by-patient/1 - null null
2025-11-24 02:49:28.007 +02:00 [DBG] 1 candidate(s) found for the request path '/api/MedicalRecord/by-patient/1'
2025-11-24 02:49:28.008 +02:00 [DBG] Endpoint 'Hospital.Controllers.MedicalRecordController.GetByPatient (Hospital)' with route pattern 'api/MedicalRecord/by-patient/{patientId}' is valid for the request path '/api/MedicalRecord/by-patient/1'
2025-11-24 02:49:28.009 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.MedicalRecordController.GetByPatient (Hospital)'
2025-11-24 02:49:28.010 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:49:28.011 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:49:28.011 +02:00 [INF] Executing endpoint 'Hospital.Controllers.MedicalRecordController.GetByPatient (Hospital)'
2025-11-24 02:49:28.014 +02:00 [INF] Route matched with {action = "GetByPatient", controller = "MedicalRecord"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[Hospital.Application.DTO.MedicalRecord.PatientMedicalRecordDto]]] GetByPatient(Int32) on controller Hospital.Controllers.MedicalRecordController (Hospital).
2025-11-24 02:49:28.015 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:49:28.016 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:49:28.017 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:49:28.018 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:49:28.019 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:49:28.020 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.MedicalRecordController (Hospital)
2025-11-24 02:49:28.022 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.MedicalRecordController (Hospital)
2025-11-24 02:49:28.022 +02:00 [DBG] Attempting to bind parameter 'patientId' of type 'System.Int32' ...
2025-11-24 02:49:28.023 +02:00 [DBG] Attempting to bind parameter 'patientId' of type 'System.Int32' using the name 'patientId' in request data ...
2025-11-24 02:49:28.023 +02:00 [DBG] Done attempting to bind parameter 'patientId' of type 'System.Int32'.
2025-11-24 02:49:28.024 +02:00 [DBG] Done attempting to bind parameter 'patientId' of type 'System.Int32'.
2025-11-24 02:49:28.024 +02:00 [DBG] Attempting to validate the bound parameter 'patientId' of type 'System.Int32' ...
2025-11-24 02:49:28.025 +02:00 [DBG] Done attempting to validate the bound parameter 'patientId' of type 'System.Int32'.
2025-11-24 02:49:28.026 +02:00 [INF] get medical record by patient id called at "2025-11-24T02:49:28.0261217+02:00"
2025-11-24 02:49:28.027 +02:00 [INF] Fetching medical records for PatientId 1
2025-11-24 02:49:28.027 +02:00 [INF] Fetching patient with ID: 1
2025-11-24 02:49:28.028 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:49:28.030 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:49:28.030 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:49:28.031 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:49:28.032 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:49:28.033 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:49:28.034 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:49:28.034 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:49:28.035 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 02:49:28.039 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 02:49:28.042 +02:00 [DBG] Context 'AppDbContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:28.043 +02:00 [DBG] The navigation 'Patient.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:28.043 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:28.044 +02:00 [DBG] Context 'AppDbContext' started tracking 'MedicalRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:28.044 +02:00 [DBG] The navigation 'MedicalRecord.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:28.045 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:28.045 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:28.046 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:28.047 +02:00 [DBG] The navigation 'MedicalRecord.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:28.048 +02:00 [DBG] Context 'AppDbContext' started tracking 'MedicalRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:28.049 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:49:28.049 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 7ms reading results.
2025-11-24 02:49:28.050 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:49:28.051 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:49:28.052 +02:00 [INF] Patient with ID 1 retrieved successfully
2025-11-24 02:49:28.054 +02:00 [DBG] Compiling query expression: 
'DbSet<MedicalRecord>()
    .Include(m => m.Patient)
    .Include(m => m.Doctor)
    .Include(m => m.Appointment)
    .Where(m => m.PatientId == __patientId_0)'
2025-11-24 02:49:28.055 +02:00 [DBG] Including navigation: 'MedicalRecord.Patient'.
2025-11-24 02:49:28.055 +02:00 [DBG] Including navigation: 'MedicalRecord.Doctor'.
2025-11-24 02:49:28.056 +02:00 [DBG] Including navigation: 'MedicalRecord.Appointment'.
2025-11-24 02:49:28.061 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<MedicalRecord>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: MedicalRecord.RecordId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: MedicalRecord.AppointmentId (int) Required FK Index, 1], [Property: MedicalRecord.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 2], [Property: MedicalRecord.Diagnosis (string), 3], [Property: MedicalRecord.DoctorId (int) Required FK Index, 4], [Property: MedicalRecord.Notes (string), 5], [Property: MedicalRecord.PatientId (int) Required FK Index, 6], [Property: MedicalRecord.TreatmentPlan (string), 7], [Property: MedicalRecord.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 8] }
            1 -> Dictionary<IProperty, int> { [Property: Patient.PatientId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 9], [Property: Patient.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 10], [Property: Patient.EmergencyContact (string) MaxLength(150), 11], [Property: Patient.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 12], [Property: Patient.UserId (string) Required FK Index, 13] }
            2 -> Dictionary<IProperty, int> { [Property: Doctor.DoctorId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 14], [Property: Doctor.Available (bool?), 15], [Property: Doctor.Biography (string), 16], [Property: Doctor.ConsultationFees (decimal) Required, 17], [Property: Doctor.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 18], [Property: Doctor.ExperienceYears (int?), 19], [Property: Doctor.ImageURL (string) MaxLength(300), 20], [Property: Doctor.SpecializationId (int) Required FK Index, 21], [Property: Doctor.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 22], [Property: Doctor.UserId (string) Required FK Index, 23] }
            3 -> Dictionary<IProperty, int> { [Property: Appointment.AppointmentId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 24], [Property: Appointment.BranchId (int) Required FK Index, 25], [Property: Appointment.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 26], [Property: Appointment.CreatedBy (string) FK Index, 27], [Property: Appointment.Date (DateOnly) Required, 28], [Property: Appointment.DoctorId (int) Required FK Index, 29], [Property: Appointment.Notes (string), 30], [Property: Appointment.PatientId (int) Required FK Index, 31], [Property: Appointment.PaymentMethod (PaymentMethod) Required, 32], [Property: Appointment.Status (AppointmentStatus) Required MaxLength(20), 33], [Property: Appointment.Time (DateTime) Required, 34], [Property: Appointment.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 35] }
        SELECT m.RecordId, m.AppointmentId, m.CreatedAt, m.Diagnosis, m.DoctorId, m.Notes, m.PatientId, m.TreatmentPlan, m.UpdatedAt, p.PatientId, p.CreatedAt, p.EmergencyContact, p.UpdatedAt, p.UserId, d.DoctorId, d.Available, d.Biography, d.ConsultationFees, d.CreatedAt, d.ExperienceYears, d.ImageURL, d.SpecializationId, d.UpdatedAt, d.UserId, a.AppointmentId, a.BranchId, a.CreatedAt, a.CreatedBy, a.Date, a.DoctorId, a.Notes, a.PatientId, a.PaymentMethod, a.Status, a.Time, a.UpdatedAt
        FROM MedicalRecords AS m
        INNER JOIN Patients AS p ON m.PatientId == p.PatientId
        INNER JOIN Doctors AS d ON m.DoctorId == d.DoctorId
        INNER JOIN Appointments AS a ON m.AppointmentId == a.AppointmentId
        WHERE m.PatientId == @__patientId_0), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, MedicalRecord>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 02:49:28.064 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:49:28.065 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:49:28.066 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:49:28.066 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:49:28.067 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:49:28.067 +02:00 [DBG] Executing DbCommand [Parameters=[@__patientId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt]
FROM [MedicalRecords] AS [m]
INNER JOIN [Patients] AS [p] ON [m].[PatientId] = [p].[PatientId]
INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
INNER JOIN [Appointments] AS [a] ON [m].[AppointmentId] = [a].[AppointmentId]
WHERE [m].[PatientId] = @__patientId_0
2025-11-24 02:49:28.074 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@__patientId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt]
FROM [MedicalRecords] AS [m]
INNER JOIN [Patients] AS [p] ON [m].[PatientId] = [p].[PatientId]
INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
INNER JOIN [Appointments] AS [a] ON [m].[AppointmentId] = [a].[AppointmentId]
WHERE [m].[PatientId] = @__patientId_0
2025-11-24 02:49:28.075 +02:00 [DBG] The navigation 'MedicalRecord.Appointment' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:28.076 +02:00 [DBG] The navigation 'MedicalRecord.Appointment' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:28.076 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:28.077 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:49:28.077 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 2ms reading results.
2025-11-24 02:49:28.078 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:49:28.078 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:49:28.079 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:49:28.081 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:49:28.082 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:49:28.082 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:49:28.082 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:49:28.083 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.MedicalRecord.MedicalRecordDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 02:49:28.084 +02:00 [INF] Executed action Hospital.Controllers.MedicalRecordController.GetByPatient (Hospital) in 64.3108ms
2025-11-24 02:49:28.084 +02:00 [INF] Executed endpoint 'Hospital.Controllers.MedicalRecordController.GetByPatient (Hospital)'
2025-11-24 02:49:28.085 +02:00 [DBG] Connection id "0HNHAU3HQ5A6I" completed keep alive response.
2025-11-24 02:49:28.086 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:49:28.086 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:49:28.087 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:49:28.087 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/MedicalRecord/by-patient/1 - 200 null application/json; charset=utf-8 81.1255ms
2025-11-24 02:49:38.498 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/MedicalRecord/records/doctor/1/patient/1 - null null
2025-11-24 02:49:38.502 +02:00 [DBG] 1 candidate(s) found for the request path '/api/MedicalRecord/records/doctor/1/patient/1'
2025-11-24 02:49:38.503 +02:00 [DBG] Endpoint 'Hospital.Controllers.MedicalRecordController.GetHistory (Hospital)' with route pattern 'api/MedicalRecord/records/doctor/{doctorId}/patient/{patientId}' is valid for the request path '/api/MedicalRecord/records/doctor/1/patient/1'
2025-11-24 02:49:38.504 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.MedicalRecordController.GetHistory (Hospital)'
2025-11-24 02:49:38.504 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:49:38.505 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:49:38.505 +02:00 [INF] Executing endpoint 'Hospital.Controllers.MedicalRecordController.GetHistory (Hospital)'
2025-11-24 02:49:38.508 +02:00 [INF] Route matched with {action = "GetHistory", controller = "MedicalRecord"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetHistory(Int32, Int32) on controller Hospital.Controllers.MedicalRecordController (Hospital).
2025-11-24 02:49:38.510 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:49:38.511 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:49:38.512 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:49:38.514 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:49:38.515 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:49:38.516 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.MedicalRecordController (Hospital)
2025-11-24 02:49:38.516 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.MedicalRecordController (Hospital)
2025-11-24 02:49:38.517 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 02:49:38.517 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' using the name 'doctorId' in request data ...
2025-11-24 02:49:38.518 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 02:49:38.519 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 02:49:38.519 +02:00 [DBG] Attempting to validate the bound parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 02:49:38.520 +02:00 [DBG] Done attempting to validate the bound parameter 'doctorId' of type 'System.Int32'.
2025-11-24 02:49:38.520 +02:00 [DBG] Attempting to bind parameter 'patientId' of type 'System.Int32' ...
2025-11-24 02:49:38.522 +02:00 [DBG] Attempting to bind parameter 'patientId' of type 'System.Int32' using the name 'patientId' in request data ...
2025-11-24 02:49:38.522 +02:00 [DBG] Done attempting to bind parameter 'patientId' of type 'System.Int32'.
2025-11-24 02:49:38.523 +02:00 [DBG] Done attempting to bind parameter 'patientId' of type 'System.Int32'.
2025-11-24 02:49:38.524 +02:00 [DBG] Attempting to validate the bound parameter 'patientId' of type 'System.Int32' ...
2025-11-24 02:49:38.524 +02:00 [DBG] Done attempting to validate the bound parameter 'patientId' of type 'System.Int32'.
2025-11-24 02:49:38.525 +02:00 [INF] get medical record history by doctor id and patient id   called at "2025-11-24T02:49:38.5254060+02:00"
2025-11-24 02:49:38.526 +02:00 [INF] Fetching medical records between DoctorId 1 and PatientId 1
2025-11-24 02:49:38.527 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:49:38.528 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:49:38.528 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:49:38.529 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:49:38.530 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:49:38.530 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:49:38.531 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:49:38.532 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:49:38.532 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:49:38.535 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:49:38.538 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:38.539 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:38.539 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:38.540 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:38.541 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:38.541 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:38.542 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:38.543 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:49:38.543 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 5ms reading results.
2025-11-24 02:49:38.544 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:49:38.544 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:49:38.545 +02:00 [INF] Fetching patient with ID: 1
2025-11-24 02:49:38.545 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:49:38.546 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:49:38.546 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:49:38.547 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:49:38.547 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:49:38.548 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 02:49:38.551 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 02:49:38.554 +02:00 [DBG] Context 'AppDbContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:38.555 +02:00 [DBG] The navigation 'Patient.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:38.556 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:38.556 +02:00 [DBG] The navigation 'MedicalRecord.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:38.557 +02:00 [DBG] Context 'AppDbContext' started tracking 'MedicalRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:38.557 +02:00 [DBG] The navigation 'MedicalRecord.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:38.558 +02:00 [DBG] Context 'AppDbContext' started tracking 'MedicalRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:38.559 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:49:38.559 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 4ms reading results.
2025-11-24 02:49:38.560 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:49:38.560 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:49:38.561 +02:00 [INF] Patient with ID 1 retrieved successfully
2025-11-24 02:49:38.563 +02:00 [DBG] Compiling query expression: 
'DbSet<MedicalRecord>()
    .Include(r => r.Doctor)
    .ThenInclude(d => d.User)
    .Include(r => r.Patient)
    .ThenInclude(p => p.User)
    .Include(r => r.Appointment)
    .ThenInclude(a => a.Branch)
    .Where(r => r.DoctorId == __doctorId_0 && r.PatientId == __patientId_1)'
2025-11-24 02:49:38.564 +02:00 [DBG] Including navigation: 'MedicalRecord.Doctor'.
2025-11-24 02:49:38.565 +02:00 [DBG] Including navigation: 'Doctor.User'.
2025-11-24 02:49:38.566 +02:00 [DBG] Including navigation: 'MedicalRecord.Patient'.
2025-11-24 02:49:38.566 +02:00 [DBG] Including navigation: 'Patient.User'.
2025-11-24 02:49:38.567 +02:00 [DBG] Including navigation: 'MedicalRecord.Appointment'.
2025-11-24 02:49:38.568 +02:00 [DBG] Including navigation: 'Appointment.Branch'.
2025-11-24 02:49:38.582 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<MedicalRecord>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: MedicalRecord.RecordId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: MedicalRecord.AppointmentId (int) Required FK Index, 1], [Property: MedicalRecord.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 2], [Property: MedicalRecord.Diagnosis (string), 3], [Property: MedicalRecord.DoctorId (int) Required FK Index, 4], [Property: MedicalRecord.Notes (string), 5], [Property: MedicalRecord.PatientId (int) Required FK Index, 6], [Property: MedicalRecord.TreatmentPlan (string), 7], [Property: MedicalRecord.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 8] }
            1 -> Dictionary<IProperty, int> { [Property: Doctor.DoctorId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 9], [Property: Doctor.Available (bool?), 10], [Property: Doctor.Biography (string), 11], [Property: Doctor.ConsultationFees (decimal) Required, 12], [Property: Doctor.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 13], [Property: Doctor.ExperienceYears (int?), 14], [Property: Doctor.ImageURL (string) MaxLength(300), 15], [Property: Doctor.SpecializationId (int) Required FK Index, 16], [Property: Doctor.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 17], [Property: Doctor.UserId (string) Required FK Index, 18] }
            2 -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 19], [Property: User.AccessFailedCount (int) Required, 20], [Property: User.ConcurrencyStamp (string) Concurrency, 21], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 22], [Property: User.DateOfBirth (DateOnly?), 23], [Property: User.Email (string) Index MaxLength(256), 24], [Property: User.EmailConfirmed (bool) Required, 25], [Property: User.FullName (string) Required MaxLength(150), 26], [Property: User.Gender (GenderType?) MaxLength(10), 27], [Property: User.LockoutEnabled (bool) Required, 28], [Property: User.LockoutEnd (DateTimeOffset?), 29], [Property: User.NormalizedEmail (string) Index MaxLength(256), 30], [Property: User.NormalizedUserName (string) Index MaxLength(256), 31], [Property: User.PasswordHash (string), 32], [Property: User.PhoneNumber (string), 33], [Property: User.PhoneNumberConfirmed (bool) Required, 34], [Property: User.RefreshToken (string), 35], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 36], [Property: User.Role (string) Required MaxLength(50), 37], [Property: User.SecurityStamp (string), 38], [Property: User.TwoFactorEnabled (bool) Required, 39], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 40], [Property: User.UserName (string) MaxLength(256), 41] }
            3 -> Dictionary<IProperty, int> { [Property: Patient.PatientId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 42], [Property: Patient.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 43], [Property: Patient.EmergencyContact (string) MaxLength(150), 44], [Property: Patient.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 45], [Property: Patient.UserId (string) Required FK Index, 46] }
            4 -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 47], [Property: User.AccessFailedCount (int) Required, 48], [Property: User.ConcurrencyStamp (string) Concurrency, 49], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 50], [Property: User.DateOfBirth (DateOnly?), 51], [Property: User.Email (string) Index MaxLength(256), 52], [Property: User.EmailConfirmed (bool) Required, 53], [Property: User.FullName (string) Required MaxLength(150), 54], [Property: User.Gender (GenderType?) MaxLength(10), 55], [Property: User.LockoutEnabled (bool) Required, 56], [Property: User.LockoutEnd (DateTimeOffset?), 57], [Property: User.NormalizedEmail (string) Index MaxLength(256), 58], [Property: User.NormalizedUserName (string) Index MaxLength(256), 59], [Property: User.PasswordHash (string), 60], [Property: User.PhoneNumber (string), 61], [Property: User.PhoneNumberConfirmed (bool) Required, 62], [Property: User.RefreshToken (string), 63], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 64], [Property: User.Role (string) Required MaxLength(50), 65], [Property: User.SecurityStamp (string), 66], [Property: User.TwoFactorEnabled (bool) Required, 67], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 68], [Property: User.UserName (string) MaxLength(256), 69] }
            5 -> Dictionary<IProperty, int> { [Property: Appointment.AppointmentId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 70], [Property: Appointment.BranchId (int) Required FK Index, 71], [Property: Appointment.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 72], [Property: Appointment.CreatedBy (string) FK Index, 73], [Property: Appointment.Date (DateOnly) Required, 74], [Property: Appointment.DoctorId (int) Required FK Index, 75], [Property: Appointment.Notes (string), 76], [Property: Appointment.PatientId (int) Required FK Index, 77], [Property: Appointment.PaymentMethod (PaymentMethod) Required, 78], [Property: Appointment.Status (AppointmentStatus) Required MaxLength(20), 79], [Property: Appointment.Time (DateTime) Required, 80], [Property: Appointment.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 81] }
            6 -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 82], [Property: Branch.Address (string) MaxLength(250), 83], [Property: Branch.BranchName (string) Required MaxLength(150), 84], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 85], [Property: Branch.Description (string), 86], [Property: Branch.Email (string) MaxLength(200), 87], [Property: Branch.ImageURL (string) MaxLength(300), 88], [Property: Branch.Phone (string) MaxLength(25), 89], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 90] }
        SELECT m.RecordId, m.AppointmentId, m.CreatedAt, m.Diagnosis, m.DoctorId, m.Notes, m.PatientId, m.TreatmentPlan, m.UpdatedAt, d.DoctorId, d.Available, d.Biography, d.ConsultationFees, d.CreatedAt, d.ExperienceYears, d.ImageURL, d.SpecializationId, d.UpdatedAt, d.UserId, u.Id, u.AccessFailedCount, u.ConcurrencyStamp, u.CreatedAt, u.DateOfBirth, u.Email, u.EmailConfirmed, u.FullName, u.Gender, u.LockoutEnabled, u.LockoutEnd, u.NormalizedEmail, u.NormalizedUserName, u.PasswordHash, u.PhoneNumber, u.PhoneNumberConfirmed, u.RefreshToken, u.RefreshTokenExpiryTime, u.Role, u.SecurityStamp, u.TwoFactorEnabled, u.UpdatedAt, u.UserName, p.PatientId, p.CreatedAt, p.EmergencyContact, p.UpdatedAt, p.UserId, u0.Id, u0.AccessFailedCount, u0.ConcurrencyStamp, u0.CreatedAt, u0.DateOfBirth, u0.Email, u0.EmailConfirmed, u0.FullName, u0.Gender, u0.LockoutEnabled, u0.LockoutEnd, u0.NormalizedEmail, u0.NormalizedUserName, u0.PasswordHash, u0.PhoneNumber, u0.PhoneNumberConfirmed, u0.RefreshToken, u0.RefreshTokenExpiryTime, u0.Role, u0.SecurityStamp, u0.TwoFactorEnabled, u0.UpdatedAt, u0.UserName, a.AppointmentId, a.BranchId, a.CreatedAt, a.CreatedBy, a.Date, a.DoctorId, a.Notes, a.PatientId, a.PaymentMethod, a.Status, a.Time, a.UpdatedAt, b.BranchId, b.Address, b.BranchName, b.CreatedAt, b.Description, b.Email, b.ImageURL, b.Phone, b.UpdatedAt
        FROM MedicalRecords AS m
        INNER JOIN Doctors AS d ON m.DoctorId == d.DoctorId
        INNER JOIN Users AS u ON d.UserId == u.Id
        INNER JOIN Patients AS p ON m.PatientId == p.PatientId
        INNER JOIN Users AS u0 ON p.UserId == u0.Id
        INNER JOIN Appointments AS a ON m.AppointmentId == a.AppointmentId
        INNER JOIN Branches AS b ON a.BranchId == b.BranchId
        WHERE (m.DoctorId == @__doctorId_0) && (m.PatientId == @__patientId_1)), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, MedicalRecord>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 02:49:38.586 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:49:38.587 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:49:38.587 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:49:38.587 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:49:38.588 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:49:38.588 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32), @__patientId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt], [u0].[UserName], [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [MedicalRecords] AS [m]
INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
INNER JOIN [Patients] AS [p] ON [m].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u0] ON [p].[UserId] = [u0].[Id]
INNER JOIN [Appointments] AS [a] ON [m].[AppointmentId] = [a].[AppointmentId]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [m].[DoctorId] = @__doctorId_0 AND [m].[PatientId] = @__patientId_1
2025-11-24 02:49:38.604 +02:00 [INF] Executed DbCommand (16ms) [Parameters=[@__doctorId_0='?' (DbType = Int32), @__patientId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt], [u0].[UserName], [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [MedicalRecords] AS [m]
INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
INNER JOIN [Patients] AS [p] ON [m].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u0] ON [p].[UserId] = [u0].[Id]
INNER JOIN [Appointments] AS [a] ON [m].[AppointmentId] = [a].[AppointmentId]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [m].[DoctorId] = @__doctorId_0 AND [m].[PatientId] = @__patientId_1
2025-11-24 02:49:38.606 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:38.607 +02:00 [DBG] The navigation 'MedicalRecord.Appointment' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:38.607 +02:00 [DBG] The navigation 'MedicalRecord.Appointment' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:38.608 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:38.611 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:49:38.612 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 5ms reading results.
2025-11-24 02:49:38.613 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:49:38.614 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:49:38.615 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:49:38.616 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:49:38.616 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:49:38.617 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:49:38.617 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:49:38.617 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.MedicalRecord.MedicalRecordDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 02:49:38.619 +02:00 [INF] Executed action Hospital.Controllers.MedicalRecordController.GetHistory (Hospital) in 103.9084ms
2025-11-24 02:49:38.620 +02:00 [INF] Executed endpoint 'Hospital.Controllers.MedicalRecordController.GetHistory (Hospital)'
2025-11-24 02:49:38.620 +02:00 [DBG] Connection id "0HNHAU3HQ5A6I" completed keep alive response.
2025-11-24 02:49:38.621 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:49:38.621 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:49:38.622 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:49:38.623 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/MedicalRecord/records/doctor/1/patient/1 - 200 null application/json; charset=utf-8 125.0024ms
2025-11-24 02:49:44.912 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/MedicalRecord/records/doctor/2/patient/1 - null null
2025-11-24 02:49:44.914 +02:00 [DBG] 1 candidate(s) found for the request path '/api/MedicalRecord/records/doctor/2/patient/1'
2025-11-24 02:49:44.915 +02:00 [DBG] Endpoint 'Hospital.Controllers.MedicalRecordController.GetHistory (Hospital)' with route pattern 'api/MedicalRecord/records/doctor/{doctorId}/patient/{patientId}' is valid for the request path '/api/MedicalRecord/records/doctor/2/patient/1'
2025-11-24 02:49:44.916 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.MedicalRecordController.GetHistory (Hospital)'
2025-11-24 02:49:44.916 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:49:44.916 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:49:44.917 +02:00 [INF] Executing endpoint 'Hospital.Controllers.MedicalRecordController.GetHistory (Hospital)'
2025-11-24 02:49:44.917 +02:00 [INF] Route matched with {action = "GetHistory", controller = "MedicalRecord"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetHistory(Int32, Int32) on controller Hospital.Controllers.MedicalRecordController (Hospital).
2025-11-24 02:49:44.918 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:49:44.919 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:49:44.919 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:49:44.920 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:49:44.921 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:49:44.921 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.MedicalRecordController (Hospital)
2025-11-24 02:49:44.922 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.MedicalRecordController (Hospital)
2025-11-24 02:49:44.922 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 02:49:44.923 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' using the name 'doctorId' in request data ...
2025-11-24 02:49:44.924 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 02:49:44.924 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 02:49:44.924 +02:00 [DBG] Attempting to validate the bound parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 02:49:44.925 +02:00 [DBG] Done attempting to validate the bound parameter 'doctorId' of type 'System.Int32'.
2025-11-24 02:49:44.925 +02:00 [DBG] Attempting to bind parameter 'patientId' of type 'System.Int32' ...
2025-11-24 02:49:44.925 +02:00 [DBG] Attempting to bind parameter 'patientId' of type 'System.Int32' using the name 'patientId' in request data ...
2025-11-24 02:49:44.926 +02:00 [DBG] Done attempting to bind parameter 'patientId' of type 'System.Int32'.
2025-11-24 02:49:44.926 +02:00 [DBG] Done attempting to bind parameter 'patientId' of type 'System.Int32'.
2025-11-24 02:49:44.927 +02:00 [DBG] Attempting to validate the bound parameter 'patientId' of type 'System.Int32' ...
2025-11-24 02:49:44.927 +02:00 [DBG] Done attempting to validate the bound parameter 'patientId' of type 'System.Int32'.
2025-11-24 02:49:44.927 +02:00 [INF] get medical record history by doctor id and patient id   called at "2025-11-24T02:49:44.9279762+02:00"
2025-11-24 02:49:44.928 +02:00 [INF] Fetching medical records between DoctorId 2 and PatientId 1
2025-11-24 02:49:44.929 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:49:44.931 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:49:44.931 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:49:44.931 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:49:44.933 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:49:44.933 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:49:44.933 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:49:44.934 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:49:44.935 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:49:44.937 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:49:44.940 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:44.941 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:44.941 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:44.942 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:44.943 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:44.943 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:44.943 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:44.944 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:44.945 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:49:44.945 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 5ms reading results.
2025-11-24 02:49:44.946 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:49:44.947 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:49:44.947 +02:00 [INF] Fetching patient with ID: 1
2025-11-24 02:49:44.948 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:49:44.949 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:49:44.950 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:49:44.950 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:49:44.951 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:49:44.952 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 02:49:44.954 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 02:49:44.956 +02:00 [DBG] Context 'AppDbContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:44.957 +02:00 [DBG] The navigation 'Patient.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:44.958 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:44.958 +02:00 [DBG] Context 'AppDbContext' started tracking 'MedicalRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:44.959 +02:00 [DBG] The navigation 'MedicalRecord.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:44.959 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:44.960 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:44.960 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:44.961 +02:00 [DBG] The navigation 'MedicalRecord.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:44.962 +02:00 [DBG] Context 'AppDbContext' started tracking 'MedicalRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:49:44.963 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:49:44.963 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 6ms reading results.
2025-11-24 02:49:44.964 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:49:44.964 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:49:44.965 +02:00 [INF] Patient with ID 1 retrieved successfully
2025-11-24 02:49:44.965 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:49:44.966 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:49:44.967 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:49:44.967 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:49:44.968 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:49:44.969 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32), @__patientId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt], [u0].[UserName], [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [MedicalRecords] AS [m]
INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
INNER JOIN [Patients] AS [p] ON [m].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u0] ON [p].[UserId] = [u0].[Id]
INNER JOIN [Appointments] AS [a] ON [m].[AppointmentId] = [a].[AppointmentId]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [m].[DoctorId] = @__doctorId_0 AND [m].[PatientId] = @__patientId_1
2025-11-24 02:49:44.971 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__doctorId_0='?' (DbType = Int32), @__patientId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt], [u0].[UserName], [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [MedicalRecords] AS [m]
INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
INNER JOIN [Patients] AS [p] ON [m].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u0] ON [p].[UserId] = [u0].[Id]
INNER JOIN [Appointments] AS [a] ON [m].[AppointmentId] = [a].[AppointmentId]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [m].[DoctorId] = @__doctorId_0 AND [m].[PatientId] = @__patientId_1
2025-11-24 02:49:44.973 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:49:44.974 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:49:44.975 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:49:44.975 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:49:44.976 +02:00 [INF] No medical records found between DoctorId 2 and PatientId 1
2025-11-24 02:49:44.976 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:49:44.978 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:49:44.978 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:49:44.979 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:49:44.979 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:49:44.980 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.MedicalRecord.MedicalRecordDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 02:49:44.981 +02:00 [INF] Executed action Hospital.Controllers.MedicalRecordController.GetHistory (Hospital) in 59.6087ms
2025-11-24 02:49:44.981 +02:00 [INF] Executed endpoint 'Hospital.Controllers.MedicalRecordController.GetHistory (Hospital)'
2025-11-24 02:49:44.982 +02:00 [DBG] Connection id "0HNHAU3HQ5A6I" completed keep alive response.
2025-11-24 02:49:44.982 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:49:44.983 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:49:44.983 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:49:44.984 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/MedicalRecord/records/doctor/2/patient/1 - 200 null application/json; charset=utf-8 72.5533ms
2025-11-24 02:49:56.900 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/MedicalRecord/records/doctor/6/patient/1 - null null
2025-11-24 02:49:56.902 +02:00 [DBG] 1 candidate(s) found for the request path '/api/MedicalRecord/records/doctor/6/patient/1'
2025-11-24 02:49:56.904 +02:00 [DBG] Endpoint 'Hospital.Controllers.MedicalRecordController.GetHistory (Hospital)' with route pattern 'api/MedicalRecord/records/doctor/{doctorId}/patient/{patientId}' is valid for the request path '/api/MedicalRecord/records/doctor/6/patient/1'
2025-11-24 02:49:56.905 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.MedicalRecordController.GetHistory (Hospital)'
2025-11-24 02:49:56.905 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:49:56.906 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:49:56.907 +02:00 [INF] Executing endpoint 'Hospital.Controllers.MedicalRecordController.GetHistory (Hospital)'
2025-11-24 02:49:56.908 +02:00 [INF] Route matched with {action = "GetHistory", controller = "MedicalRecord"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetHistory(Int32, Int32) on controller Hospital.Controllers.MedicalRecordController (Hospital).
2025-11-24 02:49:56.910 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:49:56.911 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:49:56.913 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:49:56.914 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:49:56.915 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:49:56.916 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.MedicalRecordController (Hospital)
2025-11-24 02:49:56.917 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.MedicalRecordController (Hospital)
2025-11-24 02:49:56.918 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 02:49:56.919 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' using the name 'doctorId' in request data ...
2025-11-24 02:49:56.920 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 02:49:56.921 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 02:49:56.922 +02:00 [DBG] Attempting to validate the bound parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 02:49:56.923 +02:00 [DBG] Done attempting to validate the bound parameter 'doctorId' of type 'System.Int32'.
2025-11-24 02:49:56.924 +02:00 [DBG] Attempting to bind parameter 'patientId' of type 'System.Int32' ...
2025-11-24 02:49:56.925 +02:00 [DBG] Attempting to bind parameter 'patientId' of type 'System.Int32' using the name 'patientId' in request data ...
2025-11-24 02:49:56.925 +02:00 [DBG] Done attempting to bind parameter 'patientId' of type 'System.Int32'.
2025-11-24 02:49:56.926 +02:00 [DBG] Done attempting to bind parameter 'patientId' of type 'System.Int32'.
2025-11-24 02:49:56.927 +02:00 [DBG] Attempting to validate the bound parameter 'patientId' of type 'System.Int32' ...
2025-11-24 02:49:56.928 +02:00 [DBG] Done attempting to validate the bound parameter 'patientId' of type 'System.Int32'.
2025-11-24 02:49:56.930 +02:00 [INF] get medical record history by doctor id and patient id   called at "2025-11-24T02:49:56.9300675+02:00"
2025-11-24 02:49:56.930 +02:00 [INF] Fetching medical records between DoctorId 6 and PatientId 1
2025-11-24 02:49:56.932 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:49:56.933 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:49:56.933 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:49:56.934 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:49:56.935 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:49:56.936 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:49:56.937 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:49:56.937 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:49:56.938 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:49:56.951 +02:00 [INF] Executed DbCommand (13ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:49:56.954 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:49:56.955 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 1ms reading results.
2025-11-24 02:49:56.956 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:49:56.957 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:49:56.958 +02:00 [WRN] Doctor with Id 6 not found
2025-11-24 02:49:56.990 +02:00 [INF] Executed action Hospital.Controllers.MedicalRecordController.GetHistory (Hospital) in 73.4285ms
2025-11-24 02:49:56.991 +02:00 [INF] Executed endpoint 'Hospital.Controllers.MedicalRecordController.GetHistory (Hospital)'
2025-11-24 02:49:57.026 +02:00 [ERR]  Exception caught: Doctor with Id 6 not found
System.Exception: Doctor with Id 6 not found
   at Hospital.Infrastructure.Services.MedicalRecordService.GetRecordsBetweenDoctorAndPatientAsync(Int32 doctorId, Int32 patientId) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\MedicalRecordService.cs:line 199
   at Hospital.Controllers.MedicalRecordController.GetHistory(Int32 doctorId, Int32 patientId) in D:\Walaa\GP\Hospital\Hospital\Controllers\MedicalRecordController.cs:line 90
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
2025-11-24 02:49:57.030 +02:00 [DBG] Connection id "0HNHAU3HQ5A6I" completed keep alive response.
2025-11-24 02:49:57.031 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:49:57.031 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:49:57.032 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:49:57.032 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/MedicalRecord/records/doctor/6/patient/1 - 500 null application/json 131.9971ms
2025-11-24 02:50:05.350 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/MedicalRecord/records/doctor/2/patient/7 - null null
2025-11-24 02:50:05.352 +02:00 [DBG] 1 candidate(s) found for the request path '/api/MedicalRecord/records/doctor/2/patient/7'
2025-11-24 02:50:05.352 +02:00 [DBG] Endpoint 'Hospital.Controllers.MedicalRecordController.GetHistory (Hospital)' with route pattern 'api/MedicalRecord/records/doctor/{doctorId}/patient/{patientId}' is valid for the request path '/api/MedicalRecord/records/doctor/2/patient/7'
2025-11-24 02:50:05.353 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.MedicalRecordController.GetHistory (Hospital)'
2025-11-24 02:50:05.354 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:50:05.355 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:50:05.355 +02:00 [INF] Executing endpoint 'Hospital.Controllers.MedicalRecordController.GetHistory (Hospital)'
2025-11-24 02:50:05.356 +02:00 [INF] Route matched with {action = "GetHistory", controller = "MedicalRecord"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetHistory(Int32, Int32) on controller Hospital.Controllers.MedicalRecordController (Hospital).
2025-11-24 02:50:05.357 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:50:05.358 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:50:05.359 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:50:05.360 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:50:05.360 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:50:05.361 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.MedicalRecordController (Hospital)
2025-11-24 02:50:05.362 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.MedicalRecordController (Hospital)
2025-11-24 02:50:05.362 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 02:50:05.363 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' using the name 'doctorId' in request data ...
2025-11-24 02:50:05.364 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 02:50:05.364 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 02:50:05.365 +02:00 [DBG] Attempting to validate the bound parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 02:50:05.366 +02:00 [DBG] Done attempting to validate the bound parameter 'doctorId' of type 'System.Int32'.
2025-11-24 02:50:05.368 +02:00 [DBG] Attempting to bind parameter 'patientId' of type 'System.Int32' ...
2025-11-24 02:50:05.369 +02:00 [DBG] Attempting to bind parameter 'patientId' of type 'System.Int32' using the name 'patientId' in request data ...
2025-11-24 02:50:05.369 +02:00 [DBG] Done attempting to bind parameter 'patientId' of type 'System.Int32'.
2025-11-24 02:50:05.371 +02:00 [DBG] Done attempting to bind parameter 'patientId' of type 'System.Int32'.
2025-11-24 02:50:05.372 +02:00 [DBG] Attempting to validate the bound parameter 'patientId' of type 'System.Int32' ...
2025-11-24 02:50:05.373 +02:00 [DBG] Done attempting to validate the bound parameter 'patientId' of type 'System.Int32'.
2025-11-24 02:50:05.373 +02:00 [INF] get medical record history by doctor id and patient id   called at "2025-11-24T02:50:05.3739425+02:00"
2025-11-24 02:50:05.374 +02:00 [INF] Fetching medical records between DoctorId 2 and PatientId 7
2025-11-24 02:50:05.375 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:50:05.378 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:50:05.378 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:50:05.379 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:50:05.379 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:50:05.380 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:50:05.381 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:50:05.382 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 02:50:05.383 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:50:05.385 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:50:05.387 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:05.388 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:05.388 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:05.389 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:05.390 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:05.391 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:05.392 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:05.392 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:05.393 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:50:05.394 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 7ms reading results.
2025-11-24 02:50:05.395 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:50:05.395 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:50:05.396 +02:00 [INF] Fetching patient with ID: 7
2025-11-24 02:50:05.397 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:50:05.397 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:50:05.398 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:50:05.398 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:50:05.399 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:50:05.400 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 02:50:05.412 +02:00 [INF] Executed DbCommand (12ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 02:50:05.414 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:50:05.415 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:50:05.415 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:50:05.416 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:50:05.417 +02:00 [WRN] Patient with ID 7 not found
2025-11-24 02:50:05.430 +02:00 [ERR] Error while fetching patient with ID: 7
System.Collections.Generic.KeyNotFoundException: Patient with ID 7 not found
   at Hospital.Infrastructure.Services.PatientService.GetPatientByIdAsync(Int32 id) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\PatientService.cs:line 34
2025-11-24 02:50:05.477 +02:00 [INF] Executed action Hospital.Controllers.MedicalRecordController.GetHistory (Hospital) in 115.9392ms
2025-11-24 02:50:05.478 +02:00 [INF] Executed endpoint 'Hospital.Controllers.MedicalRecordController.GetHistory (Hospital)'
2025-11-24 02:50:05.514 +02:00 [ERR]  Exception caught: Patient with ID 7 not found
System.Collections.Generic.KeyNotFoundException: Patient with ID 7 not found
   at Hospital.Infrastructure.Services.PatientService.GetPatientByIdAsync(Int32 id) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\PatientService.cs:line 34
   at Hospital.Infrastructure.Services.MedicalRecordService.GetRecordsBetweenDoctorAndPatientAsync(Int32 doctorId, Int32 patientId) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\MedicalRecordService.cs:line 208
   at Hospital.Controllers.MedicalRecordController.GetHistory(Int32 doctorId, Int32 patientId) in D:\Walaa\GP\Hospital\Hospital\Controllers\MedicalRecordController.cs:line 90
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
2025-11-24 02:50:05.518 +02:00 [DBG] Connection id "0HNHAU3HQ5A6I" completed keep alive response.
2025-11-24 02:50:05.519 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:50:05.521 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:50:05.522 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:50:05.522 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/MedicalRecord/records/doctor/2/patient/7 - 404 null application/json 172.611ms
2025-11-24 02:50:21.634 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Appointment/1 - null null
2025-11-24 02:50:21.636 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Appointment/1'
2025-11-24 02:50:21.638 +02:00 [DBG] Endpoint 'Hospital.API.Controllers.AppointmentController.GetById (Hospital)' with route pattern 'api/Appointment/{id:int}' is valid for the request path '/api/Appointment/1'
2025-11-24 02:50:21.638 +02:00 [DBG] Request matched endpoint 'Hospital.API.Controllers.AppointmentController.GetById (Hospital)'
2025-11-24 02:50:21.639 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:50:21.640 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:50:21.640 +02:00 [INF] Executing endpoint 'Hospital.API.Controllers.AppointmentController.GetById (Hospital)'
2025-11-24 02:50:21.644 +02:00 [INF] Route matched with {action = "GetById", controller = "Appointment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetById(Int32) on controller Hospital.API.Controllers.AppointmentController (Hospital).
2025-11-24 02:50:21.645 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:50:21.645 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:50:21.646 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:50:21.647 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:50:21.648 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:50:21.648 +02:00 [DBG] Executing controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 02:50:21.649 +02:00 [DBG] Executed controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 02:50:21.650 +02:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-11-24 02:50:21.651 +02:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-11-24 02:50:21.652 +02:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-11-24 02:50:21.652 +02:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-11-24 02:50:21.653 +02:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-11-24 02:50:21.653 +02:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-11-24 02:50:21.654 +02:00 [INF] Get Appointment ByID called at "2025-11-24T02:50:21.6547614+02:00"
2025-11-24 02:50:21.655 +02:00 [INF] Fetching appointment by ID: 1
2025-11-24 02:50:21.656 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:50:21.657 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:50:21.657 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:50:21.658 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:50:21.659 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:50:21.660 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:50:21.660 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:50:21.661 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:50:21.662 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Doctors] AS [d] ON [a].[DoctorId] = [d].[DoctorId]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[AppointmentId] = @__id_0
2025-11-24 02:50:21.667 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Doctors] AS [d] ON [a].[DoctorId] = [d].[DoctorId]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[AppointmentId] = @__id_0
2025-11-24 02:50:21.668 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:21.669 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:21.670 +02:00 [DBG] Context 'AppDbContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:21.671 +02:00 [DBG] The navigation 'Appointment.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:21.672 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:21.673 +02:00 [DBG] The navigation 'Appointment.Branch' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:21.673 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:21.673 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:50:21.674 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 5ms reading results.
2025-11-24 02:50:21.674 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:50:21.674 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:50:21.675 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:50:21.676 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:50:21.676 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:50:21.677 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:50:21.677 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:50:21.678 +02:00 [INF] Executing OkObjectResult, writing value of type 'Hospital.Application.DTO.Appointment.AppointmentDto'.
2025-11-24 02:50:21.680 +02:00 [INF] Executed action Hospital.API.Controllers.AppointmentController.GetById (Hospital) in 32.0527ms
2025-11-24 02:50:21.681 +02:00 [INF] Executed endpoint 'Hospital.API.Controllers.AppointmentController.GetById (Hospital)'
2025-11-24 02:50:21.681 +02:00 [DBG] Connection id "0HNHAU3HQ5A6I" completed keep alive response.
2025-11-24 02:50:21.681 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:50:21.682 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:50:21.682 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:50:21.683 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Appointment/1 - 200 null application/json; charset=utf-8 49.0371ms
2025-11-24 02:50:32.387 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Appointment/doctor/1 - null null
2025-11-24 02:50:32.389 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Appointment/doctor/1'
2025-11-24 02:50:32.391 +02:00 [DBG] Endpoint 'Hospital.API.Controllers.AppointmentController.GetByDoctorId (Hospital)' with route pattern 'api/Appointment/doctor/{doctorId:int}' is valid for the request path '/api/Appointment/doctor/1'
2025-11-24 02:50:32.392 +02:00 [DBG] Request matched endpoint 'Hospital.API.Controllers.AppointmentController.GetByDoctorId (Hospital)'
2025-11-24 02:50:32.393 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:50:32.393 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:50:32.394 +02:00 [INF] Executing endpoint 'Hospital.API.Controllers.AppointmentController.GetByDoctorId (Hospital)'
2025-11-24 02:50:32.396 +02:00 [INF] Route matched with {action = "GetByDoctorId", controller = "Appointment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetByDoctorId(Int32) on controller Hospital.API.Controllers.AppointmentController (Hospital).
2025-11-24 02:50:32.397 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:50:32.398 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:50:32.399 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:50:32.399 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:50:32.401 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:50:32.401 +02:00 [DBG] Executing controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 02:50:32.402 +02:00 [DBG] Executed controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 02:50:32.403 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 02:50:32.403 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' using the name 'doctorId' in request data ...
2025-11-24 02:50:32.404 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 02:50:32.404 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 02:50:32.405 +02:00 [DBG] Attempting to validate the bound parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 02:50:32.405 +02:00 [DBG] Done attempting to validate the bound parameter 'doctorId' of type 'System.Int32'.
2025-11-24 02:50:32.406 +02:00 [INF] Get Appointment by GetByDoctorId  called at "2025-11-24T02:50:32.4068012+02:00"
2025-11-24 02:50:32.407 +02:00 [INF] Fetching appointments for DoctorId: 1
2025-11-24 02:50:32.408 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:50:32.409 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:50:32.409 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:50:32.410 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:50:32.410 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:50:32.411 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:50:32.411 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:50:32.412 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:50:32.413 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:50:32.416 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:50:32.418 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:32.418 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:32.419 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:32.419 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:32.420 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:32.420 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:32.421 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:32.421 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:50:32.422 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 4ms reading results.
2025-11-24 02:50:32.422 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:50:32.423 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:50:32.424 +02:00 [DBG] Compiling query expression: 
'DbSet<Appointment>()
    .Where(a => a.DoctorId == __doctorId_0)
    .Include(a => a.Patient)
    .Include(a => a.Branch)'
2025-11-24 02:50:32.425 +02:00 [DBG] Including navigation: 'Appointment.Patient'.
2025-11-24 02:50:32.426 +02:00 [DBG] Including navigation: 'Appointment.Branch'.
2025-11-24 02:50:32.436 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Appointment>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Appointment.AppointmentId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Appointment.BranchId (int) Required FK Index, 1], [Property: Appointment.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 2], [Property: Appointment.CreatedBy (string) FK Index, 3], [Property: Appointment.Date (DateOnly) Required, 4], [Property: Appointment.DoctorId (int) Required FK Index, 5], [Property: Appointment.Notes (string), 6], [Property: Appointment.PatientId (int) Required FK Index, 7], [Property: Appointment.PaymentMethod (PaymentMethod) Required, 8], [Property: Appointment.Status (AppointmentStatus) Required MaxLength(20), 9], [Property: Appointment.Time (DateTime) Required, 10], [Property: Appointment.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 11] }
            1 -> Dictionary<IProperty, int> { [Property: Patient.PatientId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 12], [Property: Patient.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 13], [Property: Patient.EmergencyContact (string) MaxLength(150), 14], [Property: Patient.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 15], [Property: Patient.UserId (string) Required FK Index, 16] }
            2 -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 17], [Property: Branch.Address (string) MaxLength(250), 18], [Property: Branch.BranchName (string) Required MaxLength(150), 19], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 20], [Property: Branch.Description (string), 21], [Property: Branch.Email (string) MaxLength(200), 22], [Property: Branch.ImageURL (string) MaxLength(300), 23], [Property: Branch.Phone (string) MaxLength(25), 24], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 25] }
        SELECT a.AppointmentId, a.BranchId, a.CreatedAt, a.CreatedBy, a.Date, a.DoctorId, a.Notes, a.PatientId, a.PaymentMethod, a.Status, a.Time, a.UpdatedAt, p.PatientId, p.CreatedAt, p.EmergencyContact, p.UpdatedAt, p.UserId, b.BranchId, b.Address, b.BranchName, b.CreatedAt, b.Description, b.Email, b.ImageURL, b.Phone, b.UpdatedAt
        FROM Appointments AS a
        INNER JOIN Patients AS p ON a.PatientId == p.PatientId
        INNER JOIN Branches AS b ON a.BranchId == b.BranchId
        WHERE a.DoctorId == @__doctorId_0), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Appointment>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 02:50:32.438 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:50:32.440 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:50:32.441 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:50:32.442 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:50:32.443 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 02:50:32.444 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0
2025-11-24 02:50:32.448 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0
2025-11-24 02:50:32.450 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:50:32.450 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:50:32.452 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:50:32.452 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:50:32.456 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:50:32.457 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:50:32.458 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:50:32.458 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:50:32.459 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:50:32.459 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Appointment.AppointmentDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 02:50:32.461 +02:00 [INF] Executed action Hospital.API.Controllers.AppointmentController.GetByDoctorId (Hospital) in 59.177ms
2025-11-24 02:50:32.461 +02:00 [INF] Executed endpoint 'Hospital.API.Controllers.AppointmentController.GetByDoctorId (Hospital)'
2025-11-24 02:50:32.462 +02:00 [DBG] Connection id "0HNHAU3HQ5A6I" completed keep alive response.
2025-11-24 02:50:32.463 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:50:32.463 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:50:32.464 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:50:32.465 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Appointment/doctor/1 - 200 null application/json; charset=utf-8 78.0449ms
2025-11-24 02:50:39.750 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Appointment/doctor/2 - null null
2025-11-24 02:50:39.752 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Appointment/doctor/2'
2025-11-24 02:50:39.752 +02:00 [DBG] Endpoint 'Hospital.API.Controllers.AppointmentController.GetByDoctorId (Hospital)' with route pattern 'api/Appointment/doctor/{doctorId:int}' is valid for the request path '/api/Appointment/doctor/2'
2025-11-24 02:50:39.753 +02:00 [DBG] Request matched endpoint 'Hospital.API.Controllers.AppointmentController.GetByDoctorId (Hospital)'
2025-11-24 02:50:39.753 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:50:39.753 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:50:39.754 +02:00 [INF] Executing endpoint 'Hospital.API.Controllers.AppointmentController.GetByDoctorId (Hospital)'
2025-11-24 02:50:39.755 +02:00 [INF] Route matched with {action = "GetByDoctorId", controller = "Appointment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetByDoctorId(Int32) on controller Hospital.API.Controllers.AppointmentController (Hospital).
2025-11-24 02:50:39.756 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:50:39.756 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:50:39.757 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:50:39.757 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:50:39.758 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:50:39.759 +02:00 [DBG] Executing controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 02:50:39.760 +02:00 [DBG] Executed controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 02:50:39.761 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 02:50:39.761 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' using the name 'doctorId' in request data ...
2025-11-24 02:50:39.762 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 02:50:39.763 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 02:50:39.764 +02:00 [DBG] Attempting to validate the bound parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 02:50:39.764 +02:00 [DBG] Done attempting to validate the bound parameter 'doctorId' of type 'System.Int32'.
2025-11-24 02:50:39.765 +02:00 [INF] Get Appointment by GetByDoctorId  called at "2025-11-24T02:50:39.7651900+02:00"
2025-11-24 02:50:39.766 +02:00 [INF] Fetching appointments for DoctorId: 2
2025-11-24 02:50:39.766 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:50:39.767 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:50:39.767 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:50:39.768 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:50:39.768 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:50:39.769 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:50:39.770 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:50:39.771 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:50:39.772 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:50:39.775 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:50:39.784 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:39.785 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:39.785 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:39.786 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:39.787 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:39.788 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:39.789 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:39.791 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:39.792 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:50:39.793 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 8ms reading results.
2025-11-24 02:50:39.794 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:50:39.794 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:50:39.795 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:50:39.796 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:50:39.797 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:50:39.798 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:50:39.799 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:50:39.800 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0
2025-11-24 02:50:39.803 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0
2025-11-24 02:50:39.804 +02:00 [DBG] The navigation 'Appointment.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:39.805 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:39.805 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:39.806 +02:00 [DBG] Context 'AppDbContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:39.806 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:50:39.807 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 2ms reading results.
2025-11-24 02:50:39.807 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:50:39.808 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (1ms).
2025-11-24 02:50:39.810 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:50:39.812 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:50:39.812 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:50:39.812 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:50:39.812 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:50:39.813 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Appointment.AppointmentDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 02:50:39.814 +02:00 [INF] Executed action Hospital.API.Controllers.AppointmentController.GetByDoctorId (Hospital) in 55.1638ms
2025-11-24 02:50:39.814 +02:00 [INF] Executed endpoint 'Hospital.API.Controllers.AppointmentController.GetByDoctorId (Hospital)'
2025-11-24 02:50:39.815 +02:00 [DBG] Connection id "0HNHAU3HQ5A6I" completed keep alive response.
2025-11-24 02:50:39.815 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:50:39.815 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:50:39.816 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:50:39.816 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Appointment/doctor/2 - 200 null application/json; charset=utf-8 66.0849ms
2025-11-24 02:50:59.849 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Appointment/patient/1 - null null
2025-11-24 02:50:59.850 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Appointment/patient/1'
2025-11-24 02:50:59.851 +02:00 [DBG] Endpoint 'Hospital.API.Controllers.AppointmentController.GetByPatientId (Hospital)' with route pattern 'api/Appointment/patient/{patientId:int}' is valid for the request path '/api/Appointment/patient/1'
2025-11-24 02:50:59.851 +02:00 [DBG] Request matched endpoint 'Hospital.API.Controllers.AppointmentController.GetByPatientId (Hospital)'
2025-11-24 02:50:59.852 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:50:59.852 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:50:59.852 +02:00 [INF] Executing endpoint 'Hospital.API.Controllers.AppointmentController.GetByPatientId (Hospital)'
2025-11-24 02:50:59.855 +02:00 [INF] Route matched with {action = "GetByPatientId", controller = "Appointment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetByPatientId(Int32) on controller Hospital.API.Controllers.AppointmentController (Hospital).
2025-11-24 02:50:59.856 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:50:59.856 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:50:59.857 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:50:59.857 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:50:59.858 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:50:59.860 +02:00 [DBG] Executing controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 02:50:59.861 +02:00 [DBG] Executed controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 02:50:59.862 +02:00 [DBG] Attempting to bind parameter 'patientId' of type 'System.Int32' ...
2025-11-24 02:50:59.863 +02:00 [DBG] Attempting to bind parameter 'patientId' of type 'System.Int32' using the name 'patientId' in request data ...
2025-11-24 02:50:59.863 +02:00 [DBG] Done attempting to bind parameter 'patientId' of type 'System.Int32'.
2025-11-24 02:50:59.864 +02:00 [DBG] Done attempting to bind parameter 'patientId' of type 'System.Int32'.
2025-11-24 02:50:59.865 +02:00 [DBG] Attempting to validate the bound parameter 'patientId' of type 'System.Int32' ...
2025-11-24 02:50:59.866 +02:00 [DBG] Done attempting to validate the bound parameter 'patientId' of type 'System.Int32'.
2025-11-24 02:50:59.867 +02:00 [INF] Get Appointment by GetByPatientId  called at "2025-11-24T02:50:59.8670637+02:00"
2025-11-24 02:50:59.868 +02:00 [INF] Fetching appointments for PatientId: 1
2025-11-24 02:50:59.869 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:50:59.871 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:50:59.871 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:50:59.871 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:50:59.872 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:50:59.872 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:50:59.873 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:50:59.873 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:50:59.874 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 02:50:59.885 +02:00 [INF] Executed DbCommand (10ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 02:50:59.892 +02:00 [DBG] Context 'AppDbContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:59.893 +02:00 [DBG] The navigation 'Patient.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:59.893 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:59.894 +02:00 [DBG] Context 'AppDbContext' started tracking 'MedicalRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:59.895 +02:00 [DBG] The navigation 'MedicalRecord.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:59.895 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:59.896 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:59.896 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:59.897 +02:00 [DBG] The navigation 'MedicalRecord.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:59.897 +02:00 [DBG] Context 'AppDbContext' started tracking 'MedicalRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:59.898 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:50:59.898 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 6ms reading results.
2025-11-24 02:50:59.899 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:50:59.900 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:50:59.902 +02:00 [DBG] Compiling query expression: 
'DbSet<Appointment>()
    .Where(a => a.PatientId == __patientId_0)
    .Include(a => a.Doctor)
    .Include(a => a.Branch)'
2025-11-24 02:50:59.903 +02:00 [DBG] Including navigation: 'Appointment.Doctor'.
2025-11-24 02:50:59.903 +02:00 [DBG] Including navigation: 'Appointment.Branch'.
2025-11-24 02:50:59.908 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Appointment>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Appointment.AppointmentId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Appointment.BranchId (int) Required FK Index, 1], [Property: Appointment.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 2], [Property: Appointment.CreatedBy (string) FK Index, 3], [Property: Appointment.Date (DateOnly) Required, 4], [Property: Appointment.DoctorId (int) Required FK Index, 5], [Property: Appointment.Notes (string), 6], [Property: Appointment.PatientId (int) Required FK Index, 7], [Property: Appointment.PaymentMethod (PaymentMethod) Required, 8], [Property: Appointment.Status (AppointmentStatus) Required MaxLength(20), 9], [Property: Appointment.Time (DateTime) Required, 10], [Property: Appointment.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 11] }
            1 -> Dictionary<IProperty, int> { [Property: Doctor.DoctorId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 12], [Property: Doctor.Available (bool?), 13], [Property: Doctor.Biography (string), 14], [Property: Doctor.ConsultationFees (decimal) Required, 15], [Property: Doctor.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 16], [Property: Doctor.ExperienceYears (int?), 17], [Property: Doctor.ImageURL (string) MaxLength(300), 18], [Property: Doctor.SpecializationId (int) Required FK Index, 19], [Property: Doctor.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 20], [Property: Doctor.UserId (string) Required FK Index, 21] }
            2 -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 22], [Property: Branch.Address (string) MaxLength(250), 23], [Property: Branch.BranchName (string) Required MaxLength(150), 24], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 25], [Property: Branch.Description (string), 26], [Property: Branch.Email (string) MaxLength(200), 27], [Property: Branch.ImageURL (string) MaxLength(300), 28], [Property: Branch.Phone (string) MaxLength(25), 29], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 30] }
        SELECT a.AppointmentId, a.BranchId, a.CreatedAt, a.CreatedBy, a.Date, a.DoctorId, a.Notes, a.PatientId, a.PaymentMethod, a.Status, a.Time, a.UpdatedAt, d.DoctorId, d.Available, d.Biography, d.ConsultationFees, d.CreatedAt, d.ExperienceYears, d.ImageURL, d.SpecializationId, d.UpdatedAt, d.UserId, b.BranchId, b.Address, b.BranchName, b.CreatedAt, b.Description, b.Email, b.ImageURL, b.Phone, b.UpdatedAt
        FROM Appointments AS a
        INNER JOIN Doctors AS d ON a.DoctorId == d.DoctorId
        INNER JOIN Branches AS b ON a.BranchId == b.BranchId
        WHERE a.PatientId == @__patientId_0), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Appointment>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 02:50:59.909 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:50:59.910 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:50:59.911 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:50:59.912 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:50:59.912 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:50:59.913 +02:00 [DBG] Executing DbCommand [Parameters=[@__patientId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Doctors] AS [d] ON [a].[DoctorId] = [d].[DoctorId]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[PatientId] = @__patientId_0
2025-11-24 02:50:59.917 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__patientId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Doctors] AS [d] ON [a].[DoctorId] = [d].[DoctorId]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[PatientId] = @__patientId_0
2025-11-24 02:50:59.918 +02:00 [DBG] The navigation 'MedicalRecord.Appointment' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:59.918 +02:00 [DBG] The navigation 'MedicalRecord.Appointment' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:59.919 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:59.919 +02:00 [DBG] The navigation 'Appointment.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:59.920 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:59.921 +02:00 [DBG] The navigation 'Appointment.Branch' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:59.922 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:50:59.922 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:50:59.923 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 5ms reading results.
2025-11-24 02:50:59.923 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:50:59.924 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:50:59.925 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:50:59.926 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:50:59.927 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:50:59.927 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:50:59.928 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:50:59.929 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Appointment.AppointmentDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 02:50:59.930 +02:00 [INF] Executed action Hospital.API.Controllers.AppointmentController.GetByPatientId (Hospital) in 70.0044ms
2025-11-24 02:50:59.932 +02:00 [INF] Executed endpoint 'Hospital.API.Controllers.AppointmentController.GetByPatientId (Hospital)'
2025-11-24 02:50:59.933 +02:00 [DBG] Connection id "0HNHAU3HQ5A6I" completed keep alive response.
2025-11-24 02:50:59.933 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:50:59.934 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:50:59.935 +02:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-11-24 02:50:59.936 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Appointment/patient/1 - 200 null application/json; charset=utf-8 87.6565ms
2025-11-24 02:51:03.632 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Appointment/patient/10 - null null
2025-11-24 02:51:03.633 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Appointment/patient/10'
2025-11-24 02:51:03.634 +02:00 [DBG] Endpoint 'Hospital.API.Controllers.AppointmentController.GetByPatientId (Hospital)' with route pattern 'api/Appointment/patient/{patientId:int}' is valid for the request path '/api/Appointment/patient/10'
2025-11-24 02:51:03.634 +02:00 [DBG] Request matched endpoint 'Hospital.API.Controllers.AppointmentController.GetByPatientId (Hospital)'
2025-11-24 02:51:03.634 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:51:03.635 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:51:03.635 +02:00 [INF] Executing endpoint 'Hospital.API.Controllers.AppointmentController.GetByPatientId (Hospital)'
2025-11-24 02:51:03.636 +02:00 [INF] Route matched with {action = "GetByPatientId", controller = "Appointment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetByPatientId(Int32) on controller Hospital.API.Controllers.AppointmentController (Hospital).
2025-11-24 02:51:03.636 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:51:03.637 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:51:03.637 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:51:03.638 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:51:03.639 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:51:03.640 +02:00 [DBG] Executing controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 02:51:03.641 +02:00 [DBG] Executed controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 02:51:03.641 +02:00 [DBG] Attempting to bind parameter 'patientId' of type 'System.Int32' ...
2025-11-24 02:51:03.642 +02:00 [DBG] Attempting to bind parameter 'patientId' of type 'System.Int32' using the name 'patientId' in request data ...
2025-11-24 02:51:03.642 +02:00 [DBG] Done attempting to bind parameter 'patientId' of type 'System.Int32'.
2025-11-24 02:51:03.643 +02:00 [DBG] Done attempting to bind parameter 'patientId' of type 'System.Int32'.
2025-11-24 02:51:03.643 +02:00 [DBG] Attempting to validate the bound parameter 'patientId' of type 'System.Int32' ...
2025-11-24 02:51:03.644 +02:00 [DBG] Done attempting to validate the bound parameter 'patientId' of type 'System.Int32'.
2025-11-24 02:51:03.644 +02:00 [INF] Get Appointment by GetByPatientId  called at "2025-11-24T02:51:03.6445389+02:00"
2025-11-24 02:51:03.644 +02:00 [INF] Fetching appointments for PatientId: 10
2025-11-24 02:51:03.645 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:51:03.647 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:51:03.648 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:51:03.648 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:51:03.649 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:51:03.649 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:51:03.650 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:51:03.650 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:51:03.651 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 02:51:03.653 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 02:51:03.655 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:51:03.655 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:51:03.656 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:51:03.657 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:51:03.658 +02:00 [WRN] Patient with ID 10 not found
2025-11-24 02:51:03.682 +02:00 [INF] Executed action Hospital.API.Controllers.AppointmentController.GetByPatientId (Hospital) in 42.4452ms
2025-11-24 02:51:03.683 +02:00 [INF] Executed endpoint 'Hospital.API.Controllers.AppointmentController.GetByPatientId (Hospital)'
2025-11-24 02:51:03.711 +02:00 [ERR]  Exception caught: Patient with ID 10 does not exist.
System.Collections.Generic.KeyNotFoundException: Patient with ID 10 does not exist.
   at Hospital.Infrastructure.Services.AppointmentService.GetByPatientId(Int32 PatientId) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\AppointmentService.cs:line 201
   at Hospital.API.Controllers.AppointmentController.GetByPatientId(Int32 patientId) in D:\Walaa\GP\Hospital\Hospital\Controllers\AppointmentController.cs:line 57
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
2025-11-24 02:51:03.715 +02:00 [DBG] Connection id "0HNHAU3HQ5A6I" completed keep alive response.
2025-11-24 02:51:03.715 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:51:03.716 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:51:03.717 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:51:03.717 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Appointment/patient/10 - 404 null application/json 85.5533ms
2025-11-24 02:51:17.063 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Appointment/GetAll - null null
2025-11-24 02:51:17.065 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Appointment/GetAll'
2025-11-24 02:51:17.068 +02:00 [DBG] Endpoint 'Hospital.API.Controllers.AppointmentController.GetById (Hospital)' with route pattern 'api/Appointment/{id:int}' was rejected by constraint 'id':'Microsoft.AspNetCore.Routing.Constraints.IntRouteConstraint' with value 'GetAll' for the request path '/api/Appointment/GetAll'
2025-11-24 02:51:17.069 +02:00 [DBG] Endpoint 'Hospital.API.Controllers.AppointmentController.GetById (Hospital)' with route pattern 'api/Appointment/{id:int}' is not valid for the request path '/api/Appointment/GetAll'
2025-11-24 02:51:17.070 +02:00 [DBG] Request did not match any endpoints
2025-11-24 02:51:17.070 +02:00 [DBG] The request path  does not match the path filter
2025-11-24 02:51:17.071 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:51:17.071 +02:00 [DBG] Connection id "0HNHAU3HQ5A6I" completed keep alive response.
2025-11-24 02:51:17.072 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Appointment/GetAll - 404 0 null 8.6575ms
2025-11-24 02:51:17.073 +02:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7217/api/Appointment/GetAll, Response status code: 404
2025-11-24 02:51:24.303 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Appointment/GetAll - null null
2025-11-24 02:51:24.305 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Appointment/GetAll'
2025-11-24 02:51:24.306 +02:00 [DBG] Endpoint 'Hospital.API.Controllers.AppointmentController.GetById (Hospital)' with route pattern 'api/Appointment/{id:int}' was rejected by constraint 'id':'Microsoft.AspNetCore.Routing.Constraints.IntRouteConstraint' with value 'GetAll' for the request path '/api/Appointment/GetAll'
2025-11-24 02:51:24.308 +02:00 [DBG] Endpoint 'Hospital.API.Controllers.AppointmentController.GetById (Hospital)' with route pattern 'api/Appointment/{id:int}' is not valid for the request path '/api/Appointment/GetAll'
2025-11-24 02:51:24.310 +02:00 [DBG] Request did not match any endpoints
2025-11-24 02:51:24.311 +02:00 [DBG] The request path  does not match the path filter
2025-11-24 02:51:24.312 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:51:24.313 +02:00 [DBG] Connection id "0HNHAU3HQ5A6I" completed keep alive response.
2025-11-24 02:51:24.313 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Appointment/GetAll - 404 0 null 10.083ms
2025-11-24 02:51:24.315 +02:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7217/api/Appointment/GetAll, Response status code: 404
2025-11-24 02:51:24.956 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Appointment/GetAll - null null
2025-11-24 02:51:24.960 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Appointment/GetAll'
2025-11-24 02:51:24.961 +02:00 [DBG] Endpoint 'Hospital.API.Controllers.AppointmentController.GetById (Hospital)' with route pattern 'api/Appointment/{id:int}' was rejected by constraint 'id':'Microsoft.AspNetCore.Routing.Constraints.IntRouteConstraint' with value 'GetAll' for the request path '/api/Appointment/GetAll'
2025-11-24 02:51:24.962 +02:00 [DBG] Endpoint 'Hospital.API.Controllers.AppointmentController.GetById (Hospital)' with route pattern 'api/Appointment/{id:int}' is not valid for the request path '/api/Appointment/GetAll'
2025-11-24 02:51:24.962 +02:00 [DBG] Request did not match any endpoints
2025-11-24 02:51:24.963 +02:00 [DBG] The request path  does not match the path filter
2025-11-24 02:51:24.963 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:51:24.964 +02:00 [DBG] Connection id "0HNHAU3HQ5A6I" completed keep alive response.
2025-11-24 02:51:24.964 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Appointment/GetAll - 404 0 null 8.3332ms
2025-11-24 02:51:24.966 +02:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7217/api/Appointment/GetAll, Response status code: 404
2025-11-24 02:51:36.585 +02:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7217/api/Appointment/MarkAsCompleted/2 - null 0
2025-11-24 02:51:36.587 +02:00 [DBG] No candidates found for the request path '/api/Appointment/MarkAsCompleted/2'
2025-11-24 02:51:36.589 +02:00 [DBG] Request did not match any endpoints
2025-11-24 02:51:36.590 +02:00 [DBG] PUT requests are not supported
2025-11-24 02:51:36.591 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:51:36.592 +02:00 [DBG] Connection id "0HNHAU3HQ5A6I" completed keep alive response.
2025-11-24 02:51:36.592 +02:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7217/api/Appointment/MarkAsCompleted/2 - 404 0 null 6.9826ms
2025-11-24 02:51:36.594 +02:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: PUT https://localhost:7217/api/Appointment/MarkAsCompleted/2, Response status code: 404
2025-11-24 02:51:51.160 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Doctor/doctor/2/today - null null
2025-11-24 02:51:51.162 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/doctor/2/today'
2025-11-24 02:51:51.164 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital)' with route pattern 'api/Doctor/doctor/{doctorId:int}/today' is valid for the request path '/api/Doctor/doctor/2/today'
2025-11-24 02:51:51.164 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital)'
2025-11-24 02:51:51.165 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:51:51.165 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:51:51.165 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital)'
2025-11-24 02:51:51.168 +02:00 [INF] Route matched with {action = "GetTodayAppointmentsForDoctor", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetTodayAppointmentsForDoctor(Int32) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 02:51:51.169 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:51:51.171 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:51:51.172 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:51:51.173 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:51:51.175 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:51:51.175 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 02:51:51.176 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 02:51:51.176 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 02:51:51.177 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' using the name 'doctorId' in request data ...
2025-11-24 02:51:51.177 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 02:51:51.179 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 02:51:51.180 +02:00 [DBG] Attempting to validate the bound parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 02:51:51.180 +02:00 [DBG] Done attempting to validate the bound parameter 'doctorId' of type 'System.Int32'.
2025-11-24 02:51:51.181 +02:00 [INF] GetTodayAppointmentsForDoctor  called at "2025-11-24T02:51:51.1817641+02:00"
2025-11-24 02:51:51.182 +02:00 [INF] Fetching today's appointments for doctor ID 2
2025-11-24 02:51:51.183 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:51:51.184 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:51:51.184 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 02:51:51.184 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:51:51.185 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:51:51.185 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:51:51.185 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:51:51.186 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:51:51.186 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:51:51.195 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:51:51.197 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:51:51.197 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:51:51.198 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:51:51.198 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:51:51.199 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:51:51.200 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:51:51.200 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:51:51.201 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 02:51:51.201 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:51:51.202 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 4ms reading results.
2025-11-24 02:51:51.202 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:51:51.202 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:51:51.204 +02:00 [DBG] Compiling query expression: 
'DbSet<Appointment>()
    .Include(a => a.Patient)
    .ThenInclude(p => p.User)
    .Include(a => a.Branch)
    .Where(a => a.DoctorId == __doctorId_0 && a.Date == __date_1 && (int)a.Status == 2)'
2025-11-24 02:51:51.205 +02:00 [DBG] Including navigation: 'Appointment.Patient'.
2025-11-24 02:51:51.206 +02:00 [DBG] Including navigation: 'Patient.User'.
2025-11-24 02:51:51.207 +02:00 [DBG] Including navigation: 'Appointment.Branch'.
2025-11-24 02:51:51.216 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Appointment>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Appointment.AppointmentId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Appointment.BranchId (int) Required FK Index, 1], [Property: Appointment.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 2], [Property: Appointment.CreatedBy (string) FK Index, 3], [Property: Appointment.Date (DateOnly) Required, 4], [Property: Appointment.DoctorId (int) Required FK Index, 5], [Property: Appointment.Notes (string), 6], [Property: Appointment.PatientId (int) Required FK Index, 7], [Property: Appointment.PaymentMethod (PaymentMethod) Required, 8], [Property: Appointment.Status (AppointmentStatus) Required MaxLength(20), 9], [Property: Appointment.Time (DateTime) Required, 10], [Property: Appointment.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 11] }
            1 -> Dictionary<IProperty, int> { [Property: Patient.PatientId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 12], [Property: Patient.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 13], [Property: Patient.EmergencyContact (string) MaxLength(150), 14], [Property: Patient.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 15], [Property: Patient.UserId (string) Required FK Index, 16] }
            2 -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 17], [Property: User.AccessFailedCount (int) Required, 18], [Property: User.ConcurrencyStamp (string) Concurrency, 19], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 20], [Property: User.DateOfBirth (DateOnly?), 21], [Property: User.Email (string) Index MaxLength(256), 22], [Property: User.EmailConfirmed (bool) Required, 23], [Property: User.FullName (string) Required MaxLength(150), 24], [Property: User.Gender (GenderType?) MaxLength(10), 25], [Property: User.LockoutEnabled (bool) Required, 26], [Property: User.LockoutEnd (DateTimeOffset?), 27], [Property: User.NormalizedEmail (string) Index MaxLength(256), 28], [Property: User.NormalizedUserName (string) Index MaxLength(256), 29], [Property: User.PasswordHash (string), 30], [Property: User.PhoneNumber (string), 31], [Property: User.PhoneNumberConfirmed (bool) Required, 32], [Property: User.RefreshToken (string), 33], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 34], [Property: User.Role (string) Required MaxLength(50), 35], [Property: User.SecurityStamp (string), 36], [Property: User.TwoFactorEnabled (bool) Required, 37], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 38], [Property: User.UserName (string) MaxLength(256), 39] }
            3 -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 40], [Property: Branch.Address (string) MaxLength(250), 41], [Property: Branch.BranchName (string) Required MaxLength(150), 42], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 43], [Property: Branch.Description (string), 44], [Property: Branch.Email (string) MaxLength(200), 45], [Property: Branch.ImageURL (string) MaxLength(300), 46], [Property: Branch.Phone (string) MaxLength(25), 47], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 48] }
        SELECT a.AppointmentId, a.BranchId, a.CreatedAt, a.CreatedBy, a.Date, a.DoctorId, a.Notes, a.PatientId, a.PaymentMethod, a.Status, a.Time, a.UpdatedAt, p.PatientId, p.CreatedAt, p.EmergencyContact, p.UpdatedAt, p.UserId, u.Id, u.AccessFailedCount, u.ConcurrencyStamp, u.CreatedAt, u.DateOfBirth, u.Email, u.EmailConfirmed, u.FullName, u.Gender, u.LockoutEnabled, u.LockoutEnd, u.NormalizedEmail, u.NormalizedUserName, u.PasswordHash, u.PhoneNumber, u.PhoneNumberConfirmed, u.RefreshToken, u.RefreshTokenExpiryTime, u.Role, u.SecurityStamp, u.TwoFactorEnabled, u.UpdatedAt, u.UserName, b.BranchId, b.Address, b.BranchName, b.CreatedAt, b.Description, b.Email, b.ImageURL, b.Phone, b.UpdatedAt
        FROM Appointments AS a
        INNER JOIN Patients AS p ON a.PatientId == p.PatientId
        INNER JOIN Users AS u ON p.UserId == u.Id
        INNER JOIN Branches AS b ON a.BranchId == b.BranchId
        WHERE ((a.DoctorId == @__doctorId_0) && (a.Date == @__date_1)) && (a.Status == N'Confirmed')), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Appointment>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 02:51:51.221 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.'.
2025-11-24 02:51:51.223 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.'.
2025-11-24 02:51:51.223 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:51:51.224 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 02:51:51.225 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 02:51:51.225 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Status] = N'Confirmed'
2025-11-24 02:51:51.233 +02:00 [INF] Executed DbCommand (8ms) [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Status] = N'Confirmed'
2025-11-24 02:51:51.234 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.'.
2025-11-24 02:51:51.235 +02:00 [DBG] A data reader for 'HospitalDB' on server '.' is being disposed after spending 0ms reading results.
2025-11-24 02:51:51.235 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:51:51.236 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.' (0ms).
2025-11-24 02:51:51.237 +02:00 [INF] No appointments found for doctor ID 2 today
2025-11-24 02:51:51.237 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 02:51:51.239 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 02:51:51.239 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 02:51:51.240 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 02:51:51.242 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 02:51:51.243 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Appointment.AppoinmentandPaientDetaliesDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 02:51:51.245 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital) in 69.7554ms
2025-11-24 02:51:51.246 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital)'
2025-11-24 02:51:51.247 +02:00 [DBG] Connection id "0HNHAU3HQ5A6I" completed keep alive response.
2025-11-24 02:51:51.248 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:51:51.248 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.'.
2025-11-24 02:51:51.249 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 02:51:51.249 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Doctor/doctor/2/today - 200 null application/json; charset=utf-8 89.3234ms
2025-11-24 02:52:02.745 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Doctor/doctor/1/date/2025-12-14 - null null
2025-11-24 02:52:02.748 +02:00 [DBG] No candidates found for the request path '/api/Doctor/doctor/1/date/2025-12-14'
2025-11-24 02:52:02.749 +02:00 [DBG] Request did not match any endpoints
2025-11-24 02:52:02.750 +02:00 [DBG] The request path  does not match the path filter
2025-11-24 02:52:02.751 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:52:02.751 +02:00 [DBG] Connection id "0HNHAU3HQ5A6I" completed keep alive response.
2025-11-24 02:52:02.751 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Doctor/doctor/1/date/2025-12-14 - 404 0 null 6.6003ms
2025-11-24 02:52:02.755 +02:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7217/api/Doctor/doctor/1/date/2025-12-14, Response status code: 404
2025-11-24 02:59:15.621 +02:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-11-24 02:59:15.715 +02:00 [DBG] Hosting starting
2025-11-24 02:59:15.740 +02:00 [INF] User profile is available. Using 'C:\Users\E-Mad\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-24 02:59:15.748 +02:00 [DBG] Reading data from file 'C:\Users\E-Mad\AppData\Local\ASP.NET\DataProtection-Keys\key-b85f0939-0825-4b2b-b21a-67409aec9db0.xml'.
2025-11-24 02:59:15.755 +02:00 [DBG] Found key {b85f0939-0825-4b2b-b21a-67409aec9db0}.
2025-11-24 02:59:15.760 +02:00 [DBG] Considering key {b85f0939-0825-4b2b-b21a-67409aec9db0} with expiration date 2026-02-09 12:52:20Z as default key.
2025-11-24 02:59:15.763 +02:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-11-24 02:59:15.765 +02:00 [DBG] Decrypting secret element using Windows DPAPI.
2025-11-24 02:59:15.767 +02:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-11-24 02:59:15.771 +02:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-11-24 02:59:15.772 +02:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-11-24 02:59:15.773 +02:00 [DBG] Using key {b85f0939-0825-4b2b-b21a-67409aec9db0} as the default key.
2025-11-24 02:59:15.774 +02:00 [DBG] Key ring with default key {b85f0939-0825-4b2b-b21a-67409aec9db0} was loaded during application startup.
2025-11-24 02:59:15.779 +02:00 [DBG] Middleware loaded
2025-11-24 02:59:15.780 +02:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16501 B).
2025-11-24 02:59:15.781 +02:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-11-24 02:59:15.845 +02:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-11-24 02:59:15.907 +02:00 [INF] Now listening on: https://localhost:7217
2025-11-24 02:59:15.909 +02:00 [INF] Now listening on: http://localhost:5163
2025-11-24 02:59:15.910 +02:00 [DBG] Loaded hosting startup assembly Hospital
2025-11-24 02:59:15.910 +02:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-11-24 02:59:15.910 +02:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-11-24 02:59:15.911 +02:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-11-24 02:59:15.968 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-24 02:59:15.968 +02:00 [INF] Hosting environment: Development
2025-11-24 02:59:15.969 +02:00 [INF] Content root path: D:\Walaa\GP\Hospital\Hospital
2025-11-24 02:59:15.970 +02:00 [DBG] Hosting started
2025-11-24 02:59:16.182 +02:00 [DBG] Connection id "0HNHAUIOENMR7" received FIN.
2025-11-24 02:59:16.187 +02:00 [DBG] Connection id "0HNHAUIOENMR7" accepted.
2025-11-24 02:59:16.188 +02:00 [DBG] Connection id "0HNHAUIOENMR7" started.
2025-11-24 02:59:16.200 +02:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-11-24 02:59:16.221 +02:00 [DBG] Connection id "0HNHAUIOENMR7" stopped.
2025-11-24 02:59:16.225 +02:00 [DBG] Connection id "0HNHAUIOENMR7" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-11-24 02:59:16.344 +02:00 [DBG] Connection id "0HNHAUIOENMR8" accepted.
2025-11-24 02:59:16.346 +02:00 [DBG] Connection id "0HNHAUIOENMR8" started.
2025-11-24 02:59:16.381 +02:00 [DBG] Connection 0HNHAUIOENMR8 established using the following protocol: "Tls12"
2025-11-24 02:59:16.431 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/swagger/index.html - null null
2025-11-24 02:59:16.496 +02:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-11-24 02:59:16.517 +02:00 [DBG] No candidates found for the request path '/swagger/index.html'
2025-11-24 02:59:16.520 +02:00 [DBG] Request did not match any endpoints
2025-11-24 02:59:16.567 +02:00 [DBG] Response markup is scheduled to include Browser Link script injection.
2025-11-24 02:59:16.569 +02:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2025-11-24 02:59:16.583 +02:00 [DBG] Response markup was updated to include Browser Link script injection.
2025-11-24 02:59:16.584 +02:00 [DBG] Response markup was updated to include browser refresh script injection.
2025-11-24 02:59:16.587 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/swagger/index.html - 200 null text/html;charset=utf-8 161.601ms
2025-11-24 02:59:16.600 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/_vs/browserLink - null null
2025-11-24 02:59:16.600 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/_framework/aspnetcore-browser-refresh.js - null null
2025-11-24 02:59:16.608 +02:00 [DBG] Script injected: /_framework/aspnetcore-browser-refresh.js
2025-11-24 02:59:16.615 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/_framework/aspnetcore-browser-refresh.js - 200 16501 application/javascript; charset=utf-8 14.9983ms
2025-11-24 02:59:16.634 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/_vs/browserLink - 200 null text/javascript; charset=UTF-8 34.3923ms
2025-11-24 02:59:16.677 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/swagger/v1/swagger.json - null null
2025-11-24 02:59:16.679 +02:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2025-11-24 02:59:16.679 +02:00 [DBG] Request did not match any endpoints
2025-11-24 02:59:16.717 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 40.9266ms
2025-11-24 02:59:44.975 +02:00 [DBG] Connection id "0HNHAUIOENMR9" received FIN.
2025-11-24 02:59:44.979 +02:00 [DBG] Connection id "0HNHAUIOENMR9" accepted.
2025-11-24 02:59:44.980 +02:00 [DBG] Connection id "0HNHAUIOENMR9" started.
2025-11-24 02:59:44.981 +02:00 [DBG] Connection id "0HNHAUIOENMRA" accepted.
2025-11-24 02:59:44.985 +02:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-11-24 02:59:44.986 +02:00 [DBG] Connection id "0HNHAUIOENMRA" started.
2025-11-24 02:59:44.988 +02:00 [DBG] Connection id "0HNHAUIOENMR9" stopped.
2025-11-24 02:59:44.990 +02:00 [DBG] Connection id "0HNHAUIOENMR9" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-11-24 02:59:44.993 +02:00 [DBG] Connection 0HNHAUIOENMRA established using the following protocol: "Tls12"
2025-11-24 02:59:44.998 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Doctor/doctor/2/today - null null
2025-11-24 02:59:45.003 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/doctor/2/today'
2025-11-24 02:59:45.005 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital)' with route pattern 'api/Doctor/doctor/{doctorId:int}/today' is valid for the request path '/api/Doctor/doctor/2/today'
2025-11-24 02:59:45.006 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital)'
2025-11-24 02:59:45.009 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 02:59:45.035 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 02:59:45.037 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital)'
2025-11-24 02:59:45.056 +02:00 [INF] Route matched with {action = "GetTodayAppointmentsForDoctor", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetTodayAppointmentsForDoctor(Int32) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 02:59:45.057 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 02:59:45.058 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 02:59:45.059 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 02:59:45.060 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 02:59:45.061 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 02:59:45.063 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 02:59:45.328 +02:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-11-24 02:59:45.357 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 02:59:45.368 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 02:59:45.371 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' using the name 'doctorId' in request data ...
2025-11-24 02:59:45.373 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 02:59:45.374 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 02:59:45.375 +02:00 [DBG] Attempting to validate the bound parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 02:59:45.378 +02:00 [DBG] Done attempting to validate the bound parameter 'doctorId' of type 'System.Int32'.
2025-11-24 02:59:45.383 +02:00 [INF] GetTodayAppointmentsForDoctor  called at "2025-11-24T02:59:45.3827946+02:00"
2025-11-24 02:59:45.386 +02:00 [INF] Fetching today's appointments for doctor ID 2
2025-11-24 02:59:45.864 +02:00 [DBG] The index {'BranchesBranchId'} was not created on entity type 'BranchDoctor (Dictionary<string, object>)' as the properties are already covered by the index {'BranchesBranchId', 'DoctorsDoctorId'}.
2025-11-24 02:59:45.866 +02:00 [DBG] The index {'BranchId'} was not created on entity type 'BranchService (Dictionary<string, object>)' as the properties are already covered by the index {'BranchId', 'ServiceId'}.
2025-11-24 02:59:45.867 +02:00 [DBG] The index {'BranchId'} was not created on entity type 'BranchSpecialization (Dictionary<string, object>)' as the properties are already covered by the index {'BranchId', 'SpecializationId'}.
2025-11-24 02:59:45.868 +02:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserRole<string>' as the properties are already covered by the index {'UserId', 'RoleId'}.
2025-11-24 02:59:45.869 +02:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserToken<string>' as the properties are already covered by the index {'UserId', 'LoginProvider', 'Name'}.
2025-11-24 02:59:45.971 +02:00 [DBG] The property 'BranchDoctor (Dictionary<string, object>).BranchesBranchId' was created in shadow state because there are no eligible CLR members with a matching name.
2025-11-24 02:59:45.974 +02:00 [DBG] The property 'BranchDoctor (Dictionary<string, object>).DoctorsDoctorId' was created in shadow state because there are no eligible CLR members with a matching name.
2025-11-24 02:59:46.123 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 02:59:46.178 +02:00 [DBG] Compiling query expression: 
'DbSet<Doctor>()
    .Include(d => d.User)
    .Include(d => d.Specialization)
    .Include(d => d.Branches)
    .Include(d => d.Schedules)
    .FirstOrDefault(d => d.DoctorId == __doctorId_0)'
2025-11-24 02:59:46.227 +02:00 [DBG] Including navigation: 'Doctor.User'.
2025-11-24 02:59:46.230 +02:00 [DBG] Including navigation: 'Doctor.Specialization'.
2025-11-24 02:59:46.233 +02:00 [DBG] Including navigation: 'Doctor.Branches'.
2025-11-24 02:59:46.237 +02:00 [DBG] Including navigation: 'Doctor.Schedules'.
2025-11-24 02:59:46.445 +02:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-11-24 02:59:46.466 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Doctor>(
    asyncEnumerable: new SingleQueryingEnumerable<Doctor>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Doctor.DoctorId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Doctor.Available (bool?), 1], [Property: Doctor.Biography (string), 2], [Property: Doctor.ConsultationFees (decimal) Required, 3], [Property: Doctor.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: Doctor.ExperienceYears (int?), 5], [Property: Doctor.ImageURL (string) MaxLength(300), 6], [Property: Doctor.SpecializationId (int) Required FK Index, 7], [Property: Doctor.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 8], [Property: Doctor.UserId (string) Required FK Index, 9] }
                1 -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 10], [Property: User.AccessFailedCount (int) Required, 11], [Property: User.ConcurrencyStamp (string) Concurrency, 12], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 13], [Property: User.DateOfBirth (DateOnly?), 14], [Property: User.Email (string) Index MaxLength(256), 15], [Property: User.EmailConfirmed (bool) Required, 16], [Property: User.FullName (string) Required MaxLength(150), 17], [Property: User.Gender (GenderType?) MaxLength(10), 18], [Property: User.LockoutEnabled (bool) Required, 19], [Property: User.LockoutEnd (DateTimeOffset?), 20], [Property: User.NormalizedEmail (string) Index MaxLength(256), 21], [Property: User.NormalizedUserName (string) Index MaxLength(256), 22], [Property: User.PasswordHash (string), 23], [Property: User.PhoneNumber (string), 24], [Property: User.PhoneNumberConfirmed (bool) Required, 25], [Property: User.RefreshToken (string), 26], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 27], [Property: User.Role (string) Required MaxLength(50), 28], [Property: User.SecurityStamp (string), 29], [Property: User.TwoFactorEnabled (bool) Required, 30], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 31], [Property: User.UserName (string) MaxLength(256), 32] }
                2 -> Dictionary<IProperty, int> { [Property: Specialization.SpecializationId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 33], [Property: Specialization.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 34], [Property: Specialization.Description (string), 35], [Property: Specialization.Name (string) Required MaxLength(120), 36], [Property: Specialization.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 37] }
                3 -> 0
                4 -> 10
                5 -> 33
                6 -> Dictionary<IProperty, int> { [Property: BranchDoctor (Dictionary<string, object>).BranchesBranchId (no field, int) Indexer Required PK FK AfterSave:Throw, 38], [Property: BranchDoctor (Dictionary<string, object>).DoctorsDoctorId (no field, int) Indexer Required PK FK Index AfterSave:Throw, 39] }
                7 -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 40], [Property: Branch.Address (string) MaxLength(250), 41], [Property: Branch.BranchName (string) Required MaxLength(150), 42], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 43], [Property: Branch.Description (string), 44], [Property: Branch.Email (string) MaxLength(200), 45], [Property: Branch.ImageURL (string) MaxLength(300), 46], [Property: Branch.Phone (string) MaxLength(25), 47], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 48] }
                8 -> 38
                9 -> 39
                10 -> 40
                11 -> Dictionary<IProperty, int> { [Property: Schedule.ScheduleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 49], [Property: Schedule.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 50], [Property: Schedule.DayOfWeek (string) Required MaxLength(20), 51], [Property: Schedule.DoctorId (int) Required FK Index, 52], [Property: Schedule.EndTime (DateTime) Required, 53], [Property: Schedule.Shift (AppointmentShift) Required, 54], [Property: Schedule.StartTime (DateTime) Required, 55], [Property: Schedule.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 56] }
                12 -> 49
            SELECT t.DoctorId, t.Available, t.Biography, t.ConsultationFees, t.CreatedAt, t.ExperienceYears, t.ImageURL, t.SpecializationId, t.UpdatedAt, t.UserId, t.Id, t.AccessFailedCount, t.ConcurrencyStamp, t.CreatedAt0, t.DateOfBirth, t.Email, t.EmailConfirmed, t.FullName, t.Gender, t.LockoutEnabled, t.LockoutEnd, t.NormalizedEmail, t.NormalizedUserName, t.PasswordHash, t.PhoneNumber, t.PhoneNumberConfirmed, t.RefreshToken, t.RefreshTokenExpiryTime, t.Role, t.SecurityStamp, t.TwoFactorEnabled, t.UpdatedAt0, t.UserName, t.SpecializationId0, t.CreatedAt1, t.Description, t.Name, t.UpdatedAt1, t0.BranchesBranchId, t0.DoctorsDoctorId, t0.BranchId, t0.Address, t0.BranchName, t0.CreatedAt, t0.Description, t0.Email, t0.ImageURL, t0.Phone, t0.UpdatedAt, s0.ScheduleId, s0.CreatedAt, s0.DayOfWeek, s0.DoctorId, s0.EndTime, s0.Shift, s0.StartTime, s0.UpdatedAt
            FROM 
            (
                SELECT TOP(1) d.DoctorId, d.Available, d.Biography, d.ConsultationFees, d.CreatedAt, d.ExperienceYears, d.ImageURL, d.SpecializationId, d.UpdatedAt, d.UserId, u.Id, u.AccessFailedCount, u.ConcurrencyStamp, u.CreatedAt AS CreatedAt0, u.DateOfBirth, u.Email, u.EmailConfirmed, u.FullName, u.Gender, u.LockoutEnabled, u.LockoutEnd, u.NormalizedEmail, u.NormalizedUserName, u.PasswordHash, u.PhoneNumber, u.PhoneNumberConfirmed, u.RefreshToken, u.RefreshTokenExpiryTime, u.Role, u.SecurityStamp, u.TwoFactorEnabled, u.UpdatedAt AS UpdatedAt0, u.UserName, s.SpecializationId AS SpecializationId0, s.CreatedAt AS CreatedAt1, s.Description, s.Name, s.UpdatedAt AS UpdatedAt1
                FROM Doctors AS d
                INNER JOIN Users AS u ON d.UserId == u.Id
                INNER JOIN Specializations AS s ON d.SpecializationId == s.SpecializationId
                WHERE d.DoctorId == @__doctorId_0
            ) AS t
            LEFT JOIN 
            (
                SELECT d0.BranchesBranchId, d0.DoctorsDoctorId, b.BranchId, b.Address, b.BranchName, b.CreatedAt, b.Description, b.Email, b.ImageURL, b.Phone, b.UpdatedAt
                FROM DoctorBranches AS d0
                INNER JOIN Branches AS b ON d0.BranchesBranchId == b.BranchId
            ) AS t0 ON t.DoctorId == t0.DoctorsDoctorId
            LEFT JOIN Schedules AS s0 ON t.DoctorId == s0.DoctorId
            ORDER BY t.DoctorId ASC, t.Id ASC, t.SpecializationId0 ASC, t0.BranchesBranchId ASC, t0.DoctorsDoctorId ASC, t0.BranchId ASC), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Doctor>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 02:59:46.511 +02:00 [DBG] Creating DbConnection.
2025-11-24 02:59:46.528 +02:00 [DBG] Created DbConnection. (15ms).
2025-11-24 02:59:46.531 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 02:59:46.744 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 02:59:46.750 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 02:59:46.756 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (4ms).
2025-11-24 02:59:46.765 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (15ms).
2025-11-24 02:59:46.774 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:59:46.836 +02:00 [ERR] Failed executing DbCommand (66ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 02:59:46.844 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 02:59:46.854 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (5ms).
2025-11-24 02:59:46.862 +02:00 [ERR] An exception occurred while iterating over the results of a query for context type 'Clinic.Infrastructure.Persistence.AppDbContext'.
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'ImageURL'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:2bff5add-60ef-4e67-a1ad-3c7aa47f3ba6
Error Number:207,State:1,Class:16
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'ImageURL'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:2bff5add-60ef-4e67-a1ad-3c7aa47f3ba6
Error Number:207,State:1,Class:16
2025-11-24 02:59:46.936 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital) in 1871.7039ms
2025-11-24 02:59:46.938 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital)'
2025-11-24 02:59:46.990 +02:00 [ERR]  Exception caught: Invalid column name 'ImageURL'.
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'ImageURL'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Hospital.Infrastructure.Repos.DoctorRepository.GetAsync(Int32 doctorId) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Repository\DoctorRepository.cs:line 43
   at Hospital.Infrastructure.Services.DoctorService.GetTodayForDoctorAsync(Int32 doctorId) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\DoctorService.cs:line 295
   at Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor(Int32 doctorId) in D:\Walaa\GP\Hospital\Hospital\Controllers\DoctorController.cs:line 226
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
ClientConnectionId:2bff5add-60ef-4e67-a1ad-3c7aa47f3ba6
Error Number:207,State:1,Class:16
2025-11-24 02:59:47.042 +02:00 [DBG] Connection id "0HNHAUIOENMRA" completed keep alive response.
2025-11-24 02:59:47.045 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 02:59:47.048 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 02:59:47.050 +02:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-11-24 02:59:47.052 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Doctor/doctor/2/today - 500 null application/json 2054.2534ms
2025-11-24 03:00:02.178 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Doctor/doctor/2/today - null null
2025-11-24 03:00:02.184 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/doctor/2/today'
2025-11-24 03:00:02.185 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital)' with route pattern 'api/Doctor/doctor/{doctorId:int}/today' is valid for the request path '/api/Doctor/doctor/2/today'
2025-11-24 03:00:02.186 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital)'
2025-11-24 03:00:02.186 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:00:02.188 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:00:02.188 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital)'
2025-11-24 03:00:02.190 +02:00 [INF] Route matched with {action = "GetTodayAppointmentsForDoctor", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetTodayAppointmentsForDoctor(Int32) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 03:00:02.191 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:00:02.191 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:00:02.192 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:00:02.193 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:00:02.193 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:00:02.194 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:00:02.198 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:00:02.199 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:00:02.200 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' using the name 'doctorId' in request data ...
2025-11-24 03:00:02.201 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:00:02.202 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:00:02.202 +02:00 [DBG] Attempting to validate the bound parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:00:02.203 +02:00 [DBG] Done attempting to validate the bound parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:00:02.203 +02:00 [INF] GetTodayAppointmentsForDoctor  called at "2025-11-24T03:00:02.2037201+02:00"
2025-11-24 03:00:02.204 +02:00 [INF] Fetching today's appointments for doctor ID 2
2025-11-24 03:00:02.240 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:00:02.244 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:00:02.244 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 03:00:02.245 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:00:02.247 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:00:02.248 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:00:02.249 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:00:02.250 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:00:02.251 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:00:02.260 +02:00 [ERR] Failed executing DbCommand (9ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:00:02.264 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:00:02.265 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (1ms).
2025-11-24 03:00:02.268 +02:00 [ERR] An exception occurred while iterating over the results of a query for context type 'Clinic.Infrastructure.Persistence.AppDbContext'.
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'ImageURL'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:2bff5add-60ef-4e67-a1ad-3c7aa47f3ba6
Error Number:207,State:1,Class:16
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'ImageURL'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:2bff5add-60ef-4e67-a1ad-3c7aa47f3ba6
Error Number:207,State:1,Class:16
2025-11-24 03:00:02.326 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital) in 131.5305ms
2025-11-24 03:00:02.327 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital)'
2025-11-24 03:00:02.356 +02:00 [ERR]  Exception caught: Invalid column name 'ImageURL'.
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'ImageURL'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Hospital.Infrastructure.Repos.DoctorRepository.GetAsync(Int32 doctorId) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Repository\DoctorRepository.cs:line 43
   at Hospital.Infrastructure.Services.DoctorService.GetTodayForDoctorAsync(Int32 doctorId) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\DoctorService.cs:line 295
   at Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor(Int32 doctorId) in D:\Walaa\GP\Hospital\Hospital\Controllers\DoctorController.cs:line 226
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
ClientConnectionId:2bff5add-60ef-4e67-a1ad-3c7aa47f3ba6
Error Number:207,State:1,Class:16
2025-11-24 03:00:02.373 +02:00 [DBG] Connection id "0HNHAUIOENMRA" completed keep alive response.
2025-11-24 03:00:02.374 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:00:02.374 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:00:02.375 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 03:00:02.376 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Doctor/doctor/2/today - 500 null application/json 197.3721ms
2025-11-24 03:00:09.843 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Doctor/doctor/1/date/2025-12-14 - null null
2025-11-24 03:00:09.844 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/doctor/1/date/2025-12-14'
2025-11-24 03:00:09.847 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)' with route pattern 'api/Doctor/doctor/{doctorId:int}/date/{date:datetime}' is valid for the request path '/api/Doctor/doctor/1/date/2025-12-14'
2025-11-24 03:00:09.848 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)'
2025-11-24 03:00:09.850 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:00:09.852 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:00:09.853 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)'
2025-11-24 03:00:09.860 +02:00 [INF] Route matched with {action = "GetAppointmentsForDoctor", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAppointmentsForDoctor(Int32, System.DateTime) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 03:00:09.861 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:00:09.863 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:00:09.863 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:00:09.867 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:00:09.868 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:00:09.869 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:00:09.879 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:00:09.880 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:00:09.881 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' using the name 'doctorId' in request data ...
2025-11-24 03:00:09.881 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:00:09.882 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:00:09.882 +02:00 [DBG] Attempting to validate the bound parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:00:09.884 +02:00 [DBG] Done attempting to validate the bound parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:00:09.885 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateTime' ...
2025-11-24 03:00:09.886 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateTime' using the name 'date' in request data ...
2025-11-24 03:00:09.886 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateTime'.
2025-11-24 03:00:09.887 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateTime'.
2025-11-24 03:00:09.887 +02:00 [DBG] Attempting to validate the bound parameter 'date' of type 'System.DateTime' ...
2025-11-24 03:00:09.888 +02:00 [DBG] Done attempting to validate the bound parameter 'date' of type 'System.DateTime'.
2025-11-24 03:00:09.889 +02:00 [INF] GetAppointmentsForDoctor called at "2025-11-24T03:00:09.8893194+02:00"
2025-11-24 03:00:09.890 +02:00 [INF] Fetching "2025-12-14"'s appointments for doctor ID 1
2025-11-24 03:00:09.902 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:00:09.904 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:00:09.905 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 03:00:09.905 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:00:09.906 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:00:09.906 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:00:09.907 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:00:09.907 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:00:09.908 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:00:09.913 +02:00 [ERR] Failed executing DbCommand (5ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:00:09.916 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:00:09.916 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:00:09.918 +02:00 [ERR] An exception occurred while iterating over the results of a query for context type 'Clinic.Infrastructure.Persistence.AppDbContext'.
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'ImageURL'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:2bff5add-60ef-4e67-a1ad-3c7aa47f3ba6
Error Number:207,State:1,Class:16
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'ImageURL'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:2bff5add-60ef-4e67-a1ad-3c7aa47f3ba6
Error Number:207,State:1,Class:16
2025-11-24 03:00:09.974 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital) in 104.9414ms
2025-11-24 03:00:09.975 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)'
2025-11-24 03:00:10.008 +02:00 [ERR]  Exception caught: Invalid column name 'ImageURL'.
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'ImageURL'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Hospital.Infrastructure.Repos.DoctorRepository.GetAsync(Int32 doctorId) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Repository\DoctorRepository.cs:line 43
   at Hospital.Infrastructure.Services.DoctorService.GetAppoinmentsForDoctorByDateAsync(Int32 doctorId, DateOnly date) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\DoctorService.cs:line 319
   at Hospital.Controllers.DoctorController.GetAppointmentsForDoctor(Int32 doctorId, DateTime date) in D:\Walaa\GP\Hospital\Hospital\Controllers\DoctorController.cs:line 237
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
ClientConnectionId:2bff5add-60ef-4e67-a1ad-3c7aa47f3ba6
Error Number:207,State:1,Class:16
2025-11-24 03:00:10.021 +02:00 [DBG] Connection id "0HNHAUIOENMRA" completed keep alive response.
2025-11-24 03:00:10.022 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:00:10.022 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:00:10.023 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 03:00:10.023 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Doctor/doctor/1/date/2025-12-14 - 500 null application/json 180.8258ms
2025-11-24 03:00:22.078 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Doctor/doctor/1/date/2025-12-15 - null null
2025-11-24 03:00:22.080 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/doctor/1/date/2025-12-15'
2025-11-24 03:00:22.081 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)' with route pattern 'api/Doctor/doctor/{doctorId:int}/date/{date:datetime}' is valid for the request path '/api/Doctor/doctor/1/date/2025-12-15'
2025-11-24 03:00:22.083 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)'
2025-11-24 03:00:22.083 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:00:22.084 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:00:22.084 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)'
2025-11-24 03:00:22.084 +02:00 [INF] Route matched with {action = "GetAppointmentsForDoctor", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAppointmentsForDoctor(Int32, System.DateTime) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 03:00:22.085 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:00:22.086 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:00:22.087 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:00:22.089 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:00:22.090 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:00:22.091 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:00:22.091 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:00:22.092 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:00:22.092 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' using the name 'doctorId' in request data ...
2025-11-24 03:00:22.093 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:00:22.094 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:00:22.095 +02:00 [DBG] Attempting to validate the bound parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:00:22.096 +02:00 [DBG] Done attempting to validate the bound parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:00:22.096 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateTime' ...
2025-11-24 03:00:22.097 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateTime' using the name 'date' in request data ...
2025-11-24 03:00:22.097 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateTime'.
2025-11-24 03:00:22.098 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateTime'.
2025-11-24 03:00:22.099 +02:00 [DBG] Attempting to validate the bound parameter 'date' of type 'System.DateTime' ...
2025-11-24 03:00:22.100 +02:00 [DBG] Done attempting to validate the bound parameter 'date' of type 'System.DateTime'.
2025-11-24 03:00:22.101 +02:00 [INF] GetAppointmentsForDoctor called at "2025-11-24T03:00:22.1016349+02:00"
2025-11-24 03:00:22.102 +02:00 [INF] Fetching "2025-12-15"'s appointments for doctor ID 1
2025-11-24 03:00:22.102 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:00:22.104 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:00:22.104 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 03:00:22.104 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:00:22.106 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:00:22.106 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:00:22.107 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:00:22.108 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:00:22.109 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:00:22.115 +02:00 [ERR] Failed executing DbCommand (7ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:00:22.118 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:00:22.119 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:00:22.121 +02:00 [ERR] An exception occurred while iterating over the results of a query for context type 'Clinic.Infrastructure.Persistence.AppDbContext'.
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'ImageURL'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:2bff5add-60ef-4e67-a1ad-3c7aa47f3ba6
Error Number:207,State:1,Class:16
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'ImageURL'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:2bff5add-60ef-4e67-a1ad-3c7aa47f3ba6
Error Number:207,State:1,Class:16
2025-11-24 03:00:22.172 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital) in 81.835ms
2025-11-24 03:00:22.173 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)'
2025-11-24 03:00:22.204 +02:00 [ERR]  Exception caught: Invalid column name 'ImageURL'.
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'ImageURL'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Hospital.Infrastructure.Repos.DoctorRepository.GetAsync(Int32 doctorId) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Repository\DoctorRepository.cs:line 43
   at Hospital.Infrastructure.Services.DoctorService.GetAppoinmentsForDoctorByDateAsync(Int32 doctorId, DateOnly date) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\DoctorService.cs:line 319
   at Hospital.Controllers.DoctorController.GetAppointmentsForDoctor(Int32 doctorId, DateTime date) in D:\Walaa\GP\Hospital\Hospital\Controllers\DoctorController.cs:line 237
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
ClientConnectionId:2bff5add-60ef-4e67-a1ad-3c7aa47f3ba6
Error Number:207,State:1,Class:16
2025-11-24 03:00:22.216 +02:00 [DBG] Connection id "0HNHAUIOENMRA" completed keep alive response.
2025-11-24 03:00:22.217 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:00:22.217 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:00:22.218 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 03:00:22.218 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Doctor/doctor/1/date/2025-12-15 - 500 null application/json 140.149ms
2025-11-24 03:00:46.185 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Appointment/GetAll - null null
2025-11-24 03:00:46.187 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Appointment/GetAll'
2025-11-24 03:00:46.187 +02:00 [DBG] Endpoint 'Hospital.API.Controllers.AppointmentController.GetAll (Hospital)' with route pattern 'api/Appointment/GetAll' is valid for the request path '/api/Appointment/GetAll'
2025-11-24 03:00:46.189 +02:00 [DBG] Request matched endpoint 'Hospital.API.Controllers.AppointmentController.GetAll (Hospital)'
2025-11-24 03:00:46.189 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:00:46.190 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:00:46.190 +02:00 [INF] Executing endpoint 'Hospital.API.Controllers.AppointmentController.GetAll (Hospital)'
2025-11-24 03:00:46.194 +02:00 [INF] Route matched with {action = "GetAll", controller = "Appointment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll() on controller Hospital.API.Controllers.AppointmentController (Hospital).
2025-11-24 03:00:46.195 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:00:46.196 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:00:46.196 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:00:46.197 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:00:46.198 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:00:46.199 +02:00 [DBG] Executing controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 03:00:46.200 +02:00 [DBG] Executed controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 03:00:46.201 +02:00 [INF] Get All Appointments called at "2025-11-24T03:00:46.2017985+02:00"
2025-11-24 03:00:46.203 +02:00 [INF] Fetching all appointments
2025-11-24 03:00:46.205 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:00:46.208 +02:00 [DBG] Compiling query expression: 
'DbSet<Appointment>()
    .Include(a => a.Patient)
    .Include(a => a.Doctor)
    .Include(a => a.Branch)'
2025-11-24 03:00:46.210 +02:00 [DBG] Including navigation: 'Appointment.Patient'.
2025-11-24 03:00:46.212 +02:00 [DBG] Including navigation: 'Appointment.Doctor'.
2025-11-24 03:00:46.213 +02:00 [DBG] Including navigation: 'Appointment.Branch'.
2025-11-24 03:00:46.224 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Appointment>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Appointment.AppointmentId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Appointment.BranchId (int) Required FK Index, 1], [Property: Appointment.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 2], [Property: Appointment.CreatedBy (string) FK Index, 3], [Property: Appointment.Date (DateOnly) Required, 4], [Property: Appointment.DoctorId (int) Required FK Index, 5], [Property: Appointment.Notes (string), 6], [Property: Appointment.PatientId (int) Required FK Index, 7], [Property: Appointment.PaymentMethod (PaymentMethod) Required, 8], [Property: Appointment.Status (AppointmentStatus) Required MaxLength(20), 9], [Property: Appointment.Time (DateTime) Required, 10], [Property: Appointment.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 11] }
            1 -> Dictionary<IProperty, int> { [Property: Patient.PatientId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 12], [Property: Patient.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 13], [Property: Patient.EmergencyContact (string) MaxLength(150), 14], [Property: Patient.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 15], [Property: Patient.UserId (string) Required FK Index, 16] }
            2 -> Dictionary<IProperty, int> { [Property: Doctor.DoctorId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 17], [Property: Doctor.Available (bool?), 18], [Property: Doctor.Biography (string), 19], [Property: Doctor.ConsultationFees (decimal) Required, 20], [Property: Doctor.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 21], [Property: Doctor.ExperienceYears (int?), 22], [Property: Doctor.ImageURL (string) MaxLength(300), 23], [Property: Doctor.SpecializationId (int) Required FK Index, 24], [Property: Doctor.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 25], [Property: Doctor.UserId (string) Required FK Index, 26] }
            3 -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 27], [Property: Branch.Address (string) MaxLength(250), 28], [Property: Branch.BranchName (string) Required MaxLength(150), 29], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 30], [Property: Branch.Description (string), 31], [Property: Branch.Email (string) MaxLength(200), 32], [Property: Branch.ImageURL (string) MaxLength(300), 33], [Property: Branch.Phone (string) MaxLength(25), 34], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 35] }
        SELECT a.AppointmentId, a.BranchId, a.CreatedAt, a.CreatedBy, a.Date, a.DoctorId, a.Notes, a.PatientId, a.PaymentMethod, a.Status, a.Time, a.UpdatedAt, p.PatientId, p.CreatedAt, p.EmergencyContact, p.UpdatedAt, p.UserId, d.DoctorId, d.Available, d.Biography, d.ConsultationFees, d.CreatedAt, d.ExperienceYears, d.ImageURL, d.SpecializationId, d.UpdatedAt, d.UserId, b.BranchId, b.Address, b.BranchName, b.CreatedAt, b.Description, b.Email, b.ImageURL, b.Phone, b.UpdatedAt
        FROM Appointments AS a
        INNER JOIN Patients AS p ON a.PatientId == p.PatientId
        INNER JOIN Doctors AS d ON a.DoctorId == d.DoctorId
        INNER JOIN Branches AS b ON a.BranchId == b.BranchId), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Appointment>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 03:00:46.229 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:00:46.230 +02:00 [DBG] Created DbConnection. (1ms).
2025-11-24 03:00:46.231 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:00:46.232 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:00:46.233 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:00:46.233 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:00:46.234 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:00:46.235 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Doctors] AS [d] ON [a].[DoctorId] = [d].[DoctorId]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
2025-11-24 03:00:46.241 +02:00 [ERR] Failed executing DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Doctors] AS [d] ON [a].[DoctorId] = [d].[DoctorId]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
2025-11-24 03:00:46.243 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:00:46.244 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:00:46.246 +02:00 [ERR] An exception occurred while iterating over the results of a query for context type 'Clinic.Infrastructure.Persistence.AppDbContext'.
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'PaymentMethod'.
Invalid column name 'ImageURL'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:2bff5add-60ef-4e67-a1ad-3c7aa47f3ba6
Error Number:207,State:1,Class:16
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'PaymentMethod'.
Invalid column name 'ImageURL'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:2bff5add-60ef-4e67-a1ad-3c7aa47f3ba6
Error Number:207,State:1,Class:16
2025-11-24 03:00:46.303 +02:00 [INF] Executed action Hospital.API.Controllers.AppointmentController.GetAll (Hospital) in 103.6668ms
2025-11-24 03:00:46.304 +02:00 [INF] Executed endpoint 'Hospital.API.Controllers.AppointmentController.GetAll (Hospital)'
2025-11-24 03:00:46.334 +02:00 [ERR]  Exception caught: Invalid column name 'PaymentMethod'.
Invalid column name 'ImageURL'.
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'PaymentMethod'.
Invalid column name 'ImageURL'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Hospital.Infrastructure.Repository.AppointmentRepository.GetAllAsync() in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Repository\AppointmentRepository.cs:line 43
   at Hospital.Infrastructure.Services.AppointmentService.GetAllAsync() in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\AppointmentService.cs:line 211
   at Hospital.API.Controllers.AppointmentController.GetAll() in D:\Walaa\GP\Hospital\Hospital\Controllers\AppointmentController.cs:line 75
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
ClientConnectionId:2bff5add-60ef-4e67-a1ad-3c7aa47f3ba6
Error Number:207,State:1,Class:16
2025-11-24 03:00:46.344 +02:00 [DBG] Connection id "0HNHAUIOENMRA" completed keep alive response.
2025-11-24 03:00:46.345 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:00:46.345 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:00:46.346 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 03:00:46.346 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Appointment/GetAll - 500 null application/json 161.2738ms
2025-11-24 03:01:15.296 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Appointment - application/json 181
2025-11-24 03:01:15.298 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Appointment'
2025-11-24 03:01:15.299 +02:00 [DBG] Endpoint 'Hospital.API.Controllers.AppointmentController.Add (Hospital)' with route pattern 'api/Appointment' is valid for the request path '/api/Appointment'
2025-11-24 03:01:15.300 +02:00 [DBG] Request matched endpoint 'Hospital.API.Controllers.AppointmentController.Add (Hospital)'
2025-11-24 03:01:15.301 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:01:15.302 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:01:15.302 +02:00 [INF] Executing endpoint 'Hospital.API.Controllers.AppointmentController.Add (Hospital)'
2025-11-24 03:01:15.305 +02:00 [INF] Route matched with {action = "Add", controller = "Appointment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Add(Hospital.Application.DTO.Appointment.AddAppointmentDto) on controller Hospital.API.Controllers.AppointmentController (Hospital).
2025-11-24 03:01:15.306 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:01:15.307 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:01:15.307 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:01:15.309 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:01:15.310 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:01:15.311 +02:00 [DBG] Executing controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 03:01:15.312 +02:00 [DBG] Executed controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 03:01:15.312 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto' ...
2025-11-24 03:01:15.314 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto' using the name '' in request data ...
2025-11-24 03:01:15.316 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 03:01:15.324 +02:00 [DBG] Connection id "0HNHAUIOENMRA", Request id "0HNHAUIOENMRA:00000006": started reading request body.
2025-11-24 03:01:15.325 +02:00 [DBG] Connection id "0HNHAUIOENMRA", Request id "0HNHAUIOENMRA:00000006": done reading request body.
2025-11-24 03:01:15.340 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Appointment.AddAppointmentDto'
2025-11-24 03:01:15.342 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto'.
2025-11-24 03:01:15.343 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto'.
2025-11-24 03:01:15.344 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto' ...
2025-11-24 03:01:15.352 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto'.
2025-11-24 03:01:15.353 +02:00 [INF] Add Appointment called at "2025-11-24T03:01:15.3536538+02:00"
2025-11-24 03:01:15.355 +02:00 [INF] Creating appointment for PatientId: 1, DoctorId: 2, Date: "2025-11-26", Time: "2025-11-23T15:33:47.5410000Z"
2025-11-24 03:01:15.356 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:01:15.360 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:01:15.360 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 03:01:15.361 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:01:15.362 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:01:15.363 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 03:01:15.367 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 03:01:15.370 +02:00 [DBG] Compiling query expression: 
'DbSet<Patient>()
    .Include(p => p.User)
    .Include(p => p.MedicalRecords)
    .ThenInclude(m => m.Doctor)
    .ThenInclude(d => d.User)
    .FirstOrDefault(p => p.PatientId == __id_0)'
2025-11-24 03:01:15.372 +02:00 [DBG] Including navigation: 'Patient.User'.
2025-11-24 03:01:15.374 +02:00 [DBG] Including navigation: 'Patient.MedicalRecords'.
2025-11-24 03:01:15.376 +02:00 [DBG] Including navigation: 'MedicalRecord.Doctor'.
2025-11-24 03:01:15.377 +02:00 [DBG] Including navigation: 'Doctor.User'.
2025-11-24 03:01:15.398 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Patient>(
    asyncEnumerable: new SingleQueryingEnumerable<Patient>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Patient.PatientId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Patient.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: Patient.EmergencyContact (string) MaxLength(150), 2], [Property: Patient.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 3], [Property: Patient.UserId (string) Required FK Index, 4] }
                1 -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 5], [Property: User.AccessFailedCount (int) Required, 6], [Property: User.ConcurrencyStamp (string) Concurrency, 7], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 8], [Property: User.DateOfBirth (DateOnly?), 9], [Property: User.Email (string) Index MaxLength(256), 10], [Property: User.EmailConfirmed (bool) Required, 11], [Property: User.FullName (string) Required MaxLength(150), 12], [Property: User.Gender (GenderType?) MaxLength(10), 13], [Property: User.LockoutEnabled (bool) Required, 14], [Property: User.LockoutEnd (DateTimeOffset?), 15], [Property: User.NormalizedEmail (string) Index MaxLength(256), 16], [Property: User.NormalizedUserName (string) Index MaxLength(256), 17], [Property: User.PasswordHash (string), 18], [Property: User.PhoneNumber (string), 19], [Property: User.PhoneNumberConfirmed (bool) Required, 20], [Property: User.RefreshToken (string), 21], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 22], [Property: User.Role (string) Required MaxLength(50), 23], [Property: User.SecurityStamp (string), 24], [Property: User.TwoFactorEnabled (bool) Required, 25], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 26], [Property: User.UserName (string) MaxLength(256), 27] }
                2 -> 0
                3 -> 5
                4 -> Dictionary<IProperty, int> { [Property: MedicalRecord.RecordId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 28], [Property: MedicalRecord.AppointmentId (int) Required FK Index, 29], [Property: MedicalRecord.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 30], [Property: MedicalRecord.Diagnosis (string), 31], [Property: MedicalRecord.DoctorId (int) Required FK Index, 32], [Property: MedicalRecord.Notes (string), 33], [Property: MedicalRecord.PatientId (int) Required FK Index, 34], [Property: MedicalRecord.TreatmentPlan (string), 35], [Property: MedicalRecord.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 36] }
                5 -> Dictionary<IProperty, int> { [Property: Doctor.DoctorId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 37], [Property: Doctor.Available (bool?), 38], [Property: Doctor.Biography (string), 39], [Property: Doctor.ConsultationFees (decimal) Required, 40], [Property: Doctor.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 41], [Property: Doctor.ExperienceYears (int?), 42], [Property: Doctor.ImageURL (string) MaxLength(300), 43], [Property: Doctor.SpecializationId (int) Required FK Index, 44], [Property: Doctor.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 45], [Property: Doctor.UserId (string) Required FK Index, 46] }
                6 -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 47], [Property: User.AccessFailedCount (int) Required, 48], [Property: User.ConcurrencyStamp (string) Concurrency, 49], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 50], [Property: User.DateOfBirth (DateOnly?), 51], [Property: User.Email (string) Index MaxLength(256), 52], [Property: User.EmailConfirmed (bool) Required, 53], [Property: User.FullName (string) Required MaxLength(150), 54], [Property: User.Gender (GenderType?) MaxLength(10), 55], [Property: User.LockoutEnabled (bool) Required, 56], [Property: User.LockoutEnd (DateTimeOffset?), 57], [Property: User.NormalizedEmail (string) Index MaxLength(256), 58], [Property: User.NormalizedUserName (string) Index MaxLength(256), 59], [Property: User.PasswordHash (string), 60], [Property: User.PhoneNumber (string), 61], [Property: User.PhoneNumberConfirmed (bool) Required, 62], [Property: User.RefreshToken (string), 63], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 64], [Property: User.Role (string) Required MaxLength(50), 65], [Property: User.SecurityStamp (string), 66], [Property: User.TwoFactorEnabled (bool) Required, 67], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 68], [Property: User.UserName (string) MaxLength(256), 69] }
                7 -> 28
                8 -> 37
                9 -> 47
            SELECT t.PatientId, t.CreatedAt, t.EmergencyContact, t.UpdatedAt, t.UserId, t.Id, t.AccessFailedCount, t.ConcurrencyStamp, t.CreatedAt0, t.DateOfBirth, t.Email, t.EmailConfirmed, t.FullName, t.Gender, t.LockoutEnabled, t.LockoutEnd, t.NormalizedEmail, t.NormalizedUserName, t.PasswordHash, t.PhoneNumber, t.PhoneNumberConfirmed, t.RefreshToken, t.RefreshTokenExpiryTime, t.Role, t.SecurityStamp, t.TwoFactorEnabled, t.UpdatedAt0, t.UserName, t0.RecordId, t0.AppointmentId, t0.CreatedAt, t0.Diagnosis, t0.DoctorId, t0.Notes, t0.PatientId, t0.TreatmentPlan, t0.UpdatedAt, t0.DoctorId0, t0.Available, t0.Biography, t0.ConsultationFees, t0.CreatedAt0, t0.ExperienceYears, t0.ImageURL, t0.SpecializationId, t0.UpdatedAt0, t0.UserId, t0.Id, t0.AccessFailedCount, t0.ConcurrencyStamp, t0.CreatedAt1, t0.DateOfBirth, t0.Email, t0.EmailConfirmed, t0.FullName, t0.Gender, t0.LockoutEnabled, t0.LockoutEnd, t0.NormalizedEmail, t0.NormalizedUserName, t0.PasswordHash, t0.PhoneNumber, t0.PhoneNumberConfirmed, t0.RefreshToken, t0.RefreshTokenExpiryTime, t0.Role, t0.SecurityStamp, t0.TwoFactorEnabled, t0.UpdatedAt1, t0.UserName
            FROM 
            (
                SELECT TOP(1) p.PatientId, p.CreatedAt, p.EmergencyContact, p.UpdatedAt, p.UserId, u.Id, u.AccessFailedCount, u.ConcurrencyStamp, u.CreatedAt AS CreatedAt0, u.DateOfBirth, u.Email, u.EmailConfirmed, u.FullName, u.Gender, u.LockoutEnabled, u.LockoutEnd, u.NormalizedEmail, u.NormalizedUserName, u.PasswordHash, u.PhoneNumber, u.PhoneNumberConfirmed, u.RefreshToken, u.RefreshTokenExpiryTime, u.Role, u.SecurityStamp, u.TwoFactorEnabled, u.UpdatedAt AS UpdatedAt0, u.UserName
                FROM Patients AS p
                INNER JOIN Users AS u ON p.UserId == u.Id
                WHERE p.PatientId == @__id_0
            ) AS t
            LEFT JOIN 
            (
                SELECT m.RecordId, m.AppointmentId, m.CreatedAt, m.Diagnosis, m.DoctorId, m.Notes, m.PatientId, m.TreatmentPlan, m.UpdatedAt, d.DoctorId AS DoctorId0, d.Available, d.Biography, d.ConsultationFees, d.CreatedAt AS CreatedAt0, d.ExperienceYears, d.ImageURL, d.SpecializationId, d.UpdatedAt AS UpdatedAt0, d.UserId, u0.Id, u0.AccessFailedCount, u0.ConcurrencyStamp, u0.CreatedAt AS CreatedAt1, u0.DateOfBirth, u0.Email, u0.EmailConfirmed, u0.FullName, u0.Gender, u0.LockoutEnabled, u0.LockoutEnd, u0.NormalizedEmail, u0.NormalizedUserName, u0.PasswordHash, u0.PhoneNumber, u0.PhoneNumberConfirmed, u0.RefreshToken, u0.RefreshTokenExpiryTime, u0.Role, u0.SecurityStamp, u0.TwoFactorEnabled, u0.UpdatedAt AS UpdatedAt1, u0.UserName
                FROM MedicalRecords AS m
                INNER JOIN Doctors AS d ON m.DoctorId == d.DoctorId
                INNER JOIN Users AS u0 ON d.UserId == u0.Id
            ) AS t0 ON t.PatientId == t0.PatientId
            ORDER BY t.PatientId ASC, t.Id ASC, t0.RecordId ASC, t0.DoctorId0 ASC), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Patient>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 03:01:15.403 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:01:15.403 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:01:15.404 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:01:15.405 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 03:01:15.440 +02:00 [INF] Executed DbCommand (34ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 03:01:15.472 +02:00 [DBG] Context 'AppDbContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:01:15.513 +02:00 [DBG] The navigation 'Patient.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:01:15.515 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:01:15.556 +02:00 [DBG] Context 'AppDbContext' started tracking 'MedicalRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:01:15.568 +02:00 [DBG] The navigation 'MedicalRecord.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:01:15.570 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:01:15.584 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:01:15.586 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:01:15.590 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:01:15.593 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 147ms reading results.
2025-11-24 03:01:15.595 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:01:15.596 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:01:15.596 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:01:15.597 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:01:15.603 +02:00 [ERR] Failed executing DbCommand (6ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:01:15.606 +02:00 [ERR] An exception occurred while iterating over the results of a query for context type 'Clinic.Infrastructure.Persistence.AppDbContext'.
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'ImageURL'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:2bff5add-60ef-4e67-a1ad-3c7aa47f3ba6
Error Number:207,State:1,Class:16
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'ImageURL'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:2bff5add-60ef-4e67-a1ad-3c7aa47f3ba6
Error Number:207,State:1,Class:16
2025-11-24 03:01:15.645 +02:00 [DBG] Rolling back transaction.
2025-11-24 03:01:15.654 +02:00 [DBG] Rolled back transaction.
2025-11-24 03:01:15.656 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:01:15.657 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:01:15.658 +02:00 [ERR] Failed to create appointment for PatientId: 1, DoctorId: 2
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'ImageURL'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Hospital.Infrastructure.Repos.DoctorRepository.GetAsync(Int32 doctorId) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Repository\DoctorRepository.cs:line 43
   at Hospital.Infrastructure.Services.AppointmentService.AddAsync(AddAppointmentDto dto) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\AppointmentService.cs:line 64
ClientConnectionId:2bff5add-60ef-4e67-a1ad-3c7aa47f3ba6
Error Number:207,State:1,Class:16
2025-11-24 03:01:15.678 +02:00 [DBG] Disposing transaction.
2025-11-24 03:01:15.719 +02:00 [INF] Executed action Hospital.API.Controllers.AppointmentController.Add (Hospital) in 407.936ms
2025-11-24 03:01:15.720 +02:00 [INF] Executed endpoint 'Hospital.API.Controllers.AppointmentController.Add (Hospital)'
2025-11-24 03:01:15.747 +02:00 [ERR]  Exception caught: Invalid column name 'ImageURL'.
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'ImageURL'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Hospital.Infrastructure.Repos.DoctorRepository.GetAsync(Int32 doctorId) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Repository\DoctorRepository.cs:line 43
   at Hospital.Infrastructure.Services.AppointmentService.AddAsync(AddAppointmentDto dto) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\AppointmentService.cs:line 64
   at Hospital.Infrastructure.Services.AppointmentService.AddAsync(AddAppointmentDto dto) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\AppointmentService.cs:line 128
   at Hospital.Infrastructure.Services.AppointmentService.AddAsync(AddAppointmentDto dto) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\AppointmentService.cs:line 129
   at Hospital.API.Controllers.AppointmentController.Add(AddAppointmentDto dto) in D:\Walaa\GP\Hospital\Hospital\Controllers\AppointmentController.cs:line 27
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
ClientConnectionId:2bff5add-60ef-4e67-a1ad-3c7aa47f3ba6
Error Number:207,State:1,Class:16
2025-11-24 03:01:15.758 +02:00 [DBG] Connection id "0HNHAUIOENMRA" completed keep alive response.
2025-11-24 03:01:15.758 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:01:15.760 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:01:15.760 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 03:01:15.762 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Appointment - 500 null application/json 465.899ms
2025-11-24 03:01:47.166 +02:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-11-24 03:01:47.497 +02:00 [DBG] The index {'BranchesBranchId'} was not created on entity type 'BranchDoctor (Dictionary<string, object>)' as the properties are already covered by the index {'BranchesBranchId', 'DoctorsDoctorId'}.
2025-11-24 03:01:47.498 +02:00 [DBG] The index {'BranchId'} was not created on entity type 'BranchService (Dictionary<string, object>)' as the properties are already covered by the index {'BranchId', 'ServiceId'}.
2025-11-24 03:01:47.498 +02:00 [DBG] The index {'BranchId'} was not created on entity type 'BranchSpecialization (Dictionary<string, object>)' as the properties are already covered by the index {'BranchId', 'SpecializationId'}.
2025-11-24 03:01:47.498 +02:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserRole<string>' as the properties are already covered by the index {'UserId', 'RoleId'}.
2025-11-24 03:01:47.498 +02:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserToken<string>' as the properties are already covered by the index {'UserId', 'LoginProvider', 'Name'}.
2025-11-24 03:01:47.577 +02:00 [DBG] The property 'BranchDoctor (Dictionary<string, object>).BranchesBranchId' was created in shadow state because there are no eligible CLR members with a matching name.
2025-11-24 03:01:47.577 +02:00 [DBG] The property 'BranchDoctor (Dictionary<string, object>).DoctorsDoctorId' was created in shadow state because there are no eligible CLR members with a matching name.
2025-11-24 03:01:47.678 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:01:47.686 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:01:47.704 +02:00 [DBG] Created DbConnection. (16ms).
2025-11-24 03:01:47.706 +02:00 [DBG] Migrating using database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:01:47.710 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:01:47.828 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:01:47.832 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 03:01:47.835 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (2ms).
2025-11-24 03:01:47.835 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (5ms).
2025-11-24 03:01:47.839 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-24 03:01:47.854 +02:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-24 03:01:47.855 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:01:47.859 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (2ms).
2025-11-24 03:01:47.860 +02:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-11-24 03:01:47.861 +02:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-11-24 03:01:47.861 +02:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-11-24 03:01:47.861 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:01:47.861 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:01:47.861 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-24 03:01:47.868 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-24 03:01:47.868 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:01:47.868 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:01:47.869 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:01:47.869 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:01:47.869 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 03:01:47.869 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 03:01:47.869 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 03:01:47.869 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-24 03:01:47.869 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-24 03:01:47.869 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:01:47.870 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:01:47.870 +02:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-11-24 03:01:47.870 +02:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-11-24 03:01:47.870 +02:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-11-24 03:01:47.870 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:01:47.870 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:01:47.870 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-24 03:01:47.870 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-24 03:01:47.870 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:01:47.870 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:01:47.876 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:01:47.877 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:01:47.877 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:01:47.877 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:01:47.877 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:01:47.877 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-24 03:01:47.883 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-24 03:01:47.885 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:01:47.886 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 1ms reading results.
2025-11-24 03:01:47.886 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:01:47.886 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:01:47.892 +02:00 [INF] Applying migration '20251119214128_resetPaswoard'.
2025-11-24 03:01:47.931 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:01:47.931 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:01:47.932 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 03:01:47.935 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 03:01:47.935 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 03:01:47.935 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 03:01:47.935 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 03:01:47.935 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [PasswordResetCodes] (
    [Id] int NOT NULL IDENTITY,
    [UserId] nvarchar(450) NOT NULL,
    [Code] nvarchar(max) NOT NULL,
    [ExpireAt] datetime2 NOT NULL,
    CONSTRAINT [PK_PasswordResetCodes] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_PasswordResetCodes_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-11-24 03:01:47.949 +02:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [PasswordResetCodes] (
    [Id] int NOT NULL IDENTITY,
    [UserId] nvarchar(450) NOT NULL,
    [Code] nvarchar(max) NOT NULL,
    [ExpireAt] datetime2 NOT NULL,
    CONSTRAINT [PK_PasswordResetCodes] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_PasswordResetCodes_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-11-24 03:01:47.949 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 03:01:47.949 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 03:01:47.949 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 03:01:47.949 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_PasswordResetCodes_UserId] ON [PasswordResetCodes] ([UserId]);
2025-11-24 03:01:47.950 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_PasswordResetCodes_UserId] ON [PasswordResetCodes] ([UserId]);
2025-11-24 03:01:47.950 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 03:01:47.950 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 03:01:47.950 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 03:01:47.950 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251119214128_resetPaswoard', N'8.0.21');
2025-11-24 03:01:47.951 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251119214128_resetPaswoard', N'8.0.21');
2025-11-24 03:01:47.952 +02:00 [DBG] Committing transaction.
2025-11-24 03:01:47.954 +02:00 [DBG] Committed transaction.
2025-11-24 03:01:47.955 +02:00 [DBG] Disposing transaction.
2025-11-24 03:01:47.955 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:01:47.955 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:01:47.956 +02:00 [INF] Applying migration '20251122193859_update appoiment with payment method'.
2025-11-24 03:01:47.978 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:01:47.979 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:01:47.979 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 03:01:47.979 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 03:01:49.529 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 03:01:49.529 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 03:01:49.529 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 03:01:49.529 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Appointments] ADD [PaymentMethod] int NOT NULL DEFAULT 0;
2025-11-24 03:01:49.540 +02:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Appointments] ADD [PaymentMethod] int NOT NULL DEFAULT 0;
2025-11-24 03:01:49.540 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 03:01:49.540 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 03:01:49.540 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 03:01:49.540 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251122193859_update appoiment with payment method', N'8.0.21');
2025-11-24 03:01:49.541 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251122193859_update appoiment with payment method', N'8.0.21');
2025-11-24 03:01:49.541 +02:00 [DBG] Committing transaction.
2025-11-24 03:01:49.542 +02:00 [DBG] Committed transaction.
2025-11-24 03:01:49.542 +02:00 [DBG] Disposing transaction.
2025-11-24 03:01:49.542 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:01:49.542 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:01:49.542 +02:00 [INF] Applying migration '20251122203902_convert type of fess in codtor to ba require'.
2025-11-24 03:01:49.574 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:01:49.574 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:01:49.574 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 03:01:49.575 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 03:01:49.575 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 03:01:49.575 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 03:01:49.575 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 03:01:49.575 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var0 sysname;
SELECT @var0 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Doctors]') AND [c].[name] = N'ConsultationFees');
IF @var0 IS NOT NULL EXEC(N'ALTER TABLE [Doctors] DROP CONSTRAINT [' + @var0 + '];');
UPDATE [Doctors] SET [ConsultationFees] = 0.0 WHERE [ConsultationFees] IS NULL;
ALTER TABLE [Doctors] ALTER COLUMN [ConsultationFees] decimal(10,2) NOT NULL;
ALTER TABLE [Doctors] ADD DEFAULT 0.0 FOR [ConsultationFees];
2025-11-24 03:01:49.609 +02:00 [INF] Executed DbCommand (34ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var0 sysname;
SELECT @var0 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Doctors]') AND [c].[name] = N'ConsultationFees');
IF @var0 IS NOT NULL EXEC(N'ALTER TABLE [Doctors] DROP CONSTRAINT [' + @var0 + '];');
UPDATE [Doctors] SET [ConsultationFees] = 0.0 WHERE [ConsultationFees] IS NULL;
ALTER TABLE [Doctors] ALTER COLUMN [ConsultationFees] decimal(10,2) NOT NULL;
ALTER TABLE [Doctors] ADD DEFAULT 0.0 FOR [ConsultationFees];
2025-11-24 03:01:49.609 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 03:01:49.609 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 03:01:49.609 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 03:01:49.609 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251122203902_convert type of fess in codtor to ba require', N'8.0.21');
2025-11-24 03:01:49.610 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251122203902_convert type of fess in codtor to ba require', N'8.0.21');
2025-11-24 03:01:51.849 +02:00 [DBG] Committing transaction.
2025-11-24 03:01:51.859 +02:00 [DBG] Committed transaction.
2025-11-24 03:01:51.859 +02:00 [DBG] Disposing transaction.
2025-11-24 03:01:51.859 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:01:51.859 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:01:51.859 +02:00 [INF] Applying migration '20251122214638_addImageInBranch'.
2025-11-24 03:01:51.891 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:01:51.892 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:01:51.892 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 03:01:51.892 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 03:01:51.892 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 03:01:51.892 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 03:01:51.892 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 03:01:51.892 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Branches] ADD [ImageURL] nvarchar(300) NULL;
2025-11-24 03:01:51.895 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Branches] ADD [ImageURL] nvarchar(300) NULL;
2025-11-24 03:01:51.895 +02:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2025-11-24 03:01:51.895 +02:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 03:01:51.895 +02:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (0ms).
2025-11-24 03:01:51.895 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251122214638_addImageInBranch', N'8.0.21');
2025-11-24 03:01:51.896 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251122214638_addImageInBranch', N'8.0.21');
2025-11-24 03:01:51.896 +02:00 [DBG] Committing transaction.
2025-11-24 03:01:51.896 +02:00 [DBG] Committed transaction.
2025-11-24 03:01:51.896 +02:00 [DBG] Disposing transaction.
2025-11-24 03:01:51.896 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:01:51.896 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:01:51.898 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:01:51.899 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:01:51.899 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 03:02:05.969 +02:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-11-24 03:02:06.056 +02:00 [DBG] Hosting starting
2025-11-24 03:02:06.079 +02:00 [INF] User profile is available. Using 'C:\Users\E-Mad\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-24 03:02:06.087 +02:00 [DBG] Reading data from file 'C:\Users\E-Mad\AppData\Local\ASP.NET\DataProtection-Keys\key-b85f0939-0825-4b2b-b21a-67409aec9db0.xml'.
2025-11-24 03:02:06.094 +02:00 [DBG] Found key {b85f0939-0825-4b2b-b21a-67409aec9db0}.
2025-11-24 03:02:06.101 +02:00 [DBG] Considering key {b85f0939-0825-4b2b-b21a-67409aec9db0} with expiration date 2026-02-09 12:52:20Z as default key.
2025-11-24 03:02:06.103 +02:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-11-24 03:02:06.105 +02:00 [DBG] Decrypting secret element using Windows DPAPI.
2025-11-24 03:02:06.106 +02:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-11-24 03:02:06.110 +02:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-11-24 03:02:06.111 +02:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-11-24 03:02:06.112 +02:00 [DBG] Using key {b85f0939-0825-4b2b-b21a-67409aec9db0} as the default key.
2025-11-24 03:02:06.114 +02:00 [DBG] Key ring with default key {b85f0939-0825-4b2b-b21a-67409aec9db0} was loaded during application startup.
2025-11-24 03:02:06.119 +02:00 [DBG] Middleware loaded
2025-11-24 03:02:06.120 +02:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16501 B).
2025-11-24 03:02:06.121 +02:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-11-24 03:02:06.183 +02:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-11-24 03:02:06.251 +02:00 [INF] Now listening on: https://localhost:7217
2025-11-24 03:02:06.253 +02:00 [INF] Now listening on: http://localhost:5163
2025-11-24 03:02:06.254 +02:00 [DBG] Loaded hosting startup assembly Hospital
2025-11-24 03:02:06.255 +02:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-11-24 03:02:06.255 +02:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-11-24 03:02:06.256 +02:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-11-24 03:02:06.332 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-24 03:02:06.335 +02:00 [INF] Hosting environment: Development
2025-11-24 03:02:06.335 +02:00 [INF] Content root path: D:\Walaa\GP\Hospital\Hospital
2025-11-24 03:02:06.336 +02:00 [DBG] Hosting started
2025-11-24 03:02:06.537 +02:00 [DBG] Connection id "0HNHAUKB7C1BB" accepted.
2025-11-24 03:02:06.538 +02:00 [DBG] Connection id "0HNHAUKB7C1BC" accepted.
2025-11-24 03:02:06.539 +02:00 [DBG] Connection id "0HNHAUKB7C1BC" started.
2025-11-24 03:02:06.539 +02:00 [DBG] Connection id "0HNHAUKB7C1BB" started.
2025-11-24 03:02:06.551 +02:00 [DBG] Connection id "0HNHAUKB7C1BC" received FIN.
2025-11-24 03:02:06.551 +02:00 [DBG] Connection id "0HNHAUKB7C1BB" received FIN.
2025-11-24 03:02:06.560 +02:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-11-24 03:02:06.560 +02:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-11-24 03:02:06.583 +02:00 [DBG] Connection id "0HNHAUKB7C1BC" stopped.
2025-11-24 03:02:06.583 +02:00 [DBG] Connection id "0HNHAUKB7C1BB" stopped.
2025-11-24 03:02:06.585 +02:00 [DBG] Connection id "0HNHAUKB7C1BB" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-11-24 03:02:06.585 +02:00 [DBG] Connection id "0HNHAUKB7C1BC" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-11-24 03:02:06.713 +02:00 [DBG] Connection id "0HNHAUKB7C1BD" accepted.
2025-11-24 03:02:06.716 +02:00 [DBG] Connection id "0HNHAUKB7C1BD" started.
2025-11-24 03:02:06.757 +02:00 [DBG] Connection 0HNHAUKB7C1BD established using the following protocol: "Tls12"
2025-11-24 03:02:06.804 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/swagger/index.html - null null
2025-11-24 03:02:06.867 +02:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-11-24 03:02:06.886 +02:00 [DBG] No candidates found for the request path '/swagger/index.html'
2025-11-24 03:02:06.888 +02:00 [DBG] Request did not match any endpoints
2025-11-24 03:02:06.925 +02:00 [DBG] Response markup is scheduled to include Browser Link script injection.
2025-11-24 03:02:06.927 +02:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2025-11-24 03:02:06.938 +02:00 [DBG] Response markup was updated to include Browser Link script injection.
2025-11-24 03:02:06.940 +02:00 [DBG] Response markup was updated to include browser refresh script injection.
2025-11-24 03:02:06.942 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/swagger/index.html - 200 null text/html;charset=utf-8 143.9571ms
2025-11-24 03:02:06.953 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/_vs/browserLink - null null
2025-11-24 03:02:06.953 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/_framework/aspnetcore-browser-refresh.js - null null
2025-11-24 03:02:06.962 +02:00 [DBG] Script injected: /_framework/aspnetcore-browser-refresh.js
2025-11-24 03:02:06.965 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/_framework/aspnetcore-browser-refresh.js - 200 16501 application/javascript; charset=utf-8 12.4272ms
2025-11-24 03:02:06.983 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/_vs/browserLink - 200 null text/javascript; charset=UTF-8 29.9394ms
2025-11-24 03:02:07.023 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/swagger/v1/swagger.json - null null
2025-11-24 03:02:07.025 +02:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2025-11-24 03:02:07.026 +02:00 [DBG] Request did not match any endpoints
2025-11-24 03:02:07.057 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 34.3496ms
2025-11-24 03:02:10.061 +02:00 [DBG] Connection id "0HNHAUKB7C1BE" received FIN.
2025-11-24 03:02:10.063 +02:00 [DBG] Connection id "0HNHAUKB7C1BE" accepted.
2025-11-24 03:02:10.063 +02:00 [DBG] Connection id "0HNHAUKB7C1BE" started.
2025-11-24 03:02:10.064 +02:00 [DBG] Connection id "0HNHAUKB7C1BF" accepted.
2025-11-24 03:02:10.065 +02:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-11-24 03:02:10.065 +02:00 [DBG] Connection id "0HNHAUKB7C1BF" started.
2025-11-24 03:02:10.067 +02:00 [DBG] Connection id "0HNHAUKB7C1BE" stopped.
2025-11-24 03:02:10.068 +02:00 [DBG] Connection id "0HNHAUKB7C1BE" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-11-24 03:02:10.071 +02:00 [DBG] Connection 0HNHAUKB7C1BF established using the following protocol: "Tls12"
2025-11-24 03:02:10.075 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Appointment - application/json 181
2025-11-24 03:02:10.078 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Appointment'
2025-11-24 03:02:10.081 +02:00 [DBG] Endpoint 'Hospital.API.Controllers.AppointmentController.Add (Hospital)' with route pattern 'api/Appointment' is valid for the request path '/api/Appointment'
2025-11-24 03:02:10.082 +02:00 [DBG] Request matched endpoint 'Hospital.API.Controllers.AppointmentController.Add (Hospital)'
2025-11-24 03:02:10.084 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:02:10.110 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:02:10.111 +02:00 [INF] Executing endpoint 'Hospital.API.Controllers.AppointmentController.Add (Hospital)'
2025-11-24 03:02:10.130 +02:00 [INF] Route matched with {action = "Add", controller = "Appointment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Add(Hospital.Application.DTO.Appointment.AddAppointmentDto) on controller Hospital.API.Controllers.AppointmentController (Hospital).
2025-11-24 03:02:10.133 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:02:10.134 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:02:10.135 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:02:10.135 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:02:10.137 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:02:10.140 +02:00 [DBG] Executing controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 03:02:10.223 +02:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-11-24 03:02:10.383 +02:00 [DBG] Executed controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 03:02:10.393 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto' ...
2025-11-24 03:02:10.396 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto' using the name '' in request data ...
2025-11-24 03:02:10.397 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 03:02:10.407 +02:00 [DBG] Connection id "0HNHAUKB7C1BF", Request id "0HNHAUKB7C1BF:00000001": started reading request body.
2025-11-24 03:02:10.409 +02:00 [DBG] Connection id "0HNHAUKB7C1BF", Request id "0HNHAUKB7C1BF:00000001": done reading request body.
2025-11-24 03:02:10.421 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Appointment.AddAppointmentDto'
2025-11-24 03:02:10.423 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto'.
2025-11-24 03:02:10.424 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto'.
2025-11-24 03:02:10.424 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto' ...
2025-11-24 03:02:10.431 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto'.
2025-11-24 03:02:10.434 +02:00 [INF] Add Appointment called at "2025-11-24T03:02:10.4340129+02:00"
2025-11-24 03:02:10.437 +02:00 [INF] Creating appointment for PatientId: 1, DoctorId: 2, Date: "2025-11-26", Time: "2025-11-23T15:33:47.5410000Z"
2025-11-24 03:02:10.844 +02:00 [DBG] The index {'BranchesBranchId'} was not created on entity type 'BranchDoctor (Dictionary<string, object>)' as the properties are already covered by the index {'BranchesBranchId', 'DoctorsDoctorId'}.
2025-11-24 03:02:10.845 +02:00 [DBG] The index {'BranchId'} was not created on entity type 'BranchService (Dictionary<string, object>)' as the properties are already covered by the index {'BranchId', 'ServiceId'}.
2025-11-24 03:02:10.846 +02:00 [DBG] The index {'BranchId'} was not created on entity type 'BranchSpecialization (Dictionary<string, object>)' as the properties are already covered by the index {'BranchId', 'SpecializationId'}.
2025-11-24 03:02:10.847 +02:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserRole<string>' as the properties are already covered by the index {'UserId', 'RoleId'}.
2025-11-24 03:02:10.847 +02:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserToken<string>' as the properties are already covered by the index {'UserId', 'LoginProvider', 'Name'}.
2025-11-24 03:02:10.936 +02:00 [DBG] The property 'BranchDoctor (Dictionary<string, object>).BranchesBranchId' was created in shadow state because there are no eligible CLR members with a matching name.
2025-11-24 03:02:10.938 +02:00 [DBG] The property 'BranchDoctor (Dictionary<string, object>).DoctorsDoctorId' was created in shadow state because there are no eligible CLR members with a matching name.
2025-11-24 03:02:11.074 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:02:11.080 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:02:11.101 +02:00 [DBG] Created DbConnection. (20ms).
2025-11-24 03:02:11.106 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:02:11.284 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:02:11.286 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 03:02:11.293 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 03:02:11.344 +02:00 [DBG] Compiling query expression: 
'DbSet<Patient>()
    .Include(p => p.User)
    .Include(p => p.MedicalRecords)
    .ThenInclude(m => m.Doctor)
    .ThenInclude(d => d.User)
    .FirstOrDefault(p => p.PatientId == __id_0)'
2025-11-24 03:02:11.393 +02:00 [DBG] Including navigation: 'Patient.User'.
2025-11-24 03:02:11.396 +02:00 [DBG] Including navigation: 'Patient.MedicalRecords'.
2025-11-24 03:02:11.397 +02:00 [DBG] Including navigation: 'MedicalRecord.Doctor'.
2025-11-24 03:02:11.399 +02:00 [DBG] Including navigation: 'Doctor.User'.
2025-11-24 03:02:11.550 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Patient>(
    asyncEnumerable: new SingleQueryingEnumerable<Patient>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Patient.PatientId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Patient.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: Patient.EmergencyContact (string) MaxLength(150), 2], [Property: Patient.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 3], [Property: Patient.UserId (string) Required FK Index, 4] }
                1 -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 5], [Property: User.AccessFailedCount (int) Required, 6], [Property: User.ConcurrencyStamp (string) Concurrency, 7], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 8], [Property: User.DateOfBirth (DateOnly?), 9], [Property: User.Email (string) Index MaxLength(256), 10], [Property: User.EmailConfirmed (bool) Required, 11], [Property: User.FullName (string) Required MaxLength(150), 12], [Property: User.Gender (GenderType?) MaxLength(10), 13], [Property: User.LockoutEnabled (bool) Required, 14], [Property: User.LockoutEnd (DateTimeOffset?), 15], [Property: User.NormalizedEmail (string) Index MaxLength(256), 16], [Property: User.NormalizedUserName (string) Index MaxLength(256), 17], [Property: User.PasswordHash (string), 18], [Property: User.PhoneNumber (string), 19], [Property: User.PhoneNumberConfirmed (bool) Required, 20], [Property: User.RefreshToken (string), 21], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 22], [Property: User.Role (string) Required MaxLength(50), 23], [Property: User.SecurityStamp (string), 24], [Property: User.TwoFactorEnabled (bool) Required, 25], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 26], [Property: User.UserName (string) MaxLength(256), 27] }
                2 -> 0
                3 -> 5
                4 -> Dictionary<IProperty, int> { [Property: MedicalRecord.RecordId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 28], [Property: MedicalRecord.AppointmentId (int) Required FK Index, 29], [Property: MedicalRecord.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 30], [Property: MedicalRecord.Diagnosis (string), 31], [Property: MedicalRecord.DoctorId (int) Required FK Index, 32], [Property: MedicalRecord.Notes (string), 33], [Property: MedicalRecord.PatientId (int) Required FK Index, 34], [Property: MedicalRecord.TreatmentPlan (string), 35], [Property: MedicalRecord.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 36] }
                5 -> Dictionary<IProperty, int> { [Property: Doctor.DoctorId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 37], [Property: Doctor.Available (bool?), 38], [Property: Doctor.Biography (string), 39], [Property: Doctor.ConsultationFees (decimal) Required, 40], [Property: Doctor.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 41], [Property: Doctor.ExperienceYears (int?), 42], [Property: Doctor.ImageURL (string) MaxLength(300), 43], [Property: Doctor.SpecializationId (int) Required FK Index, 44], [Property: Doctor.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 45], [Property: Doctor.UserId (string) Required FK Index, 46] }
                6 -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 47], [Property: User.AccessFailedCount (int) Required, 48], [Property: User.ConcurrencyStamp (string) Concurrency, 49], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 50], [Property: User.DateOfBirth (DateOnly?), 51], [Property: User.Email (string) Index MaxLength(256), 52], [Property: User.EmailConfirmed (bool) Required, 53], [Property: User.FullName (string) Required MaxLength(150), 54], [Property: User.Gender (GenderType?) MaxLength(10), 55], [Property: User.LockoutEnabled (bool) Required, 56], [Property: User.LockoutEnd (DateTimeOffset?), 57], [Property: User.NormalizedEmail (string) Index MaxLength(256), 58], [Property: User.NormalizedUserName (string) Index MaxLength(256), 59], [Property: User.PasswordHash (string), 60], [Property: User.PhoneNumber (string), 61], [Property: User.PhoneNumberConfirmed (bool) Required, 62], [Property: User.RefreshToken (string), 63], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 64], [Property: User.Role (string) Required MaxLength(50), 65], [Property: User.SecurityStamp (string), 66], [Property: User.TwoFactorEnabled (bool) Required, 67], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 68], [Property: User.UserName (string) MaxLength(256), 69] }
                7 -> 28
                8 -> 37
                9 -> 47
            SELECT t.PatientId, t.CreatedAt, t.EmergencyContact, t.UpdatedAt, t.UserId, t.Id, t.AccessFailedCount, t.ConcurrencyStamp, t.CreatedAt0, t.DateOfBirth, t.Email, t.EmailConfirmed, t.FullName, t.Gender, t.LockoutEnabled, t.LockoutEnd, t.NormalizedEmail, t.NormalizedUserName, t.PasswordHash, t.PhoneNumber, t.PhoneNumberConfirmed, t.RefreshToken, t.RefreshTokenExpiryTime, t.Role, t.SecurityStamp, t.TwoFactorEnabled, t.UpdatedAt0, t.UserName, t0.RecordId, t0.AppointmentId, t0.CreatedAt, t0.Diagnosis, t0.DoctorId, t0.Notes, t0.PatientId, t0.TreatmentPlan, t0.UpdatedAt, t0.DoctorId0, t0.Available, t0.Biography, t0.ConsultationFees, t0.CreatedAt0, t0.ExperienceYears, t0.ImageURL, t0.SpecializationId, t0.UpdatedAt0, t0.UserId, t0.Id, t0.AccessFailedCount, t0.ConcurrencyStamp, t0.CreatedAt1, t0.DateOfBirth, t0.Email, t0.EmailConfirmed, t0.FullName, t0.Gender, t0.LockoutEnabled, t0.LockoutEnd, t0.NormalizedEmail, t0.NormalizedUserName, t0.PasswordHash, t0.PhoneNumber, t0.PhoneNumberConfirmed, t0.RefreshToken, t0.RefreshTokenExpiryTime, t0.Role, t0.SecurityStamp, t0.TwoFactorEnabled, t0.UpdatedAt1, t0.UserName
            FROM 
            (
                SELECT TOP(1) p.PatientId, p.CreatedAt, p.EmergencyContact, p.UpdatedAt, p.UserId, u.Id, u.AccessFailedCount, u.ConcurrencyStamp, u.CreatedAt AS CreatedAt0, u.DateOfBirth, u.Email, u.EmailConfirmed, u.FullName, u.Gender, u.LockoutEnabled, u.LockoutEnd, u.NormalizedEmail, u.NormalizedUserName, u.PasswordHash, u.PhoneNumber, u.PhoneNumberConfirmed, u.RefreshToken, u.RefreshTokenExpiryTime, u.Role, u.SecurityStamp, u.TwoFactorEnabled, u.UpdatedAt AS UpdatedAt0, u.UserName
                FROM Patients AS p
                INNER JOIN Users AS u ON p.UserId == u.Id
                WHERE p.PatientId == @__id_0
            ) AS t
            LEFT JOIN 
            (
                SELECT m.RecordId, m.AppointmentId, m.CreatedAt, m.Diagnosis, m.DoctorId, m.Notes, m.PatientId, m.TreatmentPlan, m.UpdatedAt, d.DoctorId AS DoctorId0, d.Available, d.Biography, d.ConsultationFees, d.CreatedAt AS CreatedAt0, d.ExperienceYears, d.ImageURL, d.SpecializationId, d.UpdatedAt AS UpdatedAt0, d.UserId, u0.Id, u0.AccessFailedCount, u0.ConcurrencyStamp, u0.CreatedAt AS CreatedAt1, u0.DateOfBirth, u0.Email, u0.EmailConfirmed, u0.FullName, u0.Gender, u0.LockoutEnabled, u0.LockoutEnd, u0.NormalizedEmail, u0.NormalizedUserName, u0.PasswordHash, u0.PhoneNumber, u0.PhoneNumberConfirmed, u0.RefreshToken, u0.RefreshTokenExpiryTime, u0.Role, u0.SecurityStamp, u0.TwoFactorEnabled, u0.UpdatedAt AS UpdatedAt1, u0.UserName
                FROM MedicalRecords AS m
                INNER JOIN Doctors AS d ON m.DoctorId == d.DoctorId
                INNER JOIN Users AS u0 ON d.UserId == u0.Id
            ) AS t0 ON t.PatientId == t0.PatientId
            ORDER BY t.PatientId ASC, t.Id ASC, t0.RecordId ASC, t0.DoctorId0 ASC), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Patient>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 03:02:11.581 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:02:11.586 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2025-11-24 03:02:11.593 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (11ms).
2025-11-24 03:02:11.599 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 03:02:11.654 +02:00 [INF] Executed DbCommand (56ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 03:02:11.686 +02:00 [DBG] Context 'AppDbContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:02:11.721 +02:00 [DBG] The navigation 'Patient.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:02:11.725 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:02:11.762 +02:00 [DBG] Context 'AppDbContext' started tracking 'MedicalRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:02:11.775 +02:00 [DBG] The navigation 'MedicalRecord.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:02:11.780 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:02:11.791 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:02:11.793 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:02:11.797 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:02:11.802 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 141ms reading results.
2025-11-24 03:02:11.806 +02:00 [DBG] Compiling query expression: 
'DbSet<Doctor>()
    .Include(d => d.User)
    .Include(d => d.Specialization)
    .Include(d => d.Branches)
    .Include(d => d.Schedules)
    .FirstOrDefault(d => d.DoctorId == __doctorId_0)'
2025-11-24 03:02:11.808 +02:00 [DBG] Including navigation: 'Doctor.User'.
2025-11-24 03:02:11.811 +02:00 [DBG] Including navigation: 'Doctor.Specialization'.
2025-11-24 03:02:11.813 +02:00 [DBG] Including navigation: 'Doctor.Branches'.
2025-11-24 03:02:11.814 +02:00 [DBG] Including navigation: 'Doctor.Schedules'.
2025-11-24 03:02:11.840 +02:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-11-24 03:02:11.849 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Doctor>(
    asyncEnumerable: new SingleQueryingEnumerable<Doctor>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Doctor.DoctorId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Doctor.Available (bool?), 1], [Property: Doctor.Biography (string), 2], [Property: Doctor.ConsultationFees (decimal) Required, 3], [Property: Doctor.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: Doctor.ExperienceYears (int?), 5], [Property: Doctor.ImageURL (string) MaxLength(300), 6], [Property: Doctor.SpecializationId (int) Required FK Index, 7], [Property: Doctor.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 8], [Property: Doctor.UserId (string) Required FK Index, 9] }
                1 -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 10], [Property: User.AccessFailedCount (int) Required, 11], [Property: User.ConcurrencyStamp (string) Concurrency, 12], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 13], [Property: User.DateOfBirth (DateOnly?), 14], [Property: User.Email (string) Index MaxLength(256), 15], [Property: User.EmailConfirmed (bool) Required, 16], [Property: User.FullName (string) Required MaxLength(150), 17], [Property: User.Gender (GenderType?) MaxLength(10), 18], [Property: User.LockoutEnabled (bool) Required, 19], [Property: User.LockoutEnd (DateTimeOffset?), 20], [Property: User.NormalizedEmail (string) Index MaxLength(256), 21], [Property: User.NormalizedUserName (string) Index MaxLength(256), 22], [Property: User.PasswordHash (string), 23], [Property: User.PhoneNumber (string), 24], [Property: User.PhoneNumberConfirmed (bool) Required, 25], [Property: User.RefreshToken (string), 26], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 27], [Property: User.Role (string) Required MaxLength(50), 28], [Property: User.SecurityStamp (string), 29], [Property: User.TwoFactorEnabled (bool) Required, 30], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 31], [Property: User.UserName (string) MaxLength(256), 32] }
                2 -> Dictionary<IProperty, int> { [Property: Specialization.SpecializationId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 33], [Property: Specialization.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 34], [Property: Specialization.Description (string), 35], [Property: Specialization.Name (string) Required MaxLength(120), 36], [Property: Specialization.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 37] }
                3 -> 0
                4 -> 10
                5 -> 33
                6 -> Dictionary<IProperty, int> { [Property: BranchDoctor (Dictionary<string, object>).BranchesBranchId (no field, int) Indexer Required PK FK AfterSave:Throw, 38], [Property: BranchDoctor (Dictionary<string, object>).DoctorsDoctorId (no field, int) Indexer Required PK FK Index AfterSave:Throw, 39] }
                7 -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 40], [Property: Branch.Address (string) MaxLength(250), 41], [Property: Branch.BranchName (string) Required MaxLength(150), 42], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 43], [Property: Branch.Description (string), 44], [Property: Branch.Email (string) MaxLength(200), 45], [Property: Branch.ImageURL (string) MaxLength(300), 46], [Property: Branch.Phone (string) MaxLength(25), 47], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 48] }
                8 -> 38
                9 -> 39
                10 -> 40
                11 -> Dictionary<IProperty, int> { [Property: Schedule.ScheduleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 49], [Property: Schedule.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 50], [Property: Schedule.DayOfWeek (string) Required MaxLength(20), 51], [Property: Schedule.DoctorId (int) Required FK Index, 52], [Property: Schedule.EndTime (DateTime) Required, 53], [Property: Schedule.Shift (AppointmentShift) Required, 54], [Property: Schedule.StartTime (DateTime) Required, 55], [Property: Schedule.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 56] }
                12 -> 49
            SELECT t.DoctorId, t.Available, t.Biography, t.ConsultationFees, t.CreatedAt, t.ExperienceYears, t.ImageURL, t.SpecializationId, t.UpdatedAt, t.UserId, t.Id, t.AccessFailedCount, t.ConcurrencyStamp, t.CreatedAt0, t.DateOfBirth, t.Email, t.EmailConfirmed, t.FullName, t.Gender, t.LockoutEnabled, t.LockoutEnd, t.NormalizedEmail, t.NormalizedUserName, t.PasswordHash, t.PhoneNumber, t.PhoneNumberConfirmed, t.RefreshToken, t.RefreshTokenExpiryTime, t.Role, t.SecurityStamp, t.TwoFactorEnabled, t.UpdatedAt0, t.UserName, t.SpecializationId0, t.CreatedAt1, t.Description, t.Name, t.UpdatedAt1, t0.BranchesBranchId, t0.DoctorsDoctorId, t0.BranchId, t0.Address, t0.BranchName, t0.CreatedAt, t0.Description, t0.Email, t0.ImageURL, t0.Phone, t0.UpdatedAt, s0.ScheduleId, s0.CreatedAt, s0.DayOfWeek, s0.DoctorId, s0.EndTime, s0.Shift, s0.StartTime, s0.UpdatedAt
            FROM 
            (
                SELECT TOP(1) d.DoctorId, d.Available, d.Biography, d.ConsultationFees, d.CreatedAt, d.ExperienceYears, d.ImageURL, d.SpecializationId, d.UpdatedAt, d.UserId, u.Id, u.AccessFailedCount, u.ConcurrencyStamp, u.CreatedAt AS CreatedAt0, u.DateOfBirth, u.Email, u.EmailConfirmed, u.FullName, u.Gender, u.LockoutEnabled, u.LockoutEnd, u.NormalizedEmail, u.NormalizedUserName, u.PasswordHash, u.PhoneNumber, u.PhoneNumberConfirmed, u.RefreshToken, u.RefreshTokenExpiryTime, u.Role, u.SecurityStamp, u.TwoFactorEnabled, u.UpdatedAt AS UpdatedAt0, u.UserName, s.SpecializationId AS SpecializationId0, s.CreatedAt AS CreatedAt1, s.Description, s.Name, s.UpdatedAt AS UpdatedAt1
                FROM Doctors AS d
                INNER JOIN Users AS u ON d.UserId == u.Id
                INNER JOIN Specializations AS s ON d.SpecializationId == s.SpecializationId
                WHERE d.DoctorId == @__doctorId_0
            ) AS t
            LEFT JOIN 
            (
                SELECT d0.BranchesBranchId, d0.DoctorsDoctorId, b.BranchId, b.Address, b.BranchName, b.CreatedAt, b.Description, b.Email, b.ImageURL, b.Phone, b.UpdatedAt
                FROM DoctorBranches AS d0
                INNER JOIN Branches AS b ON d0.BranchesBranchId == b.BranchId
            ) AS t0 ON t.DoctorId == t0.DoctorsDoctorId
            LEFT JOIN Schedules AS s0 ON t.DoctorId == s0.DoctorId
            ORDER BY t.DoctorId ASC, t.Id ASC, t.SpecializationId0 ASC, t0.BranchesBranchId ASC, t0.DoctorsDoctorId ASC, t0.BranchId ASC), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Doctor>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 03:02:11.858 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:02:11.859 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:02:11.859 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:02:11.860 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:02:11.871 +02:00 [INF] Executed DbCommand (11ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:02:11.875 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:02:11.875 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 0ms reading results.
2025-11-24 03:02:11.876 +02:00 [WRN] Doctor with ID 2 not found
2025-11-24 03:02:11.905 +02:00 [DBG] Rolling back transaction.
2025-11-24 03:02:11.908 +02:00 [DBG] Rolled back transaction.
2025-11-24 03:02:11.911 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:02:11.916 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (5ms).
2025-11-24 03:02:11.917 +02:00 [ERR] Failed to create appointment for PatientId: 1, DoctorId: 2
System.ArgumentException: Doctor does not exist.
   at Hospital.Infrastructure.Services.AppointmentService.AddAsync(AddAppointmentDto dto) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\AppointmentService.cs:line 68
2025-11-24 03:02:11.948 +02:00 [DBG] Disposing transaction.
2025-11-24 03:02:11.986 +02:00 [INF] Executed action Hospital.API.Controllers.AppointmentController.Add (Hospital) in 1845.9806ms
2025-11-24 03:02:11.988 +02:00 [INF] Executed endpoint 'Hospital.API.Controllers.AppointmentController.Add (Hospital)'
2025-11-24 03:02:12.032 +02:00 [ERR]  Exception caught: Doctor does not exist.
System.ArgumentException: Doctor does not exist.
   at Hospital.Infrastructure.Services.AppointmentService.AddAsync(AddAppointmentDto dto) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\AppointmentService.cs:line 68
   at Hospital.Infrastructure.Services.AppointmentService.AddAsync(AddAppointmentDto dto) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\AppointmentService.cs:line 128
   at Hospital.Infrastructure.Services.AppointmentService.AddAsync(AddAppointmentDto dto) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\AppointmentService.cs:line 129
   at Hospital.API.Controllers.AppointmentController.Add(AddAppointmentDto dto) in D:\Walaa\GP\Hospital\Hospital\Controllers\AppointmentController.cs:line 27
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
2025-11-24 03:02:12.055 +02:00 [DBG] Connection id "0HNHAUKB7C1BF" completed keep alive response.
2025-11-24 03:02:12.058 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:02:12.060 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:02:12.061 +02:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-11-24 03:02:12.063 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Appointment - 400 null application/json 1988.5502ms
2025-11-24 03:02:39.983 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Doctor/all - null null
2025-11-24 03:02:39.987 +02:00 [DBG] 2 candidate(s) found for the request path '/api/Doctor/all'
2025-11-24 03:02:39.987 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.GetAll (Hospital)' with route pattern 'api/Doctor/all' is valid for the request path '/api/Doctor/all'
2025-11-24 03:02:39.989 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.GetDoctor (Hospital)' with route pattern 'api/Doctor/{doctorId}' is valid for the request path '/api/Doctor/all'
2025-11-24 03:02:39.990 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.GetAll (Hospital)'
2025-11-24 03:02:39.991 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:02:39.992 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:02:39.994 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.GetAll (Hospital)'
2025-11-24 03:02:39.997 +02:00 [INF] Route matched with {action = "GetAll", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll() on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 03:02:39.998 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:02:40.000 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:02:40.001 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:02:40.002 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:02:40.003 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:02:40.003 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:02:40.015 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:02:40.017 +02:00 [INF] get all doctor in system called at "2025-11-24T03:02:40.0169640+02:00"
2025-11-24 03:02:40.018 +02:00 [INF] Fetching all doctors in the system
2025-11-24 03:02:40.026 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:02:40.032 +02:00 [DBG] Compiling query expression: 
'DbSet<Doctor>()
    .Include(d => d.User)
    .Include(d => d.Specialization)
    .Include(d => d.Branches)
    .Include(d => d.Schedules)'
2025-11-24 03:02:40.033 +02:00 [DBG] Including navigation: 'Doctor.User'.
2025-11-24 03:02:40.034 +02:00 [DBG] Including navigation: 'Doctor.Specialization'.
2025-11-24 03:02:40.035 +02:00 [DBG] Including navigation: 'Doctor.Branches'.
2025-11-24 03:02:40.036 +02:00 [DBG] Including navigation: 'Doctor.Schedules'.
2025-11-24 03:02:40.050 +02:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-11-24 03:02:40.058 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Doctor>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Doctor.DoctorId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Doctor.Available (bool?), 1], [Property: Doctor.Biography (string), 2], [Property: Doctor.ConsultationFees (decimal) Required, 3], [Property: Doctor.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: Doctor.ExperienceYears (int?), 5], [Property: Doctor.ImageURL (string) MaxLength(300), 6], [Property: Doctor.SpecializationId (int) Required FK Index, 7], [Property: Doctor.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 8], [Property: Doctor.UserId (string) Required FK Index, 9] }
            1 -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 10], [Property: User.AccessFailedCount (int) Required, 11], [Property: User.ConcurrencyStamp (string) Concurrency, 12], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 13], [Property: User.DateOfBirth (DateOnly?), 14], [Property: User.Email (string) Index MaxLength(256), 15], [Property: User.EmailConfirmed (bool) Required, 16], [Property: User.FullName (string) Required MaxLength(150), 17], [Property: User.Gender (GenderType?) MaxLength(10), 18], [Property: User.LockoutEnabled (bool) Required, 19], [Property: User.LockoutEnd (DateTimeOffset?), 20], [Property: User.NormalizedEmail (string) Index MaxLength(256), 21], [Property: User.NormalizedUserName (string) Index MaxLength(256), 22], [Property: User.PasswordHash (string), 23], [Property: User.PhoneNumber (string), 24], [Property: User.PhoneNumberConfirmed (bool) Required, 25], [Property: User.RefreshToken (string), 26], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 27], [Property: User.Role (string) Required MaxLength(50), 28], [Property: User.SecurityStamp (string), 29], [Property: User.TwoFactorEnabled (bool) Required, 30], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 31], [Property: User.UserName (string) MaxLength(256), 32] }
            2 -> Dictionary<IProperty, int> { [Property: Specialization.SpecializationId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 33], [Property: Specialization.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 34], [Property: Specialization.Description (string), 35], [Property: Specialization.Name (string) Required MaxLength(120), 36], [Property: Specialization.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 37] }
            3 -> 0
            4 -> 10
            5 -> 33
            6 -> Dictionary<IProperty, int> { [Property: BranchDoctor (Dictionary<string, object>).BranchesBranchId (no field, int) Indexer Required PK FK AfterSave:Throw, 38], [Property: BranchDoctor (Dictionary<string, object>).DoctorsDoctorId (no field, int) Indexer Required PK FK Index AfterSave:Throw, 39] }
            7 -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 40], [Property: Branch.Address (string) MaxLength(250), 41], [Property: Branch.BranchName (string) Required MaxLength(150), 42], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 43], [Property: Branch.Description (string), 44], [Property: Branch.Email (string) MaxLength(200), 45], [Property: Branch.ImageURL (string) MaxLength(300), 46], [Property: Branch.Phone (string) MaxLength(25), 47], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 48] }
            8 -> 38
            9 -> 39
            10 -> 40
            11 -> Dictionary<IProperty, int> { [Property: Schedule.ScheduleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 49], [Property: Schedule.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 50], [Property: Schedule.DayOfWeek (string) Required MaxLength(20), 51], [Property: Schedule.DoctorId (int) Required FK Index, 52], [Property: Schedule.EndTime (DateTime) Required, 53], [Property: Schedule.Shift (AppointmentShift) Required, 54], [Property: Schedule.StartTime (DateTime) Required, 55], [Property: Schedule.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 56] }
            12 -> 49
        SELECT d.DoctorId, d.Available, d.Biography, d.ConsultationFees, d.CreatedAt, d.ExperienceYears, d.ImageURL, d.SpecializationId, d.UpdatedAt, d.UserId, u.Id, u.AccessFailedCount, u.ConcurrencyStamp, u.CreatedAt, u.DateOfBirth, u.Email, u.EmailConfirmed, u.FullName, u.Gender, u.LockoutEnabled, u.LockoutEnd, u.NormalizedEmail, u.NormalizedUserName, u.PasswordHash, u.PhoneNumber, u.PhoneNumberConfirmed, u.RefreshToken, u.RefreshTokenExpiryTime, u.Role, u.SecurityStamp, u.TwoFactorEnabled, u.UpdatedAt, u.UserName, s.SpecializationId, s.CreatedAt, s.Description, s.Name, s.UpdatedAt, t.BranchesBranchId, t.DoctorsDoctorId, t.BranchId, t.Address, t.BranchName, t.CreatedAt, t.Description, t.Email, t.ImageURL, t.Phone, t.UpdatedAt, s0.ScheduleId, s0.CreatedAt, s0.DayOfWeek, s0.DoctorId, s0.EndTime, s0.Shift, s0.StartTime, s0.UpdatedAt
        FROM Doctors AS d
        INNER JOIN Users AS u ON d.UserId == u.Id
        INNER JOIN Specializations AS s ON d.SpecializationId == s.SpecializationId
        LEFT JOIN 
        (
            SELECT d0.BranchesBranchId, d0.DoctorsDoctorId, b.BranchId, b.Address, b.BranchName, b.CreatedAt, b.Description, b.Email, b.ImageURL, b.Phone, b.UpdatedAt
            FROM DoctorBranches AS d0
            INNER JOIN Branches AS b ON d0.BranchesBranchId == b.BranchId
        ) AS t ON d.DoctorId == t.DoctorsDoctorId
        LEFT JOIN Schedules AS s0 ON d.DoctorId == s0.DoctorId
        ORDER BY d.DoctorId ASC, u.Id ASC, s.SpecializationId ASC, t.BranchesBranchId ASC, t.DoctorsDoctorId ASC, t.BranchId ASC), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Doctor>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 03:02:40.061 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:02:40.061 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 03:02:40.062 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:02:40.063 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:02:40.063 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:02:40.064 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:02:40.064 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:02:40.065 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt], [t].[BranchesBranchId], [t].[DoctorsDoctorId], [t].[BranchId], [t].[Address], [t].[BranchName], [t].[CreatedAt], [t].[Description], [t].[Email], [t].[ImageURL], [t].[Phone], [t].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM [Doctors] AS [d]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t] ON [d].[DoctorId] = [t].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [d].[DoctorId] = [s0].[DoctorId]
ORDER BY [d].[DoctorId], [u].[Id], [s].[SpecializationId], [t].[BranchesBranchId], [t].[DoctorsDoctorId], [t].[BranchId]
2025-11-24 03:02:40.076 +02:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt], [t].[BranchesBranchId], [t].[DoctorsDoctorId], [t].[BranchId], [t].[Address], [t].[BranchName], [t].[CreatedAt], [t].[Description], [t].[Email], [t].[ImageURL], [t].[Phone], [t].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM [Doctors] AS [d]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t] ON [d].[DoctorId] = [t].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [d].[DoctorId] = [s0].[DoctorId]
ORDER BY [d].[DoctorId], [u].[Id], [s].[SpecializationId], [t].[BranchesBranchId], [t].[DoctorsDoctorId], [t].[BranchId]
2025-11-24 03:02:40.078 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:02:40.079 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:02:40.080 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:02:40.084 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:02:40.085 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:02:40.096 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:02:40.108 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:02:40.122 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:02:40.123 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 44ms reading results.
2025-11-24 03:02:40.124 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:02:40.125 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:02:40.140 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 03:02:40.145 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 03:02:40.146 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 03:02:40.147 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 03:02:40.148 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 03:02:40.149 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Doctor.DoctorDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 03:02:40.163 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.GetAll (Hospital) in 159.9769ms
2025-11-24 03:02:40.164 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.GetAll (Hospital)'
2025-11-24 03:02:40.165 +02:00 [DBG] Connection id "0HNHAUKB7C1BF" completed keep alive response.
2025-11-24 03:02:40.166 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:02:40.166 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:02:40.167 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 03:02:40.168 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Doctor/all - 200 null application/json; charset=utf-8 184.2446ms
2025-11-24 03:02:57.156 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Schedule - application/json 73
2025-11-24 03:02:57.158 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Schedule'
2025-11-24 03:02:57.158 +02:00 [DBG] Endpoint 'Hospital.Controllers.ScheduleController.Create (Hospital)' with route pattern 'api/Schedule' is valid for the request path '/api/Schedule'
2025-11-24 03:02:57.159 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.ScheduleController.Create (Hospital)'
2025-11-24 03:02:57.160 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:02:57.162 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:02:57.163 +02:00 [INF] Executing endpoint 'Hospital.Controllers.ScheduleController.Create (Hospital)'
2025-11-24 03:02:57.165 +02:00 [INF] Route matched with {action = "Create", controller = "Schedule"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Hospital.Application.DTO.Schedule.ScheduleDto]] Create(Hospital.Application.DTO.Schedule.CreateScheduleDto) on controller Hospital.Controllers.ScheduleController (Hospital).
2025-11-24 03:02:57.167 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:02:57.168 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:02:57.168 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:02:57.170 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:02:57.170 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:02:57.171 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 03:02:57.173 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 03:02:57.173 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto' ...
2025-11-24 03:02:57.174 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto' using the name '' in request data ...
2025-11-24 03:02:57.174 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 03:02:57.177 +02:00 [DBG] Connection id "0HNHAUKB7C1BF", Request id "0HNHAUKB7C1BF:00000003": started reading request body.
2025-11-24 03:02:57.178 +02:00 [DBG] Connection id "0HNHAUKB7C1BF", Request id "0HNHAUKB7C1BF:00000003": done reading request body.
2025-11-24 03:02:57.179 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Schedule.CreateScheduleDto'
2025-11-24 03:02:57.180 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto'.
2025-11-24 03:02:57.180 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto'.
2025-11-24 03:02:57.181 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto' ...
2025-11-24 03:02:57.182 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto'.
2025-11-24 03:02:57.183 +02:00 [INF] create schedule  called at "2025-11-24T03:02:57.1838233+02:00"
2025-11-24 03:02:57.185 +02:00 [INF] Creating schedule for DoctorId: 2, Day: friday, Shift: "Afternoon"
2025-11-24 03:02:57.219 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:02:57.224 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:02:57.224 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 03:02:57.225 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:02:57.226 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:02:57.227 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:02:57.228 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:02:57.228 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:02:57.230 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:02:57.233 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:02:57.236 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:02:57.237 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 0ms reading results.
2025-11-24 03:02:57.238 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:02:57.239 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:02:57.240 +02:00 [WRN] Doctor with ID 2 not found
2025-11-24 03:02:57.278 +02:00 [INF] Executed action Hospital.Controllers.ScheduleController.Create (Hospital) in 107.3273ms
2025-11-24 03:02:57.279 +02:00 [INF] Executed endpoint 'Hospital.Controllers.ScheduleController.Create (Hospital)'
2025-11-24 03:02:57.312 +02:00 [ERR]  Exception caught: Doctor not found.
System.Collections.Generic.KeyNotFoundException: Doctor not found.
   at Hospital.Infrastructure.Services.ScheduleService.CreateAsync(CreateScheduleDto dto) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\ScheduleService.cs:line 39
   at Hospital.Controllers.ScheduleController.Create(CreateScheduleDto dto) in D:\Walaa\GP\Hospital\Hospital\Controllers\ScheduleController.cs:line 27
   at lambda_method563(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
2025-11-24 03:02:57.319 +02:00 [DBG] Connection id "0HNHAUKB7C1BF" completed keep alive response.
2025-11-24 03:02:57.320 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:02:57.320 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:02:57.321 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 03:02:57.322 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Schedule - 404 null application/json 166.3259ms
2025-11-24 03:03:03.117 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Schedule - application/json 73
2025-11-24 03:03:03.120 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Schedule'
2025-11-24 03:03:03.121 +02:00 [DBG] Endpoint 'Hospital.Controllers.ScheduleController.Create (Hospital)' with route pattern 'api/Schedule' is valid for the request path '/api/Schedule'
2025-11-24 03:03:03.122 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.ScheduleController.Create (Hospital)'
2025-11-24 03:03:03.123 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:03:03.124 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:03:03.124 +02:00 [INF] Executing endpoint 'Hospital.Controllers.ScheduleController.Create (Hospital)'
2025-11-24 03:03:03.125 +02:00 [INF] Route matched with {action = "Create", controller = "Schedule"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Hospital.Application.DTO.Schedule.ScheduleDto]] Create(Hospital.Application.DTO.Schedule.CreateScheduleDto) on controller Hospital.Controllers.ScheduleController (Hospital).
2025-11-24 03:03:03.126 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:03:03.126 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:03:03.127 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:03:03.128 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:03:03.128 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:03:03.130 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 03:03:03.131 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.ScheduleController (Hospital)
2025-11-24 03:03:03.131 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto' ...
2025-11-24 03:03:03.132 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto' using the name '' in request data ...
2025-11-24 03:03:03.132 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 03:03:03.133 +02:00 [DBG] Connection id "0HNHAUKB7C1BF", Request id "0HNHAUKB7C1BF:00000004": started reading request body.
2025-11-24 03:03:03.133 +02:00 [DBG] Connection id "0HNHAUKB7C1BF", Request id "0HNHAUKB7C1BF:00000004": done reading request body.
2025-11-24 03:03:03.134 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Schedule.CreateScheduleDto'
2025-11-24 03:03:03.135 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto'.
2025-11-24 03:03:03.135 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto'.
2025-11-24 03:03:03.136 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto' ...
2025-11-24 03:03:03.137 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Schedule.CreateScheduleDto'.
2025-11-24 03:03:03.138 +02:00 [INF] create schedule  called at "2025-11-24T03:03:03.1382490+02:00"
2025-11-24 03:03:03.138 +02:00 [INF] Creating schedule for DoctorId: 1, Day: friday, Shift: "Afternoon"
2025-11-24 03:03:03.139 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:03:03.141 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:03:03.142 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 03:03:03.142 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:03.143 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:03.144 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:03:03.144 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:03:03.144 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:03:03.145 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:03:03.148 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:03:03.150 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:03.151 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:03.152 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:03.153 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:03.154 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:03.155 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:03.155 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:03.156 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:03.156 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 6ms reading results.
2025-11-24 03:03:03.157 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:03.158 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:03:03.168 +02:00 [DBG] Compiling query expression: 
'DbSet<Schedule>()
    .Where(s => s.DayOfWeek.ToLower() == __ToLower_0)
    .Include(s => s.Doctor)
    .ThenInclude(d => d.User)'
2025-11-24 03:03:03.171 +02:00 [DBG] Including navigation: 'Schedule.Doctor'.
2025-11-24 03:03:03.171 +02:00 [DBG] Including navigation: 'Doctor.User'.
2025-11-24 03:03:03.180 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Schedule>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Schedule.ScheduleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Schedule.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: Schedule.DayOfWeek (string) Required MaxLength(20), 2], [Property: Schedule.DoctorId (int) Required FK Index, 3], [Property: Schedule.EndTime (DateTime) Required, 4], [Property: Schedule.Shift (AppointmentShift) Required, 5], [Property: Schedule.StartTime (DateTime) Required, 6], [Property: Schedule.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 7] }
            1 -> Dictionary<IProperty, int> { [Property: Doctor.DoctorId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 8], [Property: Doctor.Available (bool?), 9], [Property: Doctor.Biography (string), 10], [Property: Doctor.ConsultationFees (decimal) Required, 11], [Property: Doctor.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 12], [Property: Doctor.ExperienceYears (int?), 13], [Property: Doctor.ImageURL (string) MaxLength(300), 14], [Property: Doctor.SpecializationId (int) Required FK Index, 15], [Property: Doctor.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 16], [Property: Doctor.UserId (string) Required FK Index, 17] }
            2 -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 18], [Property: User.AccessFailedCount (int) Required, 19], [Property: User.ConcurrencyStamp (string) Concurrency, 20], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 21], [Property: User.DateOfBirth (DateOnly?), 22], [Property: User.Email (string) Index MaxLength(256), 23], [Property: User.EmailConfirmed (bool) Required, 24], [Property: User.FullName (string) Required MaxLength(150), 25], [Property: User.Gender (GenderType?) MaxLength(10), 26], [Property: User.LockoutEnabled (bool) Required, 27], [Property: User.LockoutEnd (DateTimeOffset?), 28], [Property: User.NormalizedEmail (string) Index MaxLength(256), 29], [Property: User.NormalizedUserName (string) Index MaxLength(256), 30], [Property: User.PasswordHash (string), 31], [Property: User.PhoneNumber (string), 32], [Property: User.PhoneNumberConfirmed (bool) Required, 33], [Property: User.RefreshToken (string), 34], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 35], [Property: User.Role (string) Required MaxLength(50), 36], [Property: User.SecurityStamp (string), 37], [Property: User.TwoFactorEnabled (bool) Required, 38], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 39], [Property: User.UserName (string) MaxLength(256), 40] }
        SELECT s.ScheduleId, s.CreatedAt, s.DayOfWeek, s.DoctorId, s.EndTime, s.Shift, s.StartTime, s.UpdatedAt, d.DoctorId, d.Available, d.Biography, d.ConsultationFees, d.CreatedAt, d.ExperienceYears, d.ImageURL, d.SpecializationId, d.UpdatedAt, d.UserId, u.Id, u.AccessFailedCount, u.ConcurrencyStamp, u.CreatedAt, u.DateOfBirth, u.Email, u.EmailConfirmed, u.FullName, u.Gender, u.LockoutEnabled, u.LockoutEnd, u.NormalizedEmail, u.NormalizedUserName, u.PasswordHash, u.PhoneNumber, u.PhoneNumberConfirmed, u.RefreshToken, u.RefreshTokenExpiryTime, u.Role, u.SecurityStamp, u.TwoFactorEnabled, u.UpdatedAt, u.UserName
        FROM Schedules AS s
        INNER JOIN Doctors AS d ON s.DoctorId == d.DoctorId
        INNER JOIN Users AS u ON d.UserId == u.Id
        WHERE LOWER(s.DayOfWeek) == @__ToLower_0), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Schedule>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 03:03:03.189 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:03.190 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:03.191 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:03:03.191 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:03:03.193 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 03:03:03.193 +02:00 [DBG] Executing DbCommand [Parameters=[@__ToLower_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE LOWER([s].[DayOfWeek]) = @__ToLower_0
2025-11-24 03:03:03.199 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__ToLower_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[ScheduleId], [s].[CreatedAt], [s].[DayOfWeek], [s].[DoctorId], [s].[EndTime], [s].[Shift], [s].[StartTime], [s].[UpdatedAt], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName]
FROM [Schedules] AS [s]
INNER JOIN [Doctors] AS [d] ON [s].[DoctorId] = [d].[DoctorId]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
WHERE LOWER([s].[DayOfWeek]) = @__ToLower_0
2025-11-24 03:03:03.200 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:03.201 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 0ms reading results.
2025-11-24 03:03:03.201 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:03.202 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:03:03.218 +02:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Schedule.ScheduleId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:03.234 +02:00 [DBG] The navigation 'Schedule.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:03.236 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:03.240 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 03:03:03.280 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 03:03:03.288 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 03:03:03.290 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 03:03:03.292 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 03:03:03.339 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:03.340 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:03.343 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:03:03.343 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:03:03.346 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-11-24 03:03:03.347 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 20), @p2='?' (DbType = Int32), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = DateTime2), @p6='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Schedules] ([CreatedAt], [DayOfWeek], [DoctorId], [EndTime], [Shift], [StartTime], [UpdatedAt])
OUTPUT INSERTED.[ScheduleId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-11-24 03:03:03.357 +02:00 [INF] Executed DbCommand (10ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 20), @p2='?' (DbType = Int32), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = DateTime2), @p6='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Schedules] ([CreatedAt], [DayOfWeek], [DoctorId], [EndTime], [Shift], [StartTime], [UpdatedAt])
OUTPUT INSERTED.[ScheduleId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-11-24 03:03:03.369 +02:00 [DBG] The foreign key property 'Schedule.ScheduleId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 03:03:03.375 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:03.376 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 16ms reading results.
2025-11-24 03:03:03.378 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:03.379 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:03:03.389 +02:00 [DBG] An entity of type 'Schedule' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:03.392 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 03:03:03.393 +02:00 [INF] Schedule created successfully for DoctorId 1
2025-11-24 03:03:03.397 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 03:03:03.400 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 03:03:03.400 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 03:03:03.401 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 03:03:03.401 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 03:03:03.403 +02:00 [INF] Executing OkObjectResult, writing value of type 'Hospital.Application.DTO.Schedule.ScheduleDto'.
2025-11-24 03:03:03.407 +02:00 [INF] Executed action Hospital.Controllers.ScheduleController.Create (Hospital) in 277.094ms
2025-11-24 03:03:03.408 +02:00 [INF] Executed endpoint 'Hospital.Controllers.ScheduleController.Create (Hospital)'
2025-11-24 03:03:03.408 +02:00 [DBG] Connection id "0HNHAUKB7C1BF" completed keep alive response.
2025-11-24 03:03:03.409 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:03:03.410 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:03.411 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 03:03:03.412 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Schedule - 200 null application/json; charset=utf-8 295.3529ms
2025-11-24 03:03:11.597 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Doctor/all - null null
2025-11-24 03:03:11.600 +02:00 [DBG] 2 candidate(s) found for the request path '/api/Doctor/all'
2025-11-24 03:03:11.601 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.GetAll (Hospital)' with route pattern 'api/Doctor/all' is valid for the request path '/api/Doctor/all'
2025-11-24 03:03:11.602 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.GetDoctor (Hospital)' with route pattern 'api/Doctor/{doctorId}' is valid for the request path '/api/Doctor/all'
2025-11-24 03:03:11.603 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.GetAll (Hospital)'
2025-11-24 03:03:11.604 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:03:11.605 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:03:11.606 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.GetAll (Hospital)'
2025-11-24 03:03:11.607 +02:00 [INF] Route matched with {action = "GetAll", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll() on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 03:03:11.608 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:03:11.608 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:03:11.609 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:03:11.610 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:03:11.611 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:03:11.611 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:03:11.613 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:03:11.614 +02:00 [INF] get all doctor in system called at "2025-11-24T03:03:11.6143109+02:00"
2025-11-24 03:03:11.614 +02:00 [INF] Fetching all doctors in the system
2025-11-24 03:03:11.615 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:03:11.616 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:03:11.617 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 03:03:11.618 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:11.618 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:11.619 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:03:11.620 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:03:11.620 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:03:11.621 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt], [t].[BranchesBranchId], [t].[DoctorsDoctorId], [t].[BranchId], [t].[Address], [t].[BranchName], [t].[CreatedAt], [t].[Description], [t].[Email], [t].[ImageURL], [t].[Phone], [t].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM [Doctors] AS [d]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t] ON [d].[DoctorId] = [t].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [d].[DoctorId] = [s0].[DoctorId]
ORDER BY [d].[DoctorId], [u].[Id], [s].[SpecializationId], [t].[BranchesBranchId], [t].[DoctorsDoctorId], [t].[BranchId]
2025-11-24 03:03:11.638 +02:00 [INF] Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [s].[SpecializationId], [s].[CreatedAt], [s].[Description], [s].[Name], [s].[UpdatedAt], [t].[BranchesBranchId], [t].[DoctorsDoctorId], [t].[BranchId], [t].[Address], [t].[BranchName], [t].[CreatedAt], [t].[Description], [t].[Email], [t].[ImageURL], [t].[Phone], [t].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM [Doctors] AS [d]
INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t] ON [d].[DoctorId] = [t].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [d].[DoctorId] = [s0].[DoctorId]
ORDER BY [d].[DoctorId], [u].[Id], [s].[SpecializationId], [t].[BranchesBranchId], [t].[DoctorsDoctorId], [t].[BranchId]
2025-11-24 03:03:11.641 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:11.642 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:11.643 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:11.643 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:11.644 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:11.645 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:11.645 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:11.646 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:11.647 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:11.648 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 6ms reading results.
2025-11-24 03:03:11.649 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:11.650 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:03:11.653 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 03:03:11.654 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 03:03:11.654 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 03:03:11.655 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 03:03:11.655 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 03:03:11.656 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Doctor.DoctorDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 03:03:11.658 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.GetAll (Hospital) in 47.0112ms
2025-11-24 03:03:11.659 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.GetAll (Hospital)'
2025-11-24 03:03:11.659 +02:00 [DBG] Connection id "0HNHAUKB7C1BF" completed keep alive response.
2025-11-24 03:03:11.660 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:03:11.661 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:11.661 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 03:03:11.662 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Doctor/all - 200 null application/json; charset=utf-8 64.7881ms
2025-11-24 03:03:26.673 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Appointment - application/json 181
2025-11-24 03:03:26.675 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Appointment'
2025-11-24 03:03:26.676 +02:00 [DBG] Endpoint 'Hospital.API.Controllers.AppointmentController.Add (Hospital)' with route pattern 'api/Appointment' is valid for the request path '/api/Appointment'
2025-11-24 03:03:26.676 +02:00 [DBG] Request matched endpoint 'Hospital.API.Controllers.AppointmentController.Add (Hospital)'
2025-11-24 03:03:26.677 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:03:26.677 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:03:26.679 +02:00 [INF] Executing endpoint 'Hospital.API.Controllers.AppointmentController.Add (Hospital)'
2025-11-24 03:03:26.680 +02:00 [INF] Route matched with {action = "Add", controller = "Appointment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Add(Hospital.Application.DTO.Appointment.AddAppointmentDto) on controller Hospital.API.Controllers.AppointmentController (Hospital).
2025-11-24 03:03:26.681 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:03:26.681 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:03:26.682 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:03:26.683 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:03:26.684 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:03:26.684 +02:00 [DBG] Executing controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 03:03:26.686 +02:00 [DBG] Executed controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 03:03:26.686 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto' ...
2025-11-24 03:03:26.687 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto' using the name '' in request data ...
2025-11-24 03:03:26.688 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 03:03:26.689 +02:00 [DBG] Connection id "0HNHAUKB7C1BF", Request id "0HNHAUKB7C1BF:00000006": started reading request body.
2025-11-24 03:03:26.690 +02:00 [DBG] Connection id "0HNHAUKB7C1BF", Request id "0HNHAUKB7C1BF:00000006": done reading request body.
2025-11-24 03:03:26.691 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Appointment.AddAppointmentDto'
2025-11-24 03:03:26.692 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto'.
2025-11-24 03:03:26.693 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto'.
2025-11-24 03:03:26.693 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto' ...
2025-11-24 03:03:26.694 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto'.
2025-11-24 03:03:26.694 +02:00 [INF] Add Appointment called at "2025-11-24T03:03:26.6949700+02:00"
2025-11-24 03:03:26.695 +02:00 [INF] Creating appointment for PatientId: 1, DoctorId: 1, Date: "2025-11-26", Time: "2025-11-23T15:33:47.5410000Z"
2025-11-24 03:03:26.697 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:03:26.699 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:03:26.700 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 03:03:26.700 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:26.700 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:26.701 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 03:03:26.701 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 03:03:26.702 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:03:26.703 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:03:26.703 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:03:26.703 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 03:03:26.714 +02:00 [INF] Executed DbCommand (11ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 03:03:26.717 +02:00 [DBG] Context 'AppDbContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:26.718 +02:00 [DBG] The navigation 'Patient.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:26.718 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:26.719 +02:00 [DBG] Context 'AppDbContext' started tracking 'MedicalRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:26.720 +02:00 [DBG] The navigation 'MedicalRecord.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:26.720 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:26.721 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:26.722 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:26.723 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:26.724 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 6ms reading results.
2025-11-24 03:03:26.725 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:03:26.725 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:03:26.726 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:03:26.726 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:03:26.735 +02:00 [INF] Executed DbCommand (8ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:03:26.737 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:26.738 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:26.739 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:26.739 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:26.740 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:26.741 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:26.741 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 4ms reading results.
2025-11-24 03:03:26.743 +02:00 [DBG] Compiling query expression: 
'DbSet<Branch>()
    .FirstOrDefault(e => e.BranchId == __id_0)'
2025-11-24 03:03:26.747 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Branch>(
    asyncEnumerable: new SingleQueryingEnumerable<Branch>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Branch.Address (string) MaxLength(250), 1], [Property: Branch.BranchName (string) Required MaxLength(150), 2], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 3], [Property: Branch.Description (string), 4], [Property: Branch.Email (string) MaxLength(200), 5], [Property: Branch.ImageURL (string) MaxLength(300), 6], [Property: Branch.Phone (string) MaxLength(25), 7], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 8] }
            SELECT TOP(1) b.BranchId, b.Address, b.BranchName, b.CreatedAt, b.Description, b.Email, b.ImageURL, b.Phone, b.UpdatedAt
            FROM Branches AS b
            WHERE b.BranchId == @__id_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Branch>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 03:03:26.749 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:03:26.749 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:03:26.750 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:03:26.750 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 03:03:26.754 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 03:03:26.755 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:26.757 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 1ms reading results.
2025-11-24 03:03:26.758 +02:00 [WRN] Branch with ID 2 not found
2025-11-24 03:03:26.773 +02:00 [DBG] Rolling back transaction.
2025-11-24 03:03:26.774 +02:00 [DBG] Rolled back transaction.
2025-11-24 03:03:26.775 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:26.775 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:03:26.776 +02:00 [ERR] Failed to create appointment for PatientId: 1, DoctorId: 1
System.ArgumentException: Branch does not exist.
   at Hospital.Infrastructure.Services.AppointmentService.AddAsync(AddAppointmentDto dto) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\AppointmentService.cs:line 75
2025-11-24 03:03:26.791 +02:00 [DBG] Disposing transaction.
2025-11-24 03:03:26.817 +02:00 [INF] Executed action Hospital.API.Controllers.AppointmentController.Add (Hospital) in 132.7957ms
2025-11-24 03:03:26.818 +02:00 [INF] Executed endpoint 'Hospital.API.Controllers.AppointmentController.Add (Hospital)'
2025-11-24 03:03:26.849 +02:00 [ERR]  Exception caught: Branch does not exist.
System.ArgumentException: Branch does not exist.
   at Hospital.Infrastructure.Services.AppointmentService.AddAsync(AddAppointmentDto dto) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\AppointmentService.cs:line 75
   at Hospital.Infrastructure.Services.AppointmentService.AddAsync(AddAppointmentDto dto) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\AppointmentService.cs:line 128
   at Hospital.Infrastructure.Services.AppointmentService.AddAsync(AddAppointmentDto dto) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\AppointmentService.cs:line 129
   at Hospital.API.Controllers.AppointmentController.Add(AddAppointmentDto dto) in D:\Walaa\GP\Hospital\Hospital\Controllers\AppointmentController.cs:line 27
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
2025-11-24 03:03:26.857 +02:00 [DBG] Connection id "0HNHAUKB7C1BF" completed keep alive response.
2025-11-24 03:03:26.858 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:03:26.859 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:26.859 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 03:03:26.860 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Appointment - 400 null application/json 186.9958ms
2025-11-24 03:03:36.282 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Branch/Create - application/json 146
2025-11-24 03:03:36.284 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Branch/Create'
2025-11-24 03:03:36.284 +02:00 [DBG] Endpoint 'Hospital.Controllers.BranchController.Create (Hospital)' with route pattern 'api/Branch/Create' is valid for the request path '/api/Branch/Create'
2025-11-24 03:03:36.285 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.BranchController.Create (Hospital)'
2025-11-24 03:03:36.285 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:03:36.286 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:03:36.287 +02:00 [INF] Executing endpoint 'Hospital.Controllers.BranchController.Create (Hospital)'
2025-11-24 03:03:36.289 +02:00 [INF] Route matched with {action = "Create", controller = "Branch"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Create(Hospital.Application.DTO.Branch.CreateBranchDto) on controller Hospital.Controllers.BranchController (Hospital).
2025-11-24 03:03:36.290 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:03:36.291 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:03:36.292 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:03:36.293 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:03:36.293 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:03:36.294 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.BranchController (Hospital)
2025-11-24 03:03:36.295 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.BranchController (Hospital)
2025-11-24 03:03:36.295 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Branch.CreateBranchDto' ...
2025-11-24 03:03:36.296 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Branch.CreateBranchDto' using the name '' in request data ...
2025-11-24 03:03:36.296 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 03:03:36.297 +02:00 [DBG] Connection id "0HNHAUKB7C1BF", Request id "0HNHAUKB7C1BF:00000007": started reading request body.
2025-11-24 03:03:36.298 +02:00 [DBG] Connection id "0HNHAUKB7C1BF", Request id "0HNHAUKB7C1BF:00000007": done reading request body.
2025-11-24 03:03:36.300 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Branch.CreateBranchDto'
2025-11-24 03:03:36.300 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Branch.CreateBranchDto'.
2025-11-24 03:03:36.300 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Branch.CreateBranchDto'.
2025-11-24 03:03:36.301 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Branch.CreateBranchDto' ...
2025-11-24 03:03:36.304 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Branch.CreateBranchDto'.
2025-11-24 03:03:36.306 +02:00 [INF] Create Branch called at "2025-11-24T03:03:36.3063023+02:00"
2025-11-24 03:03:36.307 +02:00 [INF] Creating new branch with name: adam17
2025-11-24 03:03:36.309 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:03:36.310 +02:00 [DBG] Compiling query expression: 
'DbSet<Branch>()
    .AsNoTracking()'
2025-11-24 03:03:36.313 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Branch>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Branch.Address (string) MaxLength(250), 1], [Property: Branch.BranchName (string) Required MaxLength(150), 2], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 3], [Property: Branch.Description (string), 4], [Property: Branch.Email (string) MaxLength(200), 5], [Property: Branch.ImageURL (string) MaxLength(300), 6], [Property: Branch.Phone (string) MaxLength(25), 7], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 8] }
        SELECT b.BranchId, b.Address, b.BranchName, b.CreatedAt, b.Description, b.Email, b.ImageURL, b.Phone, b.UpdatedAt
        FROM Branches AS b), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Branch>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 03:03:36.314 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:03:36.314 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 03:03:36.315 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:36.315 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:36.316 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:03:36.316 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:03:36.316 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:03:36.317 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
2025-11-24 03:03:36.320 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
2025-11-24 03:03:36.321 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:36.322 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 0ms reading results.
2025-11-24 03:03:36.322 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:36.323 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:03:36.326 +02:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Branch.BranchId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:36.327 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:36.328 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 03:03:36.329 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 03:03:36.330 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 03:03:36.331 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 03:03:36.331 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 03:03:36.334 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:36.334 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:36.335 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:03:36.335 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:03:36.336 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:03:36.337 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (Size = 250), @p1='?' (Size = 150), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 200), @p5='?' (Size = 300), @p6='?' (Size = 25), @p7='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Branches] ([Address], [BranchName], [CreatedAt], [Description], [Email], [ImageURL], [Phone], [UpdatedAt])
OUTPUT INSERTED.[BranchId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-11-24 03:03:36.342 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Size = 250), @p1='?' (Size = 150), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 200), @p5='?' (Size = 300), @p6='?' (Size = 25), @p7='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Branches] ([Address], [BranchName], [CreatedAt], [Description], [Email], [ImageURL], [Phone], [UpdatedAt])
OUTPUT INSERTED.[BranchId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-11-24 03:03:36.343 +02:00 [DBG] The foreign key property 'Branch.BranchId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 03:03:36.345 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:36.345 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-11-24 03:03:36.346 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:36.346 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:03:36.347 +02:00 [DBG] An entity of type 'Branch' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:36.348 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 03:03:36.348 +02:00 [INF] Branch created successfully with ID: 2
2025-11-24 03:03:36.351 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 03:03:36.354 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 03:03:36.354 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 03:03:36.355 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 03:03:36.355 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 03:03:36.356 +02:00 [INF] Executing CreatedAtActionResult, writing value of type 'Hospital.Application.DTO.Branch.BranchDto'.
2025-11-24 03:03:36.367 +02:00 [DBG] Found the endpoints ["Hospital.Controllers.BranchController.GetById (Hospital)"] for address (id=[2],action=[GetById],controller=[Branch])
2025-11-24 03:03:36.373 +02:00 [DBG] Successfully processed template api/Branch/GetBy/{id} for Hospital.Controllers.BranchController.GetById (Hospital) resulting in /api/Branch/GetBy/2 and 
2025-11-24 03:03:36.375 +02:00 [DBG] Link generation succeeded for endpoints ["Hospital.Controllers.BranchController.GetById (Hospital)"] with result /api/Branch/GetBy/2
2025-11-24 03:03:36.377 +02:00 [INF] Executed action Hospital.Controllers.BranchController.Create (Hospital) in 82.6604ms
2025-11-24 03:03:36.378 +02:00 [INF] Executed endpoint 'Hospital.Controllers.BranchController.Create (Hospital)'
2025-11-24 03:03:36.379 +02:00 [DBG] Connection id "0HNHAUKB7C1BF" completed keep alive response.
2025-11-24 03:03:36.381 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:03:36.382 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:36.383 +02:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-11-24 03:03:36.385 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Branch/Create - 201 null application/json; charset=utf-8 102.3983ms
2025-11-24 03:03:45.633 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Appointment - application/json 181
2025-11-24 03:03:45.634 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Appointment'
2025-11-24 03:03:45.635 +02:00 [DBG] Endpoint 'Hospital.API.Controllers.AppointmentController.Add (Hospital)' with route pattern 'api/Appointment' is valid for the request path '/api/Appointment'
2025-11-24 03:03:45.635 +02:00 [DBG] Request matched endpoint 'Hospital.API.Controllers.AppointmentController.Add (Hospital)'
2025-11-24 03:03:45.636 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:03:45.636 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:03:45.637 +02:00 [INF] Executing endpoint 'Hospital.API.Controllers.AppointmentController.Add (Hospital)'
2025-11-24 03:03:45.639 +02:00 [INF] Route matched with {action = "Add", controller = "Appointment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Add(Hospital.Application.DTO.Appointment.AddAppointmentDto) on controller Hospital.API.Controllers.AppointmentController (Hospital).
2025-11-24 03:03:45.640 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:03:45.641 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:03:45.641 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:03:45.642 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:03:45.643 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:03:45.643 +02:00 [DBG] Executing controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 03:03:45.647 +02:00 [DBG] Executed controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 03:03:45.647 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto' ...
2025-11-24 03:03:45.648 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto' using the name '' in request data ...
2025-11-24 03:03:45.649 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 03:03:45.650 +02:00 [DBG] Connection id "0HNHAUKB7C1BF", Request id "0HNHAUKB7C1BF:00000008": started reading request body.
2025-11-24 03:03:45.651 +02:00 [DBG] Connection id "0HNHAUKB7C1BF", Request id "0HNHAUKB7C1BF:00000008": done reading request body.
2025-11-24 03:03:45.652 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Appointment.AddAppointmentDto'
2025-11-24 03:03:45.653 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto'.
2025-11-24 03:03:45.653 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto'.
2025-11-24 03:03:45.654 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto' ...
2025-11-24 03:03:45.655 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto'.
2025-11-24 03:03:45.656 +02:00 [INF] Add Appointment called at "2025-11-24T03:03:45.6560455+02:00"
2025-11-24 03:03:45.656 +02:00 [INF] Creating appointment for PatientId: 1, DoctorId: 1, Date: "2025-11-26", Time: "2025-11-23T15:33:47.5410000Z"
2025-11-24 03:03:45.657 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:03:45.663 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:03:45.664 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 03:03:45.664 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:45.665 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:45.665 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 03:03:45.666 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 03:03:45.667 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:03:45.667 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:03:45.668 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:03:45.669 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 03:03:45.673 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 03:03:45.675 +02:00 [DBG] Context 'AppDbContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:45.676 +02:00 [DBG] The navigation 'Patient.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:45.677 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:45.678 +02:00 [DBG] Context 'AppDbContext' started tracking 'MedicalRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:45.678 +02:00 [DBG] The navigation 'MedicalRecord.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:45.679 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:45.679 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:45.680 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:45.681 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:45.681 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 6ms reading results.
2025-11-24 03:03:45.682 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:03:45.683 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:03:45.684 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 03:03:45.685 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:03:45.688 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:03:45.690 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:45.691 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:45.691 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:45.692 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:45.692 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:45.693 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:45.693 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-11-24 03:03:45.694 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:03:45.694 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:03:45.695 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:03:45.695 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 03:03:45.697 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 03:03:45.698 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:45.699 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:45.700 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 1ms reading results.
2025-11-24 03:03:45.703 +02:00 [DBG] Compiling query expression: 
'DbSet<Appointment>()
    .Any(a => a.DoctorId == __doctorId_0 && a.Date == __date_1 && a.Time == __time_2)'
2025-11-24 03:03:45.707 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Appointments AS a
                WHERE ((a.DoctorId == @__doctorId_0) && (a.Date == @__date_1)) && (a.Time == @__time_2))), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 03:03:45.715 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:03:45.716 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:03:45.720 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2025-11-24 03:03:45.720 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2), @__time_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Appointments] AS [a]
        WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Time] = @__time_2) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-24 03:03:45.733 +02:00 [INF] Executed DbCommand (13ms) [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2), @__time_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Appointments] AS [a]
        WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Time] = @__time_2) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-24 03:03:45.736 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:45.737 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-11-24 03:03:45.747 +02:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Appointment.AppointmentId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:45.762 +02:00 [DBG] The navigation 'Appointment.Branch' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:45.765 +02:00 [DBG] The navigation 'Appointment.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:45.767 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:45.770 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:45.771 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 03:03:45.784 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 03:03:45.785 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 03:03:45.786 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 03:03:45.787 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 03:03:45.794 +02:00 [DBG] Creating transaction savepoint.
2025-11-24 03:03:45.803 +02:00 [DBG] Created transaction savepoint.
2025-11-24 03:03:45.804 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:03:45.805 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:03:45.808 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-11-24 03:03:45.809 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 450), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (Size = 4000), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (Size = 20), @p9='?' (DbType = DateTime2), @p10='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Appointments] ([BranchId], [CreatedAt], [CreatedBy], [Date], [DoctorId], [Notes], [PatientId], [PaymentMethod], [Status], [Time], [UpdatedAt])
OUTPUT INSERTED.[AppointmentId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2025-11-24 03:03:45.814 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 450), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (Size = 4000), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (Size = 20), @p9='?' (DbType = DateTime2), @p10='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Appointments] ([BranchId], [CreatedAt], [CreatedBy], [Date], [DoctorId], [Notes], [PatientId], [PaymentMethod], [Status], [Time], [UpdatedAt])
OUTPUT INSERTED.[AppointmentId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2025-11-24 03:03:45.816 +02:00 [DBG] The foreign key property 'Appointment.AppointmentId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 03:03:45.818 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:45.819 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 3ms reading results.
2025-11-24 03:03:45.821 +02:00 [DBG] An entity of type 'Appointment' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:45.822 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 03:03:45.825 +02:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Payment.PaymentId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:45.840 +02:00 [DBG] The navigation 'Payment.Appointment' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:45.843 +02:00 [DBG] The navigation 'Appointment.Payment' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:45.844 +02:00 [DBG] Context 'AppDbContext' started tracking 'Payment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:45.845 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 03:03:45.854 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 03:03:45.857 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 03:03:45.857 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 03:03:45.858 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 03:03:45.860 +02:00 [DBG] Creating transaction savepoint.
2025-11-24 03:03:45.861 +02:00 [DBG] Created transaction savepoint.
2025-11-24 03:03:45.862 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:03:45.863 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:03:45.865 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 03:03:45.866 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 3), @p4='?' (Size = 4000), @p5='?' (Size = 100), @p6='?' (DbType = Int64), @p7='?' (DbType = Int64), @p8='?' (Size = 20), @p9='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Payments] ([Amount], [AppointmentId], [CreatedAt], [Currency], [GatewayResponse], [PaymobMerchantOrderId], [PaymobOrderId], [PaymobTransactionId], [Status], [UpdatedAt])
OUTPUT INSERTED.[PaymentId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-24 03:03:45.872 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 3), @p4='?' (Size = 4000), @p5='?' (Size = 100), @p6='?' (DbType = Int64), @p7='?' (DbType = Int64), @p8='?' (Size = 20), @p9='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Payments] ([Amount], [AppointmentId], [CreatedAt], [Currency], [GatewayResponse], [PaymobMerchantOrderId], [PaymobOrderId], [PaymobTransactionId], [Status], [UpdatedAt])
OUTPUT INSERTED.[PaymentId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-24 03:03:45.875 +02:00 [DBG] The foreign key property 'Payment.PaymentId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 03:03:45.876 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:45.877 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-11-24 03:03:45.878 +02:00 [DBG] An entity of type 'Payment' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:45.879 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 03:03:45.881 +02:00 [DBG] Committing transaction.
2025-11-24 03:03:45.883 +02:00 [DBG] Committed transaction.
2025-11-24 03:03:45.884 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:45.885 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:03:45.886 +02:00 [INF] Appointment created successfully with ID: 3
2025-11-24 03:03:45.890 +02:00 [DBG] Disposing transaction.
2025-11-24 03:03:45.891 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 03:03:45.893 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 03:03:45.893 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 03:03:45.894 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 03:03:45.895 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 03:03:45.895 +02:00 [INF] Executing CreatedAtActionResult, writing value of type 'Hospital.Application.DTO.Appointment.AppointmentDto'.
2025-11-24 03:03:45.896 +02:00 [DBG] Found the endpoints ["Hospital.API.Controllers.AppointmentController.GetById (Hospital)"] for address (id=[3],action=[GetById],controller=[Appointment])
2025-11-24 03:03:45.898 +02:00 [DBG] Successfully processed template api/Appointment/{id:int} for Hospital.API.Controllers.AppointmentController.GetById (Hospital) resulting in /api/Appointment/3 and 
2025-11-24 03:03:45.898 +02:00 [DBG] Link generation succeeded for endpoints ["Hospital.API.Controllers.AppointmentController.GetById (Hospital)"] with result /api/Appointment/3
2025-11-24 03:03:45.904 +02:00 [INF] Executed action Hospital.API.Controllers.AppointmentController.Add (Hospital) in 260.6705ms
2025-11-24 03:03:45.905 +02:00 [INF] Executed endpoint 'Hospital.API.Controllers.AppointmentController.Add (Hospital)'
2025-11-24 03:03:45.906 +02:00 [DBG] Connection id "0HNHAUKB7C1BF" completed keep alive response.
2025-11-24 03:03:45.907 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:03:45.907 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:45.908 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 03:03:45.908 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Appointment - 201 null application/json; charset=utf-8 275.2152ms
2025-11-24 03:03:52.064 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Appointment/GetAll - null null
2025-11-24 03:03:52.068 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Appointment/GetAll'
2025-11-24 03:03:52.070 +02:00 [DBG] Endpoint 'Hospital.API.Controllers.AppointmentController.GetAll (Hospital)' with route pattern 'api/Appointment/GetAll' is valid for the request path '/api/Appointment/GetAll'
2025-11-24 03:03:52.071 +02:00 [DBG] Request matched endpoint 'Hospital.API.Controllers.AppointmentController.GetAll (Hospital)'
2025-11-24 03:03:52.071 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:03:52.072 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:03:52.072 +02:00 [INF] Executing endpoint 'Hospital.API.Controllers.AppointmentController.GetAll (Hospital)'
2025-11-24 03:03:52.074 +02:00 [INF] Route matched with {action = "GetAll", controller = "Appointment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll() on controller Hospital.API.Controllers.AppointmentController (Hospital).
2025-11-24 03:03:52.075 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:03:52.076 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:03:52.076 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:03:52.077 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:03:52.079 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:03:52.080 +02:00 [DBG] Executing controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 03:03:52.081 +02:00 [DBG] Executed controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 03:03:52.082 +02:00 [INF] Get All Appointments called at "2025-11-24T03:03:52.0825794+02:00"
2025-11-24 03:03:52.084 +02:00 [INF] Fetching all appointments
2025-11-24 03:03:52.085 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:03:52.087 +02:00 [DBG] Compiling query expression: 
'DbSet<Appointment>()
    .Include(a => a.Patient)
    .Include(a => a.Doctor)
    .Include(a => a.Branch)'
2025-11-24 03:03:52.089 +02:00 [DBG] Including navigation: 'Appointment.Patient'.
2025-11-24 03:03:52.089 +02:00 [DBG] Including navigation: 'Appointment.Doctor'.
2025-11-24 03:03:52.090 +02:00 [DBG] Including navigation: 'Appointment.Branch'.
2025-11-24 03:03:52.097 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Appointment>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Appointment.AppointmentId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Appointment.BranchId (int) Required FK Index, 1], [Property: Appointment.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 2], [Property: Appointment.CreatedBy (string) FK Index, 3], [Property: Appointment.Date (DateOnly) Required, 4], [Property: Appointment.DoctorId (int) Required FK Index, 5], [Property: Appointment.Notes (string), 6], [Property: Appointment.PatientId (int) Required FK Index, 7], [Property: Appointment.PaymentMethod (PaymentMethod) Required, 8], [Property: Appointment.Status (AppointmentStatus) Required MaxLength(20), 9], [Property: Appointment.Time (DateTime) Required, 10], [Property: Appointment.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 11] }
            1 -> Dictionary<IProperty, int> { [Property: Patient.PatientId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 12], [Property: Patient.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 13], [Property: Patient.EmergencyContact (string) MaxLength(150), 14], [Property: Patient.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 15], [Property: Patient.UserId (string) Required FK Index, 16] }
            2 -> Dictionary<IProperty, int> { [Property: Doctor.DoctorId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 17], [Property: Doctor.Available (bool?), 18], [Property: Doctor.Biography (string), 19], [Property: Doctor.ConsultationFees (decimal) Required, 20], [Property: Doctor.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 21], [Property: Doctor.ExperienceYears (int?), 22], [Property: Doctor.ImageURL (string) MaxLength(300), 23], [Property: Doctor.SpecializationId (int) Required FK Index, 24], [Property: Doctor.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 25], [Property: Doctor.UserId (string) Required FK Index, 26] }
            3 -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 27], [Property: Branch.Address (string) MaxLength(250), 28], [Property: Branch.BranchName (string) Required MaxLength(150), 29], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 30], [Property: Branch.Description (string), 31], [Property: Branch.Email (string) MaxLength(200), 32], [Property: Branch.ImageURL (string) MaxLength(300), 33], [Property: Branch.Phone (string) MaxLength(25), 34], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 35] }
        SELECT a.AppointmentId, a.BranchId, a.CreatedAt, a.CreatedBy, a.Date, a.DoctorId, a.Notes, a.PatientId, a.PaymentMethod, a.Status, a.Time, a.UpdatedAt, p.PatientId, p.CreatedAt, p.EmergencyContact, p.UpdatedAt, p.UserId, d.DoctorId, d.Available, d.Biography, d.ConsultationFees, d.CreatedAt, d.ExperienceYears, d.ImageURL, d.SpecializationId, d.UpdatedAt, d.UserId, b.BranchId, b.Address, b.BranchName, b.CreatedAt, b.Description, b.Email, b.ImageURL, b.Phone, b.UpdatedAt
        FROM Appointments AS a
        INNER JOIN Patients AS p ON a.PatientId == p.PatientId
        INNER JOIN Doctors AS d ON a.DoctorId == d.DoctorId
        INNER JOIN Branches AS b ON a.BranchId == b.BranchId), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Appointment>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 03:03:52.101 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:03:52.101 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 03:03:52.101 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:52.102 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:52.103 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:03:52.103 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:03:52.104 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:03:52.105 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Doctors] AS [d] ON [a].[DoctorId] = [d].[DoctorId]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
2025-11-24 03:03:52.111 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Doctors] AS [d] ON [a].[DoctorId] = [d].[DoctorId]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
2025-11-24 03:03:52.114 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:52.115 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:52.116 +02:00 [DBG] Context 'AppDbContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:52.118 +02:00 [DBG] The navigation 'Appointment.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:52.119 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:52.120 +02:00 [DBG] The navigation 'Appointment.Branch' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:52.120 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:52.121 +02:00 [DBG] The navigation 'Appointment.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:52.123 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:52.124 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:52.125 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:52.125 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:52.126 +02:00 [DBG] The navigation 'Appointment.Branch' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:52.126 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:03:52.127 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:52.128 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 15ms reading results.
2025-11-24 03:03:52.130 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:52.130 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:03:52.133 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 03:03:52.134 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 03:03:52.135 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 03:03:52.136 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 03:03:52.137 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 03:03:52.137 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Appointment.AppointmentDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 03:03:52.138 +02:00 [INF] Executed action Hospital.API.Controllers.AppointmentController.GetAll (Hospital) in 58.5141ms
2025-11-24 03:03:52.140 +02:00 [INF] Executed endpoint 'Hospital.API.Controllers.AppointmentController.GetAll (Hospital)'
2025-11-24 03:03:52.140 +02:00 [DBG] Connection id "0HNHAUKB7C1BF" completed keep alive response.
2025-11-24 03:03:52.142 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:03:52.142 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:03:52.143 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 03:03:52.145 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Appointment/GetAll - 200 null application/json; charset=utf-8 80.2405ms
2025-11-24 03:04:18.194 +02:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7217/api/Appointment/MarkAsCompleted/2 - null 0
2025-11-24 03:04:18.196 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Appointment/MarkAsCompleted/2'
2025-11-24 03:04:18.197 +02:00 [DBG] Endpoint 'Hospital.API.Controllers.AppointmentController.MarkAsCompleted (Hospital)' with route pattern 'api/Appointment/MarkAsCompleted/{id:int}' is valid for the request path '/api/Appointment/MarkAsCompleted/2'
2025-11-24 03:04:18.198 +02:00 [DBG] Request matched endpoint 'Hospital.API.Controllers.AppointmentController.MarkAsCompleted (Hospital)'
2025-11-24 03:04:18.199 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:04:18.199 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:04:18.199 +02:00 [INF] Executing endpoint 'Hospital.API.Controllers.AppointmentController.MarkAsCompleted (Hospital)'
2025-11-24 03:04:18.203 +02:00 [INF] Route matched with {action = "MarkAsCompleted", controller = "Appointment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MarkAsCompleted(Int32) on controller Hospital.API.Controllers.AppointmentController (Hospital).
2025-11-24 03:04:18.204 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:04:18.205 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:04:18.206 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:04:18.207 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:04:18.208 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:04:18.209 +02:00 [DBG] Executing controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 03:04:18.210 +02:00 [DBG] Executed controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 03:04:18.211 +02:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-11-24 03:04:18.212 +02:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-11-24 03:04:18.214 +02:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-11-24 03:04:18.215 +02:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-11-24 03:04:18.216 +02:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-11-24 03:04:18.217 +02:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-11-24 03:04:18.218 +02:00 [INF] Mark Appointment as Completed called at "2025-11-24T03:04:18.2181197+02:00"
2025-11-24 03:04:18.220 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:04:18.221 +02:00 [DBG] Compiling query expression: 
'DbSet<Appointment>()
    .Include(a => a.Patient)
    .Include(a => a.Doctor)
    .Include(a => a.Branch)
    .FirstOrDefault(a => a.AppointmentId == __id_0)'
2025-11-24 03:04:18.222 +02:00 [DBG] Including navigation: 'Appointment.Patient'.
2025-11-24 03:04:18.223 +02:00 [DBG] Including navigation: 'Appointment.Doctor'.
2025-11-24 03:04:18.223 +02:00 [DBG] Including navigation: 'Appointment.Branch'.
2025-11-24 03:04:18.229 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Appointment>(
    asyncEnumerable: new SingleQueryingEnumerable<Appointment>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Appointment.AppointmentId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Appointment.BranchId (int) Required FK Index, 1], [Property: Appointment.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 2], [Property: Appointment.CreatedBy (string) FK Index, 3], [Property: Appointment.Date (DateOnly) Required, 4], [Property: Appointment.DoctorId (int) Required FK Index, 5], [Property: Appointment.Notes (string), 6], [Property: Appointment.PatientId (int) Required FK Index, 7], [Property: Appointment.PaymentMethod (PaymentMethod) Required, 8], [Property: Appointment.Status (AppointmentStatus) Required MaxLength(20), 9], [Property: Appointment.Time (DateTime) Required, 10], [Property: Appointment.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 11] }
                1 -> Dictionary<IProperty, int> { [Property: Patient.PatientId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 12], [Property: Patient.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 13], [Property: Patient.EmergencyContact (string) MaxLength(150), 14], [Property: Patient.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 15], [Property: Patient.UserId (string) Required FK Index, 16] }
                2 -> Dictionary<IProperty, int> { [Property: Doctor.DoctorId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 17], [Property: Doctor.Available (bool?), 18], [Property: Doctor.Biography (string), 19], [Property: Doctor.ConsultationFees (decimal) Required, 20], [Property: Doctor.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 21], [Property: Doctor.ExperienceYears (int?), 22], [Property: Doctor.ImageURL (string) MaxLength(300), 23], [Property: Doctor.SpecializationId (int) Required FK Index, 24], [Property: Doctor.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 25], [Property: Doctor.UserId (string) Required FK Index, 26] }
                3 -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 27], [Property: Branch.Address (string) MaxLength(250), 28], [Property: Branch.BranchName (string) Required MaxLength(150), 29], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 30], [Property: Branch.Description (string), 31], [Property: Branch.Email (string) MaxLength(200), 32], [Property: Branch.ImageURL (string) MaxLength(300), 33], [Property: Branch.Phone (string) MaxLength(25), 34], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 35] }
            SELECT TOP(1) a.AppointmentId, a.BranchId, a.CreatedAt, a.CreatedBy, a.Date, a.DoctorId, a.Notes, a.PatientId, a.PaymentMethod, a.Status, a.Time, a.UpdatedAt, p.PatientId, p.CreatedAt, p.EmergencyContact, p.UpdatedAt, p.UserId, d.DoctorId, d.Available, d.Biography, d.ConsultationFees, d.CreatedAt, d.ExperienceYears, d.ImageURL, d.SpecializationId, d.UpdatedAt, d.UserId, b.BranchId, b.Address, b.BranchName, b.CreatedAt, b.Description, b.Email, b.ImageURL, b.Phone, b.UpdatedAt
            FROM Appointments AS a
            INNER JOIN Patients AS p ON a.PatientId == p.PatientId
            INNER JOIN Doctors AS d ON a.DoctorId == d.DoctorId
            INNER JOIN Branches AS b ON a.BranchId == b.BranchId
            WHERE a.AppointmentId == @__id_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Appointment>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 03:04:18.231 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:04:18.231 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 03:04:18.232 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:04:18.234 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:04:18.234 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:04:18.235 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:04:18.236 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:04:18.238 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Doctors] AS [d] ON [a].[DoctorId] = [d].[DoctorId]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[AppointmentId] = @__id_0
2025-11-24 03:04:18.246 +02:00 [INF] Executed DbCommand (8ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Doctors] AS [d] ON [a].[DoctorId] = [d].[DoctorId]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[AppointmentId] = @__id_0
2025-11-24 03:04:18.247 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:04:18.248 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:04:18.249 +02:00 [DBG] Context 'AppDbContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:04:18.250 +02:00 [DBG] The navigation 'Appointment.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:04:18.250 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:04:18.251 +02:00 [DBG] The navigation 'Appointment.Branch' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:04:18.251 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:04:18.252 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:04:18.253 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 5ms reading results.
2025-11-24 03:04:18.253 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:04:18.254 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:04:18.255 +02:00 [DBG] An entity of type 'Appointment' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:04:18.256 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 03:04:18.256 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 03:04:18.257 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 03:04:18.258 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 03:04:18.258 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 03:04:18.263 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:04:18.264 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:04:18.264 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:04:18.265 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:04:18.266 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:04:18.266 +02:00 [DBG] Executing DbCommand [Parameters=[@p11='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 450), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (Size = 4000), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (Size = 20), @p9='?' (DbType = DateTime2), @p10='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Appointments] SET [BranchId] = @p0, [CreatedAt] = @p1, [CreatedBy] = @p2, [Date] = @p3, [DoctorId] = @p4, [Notes] = @p5, [PatientId] = @p6, [PaymentMethod] = @p7, [Status] = @p8, [Time] = @p9, [UpdatedAt] = @p10
OUTPUT 1
WHERE [AppointmentId] = @p11;
2025-11-24 03:04:18.278 +02:00 [INF] Executed DbCommand (12ms) [Parameters=[@p11='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 450), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (Size = 4000), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (Size = 20), @p9='?' (DbType = DateTime2), @p10='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Appointments] SET [BranchId] = @p0, [CreatedAt] = @p1, [CreatedBy] = @p2, [Date] = @p3, [DoctorId] = @p4, [Notes] = @p5, [PatientId] = @p6, [PaymentMethod] = @p7, [Status] = @p8, [Time] = @p9, [UpdatedAt] = @p10
OUTPUT 1
WHERE [AppointmentId] = @p11;
2025-11-24 03:04:18.281 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:04:18.281 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 1ms reading results.
2025-11-24 03:04:18.282 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:04:18.283 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:04:18.284 +02:00 [DBG] An entity of type 'Appointment' tracked by 'AppDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:04:18.284 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 03:04:18.285 +02:00 [INF] Appointment with ID 2 marked as completed
2025-11-24 03:04:18.286 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 03:04:18.287 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 03:04:18.288 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 03:04:18.289 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 03:04:18.290 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter' and content type 'text/plain' to write the response.
2025-11-24 03:04:18.290 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.String'.
2025-11-24 03:04:18.291 +02:00 [INF] Executed action Hospital.API.Controllers.AppointmentController.MarkAsCompleted (Hospital) in 82.0173ms
2025-11-24 03:04:18.292 +02:00 [INF] Executed endpoint 'Hospital.API.Controllers.AppointmentController.MarkAsCompleted (Hospital)'
2025-11-24 03:04:18.293 +02:00 [DBG] Connection id "0HNHAUKB7C1BF" completed keep alive response.
2025-11-24 03:04:18.293 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:04:18.294 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:04:18.295 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 03:04:18.296 +02:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7217/api/Appointment/MarkAsCompleted/2 - 200 null text/plain; charset=utf-8 101.7923ms
2025-11-24 03:04:27.792 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Appointment/GetAll - null null
2025-11-24 03:04:27.800 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Appointment/GetAll'
2025-11-24 03:04:27.801 +02:00 [DBG] Endpoint 'Hospital.API.Controllers.AppointmentController.GetAll (Hospital)' with route pattern 'api/Appointment/GetAll' is valid for the request path '/api/Appointment/GetAll'
2025-11-24 03:04:27.802 +02:00 [DBG] Request matched endpoint 'Hospital.API.Controllers.AppointmentController.GetAll (Hospital)'
2025-11-24 03:04:27.803 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:04:27.804 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:04:27.804 +02:00 [INF] Executing endpoint 'Hospital.API.Controllers.AppointmentController.GetAll (Hospital)'
2025-11-24 03:04:27.805 +02:00 [INF] Route matched with {action = "GetAll", controller = "Appointment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll() on controller Hospital.API.Controllers.AppointmentController (Hospital).
2025-11-24 03:04:27.806 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:04:27.806 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:04:27.807 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:04:27.808 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:04:27.809 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:04:27.810 +02:00 [DBG] Executing controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 03:04:27.811 +02:00 [DBG] Executed controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 03:04:27.811 +02:00 [INF] Get All Appointments called at "2025-11-24T03:04:27.8119231+02:00"
2025-11-24 03:04:27.812 +02:00 [INF] Fetching all appointments
2025-11-24 03:04:27.812 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:04:27.813 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:04:27.814 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 03:04:27.816 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:04:27.816 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:04:27.817 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:04:27.817 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:04:27.818 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:04:27.818 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Doctors] AS [d] ON [a].[DoctorId] = [d].[DoctorId]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
2025-11-24 03:04:27.825 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Doctors] AS [d] ON [a].[DoctorId] = [d].[DoctorId]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
2025-11-24 03:04:27.827 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:04:27.827 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:04:27.828 +02:00 [DBG] Context 'AppDbContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:04:27.828 +02:00 [DBG] The navigation 'Appointment.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:04:27.829 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:04:27.831 +02:00 [DBG] The navigation 'Appointment.Branch' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:04:27.832 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:04:27.833 +02:00 [DBG] The navigation 'Appointment.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:04:27.833 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:04:27.834 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:04:27.834 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:04:27.835 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:04:27.836 +02:00 [DBG] The navigation 'Appointment.Branch' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:04:27.837 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:04:27.837 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:04:27.839 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 12ms reading results.
2025-11-24 03:04:27.839 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:04:27.840 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:04:27.841 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 03:04:27.842 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 03:04:27.842 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 03:04:27.842 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 03:04:27.843 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 03:04:27.843 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Appointment.AppointmentDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 03:04:27.844 +02:00 [INF] Executed action Hospital.API.Controllers.AppointmentController.GetAll (Hospital) in 33.8166ms
2025-11-24 03:04:27.845 +02:00 [INF] Executed endpoint 'Hospital.API.Controllers.AppointmentController.GetAll (Hospital)'
2025-11-24 03:04:27.846 +02:00 [DBG] Connection id "0HNHAUKB7C1BF" completed keep alive response.
2025-11-24 03:04:27.847 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:04:27.847 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:04:27.848 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 03:04:27.849 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Appointment/GetAll - 200 null application/json; charset=utf-8 56.6267ms
2025-11-24 03:04:40.956 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Doctor/doctor/2/today - null null
2025-11-24 03:04:40.957 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/doctor/2/today'
2025-11-24 03:04:40.958 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital)' with route pattern 'api/Doctor/doctor/{doctorId:int}/today' is valid for the request path '/api/Doctor/doctor/2/today'
2025-11-24 03:04:40.958 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital)'
2025-11-24 03:04:40.959 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:04:40.960 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:04:40.960 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital)'
2025-11-24 03:04:40.963 +02:00 [INF] Route matched with {action = "GetTodayAppointmentsForDoctor", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetTodayAppointmentsForDoctor(Int32) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 03:04:40.964 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:04:40.965 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:04:40.966 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:04:40.967 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:04:40.967 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:04:40.969 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:04:40.977 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:04:40.979 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:04:40.980 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' using the name 'doctorId' in request data ...
2025-11-24 03:04:40.981 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:04:40.982 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:04:40.982 +02:00 [DBG] Attempting to validate the bound parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:04:40.983 +02:00 [DBG] Done attempting to validate the bound parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:04:40.984 +02:00 [INF] GetTodayAppointmentsForDoctor  called at "2025-11-24T03:04:40.9848477+02:00"
2025-11-24 03:04:40.986 +02:00 [INF] Fetching today's appointments for doctor ID 2
2025-11-24 03:04:40.987 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:04:40.988 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:04:40.988 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 03:04:40.989 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:04:40.990 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:04:40.991 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:04:40.991 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:04:40.992 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:04:40.992 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:04:41.003 +02:00 [INF] Executed DbCommand (10ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:04:41.006 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:04:41.007 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 0ms reading results.
2025-11-24 03:04:41.009 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:04:41.010 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (1ms).
2025-11-24 03:04:41.011 +02:00 [WRN] Doctor with ID 2 does not exist
2025-11-24 03:04:41.050 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital) in 80.7411ms
2025-11-24 03:04:41.051 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital)'
2025-11-24 03:04:41.082 +02:00 [ERR]  Exception caught: Doctor with ID 2 does not exist.
System.Collections.Generic.KeyNotFoundException: Doctor with ID 2 does not exist.
   at Hospital.Infrastructure.Services.DoctorService.GetTodayForDoctorAsync(Int32 doctorId) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\DoctorService.cs:line 299
   at Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor(Int32 doctorId) in D:\Walaa\GP\Hospital\Hospital\Controllers\DoctorController.cs:line 226
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
2025-11-24 03:04:41.090 +02:00 [DBG] Connection id "0HNHAUKB7C1BF" completed keep alive response.
2025-11-24 03:04:41.091 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:04:41.092 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:04:41.092 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 03:04:41.093 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Doctor/doctor/2/today - 404 null application/json 137.2572ms
2025-11-24 03:04:46.155 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Doctor/doctor/1/today - null null
2025-11-24 03:04:46.158 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/doctor/1/today'
2025-11-24 03:04:46.158 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital)' with route pattern 'api/Doctor/doctor/{doctorId:int}/today' is valid for the request path '/api/Doctor/doctor/1/today'
2025-11-24 03:04:46.160 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital)'
2025-11-24 03:04:46.160 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:04:46.161 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:04:46.161 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital)'
2025-11-24 03:04:46.161 +02:00 [INF] Route matched with {action = "GetTodayAppointmentsForDoctor", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetTodayAppointmentsForDoctor(Int32) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 03:04:46.162 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:04:46.162 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:04:46.163 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:04:46.165 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:04:46.165 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:04:46.167 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:04:46.168 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:04:46.170 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:04:46.170 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' using the name 'doctorId' in request data ...
2025-11-24 03:04:46.171 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:04:46.171 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:04:46.172 +02:00 [DBG] Attempting to validate the bound parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:04:46.172 +02:00 [DBG] Done attempting to validate the bound parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:04:46.174 +02:00 [INF] GetTodayAppointmentsForDoctor  called at "2025-11-24T03:04:46.1741124+02:00"
2025-11-24 03:04:46.174 +02:00 [INF] Fetching today's appointments for doctor ID 1
2025-11-24 03:04:46.175 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:04:46.176 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:04:46.177 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 03:04:46.177 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:04:46.178 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:04:46.179 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:04:46.180 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:04:46.180 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:04:46.182 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:04:46.185 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:04:46.187 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:04:46.188 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:04:46.189 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:04:46.189 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:04:46.190 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:04:46.191 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:04:46.192 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:04:46.192 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:04:46.193 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:04:46.193 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 6ms reading results.
2025-11-24 03:04:46.194 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:04:46.194 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:04:46.196 +02:00 [DBG] Compiling query expression: 
'DbSet<Appointment>()
    .Include(a => a.Patient)
    .ThenInclude(p => p.User)
    .Include(a => a.Branch)
    .Where(a => a.DoctorId == __doctorId_0 && a.Date == __date_1 && (int)a.Status == 2)'
2025-11-24 03:04:46.197 +02:00 [DBG] Including navigation: 'Appointment.Patient'.
2025-11-24 03:04:46.198 +02:00 [DBG] Including navigation: 'Patient.User'.
2025-11-24 03:04:46.199 +02:00 [DBG] Including navigation: 'Appointment.Branch'.
2025-11-24 03:04:46.209 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Appointment>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Appointment.AppointmentId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Appointment.BranchId (int) Required FK Index, 1], [Property: Appointment.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 2], [Property: Appointment.CreatedBy (string) FK Index, 3], [Property: Appointment.Date (DateOnly) Required, 4], [Property: Appointment.DoctorId (int) Required FK Index, 5], [Property: Appointment.Notes (string), 6], [Property: Appointment.PatientId (int) Required FK Index, 7], [Property: Appointment.PaymentMethod (PaymentMethod) Required, 8], [Property: Appointment.Status (AppointmentStatus) Required MaxLength(20), 9], [Property: Appointment.Time (DateTime) Required, 10], [Property: Appointment.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 11] }
            1 -> Dictionary<IProperty, int> { [Property: Patient.PatientId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 12], [Property: Patient.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 13], [Property: Patient.EmergencyContact (string) MaxLength(150), 14], [Property: Patient.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 15], [Property: Patient.UserId (string) Required FK Index, 16] }
            2 -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 17], [Property: User.AccessFailedCount (int) Required, 18], [Property: User.ConcurrencyStamp (string) Concurrency, 19], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 20], [Property: User.DateOfBirth (DateOnly?), 21], [Property: User.Email (string) Index MaxLength(256), 22], [Property: User.EmailConfirmed (bool) Required, 23], [Property: User.FullName (string) Required MaxLength(150), 24], [Property: User.Gender (GenderType?) MaxLength(10), 25], [Property: User.LockoutEnabled (bool) Required, 26], [Property: User.LockoutEnd (DateTimeOffset?), 27], [Property: User.NormalizedEmail (string) Index MaxLength(256), 28], [Property: User.NormalizedUserName (string) Index MaxLength(256), 29], [Property: User.PasswordHash (string), 30], [Property: User.PhoneNumber (string), 31], [Property: User.PhoneNumberConfirmed (bool) Required, 32], [Property: User.RefreshToken (string), 33], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 34], [Property: User.Role (string) Required MaxLength(50), 35], [Property: User.SecurityStamp (string), 36], [Property: User.TwoFactorEnabled (bool) Required, 37], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 38], [Property: User.UserName (string) MaxLength(256), 39] }
            3 -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 40], [Property: Branch.Address (string) MaxLength(250), 41], [Property: Branch.BranchName (string) Required MaxLength(150), 42], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 43], [Property: Branch.Description (string), 44], [Property: Branch.Email (string) MaxLength(200), 45], [Property: Branch.ImageURL (string) MaxLength(300), 46], [Property: Branch.Phone (string) MaxLength(25), 47], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 48] }
        SELECT a.AppointmentId, a.BranchId, a.CreatedAt, a.CreatedBy, a.Date, a.DoctorId, a.Notes, a.PatientId, a.PaymentMethod, a.Status, a.Time, a.UpdatedAt, p.PatientId, p.CreatedAt, p.EmergencyContact, p.UpdatedAt, p.UserId, u.Id, u.AccessFailedCount, u.ConcurrencyStamp, u.CreatedAt, u.DateOfBirth, u.Email, u.EmailConfirmed, u.FullName, u.Gender, u.LockoutEnabled, u.LockoutEnd, u.NormalizedEmail, u.NormalizedUserName, u.PasswordHash, u.PhoneNumber, u.PhoneNumberConfirmed, u.RefreshToken, u.RefreshTokenExpiryTime, u.Role, u.SecurityStamp, u.TwoFactorEnabled, u.UpdatedAt, u.UserName, b.BranchId, b.Address, b.BranchName, b.CreatedAt, b.Description, b.Email, b.ImageURL, b.Phone, b.UpdatedAt
        FROM Appointments AS a
        INNER JOIN Patients AS p ON a.PatientId == p.PatientId
        INNER JOIN Users AS u ON p.UserId == u.Id
        INNER JOIN Branches AS b ON a.BranchId == b.BranchId
        WHERE ((a.DoctorId == @__doctorId_0) && (a.Date == @__date_1)) && (a.Status == N'Confirmed')), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Appointment>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 03:04:46.214 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:04:46.215 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:04:46.215 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:04:46.216 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:04:46.216 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:04:46.217 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Status] = N'Confirmed'
2025-11-24 03:04:46.228 +02:00 [INF] Executed DbCommand (11ms) [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Status] = N'Confirmed'
2025-11-24 03:04:46.232 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:04:46.233 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 1ms reading results.
2025-11-24 03:04:46.235 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:04:46.236 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:04:46.237 +02:00 [INF] No appointments found for doctor ID 1 today
2025-11-24 03:04:46.237 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 03:04:46.238 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 03:04:46.239 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 03:04:46.239 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 03:04:46.240 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 03:04:46.240 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Appointment.AppoinmentandPaientDetaliesDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 03:04:46.243 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital) in 76.2587ms
2025-11-24 03:04:46.244 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital)'
2025-11-24 03:04:46.245 +02:00 [DBG] Connection id "0HNHAUKB7C1BF" completed keep alive response.
2025-11-24 03:04:46.246 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:04:46.246 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:04:46.248 +02:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-11-24 03:04:46.248 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Doctor/doctor/1/today - 200 null application/json; charset=utf-8 93.9644ms
2025-11-24 03:04:48.616 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Doctor/doctor/1/today - null null
2025-11-24 03:04:48.618 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/doctor/1/today'
2025-11-24 03:04:48.619 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital)' with route pattern 'api/Doctor/doctor/{doctorId:int}/today' is valid for the request path '/api/Doctor/doctor/1/today'
2025-11-24 03:04:48.620 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital)'
2025-11-24 03:04:48.620 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:04:48.621 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:04:48.621 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital)'
2025-11-24 03:04:48.621 +02:00 [INF] Route matched with {action = "GetTodayAppointmentsForDoctor", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetTodayAppointmentsForDoctor(Int32) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 03:04:48.622 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:04:48.623 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:04:48.623 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:04:48.624 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:04:48.625 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:04:48.627 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:04:48.628 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:04:48.629 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:04:48.629 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' using the name 'doctorId' in request data ...
2025-11-24 03:04:48.630 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:04:48.631 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:04:48.632 +02:00 [DBG] Attempting to validate the bound parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:04:48.633 +02:00 [DBG] Done attempting to validate the bound parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:04:48.633 +02:00 [INF] GetTodayAppointmentsForDoctor  called at "2025-11-24T03:04:48.6337977+02:00"
2025-11-24 03:04:48.634 +02:00 [INF] Fetching today's appointments for doctor ID 1
2025-11-24 03:04:48.635 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:04:48.636 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:04:48.636 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 03:04:48.636 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:04:48.637 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:04:48.638 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:04:48.638 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:04:48.639 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:04:48.640 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:04:48.642 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:04:48.645 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:04:48.646 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:04:48.646 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:04:48.647 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:04:48.648 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:04:48.649 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:04:48.649 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:04:48.650 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:04:48.651 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:04:48.651 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 6ms reading results.
2025-11-24 03:04:48.652 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:04:48.652 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:04:48.653 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:04:48.654 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:04:48.655 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:04:48.655 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:04:48.656 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:04:48.657 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Status] = N'Confirmed'
2025-11-24 03:04:48.659 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Status] = N'Confirmed'
2025-11-24 03:04:48.662 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:04:48.663 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 1ms reading results.
2025-11-24 03:04:48.664 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:04:48.665 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:04:48.666 +02:00 [INF] No appointments found for doctor ID 1 today
2025-11-24 03:04:48.666 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 03:04:48.667 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 03:04:48.668 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 03:04:48.668 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 03:04:48.668 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 03:04:48.669 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Appointment.AppoinmentandPaientDetaliesDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 03:04:48.670 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital) in 42.7753ms
2025-11-24 03:04:48.671 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital)'
2025-11-24 03:04:48.672 +02:00 [DBG] Connection id "0HNHAUKB7C1BF" completed keep alive response.
2025-11-24 03:04:48.672 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:04:48.673 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:04:48.674 +02:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-11-24 03:04:48.675 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Doctor/doctor/1/today - 200 null application/json; charset=utf-8 58.709ms
2025-11-24 03:04:54.840 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Doctor/doctor/1/todayy - null null
2025-11-24 03:04:54.841 +02:00 [DBG] No candidates found for the request path '/api/Doctor/doctor/1/todayy'
2025-11-24 03:04:54.842 +02:00 [DBG] Request did not match any endpoints
2025-11-24 03:04:54.844 +02:00 [DBG] The request path  does not match the path filter
2025-11-24 03:04:54.844 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:04:54.845 +02:00 [DBG] Connection id "0HNHAUKB7C1BF" completed keep alive response.
2025-11-24 03:04:54.845 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Doctor/doctor/1/todayy - 404 0 null 5.7456ms
2025-11-24 03:04:54.848 +02:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7217/api/Doctor/doctor/1/todayy, Response status code: 404
2025-11-24 03:05:16.262 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Appointment - application/json 181
2025-11-24 03:05:16.264 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Appointment'
2025-11-24 03:05:16.266 +02:00 [DBG] Endpoint 'Hospital.API.Controllers.AppointmentController.Add (Hospital)' with route pattern 'api/Appointment' is valid for the request path '/api/Appointment'
2025-11-24 03:05:16.268 +02:00 [DBG] Request matched endpoint 'Hospital.API.Controllers.AppointmentController.Add (Hospital)'
2025-11-24 03:05:16.269 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:05:16.270 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:05:16.271 +02:00 [INF] Executing endpoint 'Hospital.API.Controllers.AppointmentController.Add (Hospital)'
2025-11-24 03:05:16.271 +02:00 [INF] Route matched with {action = "Add", controller = "Appointment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Add(Hospital.Application.DTO.Appointment.AddAppointmentDto) on controller Hospital.API.Controllers.AppointmentController (Hospital).
2025-11-24 03:05:16.272 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:05:16.273 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:05:16.273 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:05:16.274 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:05:16.275 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:05:16.275 +02:00 [DBG] Executing controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 03:05:16.276 +02:00 [DBG] Executed controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 03:05:16.277 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto' ...
2025-11-24 03:05:16.278 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto' using the name '' in request data ...
2025-11-24 03:05:16.279 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 03:05:16.280 +02:00 [DBG] Connection id "0HNHAUKB7C1BF", Request id "0HNHAUKB7C1BF:00000010": started reading request body.
2025-11-24 03:05:16.281 +02:00 [DBG] Connection id "0HNHAUKB7C1BF", Request id "0HNHAUKB7C1BF:00000010": done reading request body.
2025-11-24 03:05:16.282 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Appointment.AddAppointmentDto'
2025-11-24 03:05:16.282 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto'.
2025-11-24 03:05:16.283 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto'.
2025-11-24 03:05:16.284 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto' ...
2025-11-24 03:05:16.285 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto'.
2025-11-24 03:05:16.286 +02:00 [INF] Add Appointment called at "2025-11-24T03:05:16.2863298+02:00"
2025-11-24 03:05:16.286 +02:00 [INF] Creating appointment for PatientId: 1, DoctorId: 1, Date: "2025-11-24", Time: "2025-11-23T15:33:47.5410000Z"
2025-11-24 03:05:16.288 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:05:16.289 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:05:16.290 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 03:05:16.291 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:05:16.291 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:05:16.292 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 03:05:16.293 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 03:05:16.293 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:05:16.294 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:05:16.295 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:05:16.295 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 03:05:16.309 +02:00 [INF] Executed DbCommand (14ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 03:05:16.314 +02:00 [DBG] Context 'AppDbContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:16.315 +02:00 [DBG] The navigation 'Patient.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:16.316 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:16.317 +02:00 [DBG] Context 'AppDbContext' started tracking 'MedicalRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:16.318 +02:00 [DBG] The navigation 'MedicalRecord.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:16.319 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:16.319 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:16.320 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:16.321 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:05:16.323 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 9ms reading results.
2025-11-24 03:05:16.325 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:05:16.325 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:05:16.326 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:05:16.327 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:05:16.352 +02:00 [INF] Executed DbCommand (25ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:05:16.357 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:16.358 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:16.359 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:16.361 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:16.362 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:16.363 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:05:16.366 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 9ms reading results.
2025-11-24 03:05:16.367 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:05:16.368 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:05:16.369 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:05:16.371 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 03:05:16.374 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 03:05:16.376 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:16.377 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:05:16.379 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 2ms reading results.
2025-11-24 03:05:16.381 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:05:16.382 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:05:16.383 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:05:16.384 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2), @__time_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Appointments] AS [a]
        WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Time] = @__time_2) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-24 03:05:16.390 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2), @__time_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Appointments] AS [a]
        WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Time] = @__time_2) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-24 03:05:16.392 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:05:16.393 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 0ms reading results.
2025-11-24 03:05:16.395 +02:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Appointment.AppointmentId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:16.397 +02:00 [DBG] The navigation 'Appointment.Branch' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:16.399 +02:00 [DBG] The navigation 'Appointment.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:16.399 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:16.400 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:16.401 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 03:05:16.403 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 03:05:16.403 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 03:05:16.404 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 03:05:16.405 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 03:05:16.406 +02:00 [DBG] Creating transaction savepoint.
2025-11-24 03:05:16.408 +02:00 [DBG] Created transaction savepoint.
2025-11-24 03:05:16.415 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:05:16.416 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:05:16.417 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 03:05:16.418 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 450), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (Size = 4000), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (Size = 20), @p9='?' (DbType = DateTime2), @p10='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Appointments] ([BranchId], [CreatedAt], [CreatedBy], [Date], [DoctorId], [Notes], [PatientId], [PaymentMethod], [Status], [Time], [UpdatedAt])
OUTPUT INSERTED.[AppointmentId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2025-11-24 03:05:16.425 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 450), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (Size = 4000), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (Size = 20), @p9='?' (DbType = DateTime2), @p10='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Appointments] ([BranchId], [CreatedAt], [CreatedBy], [Date], [DoctorId], [Notes], [PatientId], [PaymentMethod], [Status], [Time], [UpdatedAt])
OUTPUT INSERTED.[AppointmentId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2025-11-24 03:05:16.427 +02:00 [DBG] The foreign key property 'Appointment.AppointmentId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 03:05:16.428 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:05:16.429 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 1ms reading results.
2025-11-24 03:05:16.431 +02:00 [DBG] An entity of type 'Appointment' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:16.432 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 03:05:16.433 +02:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Payment.PaymentId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:16.434 +02:00 [DBG] The navigation 'Payment.Appointment' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:16.435 +02:00 [DBG] The navigation 'Appointment.Payment' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:16.437 +02:00 [DBG] Context 'AppDbContext' started tracking 'Payment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:16.438 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 03:05:16.439 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 03:05:16.440 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 03:05:16.441 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 03:05:16.442 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 03:05:16.443 +02:00 [DBG] Creating transaction savepoint.
2025-11-24 03:05:16.444 +02:00 [DBG] Created transaction savepoint.
2025-11-24 03:05:16.445 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:05:16.446 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:05:16.448 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-11-24 03:05:16.449 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 3), @p4='?' (Size = 4000), @p5='?' (Size = 100), @p6='?' (DbType = Int64), @p7='?' (DbType = Int64), @p8='?' (Size = 20), @p9='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Payments] ([Amount], [AppointmentId], [CreatedAt], [Currency], [GatewayResponse], [PaymobMerchantOrderId], [PaymobOrderId], [PaymobTransactionId], [Status], [UpdatedAt])
OUTPUT INSERTED.[PaymentId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-24 03:05:16.455 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 3), @p4='?' (Size = 4000), @p5='?' (Size = 100), @p6='?' (DbType = Int64), @p7='?' (DbType = Int64), @p8='?' (Size = 20), @p9='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Payments] ([Amount], [AppointmentId], [CreatedAt], [Currency], [GatewayResponse], [PaymobMerchantOrderId], [PaymobOrderId], [PaymobTransactionId], [Status], [UpdatedAt])
OUTPUT INSERTED.[PaymentId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-24 03:05:16.457 +02:00 [DBG] The foreign key property 'Payment.PaymentId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 03:05:16.458 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:05:16.459 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 1ms reading results.
2025-11-24 03:05:16.460 +02:00 [DBG] An entity of type 'Payment' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:16.461 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 03:05:16.461 +02:00 [DBG] Committing transaction.
2025-11-24 03:05:16.462 +02:00 [DBG] Committed transaction.
2025-11-24 03:05:16.463 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:05:16.463 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:05:16.464 +02:00 [INF] Appointment created successfully with ID: 4
2025-11-24 03:05:16.464 +02:00 [DBG] Disposing transaction.
2025-11-24 03:05:16.465 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 03:05:16.466 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 03:05:16.466 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 03:05:16.466 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 03:05:16.467 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 03:05:16.467 +02:00 [INF] Executing CreatedAtActionResult, writing value of type 'Hospital.Application.DTO.Appointment.AppointmentDto'.
2025-11-24 03:05:16.468 +02:00 [DBG] Found the endpoints ["Hospital.API.Controllers.AppointmentController.GetById (Hospital)"] for address (id=[4],action=[GetById],controller=[Appointment])
2025-11-24 03:05:16.469 +02:00 [DBG] Successfully processed template api/Appointment/{id:int} for Hospital.API.Controllers.AppointmentController.GetById (Hospital) resulting in /api/Appointment/4 and 
2025-11-24 03:05:16.470 +02:00 [DBG] Link generation succeeded for endpoints ["Hospital.API.Controllers.AppointmentController.GetById (Hospital)"] with result /api/Appointment/4
2025-11-24 03:05:16.471 +02:00 [INF] Executed action Hospital.API.Controllers.AppointmentController.Add (Hospital) in 195.2294ms
2025-11-24 03:05:16.471 +02:00 [INF] Executed endpoint 'Hospital.API.Controllers.AppointmentController.Add (Hospital)'
2025-11-24 03:05:16.472 +02:00 [DBG] Connection id "0HNHAUKB7C1BF" completed keep alive response.
2025-11-24 03:05:16.472 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:05:16.473 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:05:16.474 +02:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-11-24 03:05:16.475 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Appointment - 201 null application/json; charset=utf-8 213.1374ms
2025-11-24 03:05:22.029 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Doctor/doctor/1/today - null null
2025-11-24 03:05:22.031 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/doctor/1/today'
2025-11-24 03:05:22.032 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital)' with route pattern 'api/Doctor/doctor/{doctorId:int}/today' is valid for the request path '/api/Doctor/doctor/1/today'
2025-11-24 03:05:22.033 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital)'
2025-11-24 03:05:22.034 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:05:22.034 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:05:22.034 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital)'
2025-11-24 03:05:22.036 +02:00 [INF] Route matched with {action = "GetTodayAppointmentsForDoctor", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetTodayAppointmentsForDoctor(Int32) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 03:05:22.037 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:05:22.038 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:05:22.039 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:05:22.040 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:05:22.041 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:05:22.042 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:05:22.043 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:05:22.043 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:05:22.044 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' using the name 'doctorId' in request data ...
2025-11-24 03:05:22.046 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:05:22.047 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:05:22.048 +02:00 [DBG] Attempting to validate the bound parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:05:22.049 +02:00 [DBG] Done attempting to validate the bound parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:05:22.050 +02:00 [INF] GetTodayAppointmentsForDoctor  called at "2025-11-24T03:05:22.0500725+02:00"
2025-11-24 03:05:22.050 +02:00 [INF] Fetching today's appointments for doctor ID 1
2025-11-24 03:05:22.052 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:05:22.053 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:05:22.054 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 03:05:22.054 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:05:22.055 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:05:22.056 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:05:22.056 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:05:22.057 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:05:22.058 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:05:22.071 +02:00 [INF] Executed DbCommand (13ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:05:22.075 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:22.076 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:22.077 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:22.078 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:22.079 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:22.080 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:22.081 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:22.082 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:22.083 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:05:22.084 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 8ms reading results.
2025-11-24 03:05:22.085 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:05:22.085 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:05:22.086 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:05:22.087 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:05:22.088 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:05:22.089 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:05:22.090 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:05:22.090 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Status] = N'Confirmed'
2025-11-24 03:05:22.099 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Status] = N'Confirmed'
2025-11-24 03:05:22.102 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:22.103 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:22.104 +02:00 [DBG] Context 'AppDbContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:22.105 +02:00 [DBG] The navigation 'Patient.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:22.106 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:22.107 +02:00 [DBG] The navigation 'Appointment.Branch' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:22.109 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:22.111 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:05:22.112 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 10ms reading results.
2025-11-24 03:05:22.113 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:05:22.114 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:05:22.121 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 03:05:22.124 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 03:05:22.124 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 03:05:22.125 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 03:05:22.125 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 03:05:22.126 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Appointment.AppoinmentandPaientDetaliesDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 03:05:22.129 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital) in 87.037ms
2025-11-24 03:05:22.130 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital)'
2025-11-24 03:05:22.131 +02:00 [DBG] Connection id "0HNHAUKB7C1BF" completed keep alive response.
2025-11-24 03:05:22.131 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:05:22.132 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:05:22.133 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 03:05:22.134 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Doctor/doctor/1/today - 200 null application/json; charset=utf-8 104.9969ms
2025-11-24 03:05:32.743 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Doctor/doctor/1/date/2025-12-14 - null null
2025-11-24 03:05:32.745 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/doctor/1/date/2025-12-14'
2025-11-24 03:05:32.748 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)' with route pattern 'api/Doctor/doctor/{doctorId:int}/date/{date:datetime}' is valid for the request path '/api/Doctor/doctor/1/date/2025-12-14'
2025-11-24 03:05:32.750 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)'
2025-11-24 03:05:32.750 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:05:32.751 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:05:32.751 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)'
2025-11-24 03:05:32.754 +02:00 [INF] Route matched with {action = "GetAppointmentsForDoctor", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAppointmentsForDoctor(Int32, System.DateTime) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 03:05:32.754 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:05:32.755 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:05:32.756 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:05:32.757 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:05:32.758 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:05:32.759 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:05:32.760 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:05:32.761 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:05:32.761 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' using the name 'doctorId' in request data ...
2025-11-24 03:05:32.762 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:05:32.763 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:05:32.764 +02:00 [DBG] Attempting to validate the bound parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:05:32.765 +02:00 [DBG] Done attempting to validate the bound parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:05:32.765 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateTime' ...
2025-11-24 03:05:32.766 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateTime' using the name 'date' in request data ...
2025-11-24 03:05:32.767 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateTime'.
2025-11-24 03:05:32.768 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateTime'.
2025-11-24 03:05:32.769 +02:00 [DBG] Attempting to validate the bound parameter 'date' of type 'System.DateTime' ...
2025-11-24 03:05:32.770 +02:00 [DBG] Done attempting to validate the bound parameter 'date' of type 'System.DateTime'.
2025-11-24 03:05:32.771 +02:00 [INF] GetAppointmentsForDoctor called at "2025-11-24T03:05:32.7716421+02:00"
2025-11-24 03:05:32.772 +02:00 [INF] Fetching "2025-12-14"'s appointments for doctor ID 1
2025-11-24 03:05:32.773 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:05:32.774 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:05:32.774 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 03:05:32.775 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:05:32.775 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:05:32.776 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:05:32.777 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:05:32.777 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:05:32.778 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:05:32.781 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:05:32.783 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:32.784 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:32.784 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:32.785 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:32.785 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:32.786 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:32.786 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:32.787 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:32.787 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:05:32.788 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 5ms reading results.
2025-11-24 03:05:32.789 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:05:32.790 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:05:32.791 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:05:32.791 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:05:32.792 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:05:32.792 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:05:32.793 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:05:32.793 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Status] = N'Confirmed'
2025-11-24 03:05:32.796 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Status] = N'Confirmed'
2025-11-24 03:05:32.798 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:05:32.798 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 0ms reading results.
2025-11-24 03:05:32.799 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:05:32.800 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:05:32.800 +02:00 [INF] No appointments found for doctor ID 1 today
2025-11-24 03:05:32.801 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 03:05:32.802 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 03:05:32.802 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 03:05:32.803 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 03:05:32.803 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 03:05:32.804 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Appointment.AppoinmentandPaientDetaliesDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 03:05:32.804 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital) in 45.3479ms
2025-11-24 03:05:32.805 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)'
2025-11-24 03:05:32.805 +02:00 [DBG] Connection id "0HNHAUKB7C1BF" completed keep alive response.
2025-11-24 03:05:32.806 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:05:32.806 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:05:32.807 +02:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-11-24 03:05:32.808 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Doctor/doctor/1/date/2025-12-14 - 200 null application/json; charset=utf-8 65.0169ms
2025-11-24 03:05:44.197 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Doctor/doctor/1/date/2025-11-26 - null null
2025-11-24 03:05:44.198 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/doctor/1/date/2025-11-26'
2025-11-24 03:05:44.199 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)' with route pattern 'api/Doctor/doctor/{doctorId:int}/date/{date:datetime}' is valid for the request path '/api/Doctor/doctor/1/date/2025-11-26'
2025-11-24 03:05:44.199 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)'
2025-11-24 03:05:44.200 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:05:44.201 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:05:44.201 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)'
2025-11-24 03:05:44.202 +02:00 [INF] Route matched with {action = "GetAppointmentsForDoctor", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAppointmentsForDoctor(Int32, System.DateTime) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 03:05:44.203 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:05:44.204 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:05:44.205 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:05:44.206 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:05:44.206 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:05:44.207 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:05:44.208 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:05:44.209 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:05:44.210 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' using the name 'doctorId' in request data ...
2025-11-24 03:05:44.211 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:05:44.212 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:05:44.212 +02:00 [DBG] Attempting to validate the bound parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:05:44.213 +02:00 [DBG] Done attempting to validate the bound parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:05:44.213 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateTime' ...
2025-11-24 03:05:44.214 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateTime' using the name 'date' in request data ...
2025-11-24 03:05:44.215 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateTime'.
2025-11-24 03:05:44.215 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateTime'.
2025-11-24 03:05:44.216 +02:00 [DBG] Attempting to validate the bound parameter 'date' of type 'System.DateTime' ...
2025-11-24 03:05:44.216 +02:00 [DBG] Done attempting to validate the bound parameter 'date' of type 'System.DateTime'.
2025-11-24 03:05:44.217 +02:00 [INF] GetAppointmentsForDoctor called at "2025-11-24T03:05:44.2177018+02:00"
2025-11-24 03:05:44.218 +02:00 [INF] Fetching "2025-11-26"'s appointments for doctor ID 1
2025-11-24 03:05:44.218 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:05:44.220 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:05:44.221 +02:00 [DBG] Created DbConnection. (1ms).
2025-11-24 03:05:44.221 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:05:44.222 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:05:44.224 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:05:44.224 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:05:44.225 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:05:44.225 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:05:44.230 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:05:44.232 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:44.233 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:44.233 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:44.234 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:44.235 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:44.236 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:44.237 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:44.237 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:44.238 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:05:44.239 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 7ms reading results.
2025-11-24 03:05:44.240 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:05:44.241 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:05:44.242 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:05:44.243 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:05:44.243 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:05:44.244 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:05:44.245 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:05:44.246 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Status] = N'Confirmed'
2025-11-24 03:05:44.250 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Status] = N'Confirmed'
2025-11-24 03:05:44.252 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:44.253 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:44.254 +02:00 [DBG] Context 'AppDbContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:44.255 +02:00 [DBG] The navigation 'Patient.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:44.256 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:44.256 +02:00 [DBG] The navigation 'Appointment.Branch' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:44.257 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:44.257 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:05:44.258 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 5ms reading results.
2025-11-24 03:05:44.259 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:05:44.260 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (1ms).
2025-11-24 03:05:44.261 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 03:05:44.262 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 03:05:44.263 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 03:05:44.263 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 03:05:44.264 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 03:05:44.265 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Appointment.AppoinmentandPaientDetaliesDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 03:05:44.266 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital) in 58.4423ms
2025-11-24 03:05:44.266 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)'
2025-11-24 03:05:44.267 +02:00 [DBG] Connection id "0HNHAUKB7C1BF" completed keep alive response.
2025-11-24 03:05:44.267 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:05:44.268 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:05:44.269 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 03:05:44.270 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Doctor/doctor/1/date/2025-11-26 - 200 null application/json; charset=utf-8 73.0234ms
2025-11-24 03:05:52.383 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Doctor/doctor/1/date/2024-11-26 - null null
2025-11-24 03:05:52.384 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/doctor/1/date/2024-11-26'
2025-11-24 03:05:52.385 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)' with route pattern 'api/Doctor/doctor/{doctorId:int}/date/{date:datetime}' is valid for the request path '/api/Doctor/doctor/1/date/2024-11-26'
2025-11-24 03:05:52.386 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)'
2025-11-24 03:05:52.387 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:05:52.387 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:05:52.388 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)'
2025-11-24 03:05:52.388 +02:00 [INF] Route matched with {action = "GetAppointmentsForDoctor", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAppointmentsForDoctor(Int32, System.DateTime) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 03:05:52.389 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:05:52.390 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:05:52.391 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:05:52.393 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:05:52.394 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:05:52.395 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:05:52.395 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:05:52.396 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:05:52.396 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' using the name 'doctorId' in request data ...
2025-11-24 03:05:52.397 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:05:52.398 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:05:52.399 +02:00 [DBG] Attempting to validate the bound parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:05:52.399 +02:00 [DBG] Done attempting to validate the bound parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:05:52.400 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateTime' ...
2025-11-24 03:05:52.400 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateTime' using the name 'date' in request data ...
2025-11-24 03:05:52.401 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateTime'.
2025-11-24 03:05:52.402 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateTime'.
2025-11-24 03:05:52.402 +02:00 [DBG] Attempting to validate the bound parameter 'date' of type 'System.DateTime' ...
2025-11-24 03:05:52.403 +02:00 [DBG] Done attempting to validate the bound parameter 'date' of type 'System.DateTime'.
2025-11-24 03:05:52.403 +02:00 [INF] GetAppointmentsForDoctor called at "2025-11-24T03:05:52.4038112+02:00"
2025-11-24 03:05:52.404 +02:00 [INF] Fetching "2024-11-26"'s appointments for doctor ID 1
2025-11-24 03:05:52.406 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:05:52.407 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:05:52.407 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 03:05:52.408 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:05:52.410 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:05:52.410 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:05:52.411 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:05:52.411 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:05:52.413 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:05:52.418 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:05:52.421 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:52.422 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:52.422 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:52.423 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:52.423 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:52.424 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:52.424 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:52.425 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:05:52.426 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:05:52.427 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 5ms reading results.
2025-11-24 03:05:52.428 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:05:52.428 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:05:52.429 +02:00 [WRN] The provided date "2024-11-26" is in the past
2025-11-24 03:05:52.462 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital) in 67.207ms
2025-11-24 03:05:52.463 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)'
2025-11-24 03:05:52.504 +02:00 [ERR]  Exception caught: The provided date cannot be in the past.
System.ArgumentException: The provided date cannot be in the past.
   at Hospital.Infrastructure.Services.DoctorService.GetAppoinmentsForDoctorByDateAsync(Int32 doctorId, DateOnly date) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\DoctorService.cs:line 329
   at Hospital.Controllers.DoctorController.GetAppointmentsForDoctor(Int32 doctorId, DateTime date) in D:\Walaa\GP\Hospital\Hospital\Controllers\DoctorController.cs:line 237
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context) in D:\Walaa\GP\Hospital\Hospital\Middleware\GlobalExceptionHandler.cs:line 22
2025-11-24 03:05:52.510 +02:00 [DBG] Connection id "0HNHAUKB7C1BF" completed keep alive response.
2025-11-24 03:05:52.511 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:05:52.511 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:05:52.512 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 03:05:52.513 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Doctor/doctor/1/date/2024-11-26 - 400 null application/json 130.2399ms
2025-11-24 03:06:01.401 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Doctor/doctor/1/date/2025-11-267 - null null
2025-11-24 03:06:01.402 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/doctor/1/date/2025-11-267'
2025-11-24 03:06:01.405 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)' with route pattern 'api/Doctor/doctor/{doctorId:int}/date/{date:datetime}' was rejected by constraint 'date':'Microsoft.AspNetCore.Routing.Constraints.DateTimeRouteConstraint' with value '2025-11-267' for the request path '/api/Doctor/doctor/1/date/2025-11-267'
2025-11-24 03:06:01.407 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)' with route pattern 'api/Doctor/doctor/{doctorId:int}/date/{date:datetime}' is not valid for the request path '/api/Doctor/doctor/1/date/2025-11-267'
2025-11-24 03:06:01.408 +02:00 [DBG] Request did not match any endpoints
2025-11-24 03:06:01.409 +02:00 [DBG] The request path  does not match the path filter
2025-11-24 03:06:01.410 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:06:01.411 +02:00 [DBG] Connection id "0HNHAUKB7C1BF" completed keep alive response.
2025-11-24 03:06:01.411 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Doctor/doctor/1/date/2025-11-267 - 404 0 null 10.6345ms
2025-11-24 03:06:01.413 +02:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7217/api/Doctor/doctor/1/date/2025-11-267, Response status code: 404
2025-11-24 03:06:25.283 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Doctor/doctor/1/date/2025-11-24 - null null
2025-11-24 03:06:25.285 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/doctor/1/date/2025-11-24'
2025-11-24 03:06:25.286 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)' with route pattern 'api/Doctor/doctor/{doctorId:int}/date/{date:datetime}' is valid for the request path '/api/Doctor/doctor/1/date/2025-11-24'
2025-11-24 03:06:25.287 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)'
2025-11-24 03:06:25.288 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:06:25.289 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:06:25.289 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)'
2025-11-24 03:06:25.290 +02:00 [INF] Route matched with {action = "GetAppointmentsForDoctor", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAppointmentsForDoctor(Int32, System.DateTime) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 03:06:25.292 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:06:25.292 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:06:25.293 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:06:25.295 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:06:25.296 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:06:25.297 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:06:25.297 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:06:25.298 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:06:25.299 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' using the name 'doctorId' in request data ...
2025-11-24 03:06:25.300 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:06:25.301 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:06:25.302 +02:00 [DBG] Attempting to validate the bound parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:06:25.302 +02:00 [DBG] Done attempting to validate the bound parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:06:25.303 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateTime' ...
2025-11-24 03:06:25.303 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateTime' using the name 'date' in request data ...
2025-11-24 03:06:25.304 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateTime'.
2025-11-24 03:06:25.304 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateTime'.
2025-11-24 03:06:25.305 +02:00 [DBG] Attempting to validate the bound parameter 'date' of type 'System.DateTime' ...
2025-11-24 03:06:25.305 +02:00 [DBG] Done attempting to validate the bound parameter 'date' of type 'System.DateTime'.
2025-11-24 03:06:25.305 +02:00 [INF] GetAppointmentsForDoctor called at "2025-11-24T03:06:25.3059194+02:00"
2025-11-24 03:06:25.306 +02:00 [INF] Fetching "2025-11-24"'s appointments for doctor ID 1
2025-11-24 03:06:25.307 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:06:25.308 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:06:25.309 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 03:06:25.309 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:06:25.310 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:06:25.310 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:06:25.311 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:06:25.312 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:06:25.312 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:06:25.324 +02:00 [INF] Executed DbCommand (11ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:06:25.327 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:06:25.327 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:06:25.328 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:06:25.329 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:06:25.329 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:06:25.331 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:06:25.331 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:06:25.332 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:06:25.332 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:06:25.333 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 6ms reading results.
2025-11-24 03:06:25.333 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:06:25.334 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:06:25.335 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:06:25.336 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:06:25.336 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:06:25.337 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:06:25.338 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:06:25.338 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Status] = N'Confirmed'
2025-11-24 03:06:25.346 +02:00 [INF] Executed DbCommand (8ms) [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Status] = N'Confirmed'
2025-11-24 03:06:25.349 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:06:25.349 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:06:25.350 +02:00 [DBG] Context 'AppDbContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:06:25.351 +02:00 [DBG] The navigation 'Patient.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:06:25.352 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:06:25.352 +02:00 [DBG] The navigation 'Appointment.Branch' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:06:25.353 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:06:25.354 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:06:25.355 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 6ms reading results.
2025-11-24 03:06:25.356 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:06:25.356 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:06:25.357 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 03:06:25.359 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 03:06:25.360 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 03:06:25.360 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 03:06:25.361 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 03:06:25.362 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Appointment.AppoinmentandPaientDetaliesDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 03:06:25.363 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital) in 66.4777ms
2025-11-24 03:06:25.364 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)'
2025-11-24 03:06:25.365 +02:00 [DBG] Connection id "0HNHAUKB7C1BF" completed keep alive response.
2025-11-24 03:06:25.365 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:06:25.365 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:06:25.366 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 03:06:25.367 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Doctor/doctor/1/date/2025-11-24 - 200 null application/json; charset=utf-8 84.1119ms
2025-11-24 03:06:52.260 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Doctor/doctor/1/date/2025-11-24 - null null
2025-11-24 03:06:52.264 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/doctor/1/date/2025-11-24'
2025-11-24 03:06:52.264 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)' with route pattern 'api/Doctor/doctor/{doctorId:int}/date/{date:datetime}' is valid for the request path '/api/Doctor/doctor/1/date/2025-11-24'
2025-11-24 03:06:52.265 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)'
2025-11-24 03:06:52.266 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:06:52.266 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:06:52.267 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)'
2025-11-24 03:06:52.269 +02:00 [INF] Route matched with {action = "GetAppointmentsForDoctor", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAppointmentsForDoctor(Int32, System.DateTime) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 03:06:52.270 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:06:52.271 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:06:52.272 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:06:52.273 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:06:52.274 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:06:52.275 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:06:52.275 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:06:52.276 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:06:52.276 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' using the name 'doctorId' in request data ...
2025-11-24 03:06:52.277 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:06:52.278 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:06:52.279 +02:00 [DBG] Attempting to validate the bound parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:06:52.280 +02:00 [DBG] Done attempting to validate the bound parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:06:52.281 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateTime' ...
2025-11-24 03:06:52.281 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateTime' using the name 'date' in request data ...
2025-11-24 03:06:52.282 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateTime'.
2025-11-24 03:06:52.283 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateTime'.
2025-11-24 03:06:52.283 +02:00 [DBG] Attempting to validate the bound parameter 'date' of type 'System.DateTime' ...
2025-11-24 03:06:52.284 +02:00 [DBG] Done attempting to validate the bound parameter 'date' of type 'System.DateTime'.
2025-11-24 03:06:52.284 +02:00 [INF] GetAppointmentsForDoctor called at "2025-11-24T03:06:52.2844817+02:00"
2025-11-24 03:06:52.284 +02:00 [INF] Fetching "2025-11-24"'s appointments for doctor ID 1
2025-11-24 03:06:52.286 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:06:52.287 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:06:52.287 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 03:06:52.287 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:06:52.288 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:06:52.289 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:06:52.290 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:06:52.291 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:06:52.291 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:06:52.302 +02:00 [INF] Executed DbCommand (10ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:06:52.304 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:06:52.304 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:06:52.305 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:06:52.305 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:06:52.306 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:06:52.307 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:06:52.308 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:06:52.310 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:06:52.311 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:06:52.312 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 8ms reading results.
2025-11-24 03:06:52.313 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:06:52.314 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:06:52.315 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:06:52.317 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:06:52.317 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:06:52.318 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:06:52.318 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:06:52.319 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Status] = N'Confirmed'
2025-11-24 03:06:52.325 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Status] = N'Confirmed'
2025-11-24 03:06:52.326 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:06:52.327 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:06:52.328 +02:00 [DBG] Context 'AppDbContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:06:52.328 +02:00 [DBG] The navigation 'Patient.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:06:52.329 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:06:52.330 +02:00 [DBG] The navigation 'Appointment.Branch' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:06:52.330 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:06:52.331 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:06:52.331 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 5ms reading results.
2025-11-24 03:06:52.332 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:06:52.332 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:06:52.333 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 03:06:52.334 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 03:06:52.335 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 03:06:52.335 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 03:06:52.335 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 03:06:52.336 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Appointment.AppoinmentandPaientDetaliesDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 03:06:52.336 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital) in 61.8071ms
2025-11-24 03:06:52.337 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)'
2025-11-24 03:06:52.338 +02:00 [DBG] Connection id "0HNHAUKB7C1BF" completed keep alive response.
2025-11-24 03:06:52.339 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:06:52.339 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:06:52.341 +02:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-11-24 03:06:52.341 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Doctor/doctor/1/date/2025-11-24 - 200 null application/json; charset=utf-8 84.976ms
2025-11-24 03:07:27.727 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Doctor/doctor/1/date/2025-11-26 - null null
2025-11-24 03:07:27.734 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/doctor/1/date/2025-11-26'
2025-11-24 03:07:27.735 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)' with route pattern 'api/Doctor/doctor/{doctorId:int}/date/{date:datetime}' is valid for the request path '/api/Doctor/doctor/1/date/2025-11-26'
2025-11-24 03:07:27.737 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)'
2025-11-24 03:07:27.738 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:07:27.739 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:07:27.740 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)'
2025-11-24 03:07:27.741 +02:00 [INF] Route matched with {action = "GetAppointmentsForDoctor", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAppointmentsForDoctor(Int32, System.DateTime) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 03:07:27.742 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:07:27.743 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:07:27.744 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:07:27.745 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:07:27.746 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:07:27.747 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:07:27.748 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:07:27.750 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:07:27.750 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' using the name 'doctorId' in request data ...
2025-11-24 03:07:27.751 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:07:27.751 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:07:27.752 +02:00 [DBG] Attempting to validate the bound parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:07:27.752 +02:00 [DBG] Done attempting to validate the bound parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:07:27.753 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateTime' ...
2025-11-24 03:07:27.753 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateTime' using the name 'date' in request data ...
2025-11-24 03:07:27.754 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateTime'.
2025-11-24 03:07:27.754 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateTime'.
2025-11-24 03:07:27.755 +02:00 [DBG] Attempting to validate the bound parameter 'date' of type 'System.DateTime' ...
2025-11-24 03:07:27.755 +02:00 [DBG] Done attempting to validate the bound parameter 'date' of type 'System.DateTime'.
2025-11-24 03:07:27.756 +02:00 [INF] GetAppointmentsForDoctor called at "2025-11-24T03:07:27.7561568+02:00"
2025-11-24 03:07:27.756 +02:00 [INF] Fetching "2025-11-26"'s appointments for doctor ID 1
2025-11-24 03:07:27.757 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:07:27.758 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:07:27.759 +02:00 [DBG] Created DbConnection. (1ms).
2025-11-24 03:07:27.760 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:07:27.761 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:07:27.762 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:07:27.762 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:07:27.764 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:07:27.765 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:07:27.768 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:07:27.775 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:27.776 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:27.777 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:27.777 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:27.778 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:27.779 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:27.780 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:27.781 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:27.781 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:07:27.782 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 6ms reading results.
2025-11-24 03:07:27.782 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:07:27.783 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:07:27.783 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:07:27.784 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:07:27.784 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:07:27.785 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:07:27.785 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:07:27.786 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Status] = N'Confirmed'
2025-11-24 03:07:27.788 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Status] = N'Confirmed'
2025-11-24 03:07:27.790 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:27.790 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:27.791 +02:00 [DBG] Context 'AppDbContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:27.792 +02:00 [DBG] The navigation 'Patient.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:27.792 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:27.793 +02:00 [DBG] The navigation 'Appointment.Branch' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:27.793 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:27.794 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:07:27.795 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 5ms reading results.
2025-11-24 03:07:27.796 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:07:27.797 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:07:27.798 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 03:07:27.800 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 03:07:27.800 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 03:07:27.801 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 03:07:27.801 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 03:07:27.802 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Appointment.AppoinmentandPaientDetaliesDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 03:07:27.803 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital) in 56.5094ms
2025-11-24 03:07:27.804 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)'
2025-11-24 03:07:27.805 +02:00 [DBG] Connection id "0HNHAUKB7C1BF" completed keep alive response.
2025-11-24 03:07:27.806 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:07:27.807 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:07:27.808 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 03:07:27.809 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Doctor/doctor/1/date/2025-11-26 - 200 null application/json; charset=utf-8 82.0777ms
2025-11-24 03:07:40.232 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Appointment/GetAll - null null
2025-11-24 03:07:40.234 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Appointment/GetAll'
2025-11-24 03:07:40.234 +02:00 [DBG] Endpoint 'Hospital.API.Controllers.AppointmentController.GetAll (Hospital)' with route pattern 'api/Appointment/GetAll' is valid for the request path '/api/Appointment/GetAll'
2025-11-24 03:07:40.235 +02:00 [DBG] Request matched endpoint 'Hospital.API.Controllers.AppointmentController.GetAll (Hospital)'
2025-11-24 03:07:40.236 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:07:40.237 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:07:40.237 +02:00 [INF] Executing endpoint 'Hospital.API.Controllers.AppointmentController.GetAll (Hospital)'
2025-11-24 03:07:40.238 +02:00 [INF] Route matched with {action = "GetAll", controller = "Appointment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll() on controller Hospital.API.Controllers.AppointmentController (Hospital).
2025-11-24 03:07:40.239 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:07:40.239 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:07:40.241 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:07:40.242 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:07:40.243 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:07:40.244 +02:00 [DBG] Executing controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 03:07:40.244 +02:00 [DBG] Executed controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 03:07:40.245 +02:00 [INF] Get All Appointments called at "2025-11-24T03:07:40.2451460+02:00"
2025-11-24 03:07:40.246 +02:00 [INF] Fetching all appointments
2025-11-24 03:07:40.247 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:07:40.248 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:07:40.249 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 03:07:40.249 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:07:40.250 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:07:40.251 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:07:40.251 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:07:40.252 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:07:40.252 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Doctors] AS [d] ON [a].[DoctorId] = [d].[DoctorId]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
2025-11-24 03:07:40.258 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Doctors] AS [d] ON [a].[DoctorId] = [d].[DoctorId]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
2025-11-24 03:07:40.260 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:40.261 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:40.261 +02:00 [DBG] Context 'AppDbContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:40.262 +02:00 [DBG] The navigation 'Appointment.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:40.262 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:40.263 +02:00 [DBG] The navigation 'Appointment.Branch' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:40.263 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:40.264 +02:00 [DBG] The navigation 'Appointment.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:40.265 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:40.266 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:40.266 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:40.267 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:40.267 +02:00 [DBG] The navigation 'Appointment.Branch' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:40.269 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:40.270 +02:00 [DBG] The navigation 'Appointment.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:40.270 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:40.271 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:40.272 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:07:40.273 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 13ms reading results.
2025-11-24 03:07:40.274 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:07:40.275 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:07:40.276 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 03:07:40.277 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 03:07:40.277 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 03:07:40.279 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 03:07:40.279 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 03:07:40.280 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Appointment.AppointmentDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 03:07:40.281 +02:00 [INF] Executed action Hospital.API.Controllers.AppointmentController.GetAll (Hospital) in 37.8916ms
2025-11-24 03:07:40.282 +02:00 [INF] Executed endpoint 'Hospital.API.Controllers.AppointmentController.GetAll (Hospital)'
2025-11-24 03:07:40.283 +02:00 [DBG] Connection id "0HNHAUKB7C1BF" completed keep alive response.
2025-11-24 03:07:40.284 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:07:40.284 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:07:40.285 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 03:07:40.286 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Appointment/GetAll - 200 null application/json; charset=utf-8 54.3973ms
2025-11-24 03:07:52.733 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Appointment/GetAll - null null
2025-11-24 03:07:52.735 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Appointment/GetAll'
2025-11-24 03:07:52.736 +02:00 [DBG] Endpoint 'Hospital.API.Controllers.AppointmentController.GetAll (Hospital)' with route pattern 'api/Appointment/GetAll' is valid for the request path '/api/Appointment/GetAll'
2025-11-24 03:07:52.737 +02:00 [DBG] Request matched endpoint 'Hospital.API.Controllers.AppointmentController.GetAll (Hospital)'
2025-11-24 03:07:52.737 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:07:52.738 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:07:52.738 +02:00 [INF] Executing endpoint 'Hospital.API.Controllers.AppointmentController.GetAll (Hospital)'
2025-11-24 03:07:52.739 +02:00 [INF] Route matched with {action = "GetAll", controller = "Appointment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll() on controller Hospital.API.Controllers.AppointmentController (Hospital).
2025-11-24 03:07:52.740 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:07:52.741 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:07:52.742 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:07:52.742 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:07:52.743 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:07:52.745 +02:00 [DBG] Executing controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 03:07:52.745 +02:00 [DBG] Executed controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 03:07:52.746 +02:00 [INF] Get All Appointments called at "2025-11-24T03:07:52.7462943+02:00"
2025-11-24 03:07:52.746 +02:00 [INF] Fetching all appointments
2025-11-24 03:07:52.747 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:07:52.748 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:07:52.749 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 03:07:52.749 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:07:52.750 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:07:52.750 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:07:52.751 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:07:52.751 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:07:52.752 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Doctors] AS [d] ON [a].[DoctorId] = [d].[DoctorId]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
2025-11-24 03:07:52.755 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Doctors] AS [d] ON [a].[DoctorId] = [d].[DoctorId]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
2025-11-24 03:07:52.761 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:52.762 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:52.763 +02:00 [DBG] Context 'AppDbContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:52.765 +02:00 [DBG] The navigation 'Appointment.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:52.765 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:52.766 +02:00 [DBG] The navigation 'Appointment.Branch' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:52.767 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:52.768 +02:00 [DBG] The navigation 'Appointment.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:52.769 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:52.769 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:52.770 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:52.771 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:52.772 +02:00 [DBG] The navigation 'Appointment.Branch' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:52.772 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:52.773 +02:00 [DBG] The navigation 'Appointment.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:52.773 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:52.774 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:07:52.775 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:07:52.775 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 14ms reading results.
2025-11-24 03:07:52.776 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:07:52.777 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:07:52.778 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 03:07:52.779 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 03:07:52.779 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 03:07:52.780 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 03:07:52.780 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 03:07:52.781 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Appointment.AppointmentDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 03:07:52.782 +02:00 [INF] Executed action Hospital.API.Controllers.AppointmentController.GetAll (Hospital) in 37.3623ms
2025-11-24 03:07:52.782 +02:00 [INF] Executed endpoint 'Hospital.API.Controllers.AppointmentController.GetAll (Hospital)'
2025-11-24 03:07:52.783 +02:00 [DBG] Connection id "0HNHAUKB7C1BF" completed keep alive response.
2025-11-24 03:07:52.784 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:07:52.784 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:07:52.785 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 03:07:52.785 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Appointment/GetAll - 200 null application/json; charset=utf-8 52.7921ms
2025-11-24 03:08:09.525 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Appointment/GetAll - null null
2025-11-24 03:08:09.526 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Appointment/GetAll'
2025-11-24 03:08:09.526 +02:00 [DBG] Endpoint 'Hospital.API.Controllers.AppointmentController.GetAll (Hospital)' with route pattern 'api/Appointment/GetAll' is valid for the request path '/api/Appointment/GetAll'
2025-11-24 03:08:09.529 +02:00 [DBG] Request matched endpoint 'Hospital.API.Controllers.AppointmentController.GetAll (Hospital)'
2025-11-24 03:08:09.530 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:08:09.531 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:08:09.532 +02:00 [INF] Executing endpoint 'Hospital.API.Controllers.AppointmentController.GetAll (Hospital)'
2025-11-24 03:08:09.532 +02:00 [INF] Route matched with {action = "GetAll", controller = "Appointment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll() on controller Hospital.API.Controllers.AppointmentController (Hospital).
2025-11-24 03:08:09.534 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:08:09.534 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:08:09.535 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:08:09.536 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:08:09.539 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:08:09.540 +02:00 [DBG] Executing controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 03:08:09.541 +02:00 [DBG] Executed controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 03:08:09.541 +02:00 [INF] Get All Appointments called at "2025-11-24T03:08:09.5418906+02:00"
2025-11-24 03:08:09.542 +02:00 [INF] Fetching all appointments
2025-11-24 03:08:09.543 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:08:09.544 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:08:09.545 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 03:08:09.545 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:08:09.546 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:08:09.546 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:08:09.547 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:08:09.547 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:08:09.548 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Doctors] AS [d] ON [a].[DoctorId] = [d].[DoctorId]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
2025-11-24 03:08:09.550 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Doctors] AS [d] ON [a].[DoctorId] = [d].[DoctorId]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
2025-11-24 03:08:09.553 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:09.554 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:09.555 +02:00 [DBG] Context 'AppDbContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:09.555 +02:00 [DBG] The navigation 'Appointment.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:09.556 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:09.556 +02:00 [DBG] The navigation 'Appointment.Branch' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:09.557 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:09.557 +02:00 [DBG] The navigation 'Appointment.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:09.558 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:09.559 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:09.560 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:09.561 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:09.561 +02:00 [DBG] The navigation 'Appointment.Branch' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:09.562 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:09.563 +02:00 [DBG] The navigation 'Appointment.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:09.563 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:09.563 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:09.564 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:08:09.564 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 11ms reading results.
2025-11-24 03:08:09.565 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:08:09.566 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:08:09.566 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 03:08:09.567 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 03:08:09.567 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 03:08:09.568 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 03:08:09.568 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 03:08:09.569 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Appointment.AppointmentDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 03:08:09.571 +02:00 [INF] Executed action Hospital.API.Controllers.AppointmentController.GetAll (Hospital) in 31.0183ms
2025-11-24 03:08:09.572 +02:00 [INF] Executed endpoint 'Hospital.API.Controllers.AppointmentController.GetAll (Hospital)'
2025-11-24 03:08:09.573 +02:00 [DBG] Connection id "0HNHAUKB7C1BF" completed keep alive response.
2025-11-24 03:08:09.573 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:08:09.573 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:08:09.574 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 03:08:09.575 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Appointment/GetAll - 200 null application/json; charset=utf-8 50.4874ms
2025-11-24 03:08:28.972 +02:00 [INF] Request starting HTTP/1.1 POST https://localhost:7217/api/Appointment - application/json 181
2025-11-24 03:08:28.974 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Appointment'
2025-11-24 03:08:28.975 +02:00 [DBG] Endpoint 'Hospital.API.Controllers.AppointmentController.Add (Hospital)' with route pattern 'api/Appointment' is valid for the request path '/api/Appointment'
2025-11-24 03:08:28.976 +02:00 [DBG] Request matched endpoint 'Hospital.API.Controllers.AppointmentController.Add (Hospital)'
2025-11-24 03:08:28.977 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:08:28.979 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:08:28.980 +02:00 [INF] Executing endpoint 'Hospital.API.Controllers.AppointmentController.Add (Hospital)'
2025-11-24 03:08:28.980 +02:00 [INF] Route matched with {action = "Add", controller = "Appointment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Add(Hospital.Application.DTO.Appointment.AddAppointmentDto) on controller Hospital.API.Controllers.AppointmentController (Hospital).
2025-11-24 03:08:28.981 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:08:28.982 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:08:28.983 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:08:28.983 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:08:28.984 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:08:28.985 +02:00 [DBG] Executing controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 03:08:28.986 +02:00 [DBG] Executed controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 03:08:28.987 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto' ...
2025-11-24 03:08:28.987 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto' using the name '' in request data ...
2025-11-24 03:08:28.988 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 03:08:28.989 +02:00 [DBG] Connection id "0HNHAUKB7C1BF", Request id "0HNHAUKB7C1BF:0000001C": started reading request body.
2025-11-24 03:08:28.990 +02:00 [DBG] Connection id "0HNHAUKB7C1BF", Request id "0HNHAUKB7C1BF:0000001C": done reading request body.
2025-11-24 03:08:28.990 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Appointment.AddAppointmentDto'
2025-11-24 03:08:28.991 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto'.
2025-11-24 03:08:28.992 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto'.
2025-11-24 03:08:28.992 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto' ...
2025-11-24 03:08:28.993 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Appointment.AddAppointmentDto'.
2025-11-24 03:08:28.994 +02:00 [INF] Add Appointment called at "2025-11-24T03:08:28.9945880+02:00"
2025-11-24 03:08:28.995 +02:00 [INF] Creating appointment for PatientId: 1, DoctorId: 1, Date: "2025-12-24", Time: "2025-11-23T15:33:47.5410000Z"
2025-11-24 03:08:28.996 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:08:28.997 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:08:28.997 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 03:08:28.998 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:08:28.999 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:08:29.000 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 03:08:29.001 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 03:08:29.001 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:08:29.002 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:08:29.002 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:08:29.003 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 03:08:29.017 +02:00 [INF] Executed DbCommand (13ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[PatientId], [t].[CreatedAt], [t].[EmergencyContact], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t0].[RecordId], [t0].[AppointmentId], [t0].[CreatedAt], [t0].[Diagnosis], [t0].[DoctorId], [t0].[Notes], [t0].[PatientId], [t0].[TreatmentPlan], [t0].[UpdatedAt], [t0].[DoctorId0], [t0].[Available], [t0].[Biography], [t0].[ConsultationFees], [t0].[CreatedAt0], [t0].[ExperienceYears], [t0].[ImageURL], [t0].[SpecializationId], [t0].[UpdatedAt0], [t0].[UserId], [t0].[Id], [t0].[AccessFailedCount], [t0].[ConcurrencyStamp], [t0].[CreatedAt1], [t0].[DateOfBirth], [t0].[Email], [t0].[EmailConfirmed], [t0].[FullName], [t0].[Gender], [t0].[LockoutEnabled], [t0].[LockoutEnd], [t0].[NormalizedEmail], [t0].[NormalizedUserName], [t0].[PasswordHash], [t0].[PhoneNumber], [t0].[PhoneNumberConfirmed], [t0].[RefreshToken], [t0].[RefreshTokenExpiryTime], [t0].[Role], [t0].[SecurityStamp], [t0].[TwoFactorEnabled], [t0].[UpdatedAt1], [t0].[UserName]
FROM (
    SELECT TOP(1) [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName]
    FROM [Patients] AS [p]
    INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
    WHERE [p].[PatientId] = @__id_0
) AS [t]
LEFT JOIN (
    SELECT [m].[RecordId], [m].[AppointmentId], [m].[CreatedAt], [m].[Diagnosis], [m].[DoctorId], [m].[Notes], [m].[PatientId], [m].[TreatmentPlan], [m].[UpdatedAt], [d].[DoctorId] AS [DoctorId0], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt] AS [CreatedAt0], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UserId], [u0].[Id], [u0].[AccessFailedCount], [u0].[ConcurrencyStamp], [u0].[CreatedAt] AS [CreatedAt1], [u0].[DateOfBirth], [u0].[Email], [u0].[EmailConfirmed], [u0].[FullName], [u0].[Gender], [u0].[LockoutEnabled], [u0].[LockoutEnd], [u0].[NormalizedEmail], [u0].[NormalizedUserName], [u0].[PasswordHash], [u0].[PhoneNumber], [u0].[PhoneNumberConfirmed], [u0].[RefreshToken], [u0].[RefreshTokenExpiryTime], [u0].[Role], [u0].[SecurityStamp], [u0].[TwoFactorEnabled], [u0].[UpdatedAt] AS [UpdatedAt1], [u0].[UserName]
    FROM [MedicalRecords] AS [m]
    INNER JOIN [Doctors] AS [d] ON [m].[DoctorId] = [d].[DoctorId]
    INNER JOIN [Users] AS [u0] ON [d].[UserId] = [u0].[Id]
) AS [t0] ON [t].[PatientId] = [t0].[PatientId]
ORDER BY [t].[PatientId], [t].[Id], [t0].[RecordId], [t0].[DoctorId0]
2025-11-24 03:08:29.020 +02:00 [DBG] Context 'AppDbContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:29.021 +02:00 [DBG] The navigation 'Patient.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:29.022 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:29.023 +02:00 [DBG] Context 'AppDbContext' started tracking 'MedicalRecord' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:29.024 +02:00 [DBG] The navigation 'MedicalRecord.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:29.024 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:29.025 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:29.026 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:29.027 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:08:29.028 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 7ms reading results.
2025-11-24 03:08:29.029 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:08:29.029 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:08:29.030 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:08:29.030 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:08:29.039 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:08:29.042 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:29.043 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:29.044 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:29.044 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:29.045 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:29.046 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:08:29.047 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 4ms reading results.
2025-11-24 03:08:29.048 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:08:29.048 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:08:29.049 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:08:29.050 +02:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 03:08:29.052 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Branches] AS [b]
WHERE [b].[BranchId] = @__id_0
2025-11-24 03:08:29.053 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:29.054 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:08:29.054 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 1ms reading results.
2025-11-24 03:08:29.057 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:08:29.057 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:08:29.058 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:08:29.059 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2), @__time_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Appointments] AS [a]
        WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Time] = @__time_2) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-24 03:08:29.064 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2), @__time_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Appointments] AS [a]
        WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Time] = @__time_2) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-11-24 03:08:29.065 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:08:29.066 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 0ms reading results.
2025-11-24 03:08:29.066 +02:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Appointment.AppointmentId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:29.069 +02:00 [DBG] The navigation 'Appointment.Branch' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:29.071 +02:00 [DBG] The navigation 'Appointment.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:29.071 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:29.072 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:29.073 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 03:08:29.073 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 03:08:29.074 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 03:08:29.074 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 03:08:29.075 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 03:08:29.076 +02:00 [DBG] Creating transaction savepoint.
2025-11-24 03:08:29.077 +02:00 [DBG] Created transaction savepoint.
2025-11-24 03:08:29.078 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:08:29.078 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:08:29.079 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:08:29.080 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 450), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (Size = 4000), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (Size = 20), @p9='?' (DbType = DateTime2), @p10='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Appointments] ([BranchId], [CreatedAt], [CreatedBy], [Date], [DoctorId], [Notes], [PatientId], [PaymentMethod], [Status], [Time], [UpdatedAt])
OUTPUT INSERTED.[AppointmentId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2025-11-24 03:08:29.083 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 450), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (Size = 4000), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (Size = 20), @p9='?' (DbType = DateTime2), @p10='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Appointments] ([BranchId], [CreatedAt], [CreatedBy], [Date], [DoctorId], [Notes], [PatientId], [PaymentMethod], [Status], [Time], [UpdatedAt])
OUTPUT INSERTED.[AppointmentId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2025-11-24 03:08:29.084 +02:00 [DBG] The foreign key property 'Appointment.AppointmentId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 03:08:29.085 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:08:29.086 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 1ms reading results.
2025-11-24 03:08:29.087 +02:00 [DBG] An entity of type 'Appointment' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:29.088 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 03:08:29.089 +02:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Payment.PaymentId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:29.090 +02:00 [DBG] The navigation 'Payment.Appointment' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:29.091 +02:00 [DBG] The navigation 'Appointment.Payment' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:29.092 +02:00 [DBG] Context 'AppDbContext' started tracking 'Payment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:29.093 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 03:08:29.094 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 03:08:29.094 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 03:08:29.095 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 03:08:29.095 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 03:08:29.096 +02:00 [DBG] Creating transaction savepoint.
2025-11-24 03:08:29.097 +02:00 [DBG] Created transaction savepoint.
2025-11-24 03:08:29.099 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:08:29.099 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:08:29.100 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:08:29.100 +02:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 3), @p4='?' (Size = 4000), @p5='?' (Size = 100), @p6='?' (DbType = Int64), @p7='?' (DbType = Int64), @p8='?' (Size = 20), @p9='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Payments] ([Amount], [AppointmentId], [CreatedAt], [Currency], [GatewayResponse], [PaymobMerchantOrderId], [PaymobOrderId], [PaymobTransactionId], [Status], [UpdatedAt])
OUTPUT INSERTED.[PaymentId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-24 03:08:29.104 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 3), @p4='?' (Size = 4000), @p5='?' (Size = 100), @p6='?' (DbType = Int64), @p7='?' (DbType = Int64), @p8='?' (Size = 20), @p9='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Payments] ([Amount], [AppointmentId], [CreatedAt], [Currency], [GatewayResponse], [PaymobMerchantOrderId], [PaymobOrderId], [PaymobTransactionId], [Status], [UpdatedAt])
OUTPUT INSERTED.[PaymentId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-11-24 03:08:29.105 +02:00 [DBG] The foreign key property 'Payment.PaymentId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 03:08:29.106 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:08:29.106 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 1ms reading results.
2025-11-24 03:08:29.107 +02:00 [DBG] An entity of type 'Payment' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:29.108 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 03:08:29.109 +02:00 [DBG] Committing transaction.
2025-11-24 03:08:29.110 +02:00 [DBG] Committed transaction.
2025-11-24 03:08:29.110 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:08:29.111 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:08:29.111 +02:00 [INF] Appointment created successfully with ID: 5
2025-11-24 03:08:29.112 +02:00 [DBG] Disposing transaction.
2025-11-24 03:08:29.112 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 03:08:29.113 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 03:08:29.113 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 03:08:29.114 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 03:08:29.115 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 03:08:29.115 +02:00 [INF] Executing CreatedAtActionResult, writing value of type 'Hospital.Application.DTO.Appointment.AppointmentDto'.
2025-11-24 03:08:29.116 +02:00 [DBG] Found the endpoints ["Hospital.API.Controllers.AppointmentController.GetById (Hospital)"] for address (id=[5],action=[GetById],controller=[Appointment])
2025-11-24 03:08:29.117 +02:00 [DBG] Successfully processed template api/Appointment/{id:int} for Hospital.API.Controllers.AppointmentController.GetById (Hospital) resulting in /api/Appointment/5 and 
2025-11-24 03:08:29.118 +02:00 [DBG] Link generation succeeded for endpoints ["Hospital.API.Controllers.AppointmentController.GetById (Hospital)"] with result /api/Appointment/5
2025-11-24 03:08:29.119 +02:00 [INF] Executed action Hospital.API.Controllers.AppointmentController.Add (Hospital) in 134.6007ms
2025-11-24 03:08:29.120 +02:00 [INF] Executed endpoint 'Hospital.API.Controllers.AppointmentController.Add (Hospital)'
2025-11-24 03:08:29.120 +02:00 [DBG] Connection id "0HNHAUKB7C1BF" completed keep alive response.
2025-11-24 03:08:29.121 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:08:29.121 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:08:29.122 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 03:08:29.123 +02:00 [INF] Request finished HTTP/1.1 POST https://localhost:7217/api/Appointment - 201 null application/json; charset=utf-8 150.1947ms
2025-11-24 03:08:42.487 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Doctor/doctor/1/date/2025-11-26 - null null
2025-11-24 03:08:42.489 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/doctor/1/date/2025-11-26'
2025-11-24 03:08:42.489 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)' with route pattern 'api/Doctor/doctor/{doctorId:int}/date/{date:datetime}' is valid for the request path '/api/Doctor/doctor/1/date/2025-11-26'
2025-11-24 03:08:42.491 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)'
2025-11-24 03:08:42.491 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:08:42.492 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:08:42.493 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)'
2025-11-24 03:08:42.494 +02:00 [INF] Route matched with {action = "GetAppointmentsForDoctor", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAppointmentsForDoctor(Int32, System.DateTime) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 03:08:42.496 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:08:42.497 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:08:42.498 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:08:42.499 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:08:42.500 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:08:42.501 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:08:42.502 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:08:42.503 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:08:42.504 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' using the name 'doctorId' in request data ...
2025-11-24 03:08:42.505 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:08:42.506 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:08:42.506 +02:00 [DBG] Attempting to validate the bound parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:08:42.507 +02:00 [DBG] Done attempting to validate the bound parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:08:42.508 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateTime' ...
2025-11-24 03:08:42.509 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateTime' using the name 'date' in request data ...
2025-11-24 03:08:42.509 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateTime'.
2025-11-24 03:08:42.510 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateTime'.
2025-11-24 03:08:42.511 +02:00 [DBG] Attempting to validate the bound parameter 'date' of type 'System.DateTime' ...
2025-11-24 03:08:42.511 +02:00 [DBG] Done attempting to validate the bound parameter 'date' of type 'System.DateTime'.
2025-11-24 03:08:42.511 +02:00 [INF] GetAppointmentsForDoctor called at "2025-11-24T03:08:42.5119049+02:00"
2025-11-24 03:08:42.512 +02:00 [INF] Fetching "2025-11-26"'s appointments for doctor ID 1
2025-11-24 03:08:42.513 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:08:42.514 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:08:42.515 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 03:08:42.515 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:08:42.516 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:08:42.517 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:08:42.518 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:08:42.519 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:08:42.519 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:08:42.529 +02:00 [INF] Executed DbCommand (10ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:08:42.531 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:42.533 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:42.534 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:42.535 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:42.536 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:42.537 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:42.538 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:42.539 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:42.540 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:08:42.540 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 9ms reading results.
2025-11-24 03:08:42.541 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:08:42.542 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:08:42.543 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:08:42.544 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:08:42.545 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:08:42.546 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:08:42.546 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:08:42.547 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Status] = N'Confirmed'
2025-11-24 03:08:42.554 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Status] = N'Confirmed'
2025-11-24 03:08:42.556 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:42.556 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:42.557 +02:00 [DBG] Context 'AppDbContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:42.558 +02:00 [DBG] The navigation 'Patient.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:42.558 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:42.559 +02:00 [DBG] The navigation 'Appointment.Branch' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:42.560 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:08:42.560 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:08:42.561 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 5ms reading results.
2025-11-24 03:08:42.561 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:08:42.562 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:08:42.563 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 03:08:42.564 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 03:08:42.564 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 03:08:42.564 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 03:08:42.565 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 03:08:42.565 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Appointment.AppoinmentandPaientDetaliesDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 03:08:42.566 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital) in 64.5788ms
2025-11-24 03:08:42.566 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)'
2025-11-24 03:08:42.567 +02:00 [DBG] Connection id "0HNHAUKB7C1BF" completed keep alive response.
2025-11-24 03:08:42.568 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:08:42.569 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:08:42.569 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 03:08:42.570 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Doctor/doctor/1/date/2025-11-26 - 200 null application/json; charset=utf-8 82.3592ms
2025-11-24 03:11:04.951 +02:00 [INF] Request starting HTTP/2 PUT https://localhost:7217/api/Doctor/doctor/1/date/2025-11-16 - null 0
2025-11-24 03:11:04.957 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/doctor/1/date/2025-11-16'
2025-11-24 03:11:04.958 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.CancelAppointmentsForDoctorbyDate (Hospital)' with route pattern 'api/Doctor/doctor/{doctorId:int}/date/{date:datetime}' is valid for the request path '/api/Doctor/doctor/1/date/2025-11-16'
2025-11-24 03:11:04.960 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.CancelAppointmentsForDoctorbyDate (Hospital)'
2025-11-24 03:11:04.962 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:11:04.963 +02:00 [DBG] The request has an origin header: 'https://localhost:7217'.
2025-11-24 03:11:04.964 +02:00 [INF] CORS policy execution failed.
2025-11-24 03:11:04.965 +02:00 [INF] Request origin https://localhost:7217 does not have permission to access the resource.
2025-11-24 03:11:04.966 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:11:04.966 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.CancelAppointmentsForDoctorbyDate (Hospital)'
2025-11-24 03:11:04.969 +02:00 [INF] Route matched with {action = "CancelAppointmentsForDoctorbyDate", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CancelAppointmentsForDoctorbyDate(Int32, System.DateTime) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 03:11:04.970 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:11:04.971 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:11:04.971 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:11:04.972 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:11:04.973 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:11:04.973 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:11:04.974 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:11:04.974 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:11:04.975 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' using the name 'doctorId' in request data ...
2025-11-24 03:11:04.975 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:11:04.976 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:11:04.976 +02:00 [DBG] Attempting to validate the bound parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:11:04.978 +02:00 [DBG] Done attempting to validate the bound parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:11:04.978 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateTime' ...
2025-11-24 03:11:04.979 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateTime' using the name 'date' in request data ...
2025-11-24 03:11:04.980 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateTime'.
2025-11-24 03:11:04.980 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateTime'.
2025-11-24 03:11:04.981 +02:00 [DBG] Attempting to validate the bound parameter 'date' of type 'System.DateTime' ...
2025-11-24 03:11:04.981 +02:00 [DBG] Done attempting to validate the bound parameter 'date' of type 'System.DateTime'.
2025-11-24 03:11:04.982 +02:00 [INF] GetAppointmentsForDoctor called at "2025-11-24T03:11:04.9828083+02:00"
2025-11-24 03:11:04.984 +02:00 [INF] Cancelling appointments for doctor ID 1 on date "2025-11-24T01:11:04.9842697Z"
2025-11-24 03:11:04.985 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:11:04.985 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:11:04.986 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 03:11:04.986 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:11:04.986 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:11:04.987 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:11:04.988 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:11:04.989 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:11:04.989 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:11:05.000 +02:00 [INF] Executed DbCommand (11ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:11:05.002 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:05.002 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:05.003 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:05.004 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:05.005 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:05.006 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:05.007 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:05.008 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:05.008 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:11:05.009 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 7ms reading results.
2025-11-24 03:11:05.010 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:11:05.011 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (1ms).
2025-11-24 03:11:05.013 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:11:05.014 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:11:05.014 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:11:05.015 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:11:05.015 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:11:05.016 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Status] = N'Confirmed'
2025-11-24 03:11:05.021 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Status] = N'Confirmed'
2025-11-24 03:11:05.023 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:11:05.024 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 1ms reading results.
2025-11-24 03:11:05.024 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:11:05.025 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:11:05.027 +02:00 [INF] No appointments found for doctor ID 1 on date "2025-11-24T01:11:05.0270394Z"
2025-11-24 03:11:05.027 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 03:11:05.030 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 03:11:05.030 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 03:11:05.031 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 03:11:05.031 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter' and content type 'text/plain' to write the response.
2025-11-24 03:11:05.031 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.String'.
2025-11-24 03:11:05.033 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.CancelAppointmentsForDoctorbyDate (Hospital) in 59.234ms
2025-11-24 03:11:05.033 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.CancelAppointmentsForDoctorbyDate (Hospital)'
2025-11-24 03:11:05.034 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:11:05.035 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:11:05.035 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 03:11:05.036 +02:00 [INF] Request finished HTTP/2 PUT https://localhost:7217/api/Doctor/doctor/1/date/2025-11-16 - 200 null text/plain; charset=utf-8 85.3496ms
2025-11-24 03:11:14.916 +02:00 [INF] Request starting HTTP/2 PUT https://localhost:7217/api/Doctor/doctor/1/date/2025-11-26 - null 0
2025-11-24 03:11:14.917 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/doctor/1/date/2025-11-26'
2025-11-24 03:11:14.918 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.CancelAppointmentsForDoctorbyDate (Hospital)' with route pattern 'api/Doctor/doctor/{doctorId:int}/date/{date:datetime}' is valid for the request path '/api/Doctor/doctor/1/date/2025-11-26'
2025-11-24 03:11:14.920 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.CancelAppointmentsForDoctorbyDate (Hospital)'
2025-11-24 03:11:14.921 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:11:14.922 +02:00 [DBG] The request has an origin header: 'https://localhost:7217'.
2025-11-24 03:11:14.922 +02:00 [INF] CORS policy execution failed.
2025-11-24 03:11:14.922 +02:00 [INF] Request origin https://localhost:7217 does not have permission to access the resource.
2025-11-24 03:11:14.923 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:11:14.923 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.CancelAppointmentsForDoctorbyDate (Hospital)'
2025-11-24 03:11:14.924 +02:00 [INF] Route matched with {action = "CancelAppointmentsForDoctorbyDate", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CancelAppointmentsForDoctorbyDate(Int32, System.DateTime) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 03:11:14.925 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:11:14.926 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:11:14.927 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:11:14.929 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:11:14.930 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:11:14.932 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:11:14.934 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:11:14.934 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:11:14.935 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' using the name 'doctorId' in request data ...
2025-11-24 03:11:14.935 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:11:14.936 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:11:14.937 +02:00 [DBG] Attempting to validate the bound parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:11:14.937 +02:00 [DBG] Done attempting to validate the bound parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:11:14.938 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateTime' ...
2025-11-24 03:11:14.939 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateTime' using the name 'date' in request data ...
2025-11-24 03:11:14.939 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateTime'.
2025-11-24 03:11:14.940 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateTime'.
2025-11-24 03:11:14.940 +02:00 [DBG] Attempting to validate the bound parameter 'date' of type 'System.DateTime' ...
2025-11-24 03:11:14.941 +02:00 [DBG] Done attempting to validate the bound parameter 'date' of type 'System.DateTime'.
2025-11-24 03:11:14.941 +02:00 [INF] GetAppointmentsForDoctor called at "2025-11-24T03:11:14.9417938+02:00"
2025-11-24 03:11:14.942 +02:00 [INF] Cancelling appointments for doctor ID 1 on date "2025-11-24T01:11:14.9421398Z"
2025-11-24 03:11:14.943 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:11:14.944 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:11:14.945 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 03:11:14.945 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:11:14.946 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:11:14.946 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:11:14.947 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:11:14.947 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:11:14.948 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:11:14.951 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:11:14.953 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:14.954 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:14.954 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:14.955 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:14.955 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:14.956 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:14.956 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:14.957 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:14.958 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:11:14.958 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 5ms reading results.
2025-11-24 03:11:14.960 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:11:14.960 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:11:14.961 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:11:14.962 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:11:14.962 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:11:14.963 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:11:14.963 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:11:14.963 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Status] = N'Confirmed'
2025-11-24 03:11:14.966 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Status] = N'Confirmed'
2025-11-24 03:11:14.972 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:14.972 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:14.973 +02:00 [DBG] Context 'AppDbContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:14.973 +02:00 [DBG] The navigation 'Patient.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:14.974 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:14.975 +02:00 [DBG] The navigation 'Appointment.Branch' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:14.976 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:14.977 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:11:14.977 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 5ms reading results.
2025-11-24 03:11:14.978 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:11:14.979 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:11:16.799 +02:00 [DBG] An entity of type 'Appointment' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:16.800 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 03:11:16.801 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 03:11:16.802 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 03:11:16.802 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 03:11:16.803 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 03:11:16.803 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:11:16.804 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:11:16.804 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:11:16.805 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:11:16.806 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:11:16.806 +02:00 [DBG] Executing DbCommand [Parameters=[@p11='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 450), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (Size = 4000), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (Size = 20), @p9='?' (DbType = DateTime2), @p10='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Appointments] SET [BranchId] = @p0, [CreatedAt] = @p1, [CreatedBy] = @p2, [Date] = @p3, [DoctorId] = @p4, [Notes] = @p5, [PatientId] = @p6, [PaymentMethod] = @p7, [Status] = @p8, [Time] = @p9, [UpdatedAt] = @p10
OUTPUT 1
WHERE [AppointmentId] = @p11;
2025-11-24 03:11:16.822 +02:00 [INF] Executed DbCommand (16ms) [Parameters=[@p11='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 450), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (Size = 4000), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (Size = 20), @p9='?' (DbType = DateTime2), @p10='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Appointments] SET [BranchId] = @p0, [CreatedAt] = @p1, [CreatedBy] = @p2, [Date] = @p3, [DoctorId] = @p4, [Notes] = @p5, [PatientId] = @p6, [PaymentMethod] = @p7, [Status] = @p8, [Time] = @p9, [UpdatedAt] = @p10
OUTPUT 1
WHERE [AppointmentId] = @p11;
2025-11-24 03:11:16.823 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:11:16.824 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 0ms reading results.
2025-11-24 03:11:16.824 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:11:16.825 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:11:16.825 +02:00 [DBG] An entity of type 'Appointment' tracked by 'AppDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:16.826 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 03:11:16.827 +02:00 [INF] Cancelled 1 appointments for doctor ID 1 on date "2025-11-24T01:11:16.8274585Z"
2025-11-24 03:11:16.828 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 03:11:16.829 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 03:11:16.829 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 03:11:16.830 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 03:11:16.830 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter' and content type 'text/plain' to write the response.
2025-11-24 03:11:16.831 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.String'.
2025-11-24 03:11:16.831 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.CancelAppointmentsForDoctorbyDate (Hospital) in 1899.7157ms
2025-11-24 03:11:16.832 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.CancelAppointmentsForDoctorbyDate (Hospital)'
2025-11-24 03:11:16.833 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:11:16.833 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:11:16.834 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 03:11:16.835 +02:00 [INF] Request finished HTTP/2 PUT https://localhost:7217/api/Doctor/doctor/1/date/2025-11-26 - 200 null text/plain; charset=utf-8 1919.2496ms
2025-11-24 03:11:28.066 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/api/Appointment/GetAll - null null
2025-11-24 03:11:28.072 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Appointment/GetAll'
2025-11-24 03:11:28.073 +02:00 [DBG] Endpoint 'Hospital.API.Controllers.AppointmentController.GetAll (Hospital)' with route pattern 'api/Appointment/GetAll' is valid for the request path '/api/Appointment/GetAll'
2025-11-24 03:11:28.074 +02:00 [DBG] Request matched endpoint 'Hospital.API.Controllers.AppointmentController.GetAll (Hospital)'
2025-11-24 03:11:28.074 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:11:28.075 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:11:28.075 +02:00 [INF] Executing endpoint 'Hospital.API.Controllers.AppointmentController.GetAll (Hospital)'
2025-11-24 03:11:28.078 +02:00 [INF] Route matched with {action = "GetAll", controller = "Appointment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll() on controller Hospital.API.Controllers.AppointmentController (Hospital).
2025-11-24 03:11:28.080 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:11:28.081 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:11:28.081 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:11:28.082 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:11:28.083 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:11:28.083 +02:00 [DBG] Executing controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 03:11:28.084 +02:00 [DBG] Executed controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 03:11:28.085 +02:00 [INF] Get All Appointments called at "2025-11-24T03:11:28.0856422+02:00"
2025-11-24 03:11:28.087 +02:00 [INF] Fetching all appointments
2025-11-24 03:11:28.089 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:11:28.090 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:11:28.091 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 03:11:28.091 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:11:28.092 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:11:28.092 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:11:28.093 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:11:28.093 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:11:28.094 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Doctors] AS [d] ON [a].[DoctorId] = [d].[DoctorId]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
2025-11-24 03:11:28.101 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Doctors] AS [d] ON [a].[DoctorId] = [d].[DoctorId]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
2025-11-24 03:11:28.102 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:28.103 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:28.103 +02:00 [DBG] Context 'AppDbContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:28.104 +02:00 [DBG] The navigation 'Appointment.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:28.104 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:28.105 +02:00 [DBG] The navigation 'Appointment.Branch' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:28.105 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:28.106 +02:00 [DBG] The navigation 'Appointment.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:28.107 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:28.107 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:28.108 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:28.110 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:28.111 +02:00 [DBG] The navigation 'Appointment.Branch' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:28.111 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:28.112 +02:00 [DBG] The navigation 'Appointment.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:28.113 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:28.113 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:28.114 +02:00 [DBG] The navigation 'Appointment.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:28.115 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:28.116 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:28.119 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:11:28.120 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 17ms reading results.
2025-11-24 03:11:28.120 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:11:28.121 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:11:28.122 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 03:11:28.123 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 03:11:28.123 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 03:11:28.124 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 03:11:28.125 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 03:11:28.126 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Appointment.AppointmentDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 03:11:28.128 +02:00 [INF] Executed action Hospital.API.Controllers.AppointmentController.GetAll (Hospital) in 44.2385ms
2025-11-24 03:11:28.128 +02:00 [INF] Executed endpoint 'Hospital.API.Controllers.AppointmentController.GetAll (Hospital)'
2025-11-24 03:11:28.129 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:11:28.130 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:11:28.130 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 03:11:28.131 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/api/Appointment/GetAll - 200 null application/json; charset=utf-8 64.9683ms
2025-11-24 03:11:46.486 +02:00 [DBG] Connection id "0HNHAUKB7C1BG" accepted.
2025-11-24 03:11:46.486 +02:00 [DBG] Connection id "0HNHAUKB7C1BG" received FIN.
2025-11-24 03:11:46.487 +02:00 [DBG] Connection id "0HNHAUKB7C1BG" started.
2025-11-24 03:11:46.491 +02:00 [DBG] Connection id "0HNHAUKB7C1BH" accepted.
2025-11-24 03:11:46.494 +02:00 [DBG] Connection id "0HNHAUKB7C1BH" started.
2025-11-24 03:11:46.494 +02:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-11-24 03:11:46.498 +02:00 [DBG] Connection id "0HNHAUKB7C1BG" stopped.
2025-11-24 03:11:46.499 +02:00 [DBG] Connection id "0HNHAUKB7C1BG" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-11-24 03:11:46.500 +02:00 [DBG] Connection 0HNHAUKB7C1BH established using the following protocol: "Tls12"
2025-11-24 03:11:46.501 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Appointment/GetAll - null null
2025-11-24 03:11:46.502 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Appointment/GetAll'
2025-11-24 03:11:46.502 +02:00 [DBG] Endpoint 'Hospital.API.Controllers.AppointmentController.GetAll (Hospital)' with route pattern 'api/Appointment/GetAll' is valid for the request path '/api/Appointment/GetAll'
2025-11-24 03:11:46.503 +02:00 [DBG] Request matched endpoint 'Hospital.API.Controllers.AppointmentController.GetAll (Hospital)'
2025-11-24 03:11:46.504 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:11:46.504 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:11:46.505 +02:00 [INF] Executing endpoint 'Hospital.API.Controllers.AppointmentController.GetAll (Hospital)'
2025-11-24 03:11:46.505 +02:00 [INF] Route matched with {action = "GetAll", controller = "Appointment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll() on controller Hospital.API.Controllers.AppointmentController (Hospital).
2025-11-24 03:11:46.506 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:11:46.507 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:11:46.509 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:11:46.510 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:11:46.510 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:11:46.511 +02:00 [DBG] Executing controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 03:11:46.512 +02:00 [DBG] Executed controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 03:11:46.513 +02:00 [INF] Get All Appointments called at "2025-11-24T03:11:46.5132773+02:00"
2025-11-24 03:11:46.513 +02:00 [INF] Fetching all appointments
2025-11-24 03:11:46.514 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:11:46.515 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:11:46.515 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 03:11:46.516 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:11:46.516 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:11:46.517 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:11:46.519 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:11:46.519 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:11:46.520 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Doctors] AS [d] ON [a].[DoctorId] = [d].[DoctorId]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
2025-11-24 03:11:46.523 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Doctors] AS [d] ON [a].[DoctorId] = [d].[DoctorId]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
2025-11-24 03:11:46.525 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:46.526 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:46.526 +02:00 [DBG] Context 'AppDbContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:46.528 +02:00 [DBG] The navigation 'Appointment.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:46.529 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:46.530 +02:00 [DBG] The navigation 'Appointment.Branch' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:46.531 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:46.532 +02:00 [DBG] The navigation 'Appointment.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:46.533 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:46.535 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:46.535 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:46.536 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:46.536 +02:00 [DBG] The navigation 'Appointment.Branch' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:46.537 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:46.538 +02:00 [DBG] The navigation 'Appointment.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:46.538 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:46.539 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:46.540 +02:00 [DBG] The navigation 'Appointment.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:46.541 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:46.542 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:11:46.542 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:11:46.543 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 17ms reading results.
2025-11-24 03:11:46.543 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:11:46.544 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:11:46.545 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 03:11:46.546 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 03:11:46.546 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 03:11:46.546 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 03:11:46.547 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 03:11:46.547 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Appointment.AppointmentDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 03:11:46.549 +02:00 [INF] Executed action Hospital.API.Controllers.AppointmentController.GetAll (Hospital) in 37.7614ms
2025-11-24 03:11:46.550 +02:00 [INF] Executed endpoint 'Hospital.API.Controllers.AppointmentController.GetAll (Hospital)'
2025-11-24 03:11:46.551 +02:00 [DBG] Connection id "0HNHAUKB7C1BH" completed keep alive response.
2025-11-24 03:11:46.551 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:11:46.552 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:11:46.552 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 03:11:46.553 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Appointment/GetAll - 200 null application/json; charset=utf-8 52.2167ms
2025-11-24 03:13:36.076 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/swagger/index.html - null null
2025-11-24 03:13:36.083 +02:00 [DBG] No candidates found for the request path '/swagger/index.html'
2025-11-24 03:13:36.083 +02:00 [DBG] Request did not match any endpoints
2025-11-24 03:13:36.084 +02:00 [DBG] Response markup is scheduled to include Browser Link script injection.
2025-11-24 03:13:36.084 +02:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2025-11-24 03:13:36.092 +02:00 [DBG] Response markup was updated to include Browser Link script injection.
2025-11-24 03:13:36.093 +02:00 [DBG] Response markup was updated to include browser refresh script injection.
2025-11-24 03:13:36.094 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/swagger/index.html - 200 null text/html;charset=utf-8 18.1928ms
2025-11-24 03:13:36.110 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/_framework/aspnetcore-browser-refresh.js - null null
2025-11-24 03:13:36.113 +02:00 [DBG] Script injected: /_framework/aspnetcore-browser-refresh.js
2025-11-24 03:13:36.113 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/_vs/browserLink - null null
2025-11-24 03:13:36.114 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/_framework/aspnetcore-browser-refresh.js - 200 16501 application/javascript; charset=utf-8 3.6959ms
2025-11-24 03:13:36.134 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/_vs/browserLink - 200 null text/javascript; charset=UTF-8 21.3747ms
2025-11-24 03:13:36.201 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/swagger/v1/swagger.json - null null
2025-11-24 03:13:36.204 +02:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2025-11-24 03:13:36.205 +02:00 [DBG] Request did not match any endpoints
2025-11-24 03:13:36.244 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 43.1963ms
2025-11-24 03:14:06.171 +02:00 [INF] Request starting HTTP/2 PUT https://localhost:7217/api/Doctor/CancelAppointment/doctor/1/date/2025-11-24 - null 0
2025-11-24 03:14:06.174 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/CancelAppointment/doctor/1/date/2025-11-24'
2025-11-24 03:14:06.176 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.CancelAppointmentsForDoctorbyDate (Hospital)' with route pattern 'api/Doctor/CancelAppointment/doctor/{doctorId:int}/date/{date:datetime}' is valid for the request path '/api/Doctor/CancelAppointment/doctor/1/date/2025-11-24'
2025-11-24 03:14:06.178 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.CancelAppointmentsForDoctorbyDate (Hospital)'
2025-11-24 03:14:06.179 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:14:06.180 +02:00 [DBG] The request has an origin header: 'https://localhost:7217'.
2025-11-24 03:14:06.180 +02:00 [INF] CORS policy execution failed.
2025-11-24 03:14:06.181 +02:00 [INF] Request origin https://localhost:7217 does not have permission to access the resource.
2025-11-24 03:14:06.182 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:14:06.182 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.CancelAppointmentsForDoctorbyDate (Hospital)'
2025-11-24 03:14:06.186 +02:00 [INF] Route matched with {action = "CancelAppointmentsForDoctorbyDate", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CancelAppointmentsForDoctorbyDate(Int32, System.DateTime) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 03:14:06.188 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:14:06.189 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:14:06.190 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:14:06.192 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:14:06.192 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:14:06.193 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:14:06.194 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:14:06.194 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:14:06.195 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' using the name 'doctorId' in request data ...
2025-11-24 03:14:06.195 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:14:06.196 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:14:06.197 +02:00 [DBG] Attempting to validate the bound parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:14:06.198 +02:00 [DBG] Done attempting to validate the bound parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:14:06.199 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateTime' ...
2025-11-24 03:14:06.200 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateTime' using the name 'date' in request data ...
2025-11-24 03:14:06.200 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateTime'.
2025-11-24 03:14:06.201 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateTime'.
2025-11-24 03:14:06.202 +02:00 [DBG] Attempting to validate the bound parameter 'date' of type 'System.DateTime' ...
2025-11-24 03:14:06.202 +02:00 [DBG] Done attempting to validate the bound parameter 'date' of type 'System.DateTime'.
2025-11-24 03:14:06.204 +02:00 [INF] GetAppointmentsForDoctor called at "2025-11-24T03:14:06.2040877+02:00"
2025-11-24 03:14:06.204 +02:00 [INF] Cancelling appointments for doctor ID 1 on date "2025-11-24T01:14:06.2045240Z"
2025-11-24 03:14:06.205 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:14:06.207 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:14:06.208 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 03:14:06.208 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:14:06.210 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:14:06.210 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:14:06.211 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:14:06.211 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:14:06.213 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:14:06.224 +02:00 [INF] Executed DbCommand (12ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:14:06.226 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:14:06.227 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:14:06.227 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:14:06.229 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:14:06.229 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:14:06.230 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:14:06.230 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:14:06.231 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:14:06.232 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:14:06.232 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 5ms reading results.
2025-11-24 03:14:06.233 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:14:06.234 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:14:06.235 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:14:06.236 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:14:06.237 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:14:06.237 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:14:06.239 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:14:06.239 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Status] = N'Confirmed'
2025-11-24 03:14:06.245 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Status] = N'Confirmed'
2025-11-24 03:14:06.247 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:14:06.248 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:14:06.249 +02:00 [DBG] Context 'AppDbContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:14:06.250 +02:00 [DBG] The navigation 'Patient.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:14:06.251 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:14:06.252 +02:00 [DBG] The navigation 'Appointment.Branch' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:14:06.253 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:14:06.254 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:14:06.254 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 7ms reading results.
2025-11-24 03:14:06.255 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:14:06.256 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:14:08.863 +02:00 [DBG] An entity of type 'Appointment' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:14:08.866 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 03:14:08.867 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 03:14:08.868 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 03:14:08.869 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 03:14:08.870 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 03:14:08.871 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:14:08.871 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:14:08.872 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:14:08.872 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:14:08.873 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:14:08.873 +02:00 [DBG] Executing DbCommand [Parameters=[@p11='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 450), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (Size = 4000), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (Size = 20), @p9='?' (DbType = DateTime2), @p10='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Appointments] SET [BranchId] = @p0, [CreatedAt] = @p1, [CreatedBy] = @p2, [Date] = @p3, [DoctorId] = @p4, [Notes] = @p5, [PatientId] = @p6, [PaymentMethod] = @p7, [Status] = @p8, [Time] = @p9, [UpdatedAt] = @p10
OUTPUT 1
WHERE [AppointmentId] = @p11;
2025-11-24 03:14:08.880 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@p11='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 450), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (Size = 4000), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (Size = 20), @p9='?' (DbType = DateTime2), @p10='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Appointments] SET [BranchId] = @p0, [CreatedAt] = @p1, [CreatedBy] = @p2, [Date] = @p3, [DoctorId] = @p4, [Notes] = @p5, [PatientId] = @p6, [PaymentMethod] = @p7, [Status] = @p8, [Time] = @p9, [UpdatedAt] = @p10
OUTPUT 1
WHERE [AppointmentId] = @p11;
2025-11-24 03:14:08.881 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:14:08.882 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 0ms reading results.
2025-11-24 03:14:08.883 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:14:08.884 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (1ms).
2025-11-24 03:14:08.885 +02:00 [DBG] An entity of type 'Appointment' tracked by 'AppDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:14:08.886 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-11-24 03:14:08.886 +02:00 [INF] Cancelled 1 appointments for doctor ID 1 on date "2025-11-24T01:14:08.8867682Z"
2025-11-24 03:14:08.887 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 03:14:08.888 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 03:14:08.888 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 03:14:08.889 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 03:14:08.889 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter' and content type 'text/plain' to write the response.
2025-11-24 03:14:08.890 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.String'.
2025-11-24 03:14:08.890 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.CancelAppointmentsForDoctorbyDate (Hospital) in 2697.5488ms
2025-11-24 03:14:08.891 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.CancelAppointmentsForDoctorbyDate (Hospital)'
2025-11-24 03:14:08.892 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:14:08.892 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:14:08.893 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 03:14:08.894 +02:00 [INF] Request finished HTTP/2 PUT https://localhost:7217/api/Doctor/CancelAppointment/doctor/1/date/2025-11-24 - 200 null text/plain; charset=utf-8 2722.7669ms
2025-11-24 03:14:28.706 +02:00 [DBG] Connection id "0HNHAUKB7C1BI" received FIN.
2025-11-24 03:14:28.707 +02:00 [DBG] Connection id "0HNHAUKB7C1BI" accepted.
2025-11-24 03:14:28.708 +02:00 [DBG] Connection id "0HNHAUKB7C1BI" started.
2025-11-24 03:14:28.709 +02:00 [DBG] Connection id "0HNHAUKB7C1BJ" accepted.
2025-11-24 03:14:28.714 +02:00 [DBG] Connection id "0HNHAUKB7C1BJ" started.
2025-11-24 03:14:28.714 +02:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-11-24 03:14:28.718 +02:00 [DBG] Connection id "0HNHAUKB7C1BI" stopped.
2025-11-24 03:14:28.719 +02:00 [DBG] Connection id "0HNHAUKB7C1BI" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-11-24 03:14:28.721 +02:00 [DBG] Connection 0HNHAUKB7C1BJ established using the following protocol: "Tls12"
2025-11-24 03:14:28.721 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Doctor/CancelAppointment/doctor/1/date/2025-11-24 - null null
2025-11-24 03:14:28.724 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/CancelAppointment/doctor/1/date/2025-11-24'
2025-11-24 03:14:28.725 +02:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2025-11-24 03:14:28.725 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:14:28.725 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:14:28.726 +02:00 [INF] Executing endpoint '405 HTTP Method Not Supported'
2025-11-24 03:14:28.726 +02:00 [INF] Executed endpoint '405 HTTP Method Not Supported'
2025-11-24 03:14:28.727 +02:00 [DBG] Connection id "0HNHAUKB7C1BJ" completed keep alive response.
2025-11-24 03:14:28.727 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Doctor/CancelAppointment/doctor/1/date/2025-11-24 - 405 0 null 5.6196ms
2025-11-24 03:14:59.424 +02:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7217/api/Doctor/CancelAppointment/doctor/1/date/2025-11-24 - null 0
2025-11-24 03:14:59.426 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/CancelAppointment/doctor/1/date/2025-11-24'
2025-11-24 03:14:59.427 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.CancelAppointmentsForDoctorbyDate (Hospital)' with route pattern 'api/Doctor/CancelAppointment/doctor/{doctorId:int}/date/{date:datetime}' is valid for the request path '/api/Doctor/CancelAppointment/doctor/1/date/2025-11-24'
2025-11-24 03:14:59.429 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.CancelAppointmentsForDoctorbyDate (Hospital)'
2025-11-24 03:14:59.429 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:14:59.430 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:14:59.430 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.CancelAppointmentsForDoctorbyDate (Hospital)'
2025-11-24 03:14:59.431 +02:00 [INF] Route matched with {action = "CancelAppointmentsForDoctorbyDate", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CancelAppointmentsForDoctorbyDate(Int32, System.DateTime) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 03:14:59.432 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:14:59.433 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:14:59.433 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:14:59.434 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:14:59.435 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:14:59.436 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:14:59.437 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:14:59.438 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:14:59.438 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' using the name 'doctorId' in request data ...
2025-11-24 03:14:59.439 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:14:59.439 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:14:59.440 +02:00 [DBG] Attempting to validate the bound parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:14:59.441 +02:00 [DBG] Done attempting to validate the bound parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:14:59.441 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateTime' ...
2025-11-24 03:14:59.442 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateTime' using the name 'date' in request data ...
2025-11-24 03:14:59.442 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateTime'.
2025-11-24 03:14:59.443 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateTime'.
2025-11-24 03:14:59.443 +02:00 [DBG] Attempting to validate the bound parameter 'date' of type 'System.DateTime' ...
2025-11-24 03:14:59.444 +02:00 [DBG] Done attempting to validate the bound parameter 'date' of type 'System.DateTime'.
2025-11-24 03:14:59.445 +02:00 [INF] GetAppointmentsForDoctor called at "2025-11-24T03:14:59.4450201+02:00"
2025-11-24 03:14:59.445 +02:00 [INF] Cancelling appointments for doctor ID 1 on date "2025-11-24T01:14:59.4453660Z"
2025-11-24 03:14:59.447 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:14:59.448 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:14:59.449 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 03:14:59.449 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:14:59.450 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:14:59.450 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:14:59.451 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:14:59.451 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:14:59.452 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:14:59.462 +02:00 [INF] Executed DbCommand (10ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:14:59.464 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:14:59.465 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:14:59.465 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:14:59.466 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:14:59.466 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:14:59.467 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:14:59.468 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:14:59.469 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:14:59.469 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:14:59.470 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 5ms reading results.
2025-11-24 03:14:59.470 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:14:59.471 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:14:59.471 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:14:59.472 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:14:59.472 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:14:59.473 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:14:59.473 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:14:59.474 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Status] = N'Confirmed'
2025-11-24 03:14:59.479 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Status] = N'Confirmed'
2025-11-24 03:14:59.481 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:14:59.481 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 0ms reading results.
2025-11-24 03:14:59.482 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:14:59.483 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:14:59.484 +02:00 [INF] No appointments found for doctor ID 1 on date "2025-11-24T01:14:59.4841221Z"
2025-11-24 03:14:59.484 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 03:14:59.486 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 03:14:59.486 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 03:14:59.487 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 03:14:59.487 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter' and content type 'text/plain' to write the response.
2025-11-24 03:14:59.488 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.String'.
2025-11-24 03:14:59.488 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.CancelAppointmentsForDoctorbyDate (Hospital) in 52.5421ms
2025-11-24 03:14:59.489 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.CancelAppointmentsForDoctorbyDate (Hospital)'
2025-11-24 03:14:59.490 +02:00 [DBG] Connection id "0HNHAUKB7C1BJ" completed keep alive response.
2025-11-24 03:14:59.491 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:14:59.492 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:14:59.492 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 03:14:59.493 +02:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7217/api/Doctor/CancelAppointment/doctor/1/date/2025-11-24 - 200 null text/plain; charset=utf-8 68.7974ms
2025-11-24 03:15:57.554 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Doctor/1/today - null null
2025-11-24 03:15:57.557 +02:00 [DBG] No candidates found for the request path '/api/Doctor/1/today'
2025-11-24 03:15:57.557 +02:00 [DBG] Request did not match any endpoints
2025-11-24 03:15:57.558 +02:00 [DBG] The request path  does not match the path filter
2025-11-24 03:15:57.558 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:15:57.559 +02:00 [DBG] Connection id "0HNHAUKB7C1BJ" completed keep alive response.
2025-11-24 03:15:57.559 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Doctor/1/today - 404 0 null 5.0059ms
2025-11-24 03:15:57.561 +02:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7217/api/Doctor/1/today, Response status code: 404
2025-11-24 03:16:08.482 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Doctor/2/today - null null
2025-11-24 03:16:08.483 +02:00 [DBG] No candidates found for the request path '/api/Doctor/2/today'
2025-11-24 03:16:08.483 +02:00 [DBG] Request did not match any endpoints
2025-11-24 03:16:08.484 +02:00 [DBG] The request path  does not match the path filter
2025-11-24 03:16:08.484 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:16:08.484 +02:00 [DBG] Connection id "0HNHAUKB7C1BJ" completed keep alive response.
2025-11-24 03:16:08.485 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Doctor/2/today - 404 0 null 3.0123ms
2025-11-24 03:16:08.486 +02:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7217/api/Doctor/2/today, Response status code: 404
2025-11-24 03:16:18.340 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/swagger/index.html - null null
2025-11-24 03:16:18.345 +02:00 [DBG] No candidates found for the request path '/swagger/index.html'
2025-11-24 03:16:18.345 +02:00 [DBG] Request did not match any endpoints
2025-11-24 03:16:18.346 +02:00 [DBG] Response markup is scheduled to include Browser Link script injection.
2025-11-24 03:16:18.347 +02:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2025-11-24 03:16:18.348 +02:00 [DBG] Response markup was updated to include Browser Link script injection.
2025-11-24 03:16:18.353 +02:00 [DBG] Response markup was updated to include browser refresh script injection.
2025-11-24 03:16:18.354 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/swagger/index.html - 200 null text/html;charset=utf-8 13.9424ms
2025-11-24 03:16:18.371 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/_framework/aspnetcore-browser-refresh.js - null null
2025-11-24 03:16:18.374 +02:00 [DBG] Script injected: /_framework/aspnetcore-browser-refresh.js
2025-11-24 03:16:18.374 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/_vs/browserLink - null null
2025-11-24 03:16:18.375 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/_framework/aspnetcore-browser-refresh.js - 200 16501 application/javascript; charset=utf-8 3.7498ms
2025-11-24 03:16:18.386 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/_vs/browserLink - 200 null text/javascript; charset=UTF-8 11.9471ms
2025-11-24 03:16:18.454 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/swagger/v1/swagger.json - null null
2025-11-24 03:16:18.456 +02:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2025-11-24 03:16:18.457 +02:00 [DBG] Request did not match any endpoints
2025-11-24 03:16:18.480 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 26.7335ms
2025-11-24 03:16:22.733 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Doctor/2/today - null null
2025-11-24 03:16:22.735 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/2/today'
2025-11-24 03:16:22.736 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital)' with route pattern 'api/Doctor/{doctorId:int}/today' is valid for the request path '/api/Doctor/2/today'
2025-11-24 03:16:22.736 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital)'
2025-11-24 03:16:22.737 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:16:22.737 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:16:22.739 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital)'
2025-11-24 03:16:22.743 +02:00 [INF] Route matched with {action = "GetTodayAppointmentsForDoctor", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetTodayAppointmentsForDoctor(Int32) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 03:16:22.744 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:16:22.745 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:16:22.746 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:16:22.747 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:16:22.748 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:16:22.749 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:16:22.750 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:16:22.750 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:16:22.751 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' using the name 'doctorId' in request data ...
2025-11-24 03:16:22.751 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:16:22.752 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:16:22.754 +02:00 [DBG] Attempting to validate the bound parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:16:22.755 +02:00 [DBG] Done attempting to validate the bound parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:16:22.756 +02:00 [INF] GetTodayAppointmentsForDoctor  called at "2025-11-24T03:16:22.7564387+02:00"
2025-11-24 03:16:22.756 +02:00 [INF] Fetching today's appointments for doctor ID 2
2025-11-24 03:16:22.757 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:16:22.758 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:16:22.759 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 03:16:22.759 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:16:22.760 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:16:22.761 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:16:22.761 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:16:22.762 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:16:22.762 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:16:22.773 +02:00 [INF] Executed DbCommand (10ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:16:22.775 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:16:22.776 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 0ms reading results.
2025-11-24 03:16:22.777 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:16:22.778 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:16:22.779 +02:00 [WRN] Doctor with ID 2 does not exist
2025-11-24 03:16:22.820 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital) in 70.9695ms
2025-11-24 03:16:22.822 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital)'
2025-11-24 03:16:22.871 +02:00 [ERR]  Exception caught: Doctor with ID 2 does not exist.
System.Collections.Generic.KeyNotFoundException: Doctor with ID 2 does not exist.
   at Hospital.Infrastructure.Services.DoctorService.GetTodayForDoctorAsync(Int32 doctorId) in D:\Walaa\GP\Hospital\Hospital.Infrastructure\Services\DoctorService.cs:line 299
   at Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor(Int32 doctorId)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Hospital.Middleware.GlobalExceptionHandler.InvokeAsync(HttpContext context)
2025-11-24 03:16:22.879 +02:00 [DBG] Connection id "0HNHAUKB7C1BJ" completed keep alive response.
2025-11-24 03:16:22.880 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:16:22.880 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:16:22.881 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 03:16:22.882 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Doctor/2/today - 404 null application/json 148.4602ms
2025-11-24 03:16:28.274 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Doctor/1/today - null null
2025-11-24 03:16:28.278 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/1/today'
2025-11-24 03:16:28.279 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital)' with route pattern 'api/Doctor/{doctorId:int}/today' is valid for the request path '/api/Doctor/1/today'
2025-11-24 03:16:28.281 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital)'
2025-11-24 03:16:28.282 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:16:28.282 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:16:28.283 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital)'
2025-11-24 03:16:28.283 +02:00 [INF] Route matched with {action = "GetTodayAppointmentsForDoctor", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetTodayAppointmentsForDoctor(Int32) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 03:16:28.284 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:16:28.285 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:16:28.285 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:16:28.287 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:16:28.288 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:16:28.291 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:16:28.293 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:16:28.294 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:16:28.295 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' using the name 'doctorId' in request data ...
2025-11-24 03:16:28.297 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:16:28.298 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:16:28.299 +02:00 [DBG] Attempting to validate the bound parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:16:28.300 +02:00 [DBG] Done attempting to validate the bound parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:16:28.301 +02:00 [INF] GetTodayAppointmentsForDoctor  called at "2025-11-24T03:16:28.3012995+02:00"
2025-11-24 03:16:28.301 +02:00 [INF] Fetching today's appointments for doctor ID 1
2025-11-24 03:16:28.303 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:16:28.304 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:16:28.305 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 03:16:28.305 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:16:28.306 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:16:28.306 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:16:28.307 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:16:28.308 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:16:28.308 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:16:28.312 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:16:28.315 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:16:28.316 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:16:28.316 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:16:28.317 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:16:28.317 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:16:28.318 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:16:28.319 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:16:28.320 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:16:28.321 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:16:28.321 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 6ms reading results.
2025-11-24 03:16:28.322 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:16:28.322 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:16:28.323 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:16:28.324 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:16:28.324 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:16:28.325 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:16:28.325 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:16:28.326 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Status] = N'Confirmed'
2025-11-24 03:16:28.333 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Status] = N'Confirmed'
2025-11-24 03:16:28.336 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:16:28.336 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 0ms reading results.
2025-11-24 03:16:28.337 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:16:28.338 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:16:28.338 +02:00 [INF] No appointments found for doctor ID 1 today
2025-11-24 03:16:28.339 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 03:16:28.340 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 03:16:28.341 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 03:16:28.341 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 03:16:28.342 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 03:16:28.343 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Appointment.AppoinmentandPaientDetaliesDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 03:16:28.345 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital) in 54.0299ms
2025-11-24 03:16:28.345 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital)'
2025-11-24 03:16:28.346 +02:00 [DBG] Connection id "0HNHAUKB7C1BJ" completed keep alive response.
2025-11-24 03:16:28.346 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:16:28.347 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:16:28.348 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 03:16:28.349 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Doctor/1/today - 200 null application/json; charset=utf-8 75.0321ms
2025-11-24 03:16:44.822 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Doctor/1/date/2025-11-24 - null null
2025-11-24 03:16:44.826 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/1/date/2025-11-24'
2025-11-24 03:16:44.826 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)' with route pattern 'api/Doctor/{doctorId:int}/date/{date:datetime}' is valid for the request path '/api/Doctor/1/date/2025-11-24'
2025-11-24 03:16:44.827 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)'
2025-11-24 03:16:44.828 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:16:44.829 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:16:44.829 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)'
2025-11-24 03:16:44.832 +02:00 [INF] Route matched with {action = "GetAppointmentsForDoctor", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAppointmentsForDoctor(Int32, System.DateTime) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 03:16:44.833 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:16:44.834 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:16:44.834 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:16:44.835 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:16:44.836 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:16:44.836 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:16:44.837 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:16:44.838 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:16:44.839 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' using the name 'doctorId' in request data ...
2025-11-24 03:16:44.839 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:16:44.840 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:16:44.840 +02:00 [DBG] Attempting to validate the bound parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:16:44.841 +02:00 [DBG] Done attempting to validate the bound parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:16:44.842 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateTime' ...
2025-11-24 03:16:44.844 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateTime' using the name 'date' in request data ...
2025-11-24 03:16:44.845 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateTime'.
2025-11-24 03:16:44.845 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateTime'.
2025-11-24 03:16:44.846 +02:00 [DBG] Attempting to validate the bound parameter 'date' of type 'System.DateTime' ...
2025-11-24 03:16:44.847 +02:00 [DBG] Done attempting to validate the bound parameter 'date' of type 'System.DateTime'.
2025-11-24 03:16:44.848 +02:00 [INF] GetAppointmentsForDoctor called at "2025-11-24T03:16:44.8481180+02:00"
2025-11-24 03:16:44.848 +02:00 [INF] Fetching "2025-11-24"'s appointments for doctor ID 1
2025-11-24 03:16:44.849 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:16:44.850 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:16:44.850 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 03:16:44.851 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:16:44.851 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:16:44.852 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:16:44.852 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:16:44.852 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:16:44.853 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:16:44.856 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:16:44.859 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:16:44.860 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:16:44.861 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:16:44.862 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:16:44.863 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:16:44.864 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:16:44.865 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:16:44.865 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:16:44.866 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:16:44.866 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 6ms reading results.
2025-11-24 03:16:44.867 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:16:44.869 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (1ms).
2025-11-24 03:16:44.870 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:16:44.870 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:16:44.871 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:16:44.872 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:16:44.872 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:16:44.873 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Status] = N'Confirmed'
2025-11-24 03:16:44.876 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Status] = N'Confirmed'
2025-11-24 03:16:44.878 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:16:44.878 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 0ms reading results.
2025-11-24 03:16:44.879 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:16:44.879 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:16:44.880 +02:00 [INF] No appointments found for doctor ID 1 today
2025-11-24 03:16:44.880 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 03:16:44.881 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 03:16:44.881 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 03:16:44.882 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 03:16:44.882 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 03:16:44.883 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Appointment.AppoinmentandPaientDetaliesDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 03:16:44.883 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital) in 47.3195ms
2025-11-24 03:16:44.884 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)'
2025-11-24 03:16:44.885 +02:00 [DBG] Connection id "0HNHAUKB7C1BJ" completed keep alive response.
2025-11-24 03:16:44.885 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:16:44.886 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:16:44.886 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 03:16:44.887 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Doctor/1/date/2025-11-24 - 200 null application/json; charset=utf-8 64.6611ms
2025-11-24 03:16:57.197 +02:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-11-24 03:16:57.290 +02:00 [DBG] Hosting starting
2025-11-24 03:16:57.311 +02:00 [INF] User profile is available. Using 'C:\Users\E-Mad\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-24 03:16:57.319 +02:00 [DBG] Reading data from file 'C:\Users\E-Mad\AppData\Local\ASP.NET\DataProtection-Keys\key-b85f0939-0825-4b2b-b21a-67409aec9db0.xml'.
2025-11-24 03:16:57.325 +02:00 [DBG] Found key {b85f0939-0825-4b2b-b21a-67409aec9db0}.
2025-11-24 03:16:57.332 +02:00 [DBG] Considering key {b85f0939-0825-4b2b-b21a-67409aec9db0} with expiration date 2026-02-09 12:52:20Z as default key.
2025-11-24 03:16:57.336 +02:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-11-24 03:16:57.339 +02:00 [DBG] Decrypting secret element using Windows DPAPI.
2025-11-24 03:16:57.340 +02:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-11-24 03:16:57.345 +02:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-11-24 03:16:57.348 +02:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-11-24 03:16:57.351 +02:00 [DBG] Using key {b85f0939-0825-4b2b-b21a-67409aec9db0} as the default key.
2025-11-24 03:16:57.353 +02:00 [DBG] Key ring with default key {b85f0939-0825-4b2b-b21a-67409aec9db0} was loaded during application startup.
2025-11-24 03:16:57.357 +02:00 [DBG] Middleware loaded
2025-11-24 03:16:57.359 +02:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16501 B).
2025-11-24 03:16:57.360 +02:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2025-11-24 03:16:57.424 +02:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2025-11-24 03:16:57.500 +02:00 [INF] Now listening on: https://localhost:7217
2025-11-24 03:16:57.502 +02:00 [INF] Now listening on: http://localhost:5163
2025-11-24 03:16:57.504 +02:00 [DBG] Loaded hosting startup assembly Hospital
2025-11-24 03:16:57.505 +02:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2025-11-24 03:16:57.505 +02:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2025-11-24 03:16:57.506 +02:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2025-11-24 03:16:57.569 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-11-24 03:16:57.570 +02:00 [INF] Hosting environment: Development
2025-11-24 03:16:57.570 +02:00 [INF] Content root path: D:\Walaa\GP\Hospital\Hospital
2025-11-24 03:16:57.571 +02:00 [DBG] Hosting started
2025-11-24 03:16:57.701 +02:00 [DBG] Connection id "0HNHAUSKQ5G6Q" received FIN.
2025-11-24 03:16:57.707 +02:00 [DBG] Connection id "0HNHAUSKQ5G6Q" accepted.
2025-11-24 03:16:57.708 +02:00 [DBG] Connection id "0HNHAUSKQ5G6Q" started.
2025-11-24 03:16:57.722 +02:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-11-24 03:16:57.748 +02:00 [DBG] Connection id "0HNHAUSKQ5G6Q" stopped.
2025-11-24 03:16:57.750 +02:00 [DBG] Connection id "0HNHAUSKQ5G6Q" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-11-24 03:16:57.820 +02:00 [DBG] Connection id "0HNHAUSKQ5G6R" accepted.
2025-11-24 03:16:57.822 +02:00 [DBG] Connection id "0HNHAUSKQ5G6R" started.
2025-11-24 03:16:57.859 +02:00 [DBG] Connection 0HNHAUSKQ5G6R established using the following protocol: "Tls12"
2025-11-24 03:16:57.909 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/swagger/index.html - null null
2025-11-24 03:16:57.973 +02:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-11-24 03:16:57.994 +02:00 [DBG] No candidates found for the request path '/swagger/index.html'
2025-11-24 03:16:57.995 +02:00 [DBG] Request did not match any endpoints
2025-11-24 03:16:58.035 +02:00 [DBG] Response markup is scheduled to include Browser Link script injection.
2025-11-24 03:16:58.037 +02:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2025-11-24 03:16:58.048 +02:00 [DBG] Response markup was updated to include Browser Link script injection.
2025-11-24 03:16:58.049 +02:00 [DBG] Response markup was updated to include browser refresh script injection.
2025-11-24 03:16:58.051 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/swagger/index.html - 200 null text/html;charset=utf-8 148.04ms
2025-11-24 03:16:58.062 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/_framework/aspnetcore-browser-refresh.js - null null
2025-11-24 03:16:58.062 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/_vs/browserLink - null null
2025-11-24 03:16:58.068 +02:00 [DBG] Script injected: /_framework/aspnetcore-browser-refresh.js
2025-11-24 03:16:58.070 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/_framework/aspnetcore-browser-refresh.js - 200 16501 application/javascript; charset=utf-8 7.8967ms
2025-11-24 03:16:58.099 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/_vs/browserLink - 200 null text/javascript; charset=UTF-8 37.1621ms
2025-11-24 03:16:58.141 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/swagger/v1/swagger.json - null null
2025-11-24 03:16:58.145 +02:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2025-11-24 03:16:58.146 +02:00 [DBG] Request did not match any endpoints
2025-11-24 03:16:58.187 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 46.6046ms
2025-11-24 03:17:05.483 +02:00 [DBG] Connection id "0HNHAUSKQ5G6S" accepted.
2025-11-24 03:17:05.483 +02:00 [DBG] Connection id "0HNHAUSKQ5G6S" received FIN.
2025-11-24 03:17:05.485 +02:00 [DBG] Connection id "0HNHAUSKQ5G6S" started.
2025-11-24 03:17:05.485 +02:00 [DBG] Connection id "0HNHAUSKQ5G6T" accepted.
2025-11-24 03:17:05.487 +02:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException: Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveHandshakeFrameAsync[TIOAdapter](CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](Boolean receiveFirst, Byte[] reAuthenticationData, CancellationToken cancellationToken)
   at System.Net.Security.SslStream.ProcessAuthenticationWithTelemetryAsync(Boolean isAsync, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2025-11-24 03:17:05.487 +02:00 [DBG] Connection id "0HNHAUSKQ5G6T" started.
2025-11-24 03:17:05.489 +02:00 [DBG] Connection id "0HNHAUSKQ5G6S" stopped.
2025-11-24 03:17:05.490 +02:00 [DBG] Connection id "0HNHAUSKQ5G6S" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-11-24 03:17:05.493 +02:00 [DBG] Connection 0HNHAUSKQ5G6T established using the following protocol: "Tls12"
2025-11-24 03:17:05.496 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Doctor/1/date/2025-11-24 - null null
2025-11-24 03:17:05.499 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/1/date/2025-11-24'
2025-11-24 03:17:05.503 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)' with route pattern 'api/Doctor/{doctorId:int}/date/{date:datetime}' is valid for the request path '/api/Doctor/1/date/2025-11-24'
2025-11-24 03:17:05.504 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)'
2025-11-24 03:17:05.506 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:17:05.532 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:17:05.535 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)'
2025-11-24 03:17:05.555 +02:00 [INF] Route matched with {action = "GetAppointmentsForDoctor", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAppointmentsForDoctor(Int32, System.DateTime) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 03:17:05.559 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:17:05.561 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:17:05.562 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:17:05.563 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:17:05.564 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:17:05.566 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:17:05.858 +02:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-11-24 03:17:05.884 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:17:05.896 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:17:05.899 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' using the name 'doctorId' in request data ...
2025-11-24 03:17:05.900 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:17:05.901 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:17:05.901 +02:00 [DBG] Attempting to validate the bound parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:17:05.903 +02:00 [DBG] Done attempting to validate the bound parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:17:05.904 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateTime' ...
2025-11-24 03:17:05.904 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateTime' using the name 'date' in request data ...
2025-11-24 03:17:05.905 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateTime'.
2025-11-24 03:17:05.906 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateTime'.
2025-11-24 03:17:05.906 +02:00 [DBG] Attempting to validate the bound parameter 'date' of type 'System.DateTime' ...
2025-11-24 03:17:05.907 +02:00 [DBG] Done attempting to validate the bound parameter 'date' of type 'System.DateTime'.
2025-11-24 03:17:05.911 +02:00 [INF] GetAppointmentsForDoctor called at "2025-11-24T03:17:05.9110241+02:00"
2025-11-24 03:17:05.913 +02:00 [INF] Fetching "2025-11-24"'s appointments for doctor ID 1
2025-11-24 03:17:06.388 +02:00 [DBG] The index {'BranchesBranchId'} was not created on entity type 'BranchDoctor (Dictionary<string, object>)' as the properties are already covered by the index {'BranchesBranchId', 'DoctorsDoctorId'}.
2025-11-24 03:17:06.391 +02:00 [DBG] The index {'BranchId'} was not created on entity type 'BranchService (Dictionary<string, object>)' as the properties are already covered by the index {'BranchId', 'ServiceId'}.
2025-11-24 03:17:06.392 +02:00 [DBG] The index {'BranchId'} was not created on entity type 'BranchSpecialization (Dictionary<string, object>)' as the properties are already covered by the index {'BranchId', 'SpecializationId'}.
2025-11-24 03:17:06.393 +02:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserRole<string>' as the properties are already covered by the index {'UserId', 'RoleId'}.
2025-11-24 03:17:06.394 +02:00 [DBG] The index {'UserId'} was not created on entity type 'IdentityUserToken<string>' as the properties are already covered by the index {'UserId', 'LoginProvider', 'Name'}.
2025-11-24 03:17:06.493 +02:00 [DBG] The property 'BranchDoctor (Dictionary<string, object>).BranchesBranchId' was created in shadow state because there are no eligible CLR members with a matching name.
2025-11-24 03:17:06.494 +02:00 [DBG] The property 'BranchDoctor (Dictionary<string, object>).DoctorsDoctorId' was created in shadow state because there are no eligible CLR members with a matching name.
2025-11-24 03:17:06.669 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:17:06.754 +02:00 [DBG] Compiling query expression: 
'DbSet<Doctor>()
    .Include(d => d.User)
    .Include(d => d.Specialization)
    .Include(d => d.Branches)
    .Include(d => d.Schedules)
    .FirstOrDefault(d => d.DoctorId == __doctorId_0)'
2025-11-24 03:17:06.818 +02:00 [DBG] Including navigation: 'Doctor.User'.
2025-11-24 03:17:06.822 +02:00 [DBG] Including navigation: 'Doctor.Specialization'.
2025-11-24 03:17:06.825 +02:00 [DBG] Including navigation: 'Doctor.Branches'.
2025-11-24 03:17:06.826 +02:00 [DBG] Including navigation: 'Doctor.Schedules'.
2025-11-24 03:17:06.983 +02:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-11-24 03:17:06.999 +02:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Doctor>(
    asyncEnumerable: new SingleQueryingEnumerable<Doctor>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Doctor.DoctorId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Doctor.Available (bool?), 1], [Property: Doctor.Biography (string), 2], [Property: Doctor.ConsultationFees (decimal) Required, 3], [Property: Doctor.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: Doctor.ExperienceYears (int?), 5], [Property: Doctor.ImageURL (string) MaxLength(300), 6], [Property: Doctor.SpecializationId (int) Required FK Index, 7], [Property: Doctor.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 8], [Property: Doctor.UserId (string) Required FK Index, 9] }
                1 -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 10], [Property: User.AccessFailedCount (int) Required, 11], [Property: User.ConcurrencyStamp (string) Concurrency, 12], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 13], [Property: User.DateOfBirth (DateOnly?), 14], [Property: User.Email (string) Index MaxLength(256), 15], [Property: User.EmailConfirmed (bool) Required, 16], [Property: User.FullName (string) Required MaxLength(150), 17], [Property: User.Gender (GenderType?) MaxLength(10), 18], [Property: User.LockoutEnabled (bool) Required, 19], [Property: User.LockoutEnd (DateTimeOffset?), 20], [Property: User.NormalizedEmail (string) Index MaxLength(256), 21], [Property: User.NormalizedUserName (string) Index MaxLength(256), 22], [Property: User.PasswordHash (string), 23], [Property: User.PhoneNumber (string), 24], [Property: User.PhoneNumberConfirmed (bool) Required, 25], [Property: User.RefreshToken (string), 26], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 27], [Property: User.Role (string) Required MaxLength(50), 28], [Property: User.SecurityStamp (string), 29], [Property: User.TwoFactorEnabled (bool) Required, 30], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 31], [Property: User.UserName (string) MaxLength(256), 32] }
                2 -> Dictionary<IProperty, int> { [Property: Specialization.SpecializationId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 33], [Property: Specialization.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 34], [Property: Specialization.Description (string), 35], [Property: Specialization.Name (string) Required MaxLength(120), 36], [Property: Specialization.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 37] }
                3 -> 0
                4 -> 10
                5 -> 33
                6 -> Dictionary<IProperty, int> { [Property: BranchDoctor (Dictionary<string, object>).BranchesBranchId (no field, int) Indexer Required PK FK AfterSave:Throw, 38], [Property: BranchDoctor (Dictionary<string, object>).DoctorsDoctorId (no field, int) Indexer Required PK FK Index AfterSave:Throw, 39] }
                7 -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 40], [Property: Branch.Address (string) MaxLength(250), 41], [Property: Branch.BranchName (string) Required MaxLength(150), 42], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 43], [Property: Branch.Description (string), 44], [Property: Branch.Email (string) MaxLength(200), 45], [Property: Branch.ImageURL (string) MaxLength(300), 46], [Property: Branch.Phone (string) MaxLength(25), 47], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 48] }
                8 -> 38
                9 -> 39
                10 -> 40
                11 -> Dictionary<IProperty, int> { [Property: Schedule.ScheduleId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 49], [Property: Schedule.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 50], [Property: Schedule.DayOfWeek (string) Required MaxLength(20), 51], [Property: Schedule.DoctorId (int) Required FK Index, 52], [Property: Schedule.EndTime (DateTime) Required, 53], [Property: Schedule.Shift (AppointmentShift) Required, 54], [Property: Schedule.StartTime (DateTime) Required, 55], [Property: Schedule.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 56] }
                12 -> 49
            SELECT t.DoctorId, t.Available, t.Biography, t.ConsultationFees, t.CreatedAt, t.ExperienceYears, t.ImageURL, t.SpecializationId, t.UpdatedAt, t.UserId, t.Id, t.AccessFailedCount, t.ConcurrencyStamp, t.CreatedAt0, t.DateOfBirth, t.Email, t.EmailConfirmed, t.FullName, t.Gender, t.LockoutEnabled, t.LockoutEnd, t.NormalizedEmail, t.NormalizedUserName, t.PasswordHash, t.PhoneNumber, t.PhoneNumberConfirmed, t.RefreshToken, t.RefreshTokenExpiryTime, t.Role, t.SecurityStamp, t.TwoFactorEnabled, t.UpdatedAt0, t.UserName, t.SpecializationId0, t.CreatedAt1, t.Description, t.Name, t.UpdatedAt1, t0.BranchesBranchId, t0.DoctorsDoctorId, t0.BranchId, t0.Address, t0.BranchName, t0.CreatedAt, t0.Description, t0.Email, t0.ImageURL, t0.Phone, t0.UpdatedAt, s0.ScheduleId, s0.CreatedAt, s0.DayOfWeek, s0.DoctorId, s0.EndTime, s0.Shift, s0.StartTime, s0.UpdatedAt
            FROM 
            (
                SELECT TOP(1) d.DoctorId, d.Available, d.Biography, d.ConsultationFees, d.CreatedAt, d.ExperienceYears, d.ImageURL, d.SpecializationId, d.UpdatedAt, d.UserId, u.Id, u.AccessFailedCount, u.ConcurrencyStamp, u.CreatedAt AS CreatedAt0, u.DateOfBirth, u.Email, u.EmailConfirmed, u.FullName, u.Gender, u.LockoutEnabled, u.LockoutEnd, u.NormalizedEmail, u.NormalizedUserName, u.PasswordHash, u.PhoneNumber, u.PhoneNumberConfirmed, u.RefreshToken, u.RefreshTokenExpiryTime, u.Role, u.SecurityStamp, u.TwoFactorEnabled, u.UpdatedAt AS UpdatedAt0, u.UserName, s.SpecializationId AS SpecializationId0, s.CreatedAt AS CreatedAt1, s.Description, s.Name, s.UpdatedAt AS UpdatedAt1
                FROM Doctors AS d
                INNER JOIN Users AS u ON d.UserId == u.Id
                INNER JOIN Specializations AS s ON d.SpecializationId == s.SpecializationId
                WHERE d.DoctorId == @__doctorId_0
            ) AS t
            LEFT JOIN 
            (
                SELECT d0.BranchesBranchId, d0.DoctorsDoctorId, b.BranchId, b.Address, b.BranchName, b.CreatedAt, b.Description, b.Email, b.ImageURL, b.Phone, b.UpdatedAt
                FROM DoctorBranches AS d0
                INNER JOIN Branches AS b ON d0.BranchesBranchId == b.BranchId
            ) AS t0 ON t.DoctorId == t0.DoctorsDoctorId
            LEFT JOIN Schedules AS s0 ON t.DoctorId == s0.DoctorId
            ORDER BY t.DoctorId ASC, t.Id ASC, t.SpecializationId0 ASC, t0.BranchesBranchId ASC, t0.DoctorsDoctorId ASC, t0.BranchId ASC), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Doctor>, 
        Clinic.Infrastructure.Persistence.AppDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-11-24 03:17:07.033 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:17:07.058 +02:00 [DBG] Created DbConnection. (18ms).
2025-11-24 03:17:07.063 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:17:07.263 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:17:07.267 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:17:07.273 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2025-11-24 03:17:07.278 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (11ms).
2025-11-24 03:17:07.284 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:17:07.344 +02:00 [INF] Executed DbCommand (61ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:17:07.381 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:17:07.435 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:17:07.442 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:17:07.483 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:17:07.485 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:17:07.500 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:17:07.521 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:17:07.532 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:17:07.544 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:17:07.550 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 199ms reading results.
2025-11-24 03:17:07.554 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:17:07.558 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (4ms).
2025-11-24 03:17:07.564 +02:00 [DBG] Compiling query expression: 
'DbSet<Appointment>()
    .Include(a => a.Patient)
    .ThenInclude(p => p.User)
    .Include(a => a.Branch)
    .Where(a => a.DoctorId == __doctorId_0 && a.Date == __date_1 && (int)a.Status == 2)'
2025-11-24 03:17:07.565 +02:00 [DBG] Including navigation: 'Appointment.Patient'.
2025-11-24 03:17:07.567 +02:00 [DBG] Including navigation: 'Patient.User'.
2025-11-24 03:17:07.569 +02:00 [DBG] Including navigation: 'Appointment.Branch'.
2025-11-24 03:17:07.584 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Appointment>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Appointment.AppointmentId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Appointment.BranchId (int) Required FK Index, 1], [Property: Appointment.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 2], [Property: Appointment.CreatedBy (string) FK Index, 3], [Property: Appointment.Date (DateOnly) Required, 4], [Property: Appointment.DoctorId (int) Required FK Index, 5], [Property: Appointment.Notes (string), 6], [Property: Appointment.PatientId (int) Required FK Index, 7], [Property: Appointment.PaymentMethod (PaymentMethod) Required, 8], [Property: Appointment.Status (AppointmentStatus) Required MaxLength(20), 9], [Property: Appointment.Time (DateTime) Required, 10], [Property: Appointment.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 11] }
            1 -> Dictionary<IProperty, int> { [Property: Patient.PatientId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 12], [Property: Patient.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 13], [Property: Patient.EmergencyContact (string) MaxLength(150), 14], [Property: Patient.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 15], [Property: Patient.UserId (string) Required FK Index, 16] }
            2 -> Dictionary<IProperty, int> { [Property: User.Id (string) Required PK AfterSave:Throw, 17], [Property: User.AccessFailedCount (int) Required, 18], [Property: User.ConcurrencyStamp (string) Concurrency, 19], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 20], [Property: User.DateOfBirth (DateOnly?), 21], [Property: User.Email (string) Index MaxLength(256), 22], [Property: User.EmailConfirmed (bool) Required, 23], [Property: User.FullName (string) Required MaxLength(150), 24], [Property: User.Gender (GenderType?) MaxLength(10), 25], [Property: User.LockoutEnabled (bool) Required, 26], [Property: User.LockoutEnd (DateTimeOffset?), 27], [Property: User.NormalizedEmail (string) Index MaxLength(256), 28], [Property: User.NormalizedUserName (string) Index MaxLength(256), 29], [Property: User.PasswordHash (string), 30], [Property: User.PhoneNumber (string), 31], [Property: User.PhoneNumberConfirmed (bool) Required, 32], [Property: User.RefreshToken (string), 33], [Property: User.RefreshTokenExpiryTime (DateTime) Required, 34], [Property: User.Role (string) Required MaxLength(50), 35], [Property: User.SecurityStamp (string), 36], [Property: User.TwoFactorEnabled (bool) Required, 37], [Property: User.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 38], [Property: User.UserName (string) MaxLength(256), 39] }
            3 -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 40], [Property: Branch.Address (string) MaxLength(250), 41], [Property: Branch.BranchName (string) Required MaxLength(150), 42], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 43], [Property: Branch.Description (string), 44], [Property: Branch.Email (string) MaxLength(200), 45], [Property: Branch.ImageURL (string) MaxLength(300), 46], [Property: Branch.Phone (string) MaxLength(25), 47], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 48] }
        SELECT a.AppointmentId, a.BranchId, a.CreatedAt, a.CreatedBy, a.Date, a.DoctorId, a.Notes, a.PatientId, a.PaymentMethod, a.Status, a.Time, a.UpdatedAt, p.PatientId, p.CreatedAt, p.EmergencyContact, p.UpdatedAt, p.UserId, u.Id, u.AccessFailedCount, u.ConcurrencyStamp, u.CreatedAt, u.DateOfBirth, u.Email, u.EmailConfirmed, u.FullName, u.Gender, u.LockoutEnabled, u.LockoutEnd, u.NormalizedEmail, u.NormalizedUserName, u.PasswordHash, u.PhoneNumber, u.PhoneNumberConfirmed, u.RefreshToken, u.RefreshTokenExpiryTime, u.Role, u.SecurityStamp, u.TwoFactorEnabled, u.UpdatedAt, u.UserName, b.BranchId, b.Address, b.BranchName, b.CreatedAt, b.Description, b.Email, b.ImageURL, b.Phone, b.UpdatedAt
        FROM Appointments AS a
        INNER JOIN Patients AS p ON a.PatientId == p.PatientId
        INNER JOIN Users AS u ON p.UserId == u.Id
        INNER JOIN Branches AS b ON a.BranchId == b.BranchId
        WHERE ((a.DoctorId == @__doctorId_0) && (a.Date == @__date_1)) && (a.Status == N'Confirmed')), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Appointment>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 03:17:07.588 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:17:07.590 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:17:07.591 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:17:07.591 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:17:07.593 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:17:07.594 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Status] = N'Confirmed'
2025-11-24 03:17:07.614 +02:00 [INF] Executed DbCommand (20ms) [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Status] = N'Confirmed'
2025-11-24 03:17:07.620 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:17:07.620 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 1ms reading results.
2025-11-24 03:17:07.621 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:17:07.621 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:17:07.622 +02:00 [INF] No appointments found for doctor ID 1 today
2025-11-24 03:17:07.625 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 03:17:07.629 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 03:17:07.629 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 03:17:07.630 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 03:17:07.630 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 03:17:07.631 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Appointment.AppoinmentandPaientDetaliesDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 03:17:07.645 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital) in 2078.8439ms
2025-11-24 03:17:07.646 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)'
2025-11-24 03:17:07.649 +02:00 [DBG] Connection id "0HNHAUSKQ5G6T" completed keep alive response.
2025-11-24 03:17:07.652 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:17:07.654 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:17:07.656 +02:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-11-24 03:17:07.657 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Doctor/1/date/2025-11-24 - 200 null application/json; charset=utf-8 2160.941ms
2025-11-24 03:17:20.286 +02:00 [INF] Request starting HTTP/2 PUT https://localhost:7217/api/Doctor/self-update - application/json 165
2025-11-24 03:17:20.291 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/self-update'
2025-11-24 03:17:20.292 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.SelfUpdate (Hospital)' with route pattern 'api/Doctor/self-update' is valid for the request path '/api/Doctor/self-update'
2025-11-24 03:17:20.293 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.SelfUpdate (Hospital)'
2025-11-24 03:17:20.294 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:17:20.295 +02:00 [DBG] The request has an origin header: 'https://localhost:7217'.
2025-11-24 03:17:20.296 +02:00 [INF] CORS policy execution failed.
2025-11-24 03:17:20.297 +02:00 [INF] Request origin https://localhost:7217 does not have permission to access the resource.
2025-11-24 03:17:20.299 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:17:20.300 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.SelfUpdate (Hospital)'
2025-11-24 03:17:20.304 +02:00 [INF] Route matched with {action = "SelfUpdate", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SelfUpdate(Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 03:17:20.305 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:17:20.306 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:17:20.306 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:17:20.308 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:17:20.308 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:17:20.309 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:17:20.312 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:17:20.313 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto' ...
2025-11-24 03:17:20.314 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto' using the name '' in request data ...
2025-11-24 03:17:20.316 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 03:17:20.327 +02:00 [DBG] Connection id "0HNHAUSKQ5G6R", Request id "0HNHAUSKQ5G6R:00000009": started reading request body.
2025-11-24 03:17:20.328 +02:00 [DBG] Connection id "0HNHAUSKQ5G6R", Request id "0HNHAUSKQ5G6R:00000009": done reading request body.
2025-11-24 03:17:20.339 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto'
2025-11-24 03:17:20.340 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto'.
2025-11-24 03:17:20.341 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto'.
2025-11-24 03:17:20.341 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto' ...
2025-11-24 03:17:20.350 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto'.
2025-11-24 03:17:20.355 +02:00 [INF] SelfUpdate doctor called at "2025-11-24T03:17:20.3556535+02:00"
2025-11-24 03:17:20.358 +02:00 [INF] Updating personal info for doctor ID 0
2025-11-24 03:17:20.394 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:17:20.401 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:17:20.403 +02:00 [DBG] Created DbConnection. (1ms).
2025-11-24 03:17:20.404 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:17:20.405 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:17:20.406 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:17:20.407 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:17:20.409 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-11-24 03:17:20.410 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:17:20.413 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:17:20.416 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:17:20.417 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 0ms reading results.
2025-11-24 03:17:20.419 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:17:20.419 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:17:20.420 +02:00 [WRN] Doctor with ID 0 not found
2025-11-24 03:17:20.467 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 03:17:20.468 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 03:17:20.469 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 03:17:20.470 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 03:17:20.470 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 03:17:20.471 +02:00 [INF] Executing NotFoundObjectResult, writing value of type '<>f__AnonymousType4`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-11-24 03:17:20.475 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.SelfUpdate (Hospital) in 165.7638ms
2025-11-24 03:17:20.476 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.SelfUpdate (Hospital)'
2025-11-24 03:17:20.476 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:17:20.477 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:17:20.478 +02:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-11-24 03:17:20.479 +02:00 [INF] Request finished HTTP/2 PUT https://localhost:7217/api/Doctor/self-update - 404 null application/json; charset=utf-8 192.8875ms
2025-11-24 03:18:01.019 +02:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7217/api/Doctor/self-update - application/json 189
2025-11-24 03:18:01.020 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/self-update'
2025-11-24 03:18:01.021 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.SelfUpdate (Hospital)' with route pattern 'api/Doctor/self-update' is valid for the request path '/api/Doctor/self-update'
2025-11-24 03:18:01.023 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.SelfUpdate (Hospital)'
2025-11-24 03:18:01.025 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:18:01.028 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:18:01.029 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.SelfUpdate (Hospital)'
2025-11-24 03:18:01.030 +02:00 [INF] Route matched with {action = "SelfUpdate", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SelfUpdate(Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 03:18:01.030 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:18:01.031 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:18:01.032 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:18:01.032 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:18:01.033 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:18:01.034 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:18:01.045 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:18:01.045 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto' ...
2025-11-24 03:18:01.046 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto' using the name '' in request data ...
2025-11-24 03:18:01.047 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 03:18:01.048 +02:00 [DBG] Connection id "0HNHAUSKQ5G6T", Request id "0HNHAUSKQ5G6T:00000002": started reading request body.
2025-11-24 03:18:01.049 +02:00 [DBG] Connection id "0HNHAUSKQ5G6T", Request id "0HNHAUSKQ5G6T:00000002": done reading request body.
2025-11-24 03:18:01.050 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto'
2025-11-24 03:18:01.050 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto'.
2025-11-24 03:18:01.051 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto'.
2025-11-24 03:18:01.051 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto' ...
2025-11-24 03:18:01.052 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto'.
2025-11-24 03:18:01.053 +02:00 [INF] SelfUpdate doctor called at "2025-11-24T03:18:01.0533814+02:00"
2025-11-24 03:18:01.053 +02:00 [INF] Updating personal info for doctor ID 2
2025-11-24 03:18:01.060 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:18:01.063 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:18:01.063 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 03:18:01.063 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:01.064 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:01.064 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:18:01.065 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:18:01.065 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:18:01.066 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:18:01.076 +02:00 [INF] Executed DbCommand (11ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:18:01.080 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:01.081 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 0ms reading results.
2025-11-24 03:18:01.082 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:01.082 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:18:01.083 +02:00 [WRN] Doctor with ID 2 not found
2025-11-24 03:18:01.111 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 03:18:01.113 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 03:18:01.113 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 03:18:01.114 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 03:18:01.115 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 03:18:01.115 +02:00 [INF] Executing NotFoundObjectResult, writing value of type '<>f__AnonymousType4`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-11-24 03:18:01.116 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.SelfUpdate (Hospital) in 82.7561ms
2025-11-24 03:18:01.117 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.SelfUpdate (Hospital)'
2025-11-24 03:18:01.118 +02:00 [DBG] Connection id "0HNHAUSKQ5G6T" completed keep alive response.
2025-11-24 03:18:01.118 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:18:01.119 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:01.119 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 03:18:01.120 +02:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7217/api/Doctor/self-update - 404 null application/json; charset=utf-8 102.8221ms
2025-11-24 03:18:07.282 +02:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7217/api/Doctor/self-update - application/json 189
2025-11-24 03:18:07.283 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/self-update'
2025-11-24 03:18:07.284 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.SelfUpdate (Hospital)' with route pattern 'api/Doctor/self-update' is valid for the request path '/api/Doctor/self-update'
2025-11-24 03:18:07.286 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.SelfUpdate (Hospital)'
2025-11-24 03:18:07.287 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:18:07.287 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:18:07.288 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.SelfUpdate (Hospital)'
2025-11-24 03:18:07.289 +02:00 [INF] Route matched with {action = "SelfUpdate", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SelfUpdate(Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 03:18:07.291 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:18:07.292 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:18:07.293 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:18:07.294 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:18:07.295 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:18:07.295 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:18:07.296 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:18:07.297 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto' ...
2025-11-24 03:18:07.298 +02:00 [DBG] Attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto' using the name '' in request data ...
2025-11-24 03:18:07.299 +02:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-11-24 03:18:07.299 +02:00 [DBG] Connection id "0HNHAUSKQ5G6T", Request id "0HNHAUSKQ5G6T:00000003": started reading request body.
2025-11-24 03:18:07.300 +02:00 [DBG] Connection id "0HNHAUSKQ5G6T", Request id "0HNHAUSKQ5G6T:00000003": done reading request body.
2025-11-24 03:18:07.301 +02:00 [DBG] JSON input formatter succeeded, deserializing to type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto'
2025-11-24 03:18:07.302 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto'.
2025-11-24 03:18:07.302 +02:00 [DBG] Done attempting to bind parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto'.
2025-11-24 03:18:07.303 +02:00 [DBG] Attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto' ...
2025-11-24 03:18:07.304 +02:00 [DBG] Done attempting to validate the bound parameter 'dto' of type 'Hospital.Application.DTO.Doctor.DoctorSelfUpdateDto'.
2025-11-24 03:18:07.305 +02:00 [INF] SelfUpdate doctor called at "2025-11-24T03:18:07.3056804+02:00"
2025-11-24 03:18:07.306 +02:00 [INF] Updating personal info for doctor ID 1
2025-11-24 03:18:07.307 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:18:07.309 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:18:07.309 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 03:18:07.310 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:07.310 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:07.311 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:18:07.311 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:18:07.312 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:18:07.313 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:18:07.317 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:18:07.319 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:18:07.321 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:18:07.321 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:18:07.322 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:18:07.323 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:18:07.324 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:18:07.325 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:18:07.326 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:18:07.327 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:07.328 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 8ms reading results.
2025-11-24 03:18:07.328 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:07.329 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:18:07.343 +02:00 [DBG] An entity of type 'Doctor' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:18:07.346 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 03:18:07.360 +02:00 [DBG] The unchanged property 'User.FullName' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 03:18:07.361 +02:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:18:07.365 +02:00 [DBG] The unchanged property 'User.PhoneNumber' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-11-24 03:18:07.385 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 03:18:07.394 +02:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-11-24 03:18:07.396 +02:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-11-24 03:18:07.396 +02:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-11-24 03:18:07.453 +02:00 [DBG] Executing 2 update commands as a batch.
2025-11-24 03:18:07.456 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:07.457 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:07.459 +02:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-11-24 03:18:07.464 +02:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-11-24 03:18:07.467 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:18:07.467 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:18:07.471 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2025-11-24 03:18:07.472 +02:00 [DBG] Executing DbCommand [Parameters=[@p9='?' (DbType = Int32), @p0='?' (DbType = Boolean), @p1='?' (Size = 4000), @p2='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (Size = 300), @p6='?' (DbType = Int32), @p7='?' (DbType = DateTime2), @p8='?' (Size = 450), @p13='?' (Size = 450), @p14='?' (Size = 4000), @p10='?' (Size = 150), @p11='?' (Size = 4000), @p12='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Doctors] SET [Available] = @p0, [Biography] = @p1, [ConsultationFees] = @p2, [CreatedAt] = @p3, [ExperienceYears] = @p4, [ImageURL] = @p5, [SpecializationId] = @p6, [UpdatedAt] = @p7, [UserId] = @p8
OUTPUT 1
WHERE [DoctorId] = @p9;
UPDATE [Users] SET [FullName] = @p10, [PhoneNumber] = @p11, [UpdatedAt] = @p12
OUTPUT 1
WHERE [Id] = @p13 AND [ConcurrencyStamp] = @p14;
2025-11-24 03:18:07.482 +02:00 [INF] Executed DbCommand (10ms) [Parameters=[@p9='?' (DbType = Int32), @p0='?' (DbType = Boolean), @p1='?' (Size = 4000), @p2='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (Size = 300), @p6='?' (DbType = Int32), @p7='?' (DbType = DateTime2), @p8='?' (Size = 450), @p13='?' (Size = 450), @p14='?' (Size = 4000), @p10='?' (Size = 150), @p11='?' (Size = 4000), @p12='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Doctors] SET [Available] = @p0, [Biography] = @p1, [ConsultationFees] = @p2, [CreatedAt] = @p3, [ExperienceYears] = @p4, [ImageURL] = @p5, [SpecializationId] = @p6, [UpdatedAt] = @p7, [UserId] = @p8
OUTPUT 1
WHERE [DoctorId] = @p9;
UPDATE [Users] SET [FullName] = @p10, [PhoneNumber] = @p11, [UpdatedAt] = @p12
OUTPUT 1
WHERE [Id] = @p13 AND [ConcurrencyStamp] = @p14;
2025-11-24 03:18:07.488 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:07.488 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 4ms reading results.
2025-11-24 03:18:07.491 +02:00 [DBG] Committing transaction.
2025-11-24 03:18:07.496 +02:00 [DBG] Committed transaction.
2025-11-24 03:18:07.499 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:07.499 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:18:07.502 +02:00 [DBG] Disposing transaction.
2025-11-24 03:18:07.505 +02:00 [DBG] An entity of type 'Doctor' tracked by 'AppDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:18:07.507 +02:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:18:07.510 +02:00 [DBG] SaveChanges completed for 'AppDbContext' with 2 entities written to the database.
2025-11-24 03:18:07.511 +02:00 [INF] Personal info updated successfully for doctor ID 1
2025-11-24 03:18:07.512 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 03:18:07.513 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 03:18:07.513 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 03:18:07.513 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 03:18:07.514 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 03:18:07.515 +02:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType4`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-11-24 03:18:07.516 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.SelfUpdate (Hospital) in 220.3639ms
2025-11-24 03:18:07.516 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.SelfUpdate (Hospital)'
2025-11-24 03:18:07.517 +02:00 [DBG] Connection id "0HNHAUSKQ5G6T" completed keep alive response.
2025-11-24 03:18:07.517 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:18:07.518 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:07.518 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 03:18:07.519 +02:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7217/api/Doctor/self-update - 200 null application/json; charset=utf-8 236.5374ms
2025-11-24 03:18:16.480 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Doctor/1/today - null null
2025-11-24 03:18:16.482 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/1/today'
2025-11-24 03:18:16.483 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital)' with route pattern 'api/Doctor/{doctorId:int}/today' is valid for the request path '/api/Doctor/1/today'
2025-11-24 03:18:16.484 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital)'
2025-11-24 03:18:16.484 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:18:16.484 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:18:16.485 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital)'
2025-11-24 03:18:16.489 +02:00 [INF] Route matched with {action = "GetTodayAppointmentsForDoctor", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetTodayAppointmentsForDoctor(Int32) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 03:18:16.490 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:18:16.491 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:18:16.491 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:18:16.492 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:18:16.493 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:18:16.493 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:18:16.494 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:18:16.495 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:18:16.495 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' using the name 'doctorId' in request data ...
2025-11-24 03:18:16.496 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:18:16.496 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:18:16.497 +02:00 [DBG] Attempting to validate the bound parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:18:16.497 +02:00 [DBG] Done attempting to validate the bound parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:18:16.499 +02:00 [INF] GetTodayAppointmentsForDoctor  called at "2025-11-24T03:18:16.4997922+02:00"
2025-11-24 03:18:16.502 +02:00 [INF] Fetching today's appointments for doctor ID 1
2025-11-24 03:18:16.504 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:18:16.506 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:18:16.506 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 03:18:16.507 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:16.508 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:16.509 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:18:16.509 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:18:16.510 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:18:16.510 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:18:16.513 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:18:16.516 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:18:16.517 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:18:16.518 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:18:16.520 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:18:16.521 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:18:16.521 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:18:16.522 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:18:16.522 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:18:16.523 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:16.523 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 7ms reading results.
2025-11-24 03:18:16.524 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:16.525 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:18:16.526 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:16.527 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:16.527 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:18:16.527 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:18:16.528 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:18:16.529 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Status] = N'Confirmed'
2025-11-24 03:18:16.535 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Status] = N'Confirmed'
2025-11-24 03:18:16.537 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:16.538 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 0ms reading results.
2025-11-24 03:18:16.539 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:16.539 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:18:16.540 +02:00 [INF] No appointments found for doctor ID 1 today
2025-11-24 03:18:16.541 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 03:18:16.543 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 03:18:16.543 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 03:18:16.543 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 03:18:16.544 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 03:18:16.544 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Appointment.AppoinmentandPaientDetaliesDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 03:18:16.545 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital) in 51.5903ms
2025-11-24 03:18:16.546 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital)'
2025-11-24 03:18:16.547 +02:00 [DBG] Connection id "0HNHAUSKQ5G6T" completed keep alive response.
2025-11-24 03:18:16.548 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:18:16.548 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:16.548 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 03:18:16.549 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Doctor/1/today - 200 null application/json; charset=utf-8 69.6895ms
2025-11-24 03:18:29.984 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7217/api/Doctor/1/today - null null
2025-11-24 03:18:29.985 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/1/today'
2025-11-24 03:18:29.986 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital)' with route pattern 'api/Doctor/{doctorId:int}/today' is valid for the request path '/api/Doctor/1/today'
2025-11-24 03:18:29.987 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital)'
2025-11-24 03:18:29.988 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:18:29.990 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:18:29.990 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital)'
2025-11-24 03:18:29.990 +02:00 [INF] Route matched with {action = "GetTodayAppointmentsForDoctor", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetTodayAppointmentsForDoctor(Int32) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 03:18:29.991 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:18:29.992 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:18:29.992 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:18:29.993 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:18:29.994 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:18:29.994 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:18:29.995 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:18:29.995 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:18:29.996 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' using the name 'doctorId' in request data ...
2025-11-24 03:18:29.998 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:18:29.999 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:18:29.999 +02:00 [DBG] Attempting to validate the bound parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:18:30.000 +02:00 [DBG] Done attempting to validate the bound parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:18:30.000 +02:00 [INF] GetTodayAppointmentsForDoctor  called at "2025-11-24T03:18:30.0007828+02:00"
2025-11-24 03:18:30.001 +02:00 [INF] Fetching today's appointments for doctor ID 1
2025-11-24 03:18:30.001 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:18:30.003 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:18:30.004 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 03:18:30.004 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:30.005 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:30.006 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:18:30.006 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:18:30.007 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:18:30.008 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:18:30.019 +02:00 [INF] Executed DbCommand (11ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:18:30.021 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:18:30.022 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:18:30.022 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:18:30.023 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:18:30.023 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:18:30.024 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:18:30.025 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:18:30.025 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:18:30.026 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:30.026 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 4ms reading results.
2025-11-24 03:18:30.028 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:30.030 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (1ms).
2025-11-24 03:18:30.031 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:30.031 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:30.032 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:18:30.032 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:18:30.033 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:18:30.034 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Status] = N'Confirmed'
2025-11-24 03:18:30.042 +02:00 [INF] Executed DbCommand (8ms) [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Status] = N'Confirmed'
2025-11-24 03:18:30.043 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:30.044 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 0ms reading results.
2025-11-24 03:18:30.045 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:30.045 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:18:30.046 +02:00 [INF] No appointments found for doctor ID 1 today
2025-11-24 03:18:30.047 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 03:18:30.048 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 03:18:30.048 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 03:18:30.048 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 03:18:30.049 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 03:18:30.049 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Appointment.AppoinmentandPaientDetaliesDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 03:18:30.050 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital) in 55.5793ms
2025-11-24 03:18:30.050 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.GetTodayAppointmentsForDoctor (Hospital)'
2025-11-24 03:18:30.051 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:18:30.052 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:30.053 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 03:18:30.053 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7217/api/Doctor/1/today - 200 null application/json; charset=utf-8 69.6335ms
2025-11-24 03:18:47.974 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Doctor/1/date/2025-11-24 - null null
2025-11-24 03:18:47.975 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/1/date/2025-11-24'
2025-11-24 03:18:47.976 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)' with route pattern 'api/Doctor/{doctorId:int}/date/{date:datetime}' is valid for the request path '/api/Doctor/1/date/2025-11-24'
2025-11-24 03:18:47.977 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)'
2025-11-24 03:18:47.978 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:18:47.979 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:18:47.979 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)'
2025-11-24 03:18:47.981 +02:00 [INF] Route matched with {action = "GetAppointmentsForDoctor", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAppointmentsForDoctor(Int32, System.DateTime) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 03:18:47.984 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:18:47.984 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:18:47.985 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:18:47.986 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:18:47.986 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:18:47.987 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:18:47.988 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:18:47.989 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:18:47.989 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' using the name 'doctorId' in request data ...
2025-11-24 03:18:47.990 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:18:47.991 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:18:47.991 +02:00 [DBG] Attempting to validate the bound parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:18:47.992 +02:00 [DBG] Done attempting to validate the bound parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:18:47.993 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateTime' ...
2025-11-24 03:18:47.993 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateTime' using the name 'date' in request data ...
2025-11-24 03:18:47.994 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateTime'.
2025-11-24 03:18:47.995 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateTime'.
2025-11-24 03:18:47.995 +02:00 [DBG] Attempting to validate the bound parameter 'date' of type 'System.DateTime' ...
2025-11-24 03:18:47.996 +02:00 [DBG] Done attempting to validate the bound parameter 'date' of type 'System.DateTime'.
2025-11-24 03:18:47.998 +02:00 [INF] GetAppointmentsForDoctor called at "2025-11-24T03:18:47.9982585+02:00"
2025-11-24 03:18:47.999 +02:00 [INF] Fetching "2025-11-24"'s appointments for doctor ID 1
2025-11-24 03:18:48.000 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:18:48.001 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:18:48.002 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 03:18:48.002 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:48.003 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:48.003 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:18:48.004 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:18:48.004 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:18:48.005 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:18:48.015 +02:00 [INF] Executed DbCommand (10ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:18:48.020 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:18:48.021 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:18:48.022 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:18:48.023 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:18:48.024 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:18:48.024 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:18:48.025 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:18:48.026 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:18:48.027 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:48.028 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 8ms reading results.
2025-11-24 03:18:48.030 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:48.030 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:18:48.031 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:48.032 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:48.032 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:18:48.033 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:18:48.033 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:18:48.034 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Status] = N'Confirmed'
2025-11-24 03:18:48.040 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Status] = N'Confirmed'
2025-11-24 03:18:48.041 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:48.042 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 0ms reading results.
2025-11-24 03:18:48.043 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:48.043 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:18:48.044 +02:00 [INF] No appointments found for doctor ID 1 today
2025-11-24 03:18:48.045 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 03:18:48.046 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 03:18:48.047 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 03:18:48.048 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 03:18:48.048 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 03:18:48.049 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Appointment.AppoinmentandPaientDetaliesDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 03:18:48.050 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital) in 62.4484ms
2025-11-24 03:18:48.050 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)'
2025-11-24 03:18:48.051 +02:00 [DBG] Connection id "0HNHAUSKQ5G6T" completed keep alive response.
2025-11-24 03:18:48.051 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:18:48.052 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:48.053 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 03:18:48.053 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Doctor/1/date/2025-11-24 - 200 null application/json; charset=utf-8 79.7911ms
2025-11-24 03:18:53.130 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Doctor/1/date/2025-11-26 - null null
2025-11-24 03:18:53.135 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/1/date/2025-11-26'
2025-11-24 03:18:53.136 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)' with route pattern 'api/Doctor/{doctorId:int}/date/{date:datetime}' is valid for the request path '/api/Doctor/1/date/2025-11-26'
2025-11-24 03:18:53.137 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)'
2025-11-24 03:18:53.139 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:18:53.139 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:18:53.140 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)'
2025-11-24 03:18:53.140 +02:00 [INF] Route matched with {action = "GetAppointmentsForDoctor", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAppointmentsForDoctor(Int32, System.DateTime) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 03:18:53.141 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:18:53.142 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:18:53.142 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:18:53.143 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:18:53.144 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:18:53.144 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:18:53.145 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:18:53.146 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:18:53.147 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' using the name 'doctorId' in request data ...
2025-11-24 03:18:53.148 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:18:53.148 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:18:53.149 +02:00 [DBG] Attempting to validate the bound parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:18:53.150 +02:00 [DBG] Done attempting to validate the bound parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:18:53.150 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateTime' ...
2025-11-24 03:18:53.152 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateTime' using the name 'date' in request data ...
2025-11-24 03:18:53.154 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateTime'.
2025-11-24 03:18:53.155 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateTime'.
2025-11-24 03:18:53.155 +02:00 [DBG] Attempting to validate the bound parameter 'date' of type 'System.DateTime' ...
2025-11-24 03:18:53.156 +02:00 [DBG] Done attempting to validate the bound parameter 'date' of type 'System.DateTime'.
2025-11-24 03:18:53.156 +02:00 [INF] GetAppointmentsForDoctor called at "2025-11-24T03:18:53.1568781+02:00"
2025-11-24 03:18:53.157 +02:00 [INF] Fetching "2025-11-26"'s appointments for doctor ID 1
2025-11-24 03:18:53.158 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:18:53.159 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:18:53.159 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 03:18:53.160 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:53.160 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:53.161 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:18:53.161 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:18:53.162 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:18:53.163 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:18:53.169 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:18:53.173 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:18:53.174 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:18:53.175 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:18:53.176 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:18:53.176 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:18:53.177 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:18:53.178 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:18:53.179 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:18:53.179 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:53.181 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 7ms reading results.
2025-11-24 03:18:53.182 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:53.182 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:18:53.184 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:53.185 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:53.186 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:18:53.186 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:18:53.187 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:18:53.188 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Status] = N'Confirmed'
2025-11-24 03:18:53.191 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Status] = N'Confirmed'
2025-11-24 03:18:53.192 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:53.193 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 0ms reading results.
2025-11-24 03:18:53.193 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:53.194 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:18:53.194 +02:00 [INF] No appointments found for doctor ID 1 today
2025-11-24 03:18:53.195 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 03:18:53.197 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 03:18:53.197 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 03:18:53.198 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 03:18:53.198 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 03:18:53.199 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Appointment.AppoinmentandPaientDetaliesDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 03:18:53.199 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital) in 55.0968ms
2025-11-24 03:18:53.200 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)'
2025-11-24 03:18:53.200 +02:00 [DBG] Connection id "0HNHAUSKQ5G6T" completed keep alive response.
2025-11-24 03:18:53.201 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:18:53.201 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:18:53.203 +02:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-11-24 03:18:53.203 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Doctor/1/date/2025-11-26 - 200 null application/json; charset=utf-8 73.6069ms
2025-11-24 03:19:00.767 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Doctor/1/date/2025-12-26 - null null
2025-11-24 03:19:00.769 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/1/date/2025-12-26'
2025-11-24 03:19:00.769 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)' with route pattern 'api/Doctor/{doctorId:int}/date/{date:datetime}' is valid for the request path '/api/Doctor/1/date/2025-12-26'
2025-11-24 03:19:00.770 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)'
2025-11-24 03:19:00.770 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:19:00.771 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:19:00.771 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)'
2025-11-24 03:19:00.772 +02:00 [INF] Route matched with {action = "GetAppointmentsForDoctor", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAppointmentsForDoctor(Int32, System.DateTime) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 03:19:00.773 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:19:00.774 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:19:00.774 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:19:00.775 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:19:00.776 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:19:00.776 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:19:00.778 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:19:00.778 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:19:00.779 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' using the name 'doctorId' in request data ...
2025-11-24 03:19:00.780 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:19:00.780 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:19:00.781 +02:00 [DBG] Attempting to validate the bound parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:19:00.781 +02:00 [DBG] Done attempting to validate the bound parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:19:00.782 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateTime' ...
2025-11-24 03:19:00.782 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateTime' using the name 'date' in request data ...
2025-11-24 03:19:00.782 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateTime'.
2025-11-24 03:19:00.783 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateTime'.
2025-11-24 03:19:00.784 +02:00 [DBG] Attempting to validate the bound parameter 'date' of type 'System.DateTime' ...
2025-11-24 03:19:00.785 +02:00 [DBG] Done attempting to validate the bound parameter 'date' of type 'System.DateTime'.
2025-11-24 03:19:00.785 +02:00 [INF] GetAppointmentsForDoctor called at "2025-11-24T03:19:00.7858539+02:00"
2025-11-24 03:19:00.786 +02:00 [INF] Fetching "2025-12-26"'s appointments for doctor ID 1
2025-11-24 03:19:00.787 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:19:00.790 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:19:00.791 +02:00 [DBG] Created DbConnection. (1ms).
2025-11-24 03:19:00.791 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:19:00.792 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:19:00.792 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:19:00.793 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:19:00.793 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:19:00.794 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:19:00.797 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:19:00.800 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:19:00.801 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:19:00.802 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:19:00.803 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:19:00.803 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:19:00.804 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:19:00.805 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:19:00.806 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:19:00.807 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:19:00.807 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 7ms reading results.
2025-11-24 03:19:00.808 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:19:00.809 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:19:00.810 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:19:00.811 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:19:00.811 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:19:00.812 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:19:00.812 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:19:00.813 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Status] = N'Confirmed'
2025-11-24 03:19:00.815 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Status] = N'Confirmed'
2025-11-24 03:19:00.816 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:19:00.817 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 0ms reading results.
2025-11-24 03:19:00.820 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:19:00.821 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (1ms).
2025-11-24 03:19:00.822 +02:00 [INF] No appointments found for doctor ID 1 today
2025-11-24 03:19:00.822 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 03:19:00.824 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 03:19:00.825 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 03:19:00.825 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 03:19:00.825 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 03:19:00.826 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Appointment.AppoinmentandPaientDetaliesDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 03:19:00.827 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital) in 50.3479ms
2025-11-24 03:19:00.827 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)'
2025-11-24 03:19:00.828 +02:00 [DBG] Connection id "0HNHAUSKQ5G6T" completed keep alive response.
2025-11-24 03:19:00.829 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:19:00.830 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:19:00.830 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 03:19:00.831 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Doctor/1/date/2025-12-26 - 200 null application/json; charset=utf-8 64.0463ms
2025-11-24 03:19:08.898 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Appointment/GetAll - null null
2025-11-24 03:19:08.899 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Appointment/GetAll'
2025-11-24 03:19:08.901 +02:00 [DBG] Endpoint 'Hospital.API.Controllers.AppointmentController.GetAll (Hospital)' with route pattern 'api/Appointment/GetAll' is valid for the request path '/api/Appointment/GetAll'
2025-11-24 03:19:08.902 +02:00 [DBG] Request matched endpoint 'Hospital.API.Controllers.AppointmentController.GetAll (Hospital)'
2025-11-24 03:19:08.903 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:19:08.904 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:19:08.906 +02:00 [INF] Executing endpoint 'Hospital.API.Controllers.AppointmentController.GetAll (Hospital)'
2025-11-24 03:19:08.909 +02:00 [INF] Route matched with {action = "GetAll", controller = "Appointment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll() on controller Hospital.API.Controllers.AppointmentController (Hospital).
2025-11-24 03:19:08.910 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:19:08.911 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:19:08.911 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:19:08.912 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:19:08.913 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:19:08.913 +02:00 [DBG] Executing controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 03:19:08.915 +02:00 [DBG] Executed controller factory for controller Hospital.API.Controllers.AppointmentController (Hospital)
2025-11-24 03:19:08.916 +02:00 [INF] Get All Appointments called at "2025-11-24T03:19:08.9162502+02:00"
2025-11-24 03:19:08.918 +02:00 [INF] Fetching all appointments
2025-11-24 03:19:08.920 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:19:08.921 +02:00 [DBG] Compiling query expression: 
'DbSet<Appointment>()
    .Include(a => a.Patient)
    .Include(a => a.Doctor)
    .Include(a => a.Branch)'
2025-11-24 03:19:08.922 +02:00 [DBG] Including navigation: 'Appointment.Patient'.
2025-11-24 03:19:08.923 +02:00 [DBG] Including navigation: 'Appointment.Doctor'.
2025-11-24 03:19:08.924 +02:00 [DBG] Including navigation: 'Appointment.Branch'.
2025-11-24 03:19:08.932 +02:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Appointment>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Appointment.AppointmentId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Appointment.BranchId (int) Required FK Index, 1], [Property: Appointment.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 2], [Property: Appointment.CreatedBy (string) FK Index, 3], [Property: Appointment.Date (DateOnly) Required, 4], [Property: Appointment.DoctorId (int) Required FK Index, 5], [Property: Appointment.Notes (string), 6], [Property: Appointment.PatientId (int) Required FK Index, 7], [Property: Appointment.PaymentMethod (PaymentMethod) Required, 8], [Property: Appointment.Status (AppointmentStatus) Required MaxLength(20), 9], [Property: Appointment.Time (DateTime) Required, 10], [Property: Appointment.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 11] }
            1 -> Dictionary<IProperty, int> { [Property: Patient.PatientId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 12], [Property: Patient.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 13], [Property: Patient.EmergencyContact (string) MaxLength(150), 14], [Property: Patient.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 15], [Property: Patient.UserId (string) Required FK Index, 16] }
            2 -> Dictionary<IProperty, int> { [Property: Doctor.DoctorId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 17], [Property: Doctor.Available (bool?), 18], [Property: Doctor.Biography (string), 19], [Property: Doctor.ConsultationFees (decimal) Required, 20], [Property: Doctor.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 21], [Property: Doctor.ExperienceYears (int?), 22], [Property: Doctor.ImageURL (string) MaxLength(300), 23], [Property: Doctor.SpecializationId (int) Required FK Index, 24], [Property: Doctor.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 25], [Property: Doctor.UserId (string) Required FK Index, 26] }
            3 -> Dictionary<IProperty, int> { [Property: Branch.BranchId (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 27], [Property: Branch.Address (string) MaxLength(250), 28], [Property: Branch.BranchName (string) Required MaxLength(150), 29], [Property: Branch.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 30], [Property: Branch.Description (string), 31], [Property: Branch.Email (string) MaxLength(200), 32], [Property: Branch.ImageURL (string) MaxLength(300), 33], [Property: Branch.Phone (string) MaxLength(25), 34], [Property: Branch.UpdatedAt (DateTime) Required ValueGenerated.OnAdd, 35] }
        SELECT a.AppointmentId, a.BranchId, a.CreatedAt, a.CreatedBy, a.Date, a.DoctorId, a.Notes, a.PatientId, a.PaymentMethod, a.Status, a.Time, a.UpdatedAt, p.PatientId, p.CreatedAt, p.EmergencyContact, p.UpdatedAt, p.UserId, d.DoctorId, d.Available, d.Biography, d.ConsultationFees, d.CreatedAt, d.ExperienceYears, d.ImageURL, d.SpecializationId, d.UpdatedAt, d.UserId, b.BranchId, b.Address, b.BranchName, b.CreatedAt, b.Description, b.Email, b.ImageURL, b.Phone, b.UpdatedAt
        FROM Appointments AS a
        INNER JOIN Patients AS p ON a.PatientId == p.PatientId
        INNER JOIN Doctors AS d ON a.DoctorId == d.DoctorId
        INNER JOIN Branches AS b ON a.BranchId == b.BranchId), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Appointment>, 
    Clinic.Infrastructure.Persistence.AppDbContext, 
    False, 
    False, 
    True
)'
2025-11-24 03:19:08.936 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:19:08.937 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 03:19:08.937 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:19:08.938 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:19:08.939 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:19:08.939 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:19:08.940 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:19:08.941 +02:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Doctors] AS [d] ON [a].[DoctorId] = [d].[DoctorId]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
2025-11-24 03:19:08.954 +02:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Doctors] AS [d] ON [a].[DoctorId] = [d].[DoctorId]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
2025-11-24 03:19:08.960 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:19:08.974 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:19:08.976 +02:00 [DBG] Context 'AppDbContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:19:08.982 +02:00 [DBG] The navigation 'Appointment.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:19:08.983 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:19:08.984 +02:00 [DBG] The navigation 'Appointment.Branch' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:19:08.985 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:19:08.986 +02:00 [DBG] The navigation 'Appointment.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:19:08.986 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:19:08.987 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:19:08.987 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:19:08.988 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:19:08.989 +02:00 [DBG] The navigation 'Appointment.Branch' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:19:08.989 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:19:08.991 +02:00 [DBG] The navigation 'Appointment.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:19:08.991 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:19:08.992 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:19:08.993 +02:00 [DBG] The navigation 'Appointment.Doctor' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:19:08.994 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:19:08.995 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:19:08.997 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:19:08.997 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 41ms reading results.
2025-11-24 03:19:08.998 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:19:08.999 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:19:09.008 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 03:19:09.009 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 03:19:09.009 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 03:19:09.010 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 03:19:09.011 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 03:19:09.011 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Appointment.AppointmentDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 03:19:09.016 +02:00 [INF] Executed action Hospital.API.Controllers.AppointmentController.GetAll (Hospital) in 102.4691ms
2025-11-24 03:19:09.016 +02:00 [INF] Executed endpoint 'Hospital.API.Controllers.AppointmentController.GetAll (Hospital)'
2025-11-24 03:19:09.018 +02:00 [DBG] Connection id "0HNHAUSKQ5G6T" completed keep alive response.
2025-11-24 03:19:09.019 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:19:09.019 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:19:09.020 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 03:19:09.021 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Appointment/GetAll - 200 null application/json; charset=utf-8 123.271ms
2025-11-24 03:19:29.341 +02:00 [INF] Request starting HTTP/1.1 GET https://localhost:7217/api/Doctor/1/date/2025-12-24 - null null
2025-11-24 03:19:29.342 +02:00 [DBG] 1 candidate(s) found for the request path '/api/Doctor/1/date/2025-12-24'
2025-11-24 03:19:29.343 +02:00 [DBG] Endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)' with route pattern 'api/Doctor/{doctorId:int}/date/{date:datetime}' is valid for the request path '/api/Doctor/1/date/2025-12-24'
2025-11-24 03:19:29.344 +02:00 [DBG] Request matched endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)'
2025-11-24 03:19:29.344 +02:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-11-24 03:19:29.345 +02:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-11-24 03:19:29.345 +02:00 [INF] Executing endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)'
2025-11-24 03:19:29.345 +02:00 [INF] Route matched with {action = "GetAppointmentsForDoctor", controller = "Doctor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAppointmentsForDoctor(Int32, System.DateTime) on controller Hospital.Controllers.DoctorController (Hospital).
2025-11-24 03:19:29.346 +02:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-11-24 03:19:29.347 +02:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-11-24 03:19:29.347 +02:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-11-24 03:19:29.349 +02:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-11-24 03:19:29.351 +02:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-11-24 03:19:29.352 +02:00 [DBG] Executing controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:19:29.353 +02:00 [DBG] Executed controller factory for controller Hospital.Controllers.DoctorController (Hospital)
2025-11-24 03:19:29.355 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:19:29.355 +02:00 [DBG] Attempting to bind parameter 'doctorId' of type 'System.Int32' using the name 'doctorId' in request data ...
2025-11-24 03:19:29.356 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:19:29.357 +02:00 [DBG] Done attempting to bind parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:19:29.358 +02:00 [DBG] Attempting to validate the bound parameter 'doctorId' of type 'System.Int32' ...
2025-11-24 03:19:29.359 +02:00 [DBG] Done attempting to validate the bound parameter 'doctorId' of type 'System.Int32'.
2025-11-24 03:19:29.360 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateTime' ...
2025-11-24 03:19:29.361 +02:00 [DBG] Attempting to bind parameter 'date' of type 'System.DateTime' using the name 'date' in request data ...
2025-11-24 03:19:29.362 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateTime'.
2025-11-24 03:19:29.362 +02:00 [DBG] Done attempting to bind parameter 'date' of type 'System.DateTime'.
2025-11-24 03:19:29.363 +02:00 [DBG] Attempting to validate the bound parameter 'date' of type 'System.DateTime' ...
2025-11-24 03:19:29.364 +02:00 [DBG] Done attempting to validate the bound parameter 'date' of type 'System.DateTime'.
2025-11-24 03:19:29.365 +02:00 [INF] GetAppointmentsForDoctor called at "2025-11-24T03:19:29.3653796+02:00"
2025-11-24 03:19:29.365 +02:00 [INF] Fetching "2025-12-24"'s appointments for doctor ID 1
2025-11-24 03:19:29.367 +02:00 [DBG] Entity Framework Core 8.0.21 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.21' with options: None
2025-11-24 03:19:29.368 +02:00 [DBG] Creating DbConnection.
2025-11-24 03:19:29.368 +02:00 [DBG] Created DbConnection. (0ms).
2025-11-24 03:19:29.369 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:19:29.369 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:19:29.370 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:19:29.370 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:19:29.371 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:19:29.371 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:19:29.376 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__doctorId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[DoctorId], [t].[Available], [t].[Biography], [t].[ConsultationFees], [t].[CreatedAt], [t].[ExperienceYears], [t].[ImageURL], [t].[SpecializationId], [t].[UpdatedAt], [t].[UserId], [t].[Id], [t].[AccessFailedCount], [t].[ConcurrencyStamp], [t].[CreatedAt0], [t].[DateOfBirth], [t].[Email], [t].[EmailConfirmed], [t].[FullName], [t].[Gender], [t].[LockoutEnabled], [t].[LockoutEnd], [t].[NormalizedEmail], [t].[NormalizedUserName], [t].[PasswordHash], [t].[PhoneNumber], [t].[PhoneNumberConfirmed], [t].[RefreshToken], [t].[RefreshTokenExpiryTime], [t].[Role], [t].[SecurityStamp], [t].[TwoFactorEnabled], [t].[UpdatedAt0], [t].[UserName], [t].[SpecializationId0], [t].[CreatedAt1], [t].[Description], [t].[Name], [t].[UpdatedAt1], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId], [t0].[Address], [t0].[BranchName], [t0].[CreatedAt], [t0].[Description], [t0].[Email], [t0].[ImageURL], [t0].[Phone], [t0].[UpdatedAt], [s0].[ScheduleId], [s0].[CreatedAt], [s0].[DayOfWeek], [s0].[DoctorId], [s0].[EndTime], [s0].[Shift], [s0].[StartTime], [s0].[UpdatedAt]
FROM (
    SELECT TOP(1) [d].[DoctorId], [d].[Available], [d].[Biography], [d].[ConsultationFees], [d].[CreatedAt], [d].[ExperienceYears], [d].[ImageURL], [d].[SpecializationId], [d].[UpdatedAt], [d].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt] AS [CreatedAt0], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt] AS [UpdatedAt0], [u].[UserName], [s].[SpecializationId] AS [SpecializationId0], [s].[CreatedAt] AS [CreatedAt1], [s].[Description], [s].[Name], [s].[UpdatedAt] AS [UpdatedAt1]
    FROM [Doctors] AS [d]
    INNER JOIN [Users] AS [u] ON [d].[UserId] = [u].[Id]
    INNER JOIN [Specializations] AS [s] ON [d].[SpecializationId] = [s].[SpecializationId]
    WHERE [d].[DoctorId] = @__doctorId_0
) AS [t]
LEFT JOIN (
    SELECT [d0].[BranchesBranchId], [d0].[DoctorsDoctorId], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
    FROM [DoctorBranches] AS [d0]
    INNER JOIN [Branches] AS [b] ON [d0].[BranchesBranchId] = [b].[BranchId]
) AS [t0] ON [t].[DoctorId] = [t0].[DoctorsDoctorId]
LEFT JOIN [Schedules] AS [s0] ON [t].[DoctorId] = [s0].[DoctorId]
ORDER BY [t].[DoctorId], [t].[Id], [t].[SpecializationId0], [t0].[BranchesBranchId], [t0].[DoctorsDoctorId], [t0].[BranchId]
2025-11-24 03:19:29.382 +02:00 [DBG] Context 'AppDbContext' started tracking 'Doctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:19:29.383 +02:00 [DBG] The navigation 'Doctor.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:19:29.384 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:19:29.385 +02:00 [DBG] The navigation 'Doctor.Specialization' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:19:29.385 +02:00 [DBG] Context 'AppDbContext' started tracking 'Specialization' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:19:29.386 +02:00 [DBG] Context 'AppDbContext' started tracking 'BranchDoctor' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:19:29.387 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:19:29.389 +02:00 [DBG] Context 'AppDbContext' started tracking 'Schedule' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:19:29.389 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:19:29.390 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 7ms reading results.
2025-11-24 03:19:29.391 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:19:29.392 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:19:29.393 +02:00 [DBG] Opening connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:19:29.394 +02:00 [DBG] Opened connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:19:29.394 +02:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-11-24 03:19:29.395 +02:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-11-24 03:19:29.396 +02:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-11-24 03:19:29.396 +02:00 [DBG] Executing DbCommand [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Status] = N'Confirmed'
2025-11-24 03:19:29.399 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__doctorId_0='?' (DbType = Int32), @__date_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[AppointmentId], [a].[BranchId], [a].[CreatedAt], [a].[CreatedBy], [a].[Date], [a].[DoctorId], [a].[Notes], [a].[PatientId], [a].[PaymentMethod], [a].[Status], [a].[Time], [a].[UpdatedAt], [p].[PatientId], [p].[CreatedAt], [p].[EmergencyContact], [p].[UpdatedAt], [p].[UserId], [u].[Id], [u].[AccessFailedCount], [u].[ConcurrencyStamp], [u].[CreatedAt], [u].[DateOfBirth], [u].[Email], [u].[EmailConfirmed], [u].[FullName], [u].[Gender], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiryTime], [u].[Role], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UpdatedAt], [u].[UserName], [b].[BranchId], [b].[Address], [b].[BranchName], [b].[CreatedAt], [b].[Description], [b].[Email], [b].[ImageURL], [b].[Phone], [b].[UpdatedAt]
FROM [Appointments] AS [a]
INNER JOIN [Patients] AS [p] ON [a].[PatientId] = [p].[PatientId]
INNER JOIN [Users] AS [u] ON [p].[UserId] = [u].[Id]
INNER JOIN [Branches] AS [b] ON [a].[BranchId] = [b].[BranchId]
WHERE [a].[DoctorId] = @__doctorId_0 AND [a].[Date] = @__date_1 AND [a].[Status] = N'Confirmed'
2025-11-24 03:19:29.402 +02:00 [DBG] Context 'AppDbContext' started tracking 'Appointment' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:19:29.402 +02:00 [DBG] The navigation 'Appointment.Patient' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:19:29.403 +02:00 [DBG] Context 'AppDbContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:19:29.405 +02:00 [DBG] The navigation 'Patient.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:19:29.405 +02:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:19:29.406 +02:00 [DBG] The navigation 'Appointment.Branch' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:19:29.406 +02:00 [DBG] Context 'AppDbContext' started tracking 'Branch' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-11-24 03:19:29.407 +02:00 [DBG] Closing data reader to 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:19:29.408 +02:00 [DBG] A data reader for 'HospitalDB' on server '.\SQLEXPRESS' is being disposed after spending 6ms reading results.
2025-11-24 03:19:29.409 +02:00 [DBG] Closing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:19:29.409 +02:00 [DBG] Closed connection to database 'HospitalDB' on server '.\SQLEXPRESS' (0ms).
2025-11-24 03:19:29.415 +02:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-11-24 03:19:29.416 +02:00 [DBG] No information found on request to perform content negotiation.
2025-11-24 03:19:29.417 +02:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-11-24 03:19:29.417 +02:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-11-24 03:19:29.417 +02:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-11-24 03:19:29.418 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Hospital.Application.DTO.Appointment.AppoinmentandPaientDetaliesDto, Hospital.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-11-24 03:19:29.420 +02:00 [INF] Executed action Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital) in 67.947ms
2025-11-24 03:19:29.421 +02:00 [INF] Executed endpoint 'Hospital.Controllers.DoctorController.GetAppointmentsForDoctor (Hospital)'
2025-11-24 03:19:29.421 +02:00 [DBG] Connection id "0HNHAUSKQ5G6T" completed keep alive response.
2025-11-24 03:19:29.422 +02:00 [DBG] 'AppDbContext' disposed.
2025-11-24 03:19:29.422 +02:00 [DBG] Disposing connection to database 'HospitalDB' on server '.\SQLEXPRESS'.
2025-11-24 03:19:29.423 +02:00 [DBG] Disposed connection to database '' on server '' (0ms).
2025-11-24 03:19:29.424 +02:00 [INF] Request finished HTTP/1.1 GET https://localhost:7217/api/Doctor/1/date/2025-12-24 - 200 null application/json; charset=utf-8 83.0321ms
